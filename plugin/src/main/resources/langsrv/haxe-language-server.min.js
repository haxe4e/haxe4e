!function(e){"use strict";var t,n=function(){return Yn.__string_rec(this,"")},r=r||{};class i{static __format_get(e,t){switch(t){case"%":return"%";case"A":return i.DAY_NAMES[e.getDay()];case"B":return i.MONTH_NAMES[e.getMonth()];case"C":return se.lpad(re.string(e.getFullYear()/100|0),"0",2);case"D":return i.__format(e,"%m/%d/%y");case"F":return i.__format(e,"%Y-%m-%d");case"M":return se.lpad(re.string(e.getMinutes()),"0",2);case"R":return i.__format(e,"%H:%M");case"S":return se.lpad(re.string(e.getSeconds()),"0",2);case"T":return i.__format(e,"%H:%M:%S");case"Y":return re.string(e.getFullYear());case"a":return i.DAY_SHORT_NAMES[e.getDay()];case"d":return se.lpad(re.string(e.getDate()),"0",2);case"e":return re.string(e.getDate());case"b":case"h":return i.MONTH_SHORT_NAMES[e.getMonth()];case"H":case"k":return se.lpad(re.string(e.getHours()),"H"==t?"0":" ",2);case"I":case"l":let n=e.getHours()%12;return se.lpad(re.string(0==n?12:n),"I"==t?"0":" ",2);case"m":return se.lpad(re.string(e.getMonth()+1),"0",2);case"n":return"\n";case"p":return e.getHours()>11?"PM":"AM";case"r":return i.__format(e,"%I:%M:%S %p");case"s":return re.string(e.getTime()/1e3|0);case"t":return"\t";case"u":let r=e.getDay();return 0==r?"7":null==r?"null":""+r;case"w":return re.string(e.getDay());case"y":return se.lpad(re.string(e.getFullYear()%100),"0",2);default:throw new rt("Date.format %"+t+"- not implemented yet.",null,{fileName:"DateTools.hx",lineNumber:101,className:"DateTools",methodName:"__format_get"})}}static __format(e,t){let n="",r=0;for(;;){let s=t.indexOf("%",r);if(s<0)break;let l=s-r;n+=null==l?a.substr(t,r,null):a.substr(t,r,l),n+=re.string(i.__format_get(e,a.substr(t,s+1,1))),r=s+2}let s=t.length-r;return n+=null==s?a.substr(t,r,null):a.substr(t,r,s),n}static format(e,t){return i.__format(e,t)}}i.__name__="DateTools";class s{constructor(e,t){this.r=new RegExp(e,t.split("u").join(""))}match(e){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(e),this.r.s=e,null!=this.r.m}matched(e){if(null!=this.r.m&&e>=0&&e<this.r.m.length)return this.r.m[e];throw Me.thrown("EReg::matched")}matchedRight(){if(null==this.r.m)throw Me.thrown("No string matched");let e=this.r.m.index+this.r.m[0].length;return a.substr(this.r.s,e,this.r.s.length-e)}matchedPos(){if(null==this.r.m)throw Me.thrown("No string matched");return{pos:this.r.m.index,len:this.r.m[0].length}}matchSub(e,t,n){if(null==n&&(n=-1),this.r.global){this.r.lastIndex=t,this.r.m=this.r.exec(n<0?e:a.substr(e,0,t+n));let r=null!=this.r.m;return r&&(this.r.s=e),r}{let r=this.match(n<0?a.substr(e,t,null):a.substr(e,t,n));return r&&(this.r.s=e,this.r.m.index+=t),r}}split(e){return e.replace(this.r,"#__delim__#").split("#__delim__#")}map(e,t){let n=0,r="";do{if(n>=e.length)break;if(!this.matchSub(e,n)){r+=re.string(a.substr(e,n,null));break}let i=this.matchedPos();r+=re.string(a.substr(e,n,i.pos-n)),r+=re.string(t(this)),0==i.len?(r+=re.string(a.substr(e,i.pos,1)),n=i.pos+1):n=i.pos+i.len}while(this.r.global);return!this.r.global&&n>0&&n<e.length&&(r+=re.string(a.substr(e,n,null))),r}}s.__name__="EReg",Object.assign(s.prototype,{__class__:s});class a{static cca(e,t){let n=e.charCodeAt(t);if(n==n)return n}static substr(e,t,n){if(null==n)n=e.length;else if(n<0){if(0!=t)return"";n=e.length+n}return e.substr(t,n)}static remove(e,t){let n=e.indexOf(t);return-1!=n&&(e.splice(n,1),!0)}static now(){return Date.now()}}a.__name__="HxOverrides";class l{constructor(e,t,n){this.errors=e,this.putils=t,this.errorType=n}fromJson(e,t){null==t&&(t=""),this.putils=new Hi(e),this.errors=[];try{this.loadJson(new Pi(e,t).doParse())}catch(e){We.lastError=e;let t=Me.caught(e).unwrap();if(!(t instanceof Ti))throw e;{let e=t;this.errors.push(ji.ParserError(e.message,this.putils.convertPosition(e.pos)))}}return this.value}loadJson(e,t){null==t&&(t="");let n=this.putils.convertPosition(e.pos),r=e.value;switch(r._hx_index){case 0:this.loadJsonString(r.s,n,t);break;case 1:this.loadJsonNumber(r.s,n,t);break;case 2:this.loadJsonObject(r.fields,n,t);break;case 3:this.loadJsonArray(r.values,n,t);break;case 4:this.loadJsonBool(r.b,n,t);break;case 5:this.loadJsonNull(n,t)}return this.value}loadJsonNull(e,t){this.onIncorrectType(e,t)}loadJsonString(e,t,n){this.onIncorrectType(t,n)}loadString(e,t,n,r,i){return-1!=r.indexOf(e)?e:(this.onIncorrectType(t,n),i)}loadJsonNumber(e,t,n){this.onIncorrectType(t,n)}loadJsonInt(e,t,n,r){return null!=re.parseInt(e)&&re.parseInt(e)==parseFloat(e)?re.parseInt(e):(this.onIncorrectType(t,n),r)}loadJsonBool(e,t,n){this.onIncorrectType(t,n)}loadJsonArray(e,t,n){this.onIncorrectType(t,n)}loadJsonArrayValue(e,t,n){let r=[],i=0;for(;i<e.length;){let s,a=e[i++];try{s=t(a,n)}catch(r){We.lastError=r;let e=Me.caught(r).unwrap();if(Yn.__instanceof(e,Mi)){let t=e;if(t!=Mi.ParsingThrow)throw Me.thrown(t);continue}throw r}r.push(s)}return r}loadJsonObject(e,t,n){this.onIncorrectType(t,n)}loadObjectField(e,t,n,r,i,s){try{let i=e(t.value,t.name);return this.mapSet(r,n,!0),i}catch(e){We.lastError=e;let t=Me.caught(e).unwrap();if(Yn.__instanceof(t,Mi)){let e=t;if(e!=Mi.ParsingThrow)throw Me.thrown(e)}else this.errors.push(ji.CustomFunctionException(t,s))}return i}objectSetupAssign(e,t,n){let r=0,i=t.length;for(;r<i;){let i=r++;this.mapSet(e,t[i],n[i])}}objectErrors(e,t){let n=this.putils.convertPosition(new Li(t.file,t.max-1,t.max-1)),r=e.m.keys(),i=r.next();for(;!i.done;){let t=i.value;i=r.next(),e.m.get(t)||this.errors.push(ji.UninitializedVariable(t,n))}}onIncorrectType(e,t){this.parsingThrow()}parsingThrow(){if(0!=this.errorType)throw Me.thrown(Mi.ParsingThrow)}objectThrow(e,t){if(2==this.errorType)throw Me.thrown(Mi.ParsingThrow);1==this.errorType&&this.errors.push(ji.UninitializedVariable(t,e))}mapSet(e,t,n){e.m.set(t,n)}}l.__name__="json2object.reader.BaseParser",Object.assign(l.prototype,{__class__:l});class o extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.errors.push(ji.IncorrectType(t,"{ ?wrapping : Null<formatter.config.WrapConfig>, ?whitespace : Null<formatter.config.WhitespaceConfig>, ?sameLine : Null<formatter.config.SameLineConfig>, ?lineEnds : Null<formatter.config.LineEndConfig>, ?indentation : Null<formatter.config.IndentationConfig>, ?excludes : Null<Array<String>>, ?emptyLines : Null<formatter.config.EmptyLinesConfig>, ?disableFormatting : Null<Bool> }",e)),super.onIncorrectType(e,t)}loadJsonNull(e,t){this.value=null}loadJsonObject(e,n,r){let i=new tt;this.objectSetupAssign(i,["disableFormatting","emptyLines","excludes","indentation","lineEnds","sameLine","whitespace","wrapping"],[!0,!0,!0,!0,!0,!0,!0,!0]),this.value=this.getAuto();let s=0;for(;s<e.length;){let r=e[s];switch(++s,r.name){case"disableFormatting":this.value.disableFormatting=this.loadObjectField(nl(t=new z(this.errors,this.putils,1),t.loadJson),r,"disableFormatting",i,this.value.disableFormatting,n);break;case"emptyLines":this.value.emptyLines=this.loadObjectField(nl(t=new U(this.errors,this.putils,1),t.loadJson),r,"emptyLines",i,this.value.emptyLines,n);break;case"excludes":this.value.excludes=this.loadObjectField(nl(t=new Q(this.errors,this.putils,1),t.loadJson),r,"excludes",i,this.value.excludes,n);break;case"indentation":this.value.indentation=this.loadObjectField(nl(t=new M(this.errors,this.putils,1),t.loadJson),r,"indentation",i,this.value.indentation,n);break;case"lineEnds":this.value.lineEnds=this.loadObjectField(nl(t=new H(this.errors,this.putils,1),t.loadJson),r,"lineEnds",i,this.value.lineEnds,n);break;case"sameLine":this.value.sameLine=this.loadObjectField(nl(t=new W(this.errors,this.putils,1),t.loadJson),r,"sameLine",i,this.value.sameLine,n);break;case"whitespace":this.value.whitespace=this.loadObjectField(nl(t=new J(this.errors,this.putils,1),t.loadJson),r,"whitespace",i,this.value.whitespace,n);break;case"wrapping":this.value.wrapping=this.loadObjectField(nl(t=new $(this.errors,this.putils,1),t.loadJson),r,"wrapping",i,this.value.wrapping,n);break;default:this.errors.push(ji.UnknownVariable(r.name,this.putils.convertPosition(r.namePos)))}}this.objectErrors(i,n)}getAuto(){return{disableFormatting:!1,emptyLines:new U([],this.putils,0).getAuto(),excludes:["\\.haxelib","\\.git","node_modules"],indentation:new M([],this.putils,0).getAuto(),lineEnds:new H([],this.putils,0).getAuto(),sameLine:new W([],this.putils,0).getAuto(),whitespace:new J([],this.putils,0).getAuto(),wrapping:new $([],this.putils,0).getAuto()}}}o.__name__="JsonParser_1",o.__super__=l,Object.assign(o.prototype,{__class__:o});class c extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.errors.push(ji.IncorrectType(t,"Int",e)),super.onIncorrectType(e,t)}loadJsonNull(e,t){this.value=null}loadJsonNumber(e,t,n){this.value=this.loadJsonInt(e,t,n,this.value)}}c.__name__="JsonParser_101",c.__super__=l,Object.assign(c.prototype,{__class__:c});class u extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.value="beforeLast",this.errors.push(ji.IncorrectType(t,"formatter.config.WrappingLocation",e)),this.objectThrow(e,t)}loadJsonNull(e,t){this.value=null}loadJsonString(e,t,n){this.value=this.loadString(e,t,n,["beforeLast","afterLast"],"beforeLast")}}u.__name__="JsonParser_117",u.__super__=l,Object.assign(u.prototype,{__class__:u});class h extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.value="onePerLine",this.errors.push(ji.IncorrectType(t,"formatter.config.WrappingType",e)),this.objectThrow(e,t)}loadJsonNull(e,t){this.value=null}loadJsonString(e,t,n){this.value=this.loadString(e,t,n,["onePerLine","onePerLineAfterFirst","equalNumber","fillLine","fillLineWithLeadingBreak","noWrap","keep"],"onePerLine")}}h.__name__="JsonParser_119",h.__super__=l,Object.assign(h.prototype,{__class__:h});class d extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.errors.push(ji.IncorrectType(t,"{ ?beforeError : Null<Int>, ?beforeEnd : Null<Int>, ?beforeElse : Null<Int>, ?afterIf : Null<Int>, ?afterError : Null<Int>, ?afterElse : Null<Int> }",e)),super.onIncorrectType(e,t)}loadJsonNull(e,t){this.value=null}loadJsonObject(e,n,r){let i=new tt;this.objectSetupAssign(i,["afterElse","afterError","afterIf","beforeElse","beforeEnd","beforeError"],[!0,!0,!0,!0,!0,!0]),this.value=this.getAuto();let s=0;for(;s<e.length;){let r=e[s];switch(++s,r.name){case"afterElse":this.value.afterElse=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"afterElse",i,this.value.afterElse,n);break;case"afterError":this.value.afterError=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"afterError",i,this.value.afterError,n);break;case"afterIf":this.value.afterIf=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"afterIf",i,this.value.afterIf,n);break;case"beforeElse":this.value.beforeElse=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"beforeElse",i,this.value.beforeElse,n);break;case"beforeEnd":this.value.beforeEnd=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"beforeEnd",i,this.value.beforeEnd,n);break;case"beforeError":this.value.beforeError=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"beforeError",i,this.value.beforeError,n);break;default:this.errors.push(ji.UnknownVariable(r.name,this.putils.convertPosition(r.namePos)))}}this.objectErrors(i,n)}getAuto(){return{afterElse:0,afterError:0,afterIf:0,beforeElse:0,beforeEnd:0,beforeError:0}}}d.__name__="JsonParser_12",d.__super__=l,Object.assign(d.prototype,{__class__:d});class p extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.errors.push(ji.IncorrectType(t,"Array<formatter.config.WrapRule>",e)),super.onIncorrectType(e,t)}loadJsonNull(e,t){this.value=null}loadJsonArray(e,n,r){this.value=this.loadJsonArrayValue(e,nl(t=new f(this.errors,this.putils,2),t.loadJson),r)}}p.__name__="JsonParser_121",p.__super__=l,Object.assign(p.prototype,{__class__:p});class f extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.errors.push(ji.IncorrectType(t,"{ type : formatter.config.WrappingType, ?location : Null<formatter.config.WrappingLocation>, conditions : Array<formatter.config.WrapCondition>, ?additionalIndent : Null<Int> }",e)),super.onIncorrectType(e,t)}loadJsonNull(e,t){this.value=null}loadJsonObject(e,n,r){let i=new tt;this.objectSetupAssign(i,["additionalIndent","conditions","location","type"],[!0,!1,!0,!1]),this.value=this.getAuto();let s=0;for(;s<e.length;){let r=e[s];switch(++s,r.name){case"additionalIndent":this.value.additionalIndent=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"additionalIndent",i,this.value.additionalIndent,n);break;case"conditions":this.value.conditions=this.loadObjectField(nl(t=new m(this.errors,this.putils,1),t.loadJson),r,"conditions",i,this.value.conditions,n);break;case"location":this.value.location=this.loadObjectField(nl(t=new u(this.errors,this.putils,1),t.loadJson),r,"location",i,this.value.location,n);break;case"type":this.value.type=this.loadObjectField(nl(t=new _(this.errors,this.putils,1),t.loadJson),r,"type",i,this.value.type,n);break;default:this.errors.push(ji.UnknownVariable(r.name,this.putils.convertPosition(r.namePos)))}}this.objectErrors(i,n)}getAuto(){return{additionalIndent:0,conditions:new m([],this.putils,0).loadJson(new Si(Ci.JNull,new Li("",0,1))),location:"afterLast",type:new _([],this.putils,0).loadJson(new Si(Ci.JNull,new Li("",0,1)))}}}f.__name__="JsonParser_123",f.__super__=l,Object.assign(f.prototype,{__class__:f});class m extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.errors.push(ji.IncorrectType(t,"Array<formatter.config.WrapCondition>",e)),super.onIncorrectType(e,t)}loadJsonNull(e,t){this.value=null}loadJsonArray(e,n,r){this.value=this.loadJsonArrayValue(e,nl(t=new g(this.errors,this.putils,2),t.loadJson),r)}}m.__name__="JsonParser_124",m.__super__=l,Object.assign(m.prototype,{__class__:m});class _ extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.value="onePerLine",this.errors.push(ji.IncorrectType(t,"formatter.config.WrappingType",e)),this.objectThrow(e,t)}loadJsonNull(e,t){this.value=null}loadJsonString(e,t,n){this.value=this.loadString(e,t,n,["onePerLine","onePerLineAfterFirst","equalNumber","fillLine","fillLineWithLeadingBreak","noWrap","keep"],"onePerLine")}}_.__name__="JsonParser_125",_.__super__=l,Object.assign(_.prototype,{__class__:_});class g extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.errors.push(ji.IncorrectType(t,"{ ?value : Null<Int>, cond : formatter.config.WrapConditionType }",e)),super.onIncorrectType(e,t)}loadJsonNull(e,t){this.value=null}loadJsonObject(e,n,r){let i=new tt;this.objectSetupAssign(i,["cond","value"],[!1,!0]),this.value=this.getAuto();let s=0;for(;s<e.length;){let r=e[s];switch(++s,r.name){case"cond":this.value.cond=this.loadObjectField(nl(t=new x(this.errors,this.putils,1),t.loadJson),r,"cond",i,this.value.cond,n);break;case"value":this.value.value=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"value",i,this.value.value,n);break;default:this.errors.push(ji.UnknownVariable(r.name,this.putils.convertPosition(r.namePos)))}}this.objectErrors(i,n)}getAuto(){return{cond:new x([],this.putils,0).loadJson(new Si(Ci.JNull,new Li("",0,1))),value:1}}}g.__name__="JsonParser_127",g.__super__=l,Object.assign(g.prototype,{__class__:g});class x extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.value="itemCount >= n",this.errors.push(ji.IncorrectType(t,"formatter.config.WrapConditionType",e)),this.objectThrow(e,t)}loadJsonNull(e,t){this.value=null}loadJsonString(e,t,n){this.value=this.loadString(e,t,n,["itemCount >= n","itemCount <= n","anyItemLength >= n","allItemLengths <= n","allItemLengths >= n","anyItemLength <= n","totalItemLength >= n","totalItemLength <= n","lineLength >= n","lineLength <= n","hasMultilineItems","exceedsMaxLineLength","equalItemLengths"],"itemCount >= n")}}x.__name__="JsonParser_128",x.__super__=l,Object.assign(x.prototype,{__class__:x});class k extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.value="none",this.errors.push(ji.IncorrectType(t,"formatter.config.WhitespacePolicy",e)),this.objectThrow(e,t)}loadJsonNull(e,t){this.value=null}loadJsonString(e,t,n){this.value=this.loadString(e,t,n,["none","before","noneBefore","onlyBefore","after","onlyAfter","noneAfter","around"],"none")}}k.__name__="JsonParser_130",k.__super__=l,Object.assign(k.prototype,{__class__:k});class y extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.errors.push(ji.IncorrectType(t,"{ ?existingBetweenFields : Null<formatter.config.KeepEmptyLinesPolicy>, ?endType : Null<Int>, ?betweenVars : Null<Int>, ?betweenFunctions : Null<Int>, ?beginType : Null<Int>, ?afterVars : Null<Int> }",e)),super.onIncorrectType(e,t)}loadJsonNull(e,t){this.value=null}loadJsonObject(e,n,r){let i=new tt;this.objectSetupAssign(i,["afterVars","beginType","betweenFunctions","betweenVars","endType","existingBetweenFields"],[!0,!0,!0,!0,!0,!0]),this.value=this.getAuto();let s=0;for(;s<e.length;){let r=e[s];switch(++s,r.name){case"afterVars":this.value.afterVars=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"afterVars",i,this.value.afterVars,n);break;case"beginType":this.value.beginType=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"beginType",i,this.value.beginType,n);break;case"betweenFunctions":this.value.betweenFunctions=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"betweenFunctions",i,this.value.betweenFunctions,n);break;case"betweenVars":this.value.betweenVars=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"betweenVars",i,this.value.betweenVars,n);break;case"endType":this.value.endType=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"endType",i,this.value.endType,n);break;case"existingBetweenFields":this.value.existingBetweenFields=this.loadObjectField(nl(t=new D(this.errors,this.putils,1),t.loadJson),r,"existingBetweenFields",i,this.value.existingBetweenFields,n);break;default:this.errors.push(ji.UnknownVariable(r.name,this.putils.convertPosition(r.namePos)))}}this.objectErrors(i,n)}getAuto(){return{afterVars:1,beginType:0,betweenFunctions:1,betweenVars:0,endType:0,existingBetweenFields:"keep"}}}y.__name__="JsonParser_15",y.__super__=l,Object.assign(y.prototype,{__class__:y});class w extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.errors.push(ji.IncorrectType(t,"{ ?existingBetweenFields : Null<formatter.config.KeepEmptyLinesPolicy>, ?endType : Null<Int>, ?betweenFields : Null<Int>, ?beginType : Null<Int> }",e)),super.onIncorrectType(e,t)}loadJsonNull(e,t){this.value=null}loadJsonObject(e,n,r){let i=new tt;this.objectSetupAssign(i,["beginType","betweenFields","endType","existingBetweenFields"],[!0,!0,!0,!0]),this.value=this.getAuto();let s=0;for(;s<e.length;){let r=e[s];switch(++s,r.name){case"beginType":this.value.beginType=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"beginType",i,this.value.beginType,n);break;case"betweenFields":this.value.betweenFields=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"betweenFields",i,this.value.betweenFields,n);break;case"endType":this.value.endType=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"endType",i,this.value.endType,n);break;case"existingBetweenFields":this.value.existingBetweenFields=this.loadObjectField(nl(t=new D(this.errors,this.putils,1),t.loadJson),r,"existingBetweenFields",i,this.value.existingBetweenFields,n);break;default:this.errors.push(ji.UnknownVariable(r.name,this.putils.convertPosition(r.namePos)))}}this.objectErrors(i,n)}getAuto(){return{beginType:0,betweenFields:0,endType:0,existingBetweenFields:"keep"}}}w.__name__="JsonParser_18",w.__super__=l,Object.assign(w.prototype,{__class__:w});class b extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.value="same",this.errors.push(ji.IncorrectType(t,"formatter.config.SameLinePolicy",e)),this.objectThrow(e,t)}loadJsonNull(e,t){this.value=null}loadJsonString(e,t,n){this.value=this.loadString(e,t,n,["same","next","keep"],"same")}}b.__name__="JsonParser_182",b.__super__=l,Object.assign(b.prototype,{__class__:b});class T extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.errors.push(ji.IncorrectType(t,"{ ?rightCurly : Null<formatter.config.RightCurlyLineEndPolicy>, ?leftCurly : Null<formatter.config.LeftCurlyLineEndPolicy>, ?emptyCurly : Null<formatter.config.EmptyCurlyPolicy> }",e)),super.onIncorrectType(e,t)}loadJsonNull(e,t){this.value=null}loadJsonObject(e,n,r){let i=new tt;this.objectSetupAssign(i,["emptyCurly","leftCurly","rightCurly"],[!0,!0,!0]),this.value=this.getAuto();let s=0;for(;s<e.length;){let r=e[s];switch(++s,r.name){case"emptyCurly":this.value.emptyCurly=this.loadObjectField(nl(t=new C(this.errors,this.putils,1),t.loadJson),r,"emptyCurly",i,this.value.emptyCurly,n);break;case"leftCurly":this.value.leftCurly=this.loadObjectField(nl(t=new v(this.errors,this.putils,1),t.loadJson),r,"leftCurly",i,this.value.leftCurly,n);break;case"rightCurly":this.value.rightCurly=this.loadObjectField(nl(t=new A(this.errors,this.putils,1),t.loadJson),r,"rightCurly",i,this.value.rightCurly,n);break;default:this.errors.push(ji.UnknownVariable(r.name,this.putils.convertPosition(r.namePos)))}}this.objectErrors(i,n)}getAuto(){return{emptyCurly:"noBreak",leftCurly:"after",rightCurly:"both"}}}T.__name__="JsonParser_185",T.__super__=l,Object.assign(T.prototype,{__class__:T});class S extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.value="none",this.errors.push(ji.IncorrectType(t,"formatter.config.CaseColonLineEndPolicy",e)),this.objectThrow(e,t)}loadJsonNull(e,t){this.value=null}loadJsonString(e,t,n){this.value=this.loadString(e,t,n,["none","after"],"none")}}S.__name__="JsonParser_191",S.__super__=l,Object.assign(S.prototype,{__class__:S});class C extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.value="noBreak",this.errors.push(ji.IncorrectType(t,"formatter.config.EmptyCurlyPolicy",e)),this.objectThrow(e,t)}loadJsonNull(e,t){this.value=null}loadJsonString(e,t,n){this.value=this.loadString(e,t,n,["noBreak","break"],"noBreak")}}C.__name__="JsonParser_193",C.__super__=l,Object.assign(C.prototype,{__class__:C});class v extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.value="none",this.errors.push(ji.IncorrectType(t,"formatter.config.LeftCurlyLineEndPolicy",e)),this.objectThrow(e,t)}loadJsonNull(e,t){this.value=null}loadJsonString(e,t,n){this.value=this.loadString(e,t,n,["none","after","before","both"],"none")}}v.__name__="JsonParser_195",v.__super__=l,Object.assign(v.prototype,{__class__:v});class P extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.value="auto",this.errors.push(ji.IncorrectType(t,"formatter.config.LineEndCharacter",e)),this.objectThrow(e,t)}loadJsonNull(e,t){this.value=null}loadJsonString(e,t,n){this.value=this.loadString(e,t,n,["auto","CR","LF","CRLF"],"auto")}}P.__name__="JsonParser_197",P.__super__=l,Object.assign(P.prototype,{__class__:P});class L extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.value="none",this.errors.push(ji.IncorrectType(t,"formatter.config.AtLineEndPolicy",e)),this.objectThrow(e,t)}loadJsonNull(e,t){this.value=null}loadJsonString(e,t,n){this.value=this.loadString(e,t,n,["none","after","afterLast","forceAfterLast"],"none")}}L.__name__="JsonParser_199",L.__super__=l,Object.assign(L.prototype,{__class__:L});class A extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.value="none",this.errors.push(ji.IncorrectType(t,"formatter.config.RightCurlyLineEndPolicy",e)),this.objectThrow(e,t)}loadJsonNull(e,t){this.value=null}loadJsonString(e,t,n){this.value=this.loadString(e,t,n,["none","before","after","both"],"none")}}A.__name__="JsonParser_203",A.__super__=l,Object.assign(A.prototype,{__class__:A});class F extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.value="none",this.errors.push(ji.IncorrectType(t,"formatter.config.SharpLineEndPolicy",e)),this.objectThrow(e,t)}loadJsonNull(e,t){this.value=null}loadJsonString(e,t,n){this.value=this.loadString(e,t,n,["none","after"],"none")}}F.__name__="JsonParser_205",F.__super__=l,Object.assign(F.prototype,{__class__:F});class N extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.errors.push(ji.IncorrectType(t,"String",e)),super.onIncorrectType(e,t)}loadJsonNull(e,t){this.value=null}loadJsonString(e,t,n){this.value=e}}N.__name__="JsonParser_209",N.__super__=l,Object.assign(N.prototype,{__class__:N});class I extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.errors.push(ji.IncorrectType(t,"{ ?existingBetweenFields : Null<formatter.config.KeepEmptyLinesPolicy>, ?endType : Null<Int>, ?betweenVars : Null<Int>, ?betweenFunctions : Null<Int>, ?beginType : Null<Int>, ?afterVars : Null<Int> }",e)),super.onIncorrectType(e,t)}loadJsonNull(e,t){this.value=null}loadJsonObject(e,n,r){let i=new tt;this.objectSetupAssign(i,["afterVars","beginType","betweenFunctions","betweenVars","endType","existingBetweenFields"],[!0,!0,!0,!0,!0,!0]),this.value=this.getAuto();let s=0;for(;s<e.length;){let r=e[s];switch(++s,r.name){case"afterVars":this.value.afterVars=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"afterVars",i,this.value.afterVars,n);break;case"beginType":this.value.beginType=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"beginType",i,this.value.beginType,n);break;case"betweenFunctions":this.value.betweenFunctions=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"betweenFunctions",i,this.value.betweenFunctions,n);break;case"betweenVars":this.value.betweenVars=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"betweenVars",i,this.value.betweenVars,n);break;case"endType":this.value.endType=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"endType",i,this.value.endType,n);break;case"existingBetweenFields":this.value.existingBetweenFields=this.loadObjectField(nl(t=new D(this.errors,this.putils,1),t.loadJson),r,"existingBetweenFields",i,this.value.existingBetweenFields,n);break;default:this.errors.push(ji.UnknownVariable(r.name,this.putils.convertPosition(r.namePos)))}}this.objectErrors(i,n)}getAuto(){return{afterVars:0,beginType:0,betweenFunctions:0,betweenVars:0,endType:0,existingBetweenFields:"keep"}}}I.__name__="JsonParser_21",I.__super__=l,Object.assign(I.prototype,{__class__:I});class O extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.value="fixedZero",this.errors.push(ji.IncorrectType(t,"formatter.config.ConditionalIndentationPolicy",e)),this.objectThrow(e,t)}loadJsonNull(e,t){this.value=null}loadJsonString(e,t,n){this.value=this.loadString(e,t,n,["fixedZero","fixedZeroIncrease","fixedZeroIncreaseBlocks","aligned","alignedNestedIncrease","alignedIncrease","alignedDecrease"],"fixedZero")}}O.__name__="JsonParser_211",O.__super__=l,Object.assign(O.prototype,{__class__:O});class E extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.value="all",this.errors.push(ji.IncorrectType(t,"formatter.config.BetweenImportsEmptyLinesLevel",e)),this.objectThrow(e,t)}loadJsonNull(e,t){this.value=null}loadJsonString(e,t,n){this.value=this.loadString(e,t,n,["all","firstLevelPackage","secondLevelPackage","thirdLevelPackage","fourthLevelPackage","fifthLevelPackage","fullPackage"],"all")}}E.__name__="JsonParser_213",E.__super__=l,Object.assign(E.prototype,{__class__:E});class D extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.value="keep",this.errors.push(ji.IncorrectType(t,"formatter.config.KeepEmptyLinesPolicy",e)),this.objectThrow(e,t)}loadJsonNull(e,t){this.value=null}loadJsonString(e,t,n){this.value=this.loadString(e,t,n,["keep","remove"],"keep")}}D.__name__="JsonParser_215",D.__super__=l,Object.assign(D.prototype,{__class__:D});class B extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.value="ignore",this.errors.push(ji.IncorrectType(t,"formatter.config.CommentEmptyLinesPolicy",e)),this.objectThrow(e,t)}loadJsonNull(e,t){this.value=null}loadJsonString(e,t,n){this.value=this.loadString(e,t,n,["ignore","none","one"],"ignore")}}B.__name__="JsonParser_219",B.__super__=l,Object.assign(B.prototype,{__class__:B});class R extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.value="keep",this.errors.push(ji.IncorrectType(t,"formatter.config.LineCommentEmptyLinePolicy",e)),this.objectThrow(e,t)}loadJsonNull(e,t){this.value=null}loadJsonString(e,t,n){this.value=this.loadString(e,t,n,["keep","one","none"],"keep")}}R.__name__="JsonParser_235",R.__super__=l,Object.assign(R.prototype,{__class__:R});class j extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.errors.push(ji.IncorrectType(t,"{ ?betweenImportsLevel : Null<formatter.config.BetweenImportsEmptyLinesLevel>, ?betweenImports : Null<Int>, ?beforeUsing : Null<Int>, ?beforeType : Null<Int> }",e)),super.onIncorrectType(e,t)}loadJsonNull(e,t){this.value=null}loadJsonObject(e,n,r){let i=new tt;this.objectSetupAssign(i,["beforeType","beforeUsing","betweenImports","betweenImportsLevel"],[!0,!0,!0,!0]),this.value=this.getAuto();let s=0;for(;s<e.length;){let r=e[s];switch(++s,r.name){case"beforeType":this.value.beforeType=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"beforeType",i,this.value.beforeType,n);break;case"beforeUsing":this.value.beforeUsing=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"beforeUsing",i,this.value.beforeUsing,n);break;case"betweenImports":this.value.betweenImports=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"betweenImports",i,this.value.betweenImports,n);break;case"betweenImportsLevel":this.value.betweenImportsLevel=this.loadObjectField(nl(t=new E(this.errors,this.putils,1),t.loadJson),r,"betweenImportsLevel",i,this.value.betweenImportsLevel,n);break;default:this.errors.push(ji.UnknownVariable(r.name,this.putils.convertPosition(r.namePos)))}}this.objectErrors(i,n)}getAuto(){return{beforeType:1,beforeUsing:1,betweenImports:0,betweenImportsLevel:"all"}}}j.__name__="JsonParser_24",j.__super__=l,Object.assign(j.prototype,{__class__:j});class M extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.errors.push(ji.IncorrectType(t,"{ ?trailingWhitespace : Null<Bool>, ?tabWidth : Null<Int>, ?indentObjectLiteral : Null<Bool>, ?indentComplexValueExpressions : Null<Bool>, ?indentCaseLabels : Null<Bool>, ?conditionalPolicy : Null<formatter.config.ConditionalIndentationPolicy>, ?character : Null<String> }",e)),super.onIncorrectType(e,t)}loadJsonNull(e,t){this.value=null}loadJsonObject(e,n,r){let i=new tt;this.objectSetupAssign(i,["character","conditionalPolicy","indentCaseLabels","indentComplexValueExpressions","indentObjectLiteral","tabWidth","trailingWhitespace"],[!0,!0,!0,!0,!0,!0,!0]),this.value=this.getAuto();let s=0;for(;s<e.length;){let r=e[s];switch(++s,r.name){case"character":this.value.character=this.loadObjectField(nl(t=new N(this.errors,this.putils,1),t.loadJson),r,"character",i,this.value.character,n);break;case"conditionalPolicy":this.value.conditionalPolicy=this.loadObjectField(nl(t=new O(this.errors,this.putils,1),t.loadJson),r,"conditionalPolicy",i,this.value.conditionalPolicy,n);break;case"indentCaseLabels":this.value.indentCaseLabels=this.loadObjectField(nl(t=new z(this.errors,this.putils,1),t.loadJson),r,"indentCaseLabels",i,this.value.indentCaseLabels,n);break;case"indentComplexValueExpressions":this.value.indentComplexValueExpressions=this.loadObjectField(nl(t=new z(this.errors,this.putils,1),t.loadJson),r,"indentComplexValueExpressions",i,this.value.indentComplexValueExpressions,n);break;case"indentObjectLiteral":this.value.indentObjectLiteral=this.loadObjectField(nl(t=new z(this.errors,this.putils,1),t.loadJson),r,"indentObjectLiteral",i,this.value.indentObjectLiteral,n);break;case"tabWidth":this.value.tabWidth=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"tabWidth",i,this.value.tabWidth,n);break;case"trailingWhitespace":this.value.trailingWhitespace=this.loadObjectField(nl(t=new z(this.errors,this.putils,1),t.loadJson),r,"trailingWhitespace",i,this.value.trailingWhitespace,n);break;default:this.errors.push(ji.UnknownVariable(r.name,this.putils.convertPosition(r.namePos)))}}this.objectErrors(i,n)}getAuto(){return{character:"tab",conditionalPolicy:"aligned",indentCaseLabels:!0,indentComplexValueExpressions:!1,indentObjectLiteral:!0,tabWidth:4,trailingWhitespace:!1}}}M.__name__="JsonParser_33",M.__super__=l,Object.assign(M.prototype,{__class__:M});class H extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.errors.push(ji.IncorrectType(t,"{ ?typedefCurly : Null<formatter.config.CurlyLineEndPolicy>, ?sharp : Null<formatter.config.SharpLineEndPolicy>, ?rightCurly : Null<formatter.config.RightCurlyLineEndPolicy>, ?objectLiteralCurly : Null<formatter.config.CurlyLineEndPolicy>, ?metadataVar : Null<formatter.config.AtLineEndPolicy>, ?metadataType : Null<formatter.config.AtLineEndPolicy>, ?metadataOther : Null<formatter.config.AtLineEndPolicy>, ?metadataFunction : Null<formatter.config.AtLineEndPolicy>, ?lineEndCharacter : Null<formatter.config.LineEndCharacter>, ?leftCurly : Null<formatter.config.LeftCurlyLineEndPolicy>, ?emptyCurly : Null<formatter.config.EmptyCurlyPolicy>, ?caseColon : Null<formatter.config.CaseColonLineEndPolicy>, ?blockCurly : Null<formatter.config.CurlyLineEndPolicy>, ?anonTypeCurly : Null<formatter.config.CurlyLineEndPolicy>, ?anonFunctionCurly : Null<formatter.config.CurlyLineEndPolicy> }",e)),super.onIncorrectType(e,t)}loadJsonNull(e,t){this.value=null}loadJsonObject(e,n,r){let i=new tt;this.objectSetupAssign(i,["anonFunctionCurly","anonTypeCurly","blockCurly","caseColon","emptyCurly","leftCurly","lineEndCharacter","metadataFunction","metadataOther","metadataType","metadataVar","objectLiteralCurly","rightCurly","sharp","typedefCurly"],[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0]),this.value=this.getAuto();let s=0;for(;s<e.length;){let r=e[s];switch(++s,r.name){case"anonFunctionCurly":this.value.anonFunctionCurly=this.loadObjectField(nl(t=new T(this.errors,this.putils,1),t.loadJson),r,"anonFunctionCurly",i,this.value.anonFunctionCurly,n);break;case"anonTypeCurly":this.value.anonTypeCurly=this.loadObjectField(nl(t=new T(this.errors,this.putils,1),t.loadJson),r,"anonTypeCurly",i,this.value.anonTypeCurly,n);break;case"blockCurly":this.value.blockCurly=this.loadObjectField(nl(t=new T(this.errors,this.putils,1),t.loadJson),r,"blockCurly",i,this.value.blockCurly,n);break;case"caseColon":this.value.caseColon=this.loadObjectField(nl(t=new S(this.errors,this.putils,1),t.loadJson),r,"caseColon",i,this.value.caseColon,n);break;case"emptyCurly":this.value.emptyCurly=this.loadObjectField(nl(t=new C(this.errors,this.putils,1),t.loadJson),r,"emptyCurly",i,this.value.emptyCurly,n);break;case"leftCurly":this.value.leftCurly=this.loadObjectField(nl(t=new v(this.errors,this.putils,1),t.loadJson),r,"leftCurly",i,this.value.leftCurly,n);break;case"lineEndCharacter":this.value.lineEndCharacter=this.loadObjectField(nl(t=new P(this.errors,this.putils,1),t.loadJson),r,"lineEndCharacter",i,this.value.lineEndCharacter,n);break;case"metadataFunction":this.value.metadataFunction=this.loadObjectField(nl(t=new L(this.errors,this.putils,1),t.loadJson),r,"metadataFunction",i,this.value.metadataFunction,n);break;case"metadataOther":this.value.metadataOther=this.loadObjectField(nl(t=new L(this.errors,this.putils,1),t.loadJson),r,"metadataOther",i,this.value.metadataOther,n);break;case"metadataType":this.value.metadataType=this.loadObjectField(nl(t=new L(this.errors,this.putils,1),t.loadJson),r,"metadataType",i,this.value.metadataType,n);break;case"metadataVar":this.value.metadataVar=this.loadObjectField(nl(t=new L(this.errors,this.putils,1),t.loadJson),r,"metadataVar",i,this.value.metadataVar,n);break;case"objectLiteralCurly":this.value.objectLiteralCurly=this.loadObjectField(nl(t=new T(this.errors,this.putils,1),t.loadJson),r,"objectLiteralCurly",i,this.value.objectLiteralCurly,n);break;case"rightCurly":this.value.rightCurly=this.loadObjectField(nl(t=new A(this.errors,this.putils,1),t.loadJson),r,"rightCurly",i,this.value.rightCurly,n);break;case"sharp":this.value.sharp=this.loadObjectField(nl(t=new F(this.errors,this.putils,1),t.loadJson),r,"sharp",i,this.value.sharp,n);break;case"typedefCurly":this.value.typedefCurly=this.loadObjectField(nl(t=new T(this.errors,this.putils,1),t.loadJson),r,"typedefCurly",i,this.value.typedefCurly,n);break;default:this.errors.push(ji.UnknownVariable(r.name,this.putils.convertPosition(r.namePos)))}}this.objectErrors(i,n)}getAuto(){return{anonFunctionCurly:null,anonTypeCurly:null,blockCurly:null,caseColon:"after",emptyCurly:"noBreak",leftCurly:"after",lineEndCharacter:"auto",metadataFunction:"none",metadataOther:"none",metadataType:"none",metadataVar:"none",objectLiteralCurly:null,rightCurly:"both",sharp:"after",typedefCurly:null}}}H.__name__="JsonParser_36",H.__super__=l,Object.assign(H.prototype,{__class__:H});class W extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.errors.push(ji.IncorrectType(t,"{ ?whileBody : Null<formatter.config.SameLinePolicy>, ?untypedBody : Null<formatter.config.SameLinePolicy>, ?tryCatch : Null<formatter.config.SameLinePolicy>, ?tryBody : Null<formatter.config.SameLinePolicy>, ?returnBodySingleLine : Null<formatter.config.SameLinePolicy>, ?returnBody : Null<formatter.config.SameLinePolicy>, ?ifElseSemicolonNextLine : Null<Bool>, ?ifElse : Null<formatter.config.SameLinePolicy>, ?ifBody : Null<formatter.config.SameLinePolicy>, ?functionBody : Null<formatter.config.SameLinePolicy>, ?forBody : Null<formatter.config.SameLinePolicy>, ?expressionTry : Null<formatter.config.SameLinePolicy>, ?expressionIfWithBlocks : Null<Bool>, ?expressionIf : Null<formatter.config.SameLinePolicy>, ?expressionCase : Null<formatter.config.SameLinePolicy>, ?elseIf : Null<formatter.config.SameLinePolicy>, ?elseBody : Null<formatter.config.SameLinePolicy>, ?doWhileBody : Null<formatter.config.SameLinePolicy>, ?doWhile : Null<formatter.config.SameLinePolicy>, ?comprehensionFor : Null<formatter.config.SameLinePolicy>, ?catchBody : Null<formatter.config.SameLinePolicy>, ?caseBody : Null<formatter.config.SameLinePolicy>, ?anonFunctionBody : Null<formatter.config.SameLinePolicy> }",e)),super.onIncorrectType(e,t)}loadJsonNull(e,t){this.value=null}loadJsonObject(e,n,r){let i=new tt;this.objectSetupAssign(i,["anonFunctionBody","caseBody","catchBody","comprehensionFor","doWhile","doWhileBody","elseBody","elseIf","expressionCase","expressionIf","expressionIfWithBlocks","expressionTry","forBody","functionBody","ifBody","ifElse","ifElseSemicolonNextLine","returnBody","returnBodySingleLine","tryBody","tryCatch","untypedBody","whileBody"],[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0]),this.value=this.getAuto();let s=0;for(;s<e.length;){let r=e[s];switch(++s,r.name){case"anonFunctionBody":this.value.anonFunctionBody=this.loadObjectField(nl(t=new b(this.errors,this.putils,1),t.loadJson),r,"anonFunctionBody",i,this.value.anonFunctionBody,n);break;case"caseBody":this.value.caseBody=this.loadObjectField(nl(t=new b(this.errors,this.putils,1),t.loadJson),r,"caseBody",i,this.value.caseBody,n);break;case"catchBody":this.value.catchBody=this.loadObjectField(nl(t=new b(this.errors,this.putils,1),t.loadJson),r,"catchBody",i,this.value.catchBody,n);break;case"comprehensionFor":this.value.comprehensionFor=this.loadObjectField(nl(t=new b(this.errors,this.putils,1),t.loadJson),r,"comprehensionFor",i,this.value.comprehensionFor,n);break;case"doWhile":this.value.doWhile=this.loadObjectField(nl(t=new b(this.errors,this.putils,1),t.loadJson),r,"doWhile",i,this.value.doWhile,n);break;case"doWhileBody":this.value.doWhileBody=this.loadObjectField(nl(t=new b(this.errors,this.putils,1),t.loadJson),r,"doWhileBody",i,this.value.doWhileBody,n);break;case"elseBody":this.value.elseBody=this.loadObjectField(nl(t=new b(this.errors,this.putils,1),t.loadJson),r,"elseBody",i,this.value.elseBody,n);break;case"elseIf":this.value.elseIf=this.loadObjectField(nl(t=new b(this.errors,this.putils,1),t.loadJson),r,"elseIf",i,this.value.elseIf,n);break;case"expressionCase":this.value.expressionCase=this.loadObjectField(nl(t=new b(this.errors,this.putils,1),t.loadJson),r,"expressionCase",i,this.value.expressionCase,n);break;case"expressionIf":this.value.expressionIf=this.loadObjectField(nl(t=new b(this.errors,this.putils,1),t.loadJson),r,"expressionIf",i,this.value.expressionIf,n);break;case"expressionIfWithBlocks":this.value.expressionIfWithBlocks=this.loadObjectField(nl(t=new z(this.errors,this.putils,1),t.loadJson),r,"expressionIfWithBlocks",i,this.value.expressionIfWithBlocks,n);break;case"expressionTry":this.value.expressionTry=this.loadObjectField(nl(t=new b(this.errors,this.putils,1),t.loadJson),r,"expressionTry",i,this.value.expressionTry,n);break;case"forBody":this.value.forBody=this.loadObjectField(nl(t=new b(this.errors,this.putils,1),t.loadJson),r,"forBody",i,this.value.forBody,n);break;case"functionBody":this.value.functionBody=this.loadObjectField(nl(t=new b(this.errors,this.putils,1),t.loadJson),r,"functionBody",i,this.value.functionBody,n);break;case"ifBody":this.value.ifBody=this.loadObjectField(nl(t=new b(this.errors,this.putils,1),t.loadJson),r,"ifBody",i,this.value.ifBody,n);break;case"ifElse":this.value.ifElse=this.loadObjectField(nl(t=new b(this.errors,this.putils,1),t.loadJson),r,"ifElse",i,this.value.ifElse,n);break;case"ifElseSemicolonNextLine":this.value.ifElseSemicolonNextLine=this.loadObjectField(nl(t=new z(this.errors,this.putils,1),t.loadJson),r,"ifElseSemicolonNextLine",i,this.value.ifElseSemicolonNextLine,n);break;case"returnBody":this.value.returnBody=this.loadObjectField(nl(t=new b(this.errors,this.putils,1),t.loadJson),r,"returnBody",i,this.value.returnBody,n);break;case"returnBodySingleLine":this.value.returnBodySingleLine=this.loadObjectField(nl(t=new b(this.errors,this.putils,1),t.loadJson),r,"returnBodySingleLine",i,this.value.returnBodySingleLine,n);break;case"tryBody":this.value.tryBody=this.loadObjectField(nl(t=new b(this.errors,this.putils,1),t.loadJson),r,"tryBody",i,this.value.tryBody,n);break;case"tryCatch":this.value.tryCatch=this.loadObjectField(nl(t=new b(this.errors,this.putils,1),t.loadJson),r,"tryCatch",i,this.value.tryCatch,n);break;case"untypedBody":this.value.untypedBody=this.loadObjectField(nl(t=new b(this.errors,this.putils,1),t.loadJson),r,"untypedBody",i,this.value.untypedBody,n);break;case"whileBody":this.value.whileBody=this.loadObjectField(nl(t=new b(this.errors,this.putils,1),t.loadJson),r,"whileBody",i,this.value.whileBody,n);break;default:this.errors.push(ji.UnknownVariable(r.name,this.putils.convertPosition(r.namePos)))}}this.objectErrors(i,n)}getAuto(){return{anonFunctionBody:"same",caseBody:"next",catchBody:"next",comprehensionFor:"same",doWhile:"same",doWhileBody:"next",elseBody:"next",elseIf:"same",expressionCase:"keep",expressionIf:"same",expressionIfWithBlocks:!1,expressionTry:"same",forBody:"next",functionBody:"next",ifBody:"next",ifElse:"same",ifElseSemicolonNextLine:!0,returnBody:"same",returnBodySingleLine:"same",tryBody:"next",tryCatch:"same",untypedBody:"same",whileBody:"next"}}}W.__name__="JsonParser_39",W.__super__=l,Object.assign(W.prototype,{__class__:W});class U extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.errors.push(ji.IncorrectType(t,"{ ?typedefEmptyLines : Null<formatter.config.TypedefFieldsEmptyLinesConfig>, ?maxAnywhereInFile : Null<Int>, ?macroClassEmptyLines : Null<formatter.config.ClassFieldsEmptyLinesConfig>, ?lineCommentsBetweenTypes : Null<formatter.config.LineCommentEmptyLinePolicy>, ?lineCommentsBetweenFunctions : Null<formatter.config.LineCommentEmptyLinePolicy>, ?interfaceEmptyLines : Null<formatter.config.InterfaceFieldsEmptyLinesConfig>, ?importAndUsing : Null<formatter.config.ImportsEmptyLinesConfig>, ?finalNewline : Null<Bool>, ?externClassEmptyLines : Null<formatter.config.InterfaceFieldsEmptyLinesConfig>, ?enumEmptyLines : Null<formatter.config.TypedefFieldsEmptyLinesConfig>, ?enumAbstractEmptyLines : Null<formatter.config.EnumAbstractFieldsEmptyLinesConfig>, ?conditionalsEmptyLines : Null<formatter.config.ConditionalEmptyLinesConfig>, ?classEmptyLines : Null<formatter.config.ClassFieldsEmptyLinesConfig>, ?betweenTypes : Null<Int>, ?betweenSingleLineTypes : Null<Int>, ?betweenMultilineComments : Null<Int>, ?beforeRightCurly : Null<formatter.config.KeepEmptyLinesPolicy>, ?beforePackage : Null<Int>, ?beforeDocCommentEmptyLines : Null<formatter.config.CommentEmptyLinesPolicy>, ?beforeBlocks : Null<formatter.config.KeepEmptyLinesPolicy>, ?afterReturn : Null<formatter.config.KeepEmptyLinesPolicy>, ?afterPackage : Null<Int>, ?afterLeftCurly : Null<formatter.config.KeepEmptyLinesPolicy>, ?afterFileHeaderComment : Null<Int>, ?afterFieldsWithDocComments : Null<formatter.config.CommentEmptyLinesPolicy>, ?afterBlocks : Null<formatter.config.KeepEmptyLinesPolicy>, ?abstractEmptyLines : Null<formatter.config.ClassFieldsEmptyLinesConfig> }",e)),super.onIncorrectType(e,t)}loadJsonNull(e,t){this.value=null}loadJsonObject(e,n,r){let i=new tt;this.objectSetupAssign(i,["abstractEmptyLines","afterBlocks","afterFieldsWithDocComments","afterFileHeaderComment","afterLeftCurly","afterPackage","afterReturn","beforeBlocks","beforeDocCommentEmptyLines","beforePackage","beforeRightCurly","betweenMultilineComments","betweenSingleLineTypes","betweenTypes","classEmptyLines","conditionalsEmptyLines","enumAbstractEmptyLines","enumEmptyLines","externClassEmptyLines","finalNewline","importAndUsing","interfaceEmptyLines","lineCommentsBetweenFunctions","lineCommentsBetweenTypes","macroClassEmptyLines","maxAnywhereInFile","typedefEmptyLines"],[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0]),this.value=this.getAuto();let s=0;for(;s<e.length;){let r=e[s];switch(++s,r.name){case"abstractEmptyLines":this.value.abstractEmptyLines=this.loadObjectField(nl(t=new Z(this.errors,this.putils,1),t.loadJson),r,"abstractEmptyLines",i,this.value.abstractEmptyLines,n);break;case"afterBlocks":this.value.afterBlocks=this.loadObjectField(nl(t=new D(this.errors,this.putils,1),t.loadJson),r,"afterBlocks",i,this.value.afterBlocks,n);break;case"afterFieldsWithDocComments":this.value.afterFieldsWithDocComments=this.loadObjectField(nl(t=new B(this.errors,this.putils,1),t.loadJson),r,"afterFieldsWithDocComments",i,this.value.afterFieldsWithDocComments,n);break;case"afterFileHeaderComment":this.value.afterFileHeaderComment=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"afterFileHeaderComment",i,this.value.afterFileHeaderComment,n);break;case"afterLeftCurly":this.value.afterLeftCurly=this.loadObjectField(nl(t=new D(this.errors,this.putils,1),t.loadJson),r,"afterLeftCurly",i,this.value.afterLeftCurly,n);break;case"afterPackage":this.value.afterPackage=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"afterPackage",i,this.value.afterPackage,n);break;case"afterReturn":this.value.afterReturn=this.loadObjectField(nl(t=new D(this.errors,this.putils,1),t.loadJson),r,"afterReturn",i,this.value.afterReturn,n);break;case"beforeBlocks":this.value.beforeBlocks=this.loadObjectField(nl(t=new D(this.errors,this.putils,1),t.loadJson),r,"beforeBlocks",i,this.value.beforeBlocks,n);break;case"beforeDocCommentEmptyLines":this.value.beforeDocCommentEmptyLines=this.loadObjectField(nl(t=new B(this.errors,this.putils,1),t.loadJson),r,"beforeDocCommentEmptyLines",i,this.value.beforeDocCommentEmptyLines,n);break;case"beforePackage":this.value.beforePackage=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"beforePackage",i,this.value.beforePackage,n);break;case"beforeRightCurly":this.value.beforeRightCurly=this.loadObjectField(nl(t=new D(this.errors,this.putils,1),t.loadJson),r,"beforeRightCurly",i,this.value.beforeRightCurly,n);break;case"betweenMultilineComments":this.value.betweenMultilineComments=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"betweenMultilineComments",i,this.value.betweenMultilineComments,n);break;case"betweenSingleLineTypes":this.value.betweenSingleLineTypes=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"betweenSingleLineTypes",i,this.value.betweenSingleLineTypes,n);break;case"betweenTypes":this.value.betweenTypes=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"betweenTypes",i,this.value.betweenTypes,n);break;case"classEmptyLines":this.value.classEmptyLines=this.loadObjectField(nl(t=new Z(this.errors,this.putils,1),t.loadJson),r,"classEmptyLines",i,this.value.classEmptyLines,n);break;case"conditionalsEmptyLines":this.value.conditionalsEmptyLines=this.loadObjectField(nl(t=new d(this.errors,this.putils,1),t.loadJson),r,"conditionalsEmptyLines",i,this.value.conditionalsEmptyLines,n);break;case"enumAbstractEmptyLines":this.value.enumAbstractEmptyLines=this.loadObjectField(nl(t=new y(this.errors,this.putils,1),t.loadJson),r,"enumAbstractEmptyLines",i,this.value.enumAbstractEmptyLines,n);break;case"enumEmptyLines":this.value.enumEmptyLines=this.loadObjectField(nl(t=new w(this.errors,this.putils,1),t.loadJson),r,"enumEmptyLines",i,this.value.enumEmptyLines,n);break;case"externClassEmptyLines":this.value.externClassEmptyLines=this.loadObjectField(nl(t=new I(this.errors,this.putils,1),t.loadJson),r,"externClassEmptyLines",i,this.value.externClassEmptyLines,n);break;case"finalNewline":this.value.finalNewline=this.loadObjectField(nl(t=new z(this.errors,this.putils,1),t.loadJson),r,"finalNewline",i,this.value.finalNewline,n);break;case"importAndUsing":this.value.importAndUsing=this.loadObjectField(nl(t=new j(this.errors,this.putils,1),t.loadJson),r,"importAndUsing",i,this.value.importAndUsing,n);break;case"interfaceEmptyLines":this.value.interfaceEmptyLines=this.loadObjectField(nl(t=new I(this.errors,this.putils,1),t.loadJson),r,"interfaceEmptyLines",i,this.value.interfaceEmptyLines,n);break;case"lineCommentsBetweenFunctions":this.value.lineCommentsBetweenFunctions=this.loadObjectField(nl(t=new R(this.errors,this.putils,1),t.loadJson),r,"lineCommentsBetweenFunctions",i,this.value.lineCommentsBetweenFunctions,n);break;case"lineCommentsBetweenTypes":this.value.lineCommentsBetweenTypes=this.loadObjectField(nl(t=new R(this.errors,this.putils,1),t.loadJson),r,"lineCommentsBetweenTypes",i,this.value.lineCommentsBetweenTypes,n);break;case"macroClassEmptyLines":this.value.macroClassEmptyLines=this.loadObjectField(nl(t=new Z(this.errors,this.putils,1),t.loadJson),r,"macroClassEmptyLines",i,this.value.macroClassEmptyLines,n);break;case"maxAnywhereInFile":this.value.maxAnywhereInFile=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"maxAnywhereInFile",i,this.value.maxAnywhereInFile,n);break;case"typedefEmptyLines":this.value.typedefEmptyLines=this.loadObjectField(nl(t=new w(this.errors,this.putils,1),t.loadJson),r,"typedefEmptyLines",i,this.value.typedefEmptyLines,n);break;default:this.errors.push(ji.UnknownVariable(r.name,this.putils.convertPosition(r.namePos)))}}this.objectErrors(i,n)}getAuto(){return{abstractEmptyLines:new Z([],this.putils,0).getAuto(),afterBlocks:"remove",afterFieldsWithDocComments:"one",afterFileHeaderComment:1,afterLeftCurly:"remove",afterPackage:1,afterReturn:"remove",beforeBlocks:"remove",beforeDocCommentEmptyLines:"one",beforePackage:0,beforeRightCurly:"remove",betweenMultilineComments:0,betweenSingleLineTypes:0,betweenTypes:1,classEmptyLines:new Z([],this.putils,0).getAuto(),conditionalsEmptyLines:new d([],this.putils,0).getAuto(),enumAbstractEmptyLines:new y([],this.putils,0).getAuto(),enumEmptyLines:new w([],this.putils,0).getAuto(),externClassEmptyLines:new I([],this.putils,0).getAuto(),finalNewline:!0,importAndUsing:new j([],this.putils,0).getAuto(),interfaceEmptyLines:new I([],this.putils,0).getAuto(),lineCommentsBetweenFunctions:"keep",lineCommentsBetweenTypes:"keep",macroClassEmptyLines:new Z([],this.putils,0).getAuto(),maxAnywhereInFile:1,typedefEmptyLines:new w([],this.putils,0).getAuto()}}}U.__name__="JsonParser_4",U.__super__=l,Object.assign(U.prototype,{__class__:U});class J extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.errors.push(ji.IncorrectType(t,"{ ?whilePolicy : Null<formatter.config.WhitespacePolicy>, ?typeParamOpenPolicy : Null<formatter.config.WhitespacePolicy>, ?typeParamClosePolicy : Null<formatter.config.WhitespacePolicy>, ?typeHintColonPolicy : Null<formatter.config.WhitespacePolicy>, ?typeExtensionPolicy : Null<formatter.config.WhitespacePolicy>, ?typeCheckColonPolicy : Null<formatter.config.WhitespacePolicy>, ?tryPolicy : Null<formatter.config.WhitespacePolicy>, ?ternaryPolicy : Null<formatter.config.WhitespacePolicy>, ?switchPolicy : Null<formatter.config.WhitespacePolicy>, ?semicolonPolicy : Null<formatter.config.WhitespacePolicy>, ?parenConfig : Null<formatter.config.ParenWhitespaceConfig>, ?objectFieldColonPolicy : Null<formatter.config.WhitespacePolicy>, ?intervalPolicy : Null<formatter.config.WhitespacePolicy>, ?ifPolicy : Null<formatter.config.WhitespacePolicy>, ?functionTypeHaxe4Policy : Null<formatter.config.WhitespacePolicy>, ?functionTypeHaxe3Policy : Null<formatter.config.WhitespacePolicy>, ?formatStringInterpolation : Null<Bool>, ?forPolicy : Null<formatter.config.WhitespacePolicy>, ?dotPolicy : Null<formatter.config.WhitespacePolicy>, ?doPolicy : Null<formatter.config.WhitespacePolicy>, ?compressSuccessiveParenthesis : Null<Bool>, ?commaPolicy : Null<formatter.config.WhitespacePolicy>, ?colonPolicy : Null<formatter.config.WhitespacePolicy>, ?catchPolicy : Null<formatter.config.WhitespacePolicy>, ?caseColonPolicy : Null<formatter.config.WhitespacePolicy>, ?bracketConfig : Null<formatter.config.BracketWhitespaceConfig>, ?bracesConfig : Null<formatter.config.BracesWhitespaceConfig>, ?binopPolicy : Null<formatter.config.WhitespacePolicy>, ?arrowFunctionsPolicy : Null<formatter.config.WhitespacePolicy>, ?addLineCommentSpace : Null<Bool> }",e)),super.onIncorrectType(e,t)}loadJsonNull(e,t){this.value=null}loadJsonObject(e,n,r){let i=new tt;this.objectSetupAssign(i,["addLineCommentSpace","arrowFunctionsPolicy","binopPolicy","bracesConfig","bracketConfig","caseColonPolicy","catchPolicy","colonPolicy","commaPolicy","compressSuccessiveParenthesis","doPolicy","dotPolicy","forPolicy","formatStringInterpolation","functionTypeHaxe3Policy","functionTypeHaxe4Policy","ifPolicy","intervalPolicy","objectFieldColonPolicy","parenConfig","semicolonPolicy","switchPolicy","ternaryPolicy","tryPolicy","typeCheckColonPolicy","typeExtensionPolicy","typeHintColonPolicy","typeParamClosePolicy","typeParamOpenPolicy","whilePolicy"],[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0]),this.value=this.getAuto();let s=0;for(;s<e.length;){let r=e[s];switch(++s,r.name){case"addLineCommentSpace":this.value.addLineCommentSpace=this.loadObjectField(nl(t=new z(this.errors,this.putils,1),t.loadJson),r,"addLineCommentSpace",i,this.value.addLineCommentSpace,n);break;case"arrowFunctionsPolicy":this.value.arrowFunctionsPolicy=this.loadObjectField(nl(t=new k(this.errors,this.putils,1),t.loadJson),r,"arrowFunctionsPolicy",i,this.value.arrowFunctionsPolicy,n);break;case"binopPolicy":this.value.binopPolicy=this.loadObjectField(nl(t=new k(this.errors,this.putils,1),t.loadJson),r,"binopPolicy",i,this.value.binopPolicy,n);break;case"bracesConfig":this.value.bracesConfig=this.loadObjectField(nl(t=new V(this.errors,this.putils,1),t.loadJson),r,"bracesConfig",i,this.value.bracesConfig,n);break;case"bracketConfig":this.value.bracketConfig=this.loadObjectField(nl(t=new K(this.errors,this.putils,1),t.loadJson),r,"bracketConfig",i,this.value.bracketConfig,n);break;case"caseColonPolicy":this.value.caseColonPolicy=this.loadObjectField(nl(t=new k(this.errors,this.putils,1),t.loadJson),r,"caseColonPolicy",i,this.value.caseColonPolicy,n);break;case"catchPolicy":this.value.catchPolicy=this.loadObjectField(nl(t=new k(this.errors,this.putils,1),t.loadJson),r,"catchPolicy",i,this.value.catchPolicy,n);break;case"colonPolicy":this.value.colonPolicy=this.loadObjectField(nl(t=new k(this.errors,this.putils,1),t.loadJson),r,"colonPolicy",i,this.value.colonPolicy,n);break;case"commaPolicy":this.value.commaPolicy=this.loadObjectField(nl(t=new k(this.errors,this.putils,1),t.loadJson),r,"commaPolicy",i,this.value.commaPolicy,n);break;case"compressSuccessiveParenthesis":this.value.compressSuccessiveParenthesis=this.loadObjectField(nl(t=new z(this.errors,this.putils,1),t.loadJson),r,"compressSuccessiveParenthesis",i,this.value.compressSuccessiveParenthesis,n);break;case"doPolicy":this.value.doPolicy=this.loadObjectField(nl(t=new k(this.errors,this.putils,1),t.loadJson),r,"doPolicy",i,this.value.doPolicy,n);break;case"dotPolicy":this.value.dotPolicy=this.loadObjectField(nl(t=new k(this.errors,this.putils,1),t.loadJson),r,"dotPolicy",i,this.value.dotPolicy,n);break;case"forPolicy":this.value.forPolicy=this.loadObjectField(nl(t=new k(this.errors,this.putils,1),t.loadJson),r,"forPolicy",i,this.value.forPolicy,n);break;case"formatStringInterpolation":this.value.formatStringInterpolation=this.loadObjectField(nl(t=new z(this.errors,this.putils,1),t.loadJson),r,"formatStringInterpolation",i,this.value.formatStringInterpolation,n);break;case"functionTypeHaxe3Policy":this.value.functionTypeHaxe3Policy=this.loadObjectField(nl(t=new k(this.errors,this.putils,1),t.loadJson),r,"functionTypeHaxe3Policy",i,this.value.functionTypeHaxe3Policy,n);break;case"functionTypeHaxe4Policy":this.value.functionTypeHaxe4Policy=this.loadObjectField(nl(t=new k(this.errors,this.putils,1),t.loadJson),r,"functionTypeHaxe4Policy",i,this.value.functionTypeHaxe4Policy,n);break;case"ifPolicy":this.value.ifPolicy=this.loadObjectField(nl(t=new k(this.errors,this.putils,1),t.loadJson),r,"ifPolicy",i,this.value.ifPolicy,n);break;case"intervalPolicy":this.value.intervalPolicy=this.loadObjectField(nl(t=new k(this.errors,this.putils,1),t.loadJson),r,"intervalPolicy",i,this.value.intervalPolicy,n);break;case"objectFieldColonPolicy":this.value.objectFieldColonPolicy=this.loadObjectField(nl(t=new k(this.errors,this.putils,1),t.loadJson),r,"objectFieldColonPolicy",i,this.value.objectFieldColonPolicy,n);break;case"parenConfig":this.value.parenConfig=this.loadObjectField(nl(t=new G(this.errors,this.putils,1),t.loadJson),r,"parenConfig",i,this.value.parenConfig,n);break;case"semicolonPolicy":this.value.semicolonPolicy=this.loadObjectField(nl(t=new k(this.errors,this.putils,1),t.loadJson),r,"semicolonPolicy",i,this.value.semicolonPolicy,n);break;case"switchPolicy":this.value.switchPolicy=this.loadObjectField(nl(t=new k(this.errors,this.putils,1),t.loadJson),r,"switchPolicy",i,this.value.switchPolicy,n);break;case"ternaryPolicy":this.value.ternaryPolicy=this.loadObjectField(nl(t=new k(this.errors,this.putils,1),t.loadJson),r,"ternaryPolicy",i,this.value.ternaryPolicy,n);break;case"tryPolicy":this.value.tryPolicy=this.loadObjectField(nl(t=new k(this.errors,this.putils,1),t.loadJson),r,"tryPolicy",i,this.value.tryPolicy,n);break;case"typeCheckColonPolicy":this.value.typeCheckColonPolicy=this.loadObjectField(nl(t=new k(this.errors,this.putils,1),t.loadJson),r,"typeCheckColonPolicy",i,this.value.typeCheckColonPolicy,n);break;case"typeExtensionPolicy":this.value.typeExtensionPolicy=this.loadObjectField(nl(t=new k(this.errors,this.putils,1),t.loadJson),r,"typeExtensionPolicy",i,this.value.typeExtensionPolicy,n);break;case"typeHintColonPolicy":this.value.typeHintColonPolicy=this.loadObjectField(nl(t=new k(this.errors,this.putils,1),t.loadJson),r,"typeHintColonPolicy",i,this.value.typeHintColonPolicy,n);break;case"typeParamClosePolicy":this.value.typeParamClosePolicy=this.loadObjectField(nl(t=new k(this.errors,this.putils,1),t.loadJson),r,"typeParamClosePolicy",i,this.value.typeParamClosePolicy,n);break;case"typeParamOpenPolicy":this.value.typeParamOpenPolicy=this.loadObjectField(nl(t=new k(this.errors,this.putils,1),t.loadJson),r,"typeParamOpenPolicy",i,this.value.typeParamOpenPolicy,n);break;case"whilePolicy":this.value.whilePolicy=this.loadObjectField(nl(t=new k(this.errors,this.putils,1),t.loadJson),r,"whilePolicy",i,this.value.whilePolicy,n);break;default:this.errors.push(ji.UnknownVariable(r.name,this.putils.convertPosition(r.namePos)))}}this.objectErrors(i,n)}getAuto(){return{addLineCommentSpace:!0,arrowFunctionsPolicy:"around",binopPolicy:"around",bracesConfig:new V([],this.putils,0).getAuto(),bracketConfig:new K([],this.putils,0).getAuto(),caseColonPolicy:"onlyAfter",catchPolicy:"after",colonPolicy:"none",commaPolicy:"onlyAfter",compressSuccessiveParenthesis:!0,doPolicy:"after",dotPolicy:"none",forPolicy:"after",formatStringInterpolation:!0,functionTypeHaxe3Policy:"none",functionTypeHaxe4Policy:"around",ifPolicy:"after",intervalPolicy:"none",objectFieldColonPolicy:"after",parenConfig:new G([],this.putils,0).getAuto(),semicolonPolicy:"onlyAfter",switchPolicy:"after",ternaryPolicy:"around",tryPolicy:"after",typeCheckColonPolicy:"around",typeExtensionPolicy:"after",typeHintColonPolicy:"none",typeParamClosePolicy:"none",typeParamOpenPolicy:"none",whilePolicy:"after"}}}J.__name__="JsonParser_42",J.__super__=l,Object.assign(J.prototype,{__class__:J});class V extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.errors.push(ji.IncorrectType(t,"{ ?unknownBraces : Null<formatter.config.OpenClosePolicy>, ?typedefBraces : Null<formatter.config.OpenClosePolicy>, ?objectLiteralBraces : Null<formatter.config.OpenClosePolicy>, ?blockBraces : Null<formatter.config.OpenClosePolicy>, ?anonTypeBraces : Null<formatter.config.OpenClosePolicy> }",e)),super.onIncorrectType(e,t)}loadJsonNull(e,t){this.value=null}loadJsonObject(e,n,r){let i=new tt;this.objectSetupAssign(i,["anonTypeBraces","blockBraces","objectLiteralBraces","typedefBraces","unknownBraces"],[!0,!0,!0,!0,!0]),this.value=this.getAuto();let s=0;for(;s<e.length;){let r=e[s];switch(++s,r.name){case"anonTypeBraces":this.value.anonTypeBraces=this.loadObjectField(nl(t=new q(this.errors,this.putils,1),t.loadJson),r,"anonTypeBraces",i,this.value.anonTypeBraces,n);break;case"blockBraces":this.value.blockBraces=this.loadObjectField(nl(t=new q(this.errors,this.putils,1),t.loadJson),r,"blockBraces",i,this.value.blockBraces,n);break;case"objectLiteralBraces":this.value.objectLiteralBraces=this.loadObjectField(nl(t=new q(this.errors,this.putils,1),t.loadJson),r,"objectLiteralBraces",i,this.value.objectLiteralBraces,n);break;case"typedefBraces":this.value.typedefBraces=this.loadObjectField(nl(t=new q(this.errors,this.putils,1),t.loadJson),r,"typedefBraces",i,this.value.typedefBraces,n);break;case"unknownBraces":this.value.unknownBraces=this.loadObjectField(nl(t=new q(this.errors,this.putils,1),t.loadJson),r,"unknownBraces",i,this.value.unknownBraces,n);break;default:this.errors.push(ji.UnknownVariable(r.name,this.putils.convertPosition(r.namePos)))}}this.objectErrors(i,n)}getAuto(){return{anonTypeBraces:{openingPolicy:"before",closingPolicy:"onlyAfter",removeInnerWhenEmpty:!0},blockBraces:{openingPolicy:"before",closingPolicy:"onlyAfter",removeInnerWhenEmpty:!0},objectLiteralBraces:{openingPolicy:"before",closingPolicy:"onlyAfter",removeInnerWhenEmpty:!0},typedefBraces:{openingPolicy:"before",closingPolicy:"onlyAfter",removeInnerWhenEmpty:!0},unknownBraces:{openingPolicy:"before",closingPolicy:"onlyAfter",removeInnerWhenEmpty:!0}}}}V.__name__="JsonParser_45",V.__super__=l,Object.assign(V.prototype,{__class__:V});class K extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.errors.push(ji.IncorrectType(t,"{ ?unknownBrackets : Null<formatter.config.OpenClosePolicy>, ?mapLiteralBrackets : Null<formatter.config.OpenClosePolicy>, ?comprehensionBrackets : Null<formatter.config.OpenClosePolicy>, ?arrayLiteralBrackets : Null<formatter.config.OpenClosePolicy>, ?accessBrackets : Null<formatter.config.OpenClosePolicy> }",e)),super.onIncorrectType(e,t)}loadJsonNull(e,t){this.value=null}loadJsonObject(e,n,r){let i=new tt;this.objectSetupAssign(i,["accessBrackets","arrayLiteralBrackets","comprehensionBrackets","mapLiteralBrackets","unknownBrackets"],[!0,!0,!0,!0,!0]),this.value=this.getAuto();let s=0;for(;s<e.length;){let r=e[s];switch(++s,r.name){case"accessBrackets":this.value.accessBrackets=this.loadObjectField(nl(t=new q(this.errors,this.putils,1),t.loadJson),r,"accessBrackets",i,this.value.accessBrackets,n);break;case"arrayLiteralBrackets":this.value.arrayLiteralBrackets=this.loadObjectField(nl(t=new q(this.errors,this.putils,1),t.loadJson),r,"arrayLiteralBrackets",i,this.value.arrayLiteralBrackets,n);break;case"comprehensionBrackets":this.value.comprehensionBrackets=this.loadObjectField(nl(t=new q(this.errors,this.putils,1),t.loadJson),r,"comprehensionBrackets",i,this.value.comprehensionBrackets,n);break;case"mapLiteralBrackets":this.value.mapLiteralBrackets=this.loadObjectField(nl(t=new q(this.errors,this.putils,1),t.loadJson),r,"mapLiteralBrackets",i,this.value.mapLiteralBrackets,n);break;case"unknownBrackets":this.value.unknownBrackets=this.loadObjectField(nl(t=new q(this.errors,this.putils,1),t.loadJson),r,"unknownBrackets",i,this.value.unknownBrackets,n);break;default:this.errors.push(ji.UnknownVariable(r.name,this.putils.convertPosition(r.namePos)))}}this.objectErrors(i,n)}getAuto(){return{accessBrackets:{openingPolicy:"none",closingPolicy:"none",removeInnerWhenEmpty:!0},arrayLiteralBrackets:{openingPolicy:"noneAfter",closingPolicy:"none",removeInnerWhenEmpty:!0},comprehensionBrackets:{openingPolicy:"noneAfter",closingPolicy:"none",removeInnerWhenEmpty:!0},mapLiteralBrackets:{openingPolicy:"noneAfter",closingPolicy:"none",removeInnerWhenEmpty:!0},unknownBrackets:{openingPolicy:"noneAfter",closingPolicy:"none",removeInnerWhenEmpty:!0}}}}K.__name__="JsonParser_48",K.__super__=l,Object.assign(K.prototype,{__class__:K});class G extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.errors.push(ji.IncorrectType(t,"{ ?whileConditionParens : Null<formatter.config.OpenClosePolicy>, ?switchConditionParens : Null<formatter.config.OpenClosePolicy>, ?sharpConditionParens : Null<formatter.config.OpenClosePolicy>, ?metadataParens : Null<formatter.config.OpenClosePolicy>, ?ifConditionParens : Null<formatter.config.OpenClosePolicy>, ?funcParamParens : Null<formatter.config.OpenClosePolicy>, ?forLoopParens : Null<formatter.config.OpenClosePolicy>, ?expressionParens : Null<formatter.config.OpenClosePolicy>, ?conditionParens : Null<formatter.config.OpenClosePolicy>, ?catchParens : Null<formatter.config.OpenClosePolicy>, ?callParens : Null<formatter.config.OpenClosePolicy>, ?anonFuncParamParens : Null<formatter.config.OpenClosePolicy> }",e)),super.onIncorrectType(e,t)}loadJsonNull(e,t){this.value=null}loadJsonObject(e,n,r){let i=new tt;this.objectSetupAssign(i,["anonFuncParamParens","callParens","catchParens","conditionParens","expressionParens","forLoopParens","funcParamParens","ifConditionParens","metadataParens","sharpConditionParens","switchConditionParens","whileConditionParens"],[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0]),this.value=this.getAuto();let s=0;for(;s<e.length;){let r=e[s];switch(++s,r.name){case"anonFuncParamParens":this.value.anonFuncParamParens=this.loadObjectField(nl(t=new q(this.errors,this.putils,1),t.loadJson),r,"anonFuncParamParens",i,this.value.anonFuncParamParens,n);break;case"callParens":this.value.callParens=this.loadObjectField(nl(t=new q(this.errors,this.putils,1),t.loadJson),r,"callParens",i,this.value.callParens,n);break;case"catchParens":this.value.catchParens=this.loadObjectField(nl(t=new q(this.errors,this.putils,1),t.loadJson),r,"catchParens",i,this.value.catchParens,n);break;case"conditionParens":this.value.conditionParens=this.loadObjectField(nl(t=new q(this.errors,this.putils,1),t.loadJson),r,"conditionParens",i,this.value.conditionParens,n);break;case"expressionParens":this.value.expressionParens=this.loadObjectField(nl(t=new q(this.errors,this.putils,1),t.loadJson),r,"expressionParens",i,this.value.expressionParens,n);break;case"forLoopParens":this.value.forLoopParens=this.loadObjectField(nl(t=new q(this.errors,this.putils,1),t.loadJson),r,"forLoopParens",i,this.value.forLoopParens,n);break;case"funcParamParens":this.value.funcParamParens=this.loadObjectField(nl(t=new q(this.errors,this.putils,1),t.loadJson),r,"funcParamParens",i,this.value.funcParamParens,n);break;case"ifConditionParens":this.value.ifConditionParens=this.loadObjectField(nl(t=new q(this.errors,this.putils,1),t.loadJson),r,"ifConditionParens",i,this.value.ifConditionParens,n);break;case"metadataParens":this.value.metadataParens=this.loadObjectField(nl(t=new q(this.errors,this.putils,1),t.loadJson),r,"metadataParens",i,this.value.metadataParens,n);break;case"sharpConditionParens":this.value.sharpConditionParens=this.loadObjectField(nl(t=new q(this.errors,this.putils,1),t.loadJson),r,"sharpConditionParens",i,this.value.sharpConditionParens,n);break;case"switchConditionParens":this.value.switchConditionParens=this.loadObjectField(nl(t=new q(this.errors,this.putils,1),t.loadJson),r,"switchConditionParens",i,this.value.switchConditionParens,n);break;case"whileConditionParens":this.value.whileConditionParens=this.loadObjectField(nl(t=new q(this.errors,this.putils,1),t.loadJson),r,"whileConditionParens",i,this.value.whileConditionParens,n);break;default:this.errors.push(ji.UnknownVariable(r.name,this.putils.convertPosition(r.namePos)))}}this.objectErrors(i,n)}getAuto(){return{anonFuncParamParens:new q([],this.putils,0).getAuto(),callParens:new q([],this.putils,0).getAuto(),catchParens:null,conditionParens:{openingPolicy:"noneAfter",closingPolicy:"onlyAfter",removeInnerWhenEmpty:!0},expressionParens:{openingPolicy:"noneAfter",closingPolicy:"onlyAfter",removeInnerWhenEmpty:!0},forLoopParens:{openingPolicy:"noneAfter",closingPolicy:"onlyAfter",removeInnerWhenEmpty:!0},funcParamParens:new q([],this.putils,0).getAuto(),ifConditionParens:null,metadataParens:new q([],this.putils,0).getAuto(),sharpConditionParens:null,switchConditionParens:null,whileConditionParens:null}}}G.__name__="JsonParser_51",G.__super__=l,Object.assign(G.prototype,{__class__:G});class q extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.errors.push(ji.IncorrectType(t,"{ ?removeInnerWhenEmpty : Null<Bool>, ?openingPolicy : Null<formatter.config.WhitespacePolicy>, ?closingPolicy : Null<formatter.config.WhitespacePolicy> }",e)),super.onIncorrectType(e,t)}loadJsonNull(e,t){this.value=null}loadJsonObject(e,n,r){let i=new tt;this.objectSetupAssign(i,["closingPolicy","openingPolicy","removeInnerWhenEmpty"],[!0,!0,!0]),this.value=this.getAuto();let s=0;for(;s<e.length;){let r=e[s];switch(++s,r.name){case"closingPolicy":this.value.closingPolicy=this.loadObjectField(nl(t=new k(this.errors,this.putils,1),t.loadJson),r,"closingPolicy",i,this.value.closingPolicy,n);break;case"openingPolicy":this.value.openingPolicy=this.loadObjectField(nl(t=new k(this.errors,this.putils,1),t.loadJson),r,"openingPolicy",i,this.value.openingPolicy,n);break;case"removeInnerWhenEmpty":this.value.removeInnerWhenEmpty=this.loadObjectField(nl(t=new z(this.errors,this.putils,1),t.loadJson),r,"removeInnerWhenEmpty",i,this.value.removeInnerWhenEmpty,n);break;default:this.errors.push(ji.UnknownVariable(r.name,this.putils.convertPosition(r.namePos)))}}this.objectErrors(i,n)}getAuto(){return{closingPolicy:"onlyAfter",openingPolicy:"none",removeInnerWhenEmpty:!0}}}q.__name__="JsonParser_54",q.__super__=l,Object.assign(q.prototype,{__class__:q});class $ extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.errors.push(ji.IncorrectType(t,"{ ?typeParameter : Null<formatter.config.WrapRules>, ?opBoolChain : Null<formatter.config.WrapRules>, ?opAddSubChain : Null<formatter.config.WrapRules>, ?objectLiteral : Null<formatter.config.WrapRules>, ?multiVar : Null<formatter.config.WrapRules>, ?methodChain : Null<formatter.config.WrapRules>, ?metadataCallParameter : Null<formatter.config.WrapRules>, ?maxLineLength : Null<Int>, ?mapWrap : Null<formatter.config.WrapRules>, ?implementsExtends : Null<formatter.config.WrapRules>, ?functionSignature : Null<formatter.config.WrapRules>, ?casePattern : Null<formatter.config.WrapRules>, ?callParameter : Null<formatter.config.WrapRules>, ?arrayWrap : Null<formatter.config.WrapRules>, ?arrayMatrixWrap : Null<formatter.config.ArrayMatrixWrap>, ?anonType : Null<formatter.config.WrapRules>, ?anonFunctionSignature : Null<formatter.config.WrapRules> }",e)),super.onIncorrectType(e,t)}loadJsonNull(e,t){this.value=null}loadJsonObject(e,n,r){let i=new tt;this.objectSetupAssign(i,["anonFunctionSignature","anonType","arrayMatrixWrap","arrayWrap","callParameter","casePattern","functionSignature","implementsExtends","mapWrap","maxLineLength","metadataCallParameter","methodChain","multiVar","objectLiteral","opAddSubChain","opBoolChain","typeParameter"],[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0]),this.value=this.getAuto();let s=0;for(;s<e.length;){let r=e[s];switch(++s,r.name){case"anonFunctionSignature":this.value.anonFunctionSignature=this.loadObjectField(nl(t=new Y(this.errors,this.putils,1),t.loadJson),r,"anonFunctionSignature",i,this.value.anonFunctionSignature,n);break;case"anonType":this.value.anonType=this.loadObjectField(nl(t=new Y(this.errors,this.putils,1),t.loadJson),r,"anonType",i,this.value.anonType,n);break;case"arrayMatrixWrap":this.value.arrayMatrixWrap=this.loadObjectField(nl(t=new ee(this.errors,this.putils,1),t.loadJson),r,"arrayMatrixWrap",i,this.value.arrayMatrixWrap,n);break;case"arrayWrap":this.value.arrayWrap=this.loadObjectField(nl(t=new Y(this.errors,this.putils,1),t.loadJson),r,"arrayWrap",i,this.value.arrayWrap,n);break;case"callParameter":this.value.callParameter=this.loadObjectField(nl(t=new Y(this.errors,this.putils,1),t.loadJson),r,"callParameter",i,this.value.callParameter,n);break;case"casePattern":this.value.casePattern=this.loadObjectField(nl(t=new Y(this.errors,this.putils,1),t.loadJson),r,"casePattern",i,this.value.casePattern,n);break;case"functionSignature":this.value.functionSignature=this.loadObjectField(nl(t=new Y(this.errors,this.putils,1),t.loadJson),r,"functionSignature",i,this.value.functionSignature,n);break;case"implementsExtends":this.value.implementsExtends=this.loadObjectField(nl(t=new Y(this.errors,this.putils,1),t.loadJson),r,"implementsExtends",i,this.value.implementsExtends,n);break;case"mapWrap":this.value.mapWrap=this.loadObjectField(nl(t=new Y(this.errors,this.putils,1),t.loadJson),r,"mapWrap",i,this.value.mapWrap,n);break;case"maxLineLength":this.value.maxLineLength=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"maxLineLength",i,this.value.maxLineLength,n);break;case"metadataCallParameter":this.value.metadataCallParameter=this.loadObjectField(nl(t=new Y(this.errors,this.putils,1),t.loadJson),r,"metadataCallParameter",i,this.value.metadataCallParameter,n);break;case"methodChain":this.value.methodChain=this.loadObjectField(nl(t=new Y(this.errors,this.putils,1),t.loadJson),r,"methodChain",i,this.value.methodChain,n);break;case"multiVar":this.value.multiVar=this.loadObjectField(nl(t=new Y(this.errors,this.putils,1),t.loadJson),r,"multiVar",i,this.value.multiVar,n);break;case"objectLiteral":this.value.objectLiteral=this.loadObjectField(nl(t=new Y(this.errors,this.putils,1),t.loadJson),r,"objectLiteral",i,this.value.objectLiteral,n);break;case"opAddSubChain":this.value.opAddSubChain=this.loadObjectField(nl(t=new Y(this.errors,this.putils,1),t.loadJson),r,"opAddSubChain",i,this.value.opAddSubChain,n);break;case"opBoolChain":this.value.opBoolChain=this.loadObjectField(nl(t=new Y(this.errors,this.putils,1),t.loadJson),r,"opBoolChain",i,this.value.opBoolChain,n);break;case"typeParameter":this.value.typeParameter=this.loadObjectField(nl(t=new Y(this.errors,this.putils,1),t.loadJson),r,"typeParameter",i,this.value.typeParameter,n);break;default:this.errors.push(ji.UnknownVariable(r.name,this.putils.convertPosition(r.namePos)))}}this.objectErrors(i,n)}getAuto(){return{anonFunctionSignature:{defaultWrap:"noWrap",rules:[{conditions:[{cond:"itemCount >= n",value:7}],type:"fillLine",additionalIndent:1},{conditions:[{cond:"totalItemLength >= n",value:80}],type:"fillLine",additionalIndent:1},{conditions:[{cond:"exceedsMaxLineLength",value:1}],type:"fillLine",additionalIndent:1}]},anonType:{defaultWrap:"noWrap",rules:[{conditions:[{cond:"itemCount <= n",value:3},{cond:"exceedsMaxLineLength",value:0}],type:"noWrap"},{conditions:[{cond:"anyItemLength >= n",value:30}],type:"onePerLine"},{conditions:[{cond:"totalItemLength >= n",value:60}],type:"onePerLine"},{conditions:[{cond:"itemCount >= n",value:4}],type:"onePerLine"},{conditions:[{cond:"exceedsMaxLineLength",value:1}],type:"fillLine"}]},arrayMatrixWrap:"matrixWrapWithAlign",arrayWrap:{defaultWrap:"noWrap",rules:[{conditions:[{cond:"hasMultilineItems",value:1}],type:"onePerLine"},{conditions:[{cond:"totalItemLength <= n",value:80}],type:"noWrap"},{conditions:[{cond:"equalItemLengths",value:1},{cond:"allItemLengths <= n",value:30},{cond:"itemCount >= n",value:10}],type:"fillLineWithLeadingBreak"},{conditions:[{cond:"allItemLengths <= n",value:10},{cond:"itemCount >= n",value:10}],type:"fillLineWithLeadingBreak"},{conditions:[{cond:"anyItemLength >= n",value:30}],type:"onePerLine"},{conditions:[{cond:"itemCount >= n",value:4}],type:"onePerLine"},{conditions:[{cond:"exceedsMaxLineLength",value:1}],type:"onePerLine"}]},callParameter:{defaultWrap:"noWrap",rules:[{conditions:[{cond:"itemCount >= n",value:7}],type:"fillLine"},{conditions:[{cond:"totalItemLength >= n",value:140}],type:"fillLine"},{conditions:[{cond:"anyItemLength >= n",value:80}],type:"fillLine"},{conditions:[{cond:"lineLength >= n",value:160}],type:"fillLine"},{conditions:[{cond:"exceedsMaxLineLength",value:1}],type:"fillLine"}]},casePattern:{defaultWrap:"noWrap",rules:[{conditions:[{cond:"itemCount >= n",value:2}],type:"fillLine"},{conditions:[{cond:"exceedsMaxLineLength",value:1}],type:"fillLine"}]},functionSignature:{defaultWrap:"fillLine",defaultAdditionalIndent:1,rules:[]},implementsExtends:{defaultWrap:"noWrap",rules:[{conditions:[{cond:"lineLength >= n",value:140}],type:"fillLine",additionalIndent:2},{conditions:[{cond:"itemCount >= n",value:4}],type:"fillLine",additionalIndent:2},{conditions:[{cond:"exceedsMaxLineLength",value:1}],type:"fillLine",additionalIndent:2}]},mapWrap:{defaultWrap:"noWrap",rules:[{conditions:[{cond:"hasMultilineItems",value:1}],type:"onePerLine"},{conditions:[{cond:"totalItemLength <= n",value:80}],type:"noWrap"},{conditions:[{cond:"equalItemLengths",value:1},{cond:"allItemLengths <= n",value:30},{cond:"itemCount >= n",value:10}],type:"fillLineWithLeadingBreak"},{conditions:[{cond:"allItemLengths <= n",value:10},{cond:"itemCount >= n",value:10}],type:"fillLineWithLeadingBreak"},{conditions:[{cond:"anyItemLength >= n",value:30}],type:"onePerLine"},{conditions:[{cond:"itemCount >= n",value:4}],type:"onePerLine"},{conditions:[{cond:"exceedsMaxLineLength",value:1}],type:"onePerLine"}]},maxLineLength:160,metadataCallParameter:{defaultWrap:"noWrap",rules:[{conditions:[{cond:"totalItemLength >= n",value:140}],type:"fillLine"},{conditions:[{cond:"lineLength >= n",value:160}],type:"fillLine"},{conditions:[{cond:"exceedsMaxLineLength",value:1}],type:"fillLine"}]},methodChain:{defaultWrap:"noWrap",rules:[{conditions:[{cond:"lineLength >= n",value:160}],type:"onePerLineAfterFirst"},{conditions:[{cond:"itemCount <= n",value:3},{cond:"exceedsMaxLineLength",value:0}],type:"noWrap"},{conditions:[{cond:"totalItemLength <= n",value:80},{cond:"exceedsMaxLineLength",value:0}],type:"noWrap"},{conditions:[{cond:"anyItemLength >= n",value:30},{cond:"itemCount >= n",value:4}],type:"onePerLineAfterFirst"},{conditions:[{cond:"itemCount >= n",value:7}],type:"onePerLineAfterFirst"},{conditions:[{cond:"exceedsMaxLineLength",value:1}],type:"onePerLineAfterFirst"}]},multiVar:{defaultWrap:"noWrap",rules:[{conditions:[{cond:"anyItemLength <= n",value:15}],type:"fillLine"},{conditions:[{cond:"lineLength >= n",value:80}],type:"onePerLineAfterFirst"},{conditions:[{cond:"exceedsMaxLineLength",value:1}],type:"onePerLineAfterFirst"}]},objectLiteral:{defaultWrap:"noWrap",rules:[{conditions:[{cond:"itemCount <= n",value:3},{cond:"exceedsMaxLineLength",value:0}],type:"noWrap"},{conditions:[{cond:"anyItemLength >= n",value:30}],type:"onePerLine"},{conditions:[{cond:"totalItemLength >= n",value:60}],type:"onePerLine"},{conditions:[{cond:"itemCount >= n",value:4}],type:"onePerLine"},{conditions:[{cond:"exceedsMaxLineLength",value:1}],type:"onePerLine"}]},opAddSubChain:{defaultWrap:"noWrap",rules:[{conditions:[{cond:"lineLength >= n",value:160},{cond:"anyItemLength >= n",value:60}],location:"beforeLast",type:"onePerLineAfterFirst"},{conditions:[{cond:"lineLength >= n",value:160}],location:"beforeLast",type:"fillLine"},{conditions:[{cond:"itemCount <= n",value:3},{cond:"exceedsMaxLineLength",value:0}],type:"noWrap"},{conditions:[{cond:"totalItemLength <= n",value:120},{cond:"exceedsMaxLineLength",value:0}],type:"noWrap"},{conditions:[{cond:"itemCount >= n",value:4}],location:"beforeLast",type:"onePerLineAfterFirst"},{conditions:[{cond:"exceedsMaxLineLength",value:1}],location:"beforeLast",type:"onePerLineAfterFirst"}]},opBoolChain:{defaultWrap:"noWrap",rules:[{conditions:[{cond:"lineLength >= n",value:140},{cond:"anyItemLength >= n",value:40}],location:"beforeLast",type:"onePerLineAfterFirst"},{conditions:[{cond:"lineLength >= n",value:140}],location:"beforeLast",type:"fillLine"},{conditions:[{cond:"itemCount <= n",value:3},{cond:"exceedsMaxLineLength",value:0}],type:"noWrap"},{conditions:[{cond:"totalItemLength <= n",value:120},{cond:"exceedsMaxLineLength",value:0}],type:"noWrap"},{conditions:[{cond:"itemCount >= n",value:4}],location:"beforeLast",type:"onePerLineAfterFirst"},{conditions:[{cond:"exceedsMaxLineLength",value:1}],location:"beforeLast",type:"fillLine"}]},typeParameter:{defaultWrap:"noWrap",rules:[{conditions:[{cond:"anyItemLength >= n",value:50}],type:"fillLine"},{conditions:[{cond:"totalItemLength >= n",value:70}],type:"fillLine"}]}}}}$.__name__="JsonParser_63",$.__super__=l,Object.assign($.prototype,{__class__:$});class z extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.errors.push(ji.IncorrectType(t,"Bool",e)),super.onIncorrectType(e,t)}loadJsonNull(e,t){this.value=null}loadJsonBool(e,t,n){this.value=e}}z.__name__="JsonParser_65",z.__super__=l,Object.assign(z.prototype,{__class__:z});class Q extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.errors.push(ji.IncorrectType(t,"Array<String>",e)),super.onIncorrectType(e,t)}loadJsonNull(e,t){this.value=null}loadJsonArray(e,n,r){this.value=this.loadJsonArrayValue(e,nl(t=new X(this.errors,this.putils,2),t.loadJson),r)}}Q.__name__="JsonParser_69",Q.__super__=l,Object.assign(Q.prototype,{__class__:Q});class Z extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.errors.push(ji.IncorrectType(t,"{ ?existingBetweenFields : Null<formatter.config.KeepEmptyLinesPolicy>, ?endType : Null<Int>, ?betweenVars : Null<Int>, ?betweenStaticVars : Null<Int>, ?betweenStaticFunctions : Null<Int>, ?betweenFunctions : Null<Int>, ?beginType : Null<Int>, ?afterVars : Null<Int>, ?afterStaticVars : Null<Int>, ?afterStaticFunctions : Null<Int>, ?afterPrivateVars : Null<Int>, ?afterPrivateFunctions : Null<Int> }",e)),super.onIncorrectType(e,t)}loadJsonNull(e,t){this.value=null}loadJsonObject(e,n,r){let i=new tt;this.objectSetupAssign(i,["afterPrivateFunctions","afterPrivateVars","afterStaticFunctions","afterStaticVars","afterVars","beginType","betweenFunctions","betweenStaticFunctions","betweenStaticVars","betweenVars","endType","existingBetweenFields"],[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0]),this.value=this.getAuto();let s=0;for(;s<e.length;){let r=e[s];switch(++s,r.name){case"afterPrivateFunctions":this.value.afterPrivateFunctions=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"afterPrivateFunctions",i,this.value.afterPrivateFunctions,n);break;case"afterPrivateVars":this.value.afterPrivateVars=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"afterPrivateVars",i,this.value.afterPrivateVars,n);break;case"afterStaticFunctions":this.value.afterStaticFunctions=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"afterStaticFunctions",i,this.value.afterStaticFunctions,n);break;case"afterStaticVars":this.value.afterStaticVars=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"afterStaticVars",i,this.value.afterStaticVars,n);break;case"afterVars":this.value.afterVars=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"afterVars",i,this.value.afterVars,n);break;case"beginType":this.value.beginType=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"beginType",i,this.value.beginType,n);break;case"betweenFunctions":this.value.betweenFunctions=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"betweenFunctions",i,this.value.betweenFunctions,n);break;case"betweenStaticFunctions":this.value.betweenStaticFunctions=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"betweenStaticFunctions",i,this.value.betweenStaticFunctions,n);break;case"betweenStaticVars":this.value.betweenStaticVars=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"betweenStaticVars",i,this.value.betweenStaticVars,n);break;case"betweenVars":this.value.betweenVars=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"betweenVars",i,this.value.betweenVars,n);break;case"endType":this.value.endType=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"endType",i,this.value.endType,n);break;case"existingBetweenFields":this.value.existingBetweenFields=this.loadObjectField(nl(t=new D(this.errors,this.putils,1),t.loadJson),r,"existingBetweenFields",i,this.value.existingBetweenFields,n);break;default:this.errors.push(ji.UnknownVariable(r.name,this.putils.convertPosition(r.namePos)))}}this.objectErrors(i,n)}getAuto(){return{afterPrivateFunctions:1,afterPrivateVars:1,afterStaticFunctions:1,afterStaticVars:1,afterVars:1,beginType:0,betweenFunctions:1,betweenStaticFunctions:1,betweenStaticVars:0,betweenVars:0,endType:0,existingBetweenFields:"keep"}}}Z.__name__="JsonParser_7",Z.__super__=l,Object.assign(Z.prototype,{__class__:Z});class X extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.errors.push(ji.IncorrectType(t,"String",e)),super.onIncorrectType(e,t)}loadJsonNull(e,t){this.value=null}loadJsonString(e,t,n){this.value=e}}X.__name__="JsonParser_80",X.__super__=l,Object.assign(X.prototype,{__class__:X});class Y extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.errors.push(ji.IncorrectType(t,"{ ?rules : Null<Array<formatter.config.WrapRule>>, ?defaultWrap : Null<formatter.config.WrappingType>, ?defaultLocation : Null<formatter.config.WrappingLocation>, ?defaultAdditionalIndent : Null<Int> }",e)),super.onIncorrectType(e,t)}loadJsonNull(e,t){this.value=null}loadJsonObject(e,n,r){let i=new tt;this.objectSetupAssign(i,["defaultAdditionalIndent","defaultLocation","defaultWrap","rules"],[!0,!0,!0,!0]),this.value=this.getAuto();let s=0;for(;s<e.length;){let r=e[s];switch(++s,r.name){case"defaultAdditionalIndent":this.value.defaultAdditionalIndent=this.loadObjectField(nl(t=new c(this.errors,this.putils,1),t.loadJson),r,"defaultAdditionalIndent",i,this.value.defaultAdditionalIndent,n);break;case"defaultLocation":this.value.defaultLocation=this.loadObjectField(nl(t=new u(this.errors,this.putils,1),t.loadJson),r,"defaultLocation",i,this.value.defaultLocation,n);break;case"defaultWrap":this.value.defaultWrap=this.loadObjectField(nl(t=new h(this.errors,this.putils,1),t.loadJson),r,"defaultWrap",i,this.value.defaultWrap,n);break;case"rules":this.value.rules=this.loadObjectField(nl(t=new p(this.errors,this.putils,1),t.loadJson),r,"rules",i,this.value.rules,n);break;default:this.errors.push(ji.UnknownVariable(r.name,this.putils.convertPosition(r.namePos)))}}this.objectErrors(i,n)}getAuto(){return{defaultAdditionalIndent:0,defaultLocation:"afterLast",defaultWrap:"noWrap",rules:[]}}}Y.__name__="JsonParser_83",Y.__super__=l,Object.assign(Y.prototype,{__class__:Y});class ee extends l{constructor(e,t,n){null==n&&(n=0),super(e,t,n)}onIncorrectType(e,t){this.value="noMatrixWrap",this.errors.push(ji.IncorrectType(t,"formatter.config.ArrayMatrixWrap",e)),this.objectThrow(e,t)}loadJsonNull(e,t){this.value=null}loadJsonString(e,t,n){this.value=this.loadString(e,t,n,["noMatrixWrap","matrixWrapNoAlign","matrixWrapWithAlign"],"noMatrixWrap")}}ee.__name__="JsonParser_87",ee.__super__=l,Object.assign(ee.prototype,{__class__:ee});class te{static array(e){let t=[],n=tl(e);for(;n.hasNext();)t.push(n.next());return t}static exists(e,t){let n=tl(e);for(;n.hasNext();)if(t(n.next()))return!0;return!1}static iter(e,t){let n=tl(e);for(;n.hasNext();)t(n.next())}static filter(e,t){let n=[],r=tl(e);for(;r.hasNext();){let e=r.next();t(e)&&n.push(e)}return n}static fold(e,t,n){let r=tl(e);for(;r.hasNext();)n=t(r.next(),n);return n}static count(e,t){let n=0;if(null==t){let t=tl(e);for(;t.hasNext();)t.next(),++n}else{let r=tl(e);for(;r.hasNext();)t(r.next())&&++n}return n}static find(e,t){let n=tl(e);for(;n.hasNext();){let e=n.next();if(t(e))return e}return null}}te.__name__="Lambda",Math.__name__="Math";class ne{static field(e,t){try{return e[t]}catch(e){return We.lastError=e,null}}static fields(e){let t=[];if(null!=e){let r=Object.prototype.hasOwnProperty;for(var n in e)"__id__"!=n&&"hx__closures__"!=n&&r.call(e,n)&&t.push(n)}return t}static compare(e,t){return e==t?0:e>t?1:-1}static isEnumValue(e){return null!=e&&null!=e.__enum__}static deleteField(e,t){return!!Object.prototype.hasOwnProperty.call(e,t)&&(delete e[t],!0)}}ne.__name__="Reflect";class re{static string(e){return Yn.__string_rec(e,"")}static parseInt(e){let t=parseInt(e);return isNaN(t)?null:t}}re.__name__="Std";class ie{constructor(){this.b=""}}ie.__name__="StringBuf",Object.assign(ie.prototype,{__class__:ie});class se{static htmlEscape(e,t){let n="",r=0,i=e;for(;r<i.length;){let e=i,s=r++,a=e.charCodeAt(s);a>=55296&&a<=56319&&(a=a-55232<<10|1023&e.charCodeAt(s+1));a>=65536&&++r;let l=a;switch(l){case 34:n+=t?"&quot;":String.fromCodePoint(l);break;case 38:n+="&amp;";break;case 39:n+=t?"&#039;":String.fromCodePoint(l);break;case 60:n+="&lt;";break;case 62:n+="&gt;";break;default:n+=String.fromCodePoint(l)}}return n}static isSpace(e,t){let n=a.cca(e,t);return n>8&&n<14||32==n}static trim(e){let t=e.length,n=0;for(;n<t&&se.isSpace(e,t-n-1);)++n;let r=n>0?a.substr(e,0,t-n):e,i=r.length,s=0;for(;s<i&&se.isSpace(r,s);)++s;return s>0?a.substr(r,s,i-s):r}static lpad(e,t,n){if(t.length<=0)return e;let r="";for(n-=e.length;r.length<n;)r+=null==t?"null":""+t;return r+=null==e?"null":""+e,r}static rpad(e,t,n){if(t.length<=0)return e;let r="";for(r=null==e?"null":""+e;r.length<n;)r+=null==t?"null":""+t;return r}static replace(e,t,n){return e.split(t).join(n)}static hex(e,t){let n="";do{n="0123456789ABCDEF".charAt(15&e)+n,e>>>=4}while(e>0);if(null!=t)for(;n.length<t;)n="0"+n;return n}}se.__name__="StringTools";class ae{static systemName(){let e=process.platform;switch(e){case"darwin":return"Mac";case"freebsd":return"BSD";case"linux":return"Linux";case"win32":return"Windows";default:return e}}}ae.__name__="Sys";class le{writeByte(e){throw new rt(null,null,{fileName:"haxe/io/Output.hx",lineNumber:47,className:"haxe.io.Output",methodName:"writeByte"})}writeBytes(e,t,n){if(t<0||n<0||t+n>e.length)throw Me.thrown(lt.OutsideBounds);let r=e.b,i=n;for(;i>0;)this.writeByte(r[t]),++t,--i;return n}writeFullBytes(e,t,n){for(;n>0;){let r=this.writeBytes(e,t,n);t+=r,n-=r}}writeString(e,t){let n=it.ofString(e,t);this.writeFullBytes(n,0,n.length)}}le.__name__="haxe.io.Output",Object.assign(le.prototype,{__class__:le});class oe{static enumEq(e,t){if(e==t)return!0;try{let n=e.__enum__;if(null==n||n!=t.__enum__)return!1;if(e._hx_index!=t._hx_index)return!1;let r=e.__params__(),i=t.__params__(),s=0,a=r.length;for(;s<a;){let e=s++;if(!oe.enumEq(r[e],i[e]))return!1}}catch(e){return We.lastError=e,!1}return!0}static enumParameters(e){return null!=e.__params__?e.__params__():[]}}oe.__name__="Type";class ce{static toString(e){switch(e){case 0:return"Element";case 1:return"PCData";case 2:return"CData";case 3:return"Comment";case 4:return"DocType";case 5:return"ProcessingInstruction";case 6:return"Document"}}}class ue{constructor(e){this.nodeType=e,this.children=[],this.attributeMap=new tt}get(e){if(this.nodeType!=ue.Element)throw Me.thrown("Bad node type, expected Element but found "+(null==this.nodeType?"null":ce.toString(this.nodeType)));return this.attributeMap.m.get(e)}set(e,t){if(this.nodeType!=ue.Element)throw Me.thrown("Bad node type, expected Element but found "+(null==this.nodeType?"null":ce.toString(this.nodeType)));this.attributeMap.m.set(e,t)}exists(e){if(this.nodeType!=ue.Element)throw Me.thrown("Bad node type, expected Element but found "+(null==this.nodeType?"null":ce.toString(this.nodeType)));return this.attributeMap.m.has(e)}attributes(){if(this.nodeType!=ue.Element)throw Me.thrown("Bad node type, expected Element but found "+(null==this.nodeType?"null":ce.toString(this.nodeType)));return new Ii(this.attributeMap.m.keys())}elements(){if(this.nodeType!=ue.Document&&this.nodeType!=ue.Element)throw Me.thrown("Bad node type, expected Element or Document but found "+(null==this.nodeType?"null":ce.toString(this.nodeType)));let e=[],t=0,n=this.children;for(;t<n.length;){let r=n[t];++t,r.nodeType==ue.Element&&e.push(r)}return new ct(e)}firstElement(){if(this.nodeType!=ue.Document&&this.nodeType!=ue.Element)throw Me.thrown("Bad node type, expected Element or Document but found "+(null==this.nodeType?"null":ce.toString(this.nodeType)));let e=0,t=this.children;for(;e<t.length;){let n=t[e];if(++e,n.nodeType==ue.Element)return n}return null}addChild(e){if(this.nodeType!=ue.Document&&this.nodeType!=ue.Element)throw Me.thrown("Bad node type, expected Element or Document but found "+(null==this.nodeType?"null":ce.toString(this.nodeType)));null!=e.parent&&e.parent.removeChild(e),this.children.push(e),e.parent=this}removeChild(e){if(this.nodeType!=ue.Document&&this.nodeType!=ue.Element)throw Me.thrown("Bad node type, expected Element or Document but found "+(null==this.nodeType?"null":ce.toString(this.nodeType)));return!!a.remove(this.children,e)&&(e.parent=null,!0)}toString(){return _t.print(this)}static parse(e){return mt.parse(e)}static createElement(e){let t=new ue(ue.Element);if(t.nodeType!=ue.Element)throw Me.thrown("Bad node type, expected Element but found "+(null==t.nodeType?"null":ce.toString(t.nodeType)));return t.nodeName=e,t}static createPCData(e){let t=new ue(ue.PCData);if(t.nodeType==ue.Document||t.nodeType==ue.Element)throw Me.thrown("Bad node type, unexpected "+(null==t.nodeType?"null":ce.toString(t.nodeType)));return t.nodeValue=e,t}static createCData(e){let t=new ue(ue.CData);if(t.nodeType==ue.Document||t.nodeType==ue.Element)throw Me.thrown("Bad node type, unexpected "+(null==t.nodeType?"null":ce.toString(t.nodeType)));return t.nodeValue=e,t}static createComment(e){let t=new ue(ue.Comment);if(t.nodeType==ue.Document||t.nodeType==ue.Element)throw Me.thrown("Bad node type, unexpected "+(null==t.nodeType?"null":ce.toString(t.nodeType)));return t.nodeValue=e,t}static createDocType(e){let t=new ue(ue.DocType);if(t.nodeType==ue.Document||t.nodeType==ue.Element)throw Me.thrown("Bad node type, unexpected "+(null==t.nodeType?"null":ce.toString(t.nodeType)));return t.nodeValue=e,t}static createProcessingInstruction(e){let t=new ue(ue.ProcessingInstruction);if(t.nodeType==ue.Document||t.nodeType==ue.Element)throw Me.thrown("Bad node type, unexpected "+(null==t.nodeType?"null":ce.toString(t.nodeType)));return t.nodeValue=e,t}static createDocument(){return new ue(ue.Document)}}ue.__name__="Xml",Object.assign(ue.prototype,{__class__:ue});class he{}he.__name__="formatter.FormatStats";var de=r["formatter.Result"]={__ename__:!0,__constructs__:null,Success:(t=function(e){return{_hx_index:0,formattedCode:e,__enum__:"formatter.Result",toString:n,__params__:function(){return[this.formattedCode]}}},t._hx_name="Success",t),Failure:(t=function(e){return{_hx_index:1,errorMessage:e,__enum__:"formatter.Result",toString:n,__params__:function(){return[this.errorMessage]}}},t._hx_name="Failure",t),Disabled:{_hx_name:"Disabled",_hx_index:2,__enum__:"formatter.Result",toString:n}};de.__constructs__=[de.Success,de.Failure,de.Disabled];class pe{static format(e,t,n,r,i,s){let a;switch(null==t&&(t=new be),e._hx_index){case 0:let l=e.fileName;return zs.exists(l)?(a={fileName:l,content:Ri.bytesOfBuffer(Ei.readFileSync(l)),config:t,lineSeparator:n,entryPoint:r,range:i,indentOffset:s},pe.formatInputData(a)):(process.stdout.write(re.string("Skipping '"+l+"' (path does not exist)")),process.stdout.write("\n"),de.Failure('File "'+l+'" not found'));case 1:let o,c=e.origin,u=it.ofString(e.code);switch(c._hx_index){case 0:o=c.fileName;break;case 1:o="code snippet"}return a={fileName:o,content:u,config:t,lineSeparator:n,entryPoint:r,range:i,indentOffset:s},pe.formatInputData(a);case 2:let h,d=e.tokenList,p=e.tokenTree,f=e.code,m=e.origin;switch(m._hx_index){case 0:h=m.fileName;break;case 1:h="code snippet"}return a={fileName:h,content:f,tokenList:d,tokenTree:p,config:t,lineSeparator:n,entryPoint:r,range:i,indentOffset:s},pe.formatInputData(a)}}static loadConfig(e){let t=pe.determineConfig(e);if(null==t)return null;let n=new be;return n.readConfig(t),n}static formatInputData(e){try{let t=e.config;if(t.disableFormatting)return de.Disabled;if(t.isExcluded(e.fileName))return de.Disabled;ea.MODE=Ys.Relaxed;let n=new xe(e);he.totalLinesOrig+=n.lines.length;let r=new Se(t.indentation);r.setParsedCode(n),null!=e.indentOffset&&r.setIndentOffset(e.indentOffset);let i=new Ne(t,n,r),s=new Ie(t,n,r),a=new Ae(t,n,r),l=new Fe(t,n,r),o=new Ee(t,n,r),c=new Le(t,n,r),u=new Pe(t,n,r);i.run(),s.run(),a.run(),l.run(),o.run(),c.run(),i.finalRun(),u.run();let h=Ae.outputLineSeparator(t.lineEnds,n),d=new ge(n,r,e.range);d.applyWrapping(t.wrapping,h),c.finalRun(d);let p=d.print(h);return he.totalLinesFormatted+=p.split(h).length,de.Success(p)}catch(e){We.lastError=e;let t=Me.caught(e).unwrap(),n=Re.toString(Re.exceptionStack());return de.Failure((null==t?"null":re.string(t))+"\n"+n+"\n\n")}}static determineConfig(e){let t=ot.isAbsolute(e)?e:Bi.resolve(e);for(zs.isDirectory(t)||(t=ot.directory(t));t.length>0;){let e=ot.join([t,"hxformat.json"]);if(zs.exists(e))return e;t=ot.normalize(ot.join([t,".."]))}return null}}pe.__name__="formatter.Formatter";var fe=r["formatter.FormatterInput"]={__ename__:!0,__constructs__:null,FileInput:(t=function(e){return{_hx_index:0,fileName:e,__enum__:"formatter.FormatterInput",toString:n,__params__:function(){return[this.fileName]}}},t._hx_name="FileInput",t),Code:(t=function(e,t){return{_hx_index:1,code:e,origin:t,__enum__:"formatter.FormatterInput",toString:n,__params__:function(){return[this.code,this.origin]}}},t._hx_name="Code",t),Tokens:(t=function(e,t,r,i){return{_hx_index:2,tokenList:e,tokenTree:t,code:r,origin:i,__enum__:"formatter.FormatterInput",toString:n,__params__:function(){return[this.tokenList,this.tokenTree,this.code,this.origin]}}},t._hx_name="Tokens",t)};fe.__constructs__=[fe.FileInput,fe.Code,fe.Tokens];var me=r["formatter.CodeOrigin"]={__ename__:!0,__constructs__:null,SourceFile:(t=function(e){return{_hx_index:0,fileName:e,__enum__:"formatter.CodeOrigin",toString:n,__params__:function(){return[this.fileName]}}},t._hx_name="SourceFile",t),Snippet:{_hx_name:"Snippet",_hx_index:1,__enum__:"formatter.CodeOrigin",toString:n}};me.__constructs__=[me.SourceFile,me.Snippet];class _e{constructor(e){this.indent=e,this.parts=[],this.emptyLinesAfter=0,this.verbatim=!1,this.partialLine=!1}addToken(e){e.emptyLinesAfter>this.emptyLinesAfter&&(this.emptyLinesAfter=e.emptyLinesAfter),null==this.currentPart&&(this.currentPart={firstToken:e.token,lastToken:e.token,text:"",multiLine:!1,firstLineLength:-1,lastLineLength:-1},this.parts.push(this.currentPart)),this.currentPart.lastToken=e.token,e.spacesBefore>0&&(this.currentPart.text+=se.lpad(""," ",e.spacesBefore)),e.whitespaceAfter==we.Space&&e.spacesAfter>0?this.currentPart.text+=e.text+se.lpad(""," ",e.spacesAfter):this.currentPart.text+=e.text,e.wrapAfter&&(this.currentPart=null)}applyWrapping(e,t,n,r){let i=n.calcAbsoluteIndent(this.indent),s=0,a=this.parts;for(;s<a.length;)this.calcLineLengths(a[s++],r);let l=0,o=this.parts.length;for(;l<o;){let r=l++,s=this.parts[r];if(s.multiLine){if(i+s.firstLineLength>e.maxLineLength)return this.wrappedAt(r,e,t,n);i=s.lastLineLength}else if(i+=s.text.length,i>e.maxLineLength)return this.wrappedAt(r,e,t,n)}return[this]}calcLineLengths(e,t){let n=e.text.split(t);e.multiLine=n.length>1,e.multiLine?(e.firstLineLength=n[0].length,e.lastLineLength=n[n.length-1].length):(e.firstLineLength=e.text.length,e.lastLineLength=-1)}wrappedAt(e,t,n,r){return this.wrapNormal(t,n,r)}wrapNormal(e,t,n){if(this.parts.length<=0)return[this];let r=new _e(this.indent),i=this.parts.shift();r.parts=[i];let s=n.calcAbsoluteIndent(this.indent)+i.text.length,l=[r],o=i;for(;this.parts.length>0;){let i=this.parts.shift(),c=i.firstLineLength;if(!i.multiLine){let e=i.text,t=e.length,n=0;for(;n<t&&se.isSpace(e,t-n-1);)++n;c=(n>0?a.substr(e,0,t-n):e).length}if(s+c>=e.maxLineLength){t.tokenList.lineEndAfter(o.lastToken);let e=t.tokenList.getTokenAt(i.firstToken.index),a=0;null!=e&&(a=e.additionalIndent);let c=n.calcIndent(i.firstToken)+a;r=new _e(c),s=n.calcAbsoluteIndent(c),l.push(r)}r.parts.push(i),i.lastLineLength<=0?s+=i.firstLineLength:s+=i.lastLineLength,o=i}return r.emptyLinesAfter=this.emptyLinesAfter,l}print(e,t){let n="",r=0,i=this.parts;for(;r<i.length;)n+=i[r++].text;if(this.partialLine)n=e.makeIndentString(this.indent)+n;else{let t=e.makeIndentString(this.indent),r=n.length,i=0;for(;i<r&&se.isSpace(n,r-i-1);)++i;n=t+(i>0?a.substr(n,0,r-i):n)}let s=0,l=this.emptyLinesAfter;for(;s<l;)++s,n+=t,e.shouldAddTrailingWhitespace()&&(n+=e.makeIndentString(this.indent));return n}}_e.__name__="formatter.codedata.CodeLine",Object.assign(_e.prototype,{__class__:_e});class ge{constructor(e,t,n){if(this.lines=[],this.indenter=t,this.parsedCode=e,this.range=null,this.posRange=n,this.trailingWhitespaceAfterRange="",this.rangeStartOffset=0,this.rangeEndOffset=0,null!=n){let t=e.tokenList.getTokenAtOffset(n.startPos),r=e.tokenList.getTokenAtOffset(n.endPos);if(null!=r&&n.endPos-1<r.token.pos.min&&(r=e.tokenList.getPreviousToken(r.token)),null!=t&&null!=r){if(7==t.token.tok._hx_index)this.rangeStartOffset=this.calcStartCommentOffset(t);else{let r=e.getLinePos(t.token.pos.min),i=e.getLinePos(n.startPos);e.getLinePos(t.token.pos.max),r.line!=i.line&&(this.rangeStartOffset=n.startPos-i.ofs-t.token.pos.min)}7==r.token.tok._hx_index?this.rangeEndOffset=this.calcEndCommentOffset(r):this.posRange.endPos>=r.token.pos.min&&this.posRange.endPos<r.token.pos.max&&(this.rangeEndOffset=r.text.length-(r.token.pos.max-this.posRange.endPos)),this.range={startPos:t.token.index,endPos:r.token.index}}}this.buildLines()}calcStartCommentOffset(e){let t=this.parsedCode.getString(e.token.pos.min,e.token.pos.max).split(this.parsedCode.lineSeparator),n=0,r=0,i=this.parsedCode.lineSeparator.length,s=this.posRange.startPos-e.token.pos.min,a=0;for(;a<t.length;){let e=t[a];if(++a,e.length+r+i>s)break;r+=e.length+i,++n}t=e.text.split(this.parsedCode.lineSeparator),r=0;let l=0,o=n;for(;l<o;)r+=t[l++].length+i;return r}calcEndCommentOffset(e){let t=this.parsedCode.getString(e.token.pos.min,e.token.pos.max).split(this.parsedCode.lineSeparator),n=0,r=0,i=0,s=this.posRange.endPos-e.token.pos.min,a=this.parsedCode.lineSeparator.length,l=0;for(;l<t.length;){let e=t[l];if(++l,e.length+r+a>s){i=e.length-(s-r);break}r+=e.length+a,++n}t=e.text.split(this.parsedCode.lineSeparator),r=0;let o=0,c=n;for(;o<c;)r+=t[o++].length+a;return r+t[n].length-i}buildLines(){let e=null,t=0;for(;t<this.parsedCode.tokenList.tokens.length&&!(null!=this.range&&t>this.range.endPos);){let n=this.parsedCode.tokenList.getTokenAt(t);if(null==n){++t;continue}let r=n.token.tok;if(8!=r._hx_index||" @formatter:off"!=r.s)if(null!=this.range&&t<this.range.startPos)++t;else{if(null==e&&(e=new _e(this.indenter.calcIndent(n.token)+n.additionalIndent),this.lines.push(e)),null!=this.range&&t==this.range.startPos&&this.rangeStartOffset>0&&(n.text=a.substr(n.text,this.rangeStartOffset,null),e.indent=0),null!=this.range&&t==this.range.endPos){if(this.posRange.endPos>=n.token.pos.min&&this.posRange.endPos<n.token.pos.max){let t=0;this.range.endPos==this.range.startPos&&(t=this.rangeStartOffset),n.text=a.substr(n.text,0,this.rangeEndOffset-t),n.spacesAfter=0,n.whitespaceAfter=we.None,n.emptyLinesAfter=0,e.partialLine=!0}this.posRange.endPos>n.token.pos.max&&(this.trailingWhitespaceAfterRange=this.parsedCode.getString(n.token.pos.max,this.posRange.endPos),e.partialLine=!0)}e.addToken(n),n.whitespaceAfter==we.Newline&&(e=null),++t}else e=null,t=this.skipFormatterOff(t)}}skipFormatterOff(e){let t=e++,n=this.parsedCode.tokenList.getTokenAt(t),r=this.parsedCode.getLinePos(n.token.pos.min).line;for(;e<this.parsedCode.tokenList.tokens.length;){let i=e++,s=this.parsedCode.tokenList.getTokenAt(i);if(null==s)continue;if(null!=this.range){if(i<this.range.startPos)continue;if(i==this.range.startPos&&(n=this.parsedCode.tokenList.getTokenAt(i),r=this.parsedCode.getLinePos(n.token.pos.min).line),i>=this.range.endPos)return this.copyVerbatimChars(n.token.pos.min,s.token.pos.max),e}let a=s.token.tok;if(8==a._hx_index&&" @formatter:on"==a.s)return null!=this.range&&t<this.range.startPos?(this.copyVerbatimChars(n.token.pos.min,s.token.pos.max),e):(this.copyVerbatimLines(r,this.parsedCode.getLinePos(s.token.pos.max).line),e)}return this.copyVerbatimLines(r,this.parsedCode.lines.length-1),e}copyVerbatimLines(e,t){let n=this.parsedCode.getString(this.parsedCode.linesIdx[e].l,this.parsedCode.linesIdx[t].r);if(t<this.parsedCode.lines.length-1){let e=n.length,t=0;for(;t<e&&se.isSpace(n,e-t-1);)++t;t>0&&(n=a.substr(n,0,e-t))}this.lines.push(new ye(n))}copyVerbatimChars(e,t){let n=this.parsedCode.getString(e,t);this.lines.push(new ye(n))}applyWrapping(e,t){let n=[],r=0,i=this.lines;for(;r<i.length;)n=n.concat(i[r++].applyWrapping(e,this.parsedCode,this.indenter,t));this.lines=n}print(e){let t="";this.parsedCode.tokenList.leadingEmptyLInes>0&&(t=se.lpad("",e,e.length*this.parsedCode.tokenList.leadingEmptyLInes)),null!=this.range&&(this.range.startPos>0&&(t=""),this.lines.length>0&&(this.lines[this.lines.length-1].emptyLinesAfter=0));let n=this.lines,r=new Array(n.length),i=0,s=n.length;for(;i<s;){let t=i++;r[t]=n[t].print(this.indenter,e)}return t+r.join(e)+this.trailingWhitespaceAfterRange}}ge.__name__="formatter.codedata.CodeLines",Object.assign(ge.prototype,{__class__:ge});class xe{constructor(e){this.file={name:e.fileName,content:e.content};try{this.removeBOM(),null==e.lineSeparator?this.detectLineSeparator():this.lineSeparator=e.lineSeparator,this.makeLines(),this.makePosIndices(),null==e.tokenList?(this.makeTokens(),this.getTokenTree(e.entryPoint)):(this.tokens=e.tokenList,this.root=e.tokenTree,this.makeTokenList()),this.checkTokens()}catch(e){We.lastError=e;let t=Me.caught(e).unwrap();throw Me.thrown("failed to create parser context: "+(null==t?"null":re.string(t)))}}checkTokens(){if(this.tokens.length!=this.tokenList.tokens.length)throw Me.thrown("token count mismatch");let e=0,t=0,n=this.tokens.length;for(;t<n;){let n=t++,r=this.tokenList.tokens[n];if(null==r){if(e<=0)throw Me.thrown('missing token "'+re.string(this.tokens[n])+'" ['+n+"] detected!");--e;continue}let i=r.token,s=i.tok;switch(s._hx_index){case 2:let t=s.c;switch(t._hx_index){case 0:t.v.startsWith("-")&&(e=1);break;case 1:t.f.startsWith("-")&&(e=1);break;case 2:this.elimateMulitlineEmptyLines(i.pos),e=0;break;case 5:this.elimateMulitlineEmptyLines(i.pos);let r=n+1;for(;this.tokens[r].pos.min<i.pos.max;)++e,++r;break;default:e=0}break;case 6:let r=s.op;switch(r._hx_index){case 8:case 17:e=1;break;case 18:e=2;break;case 20:switch(r.op._hx_index){case 17:e=2;break;case 18:e=3;break;default:e=0}break;default:e=0}break;case 7:this.elimateMulitlineEmptyLines(i.pos),e=0;break;default:e=0}}}elimateMulitlineEmptyLines(e){let t=this.getLinePos(e.min),n=this.getLinePos(e.max),r=t.line,i=n.line;for(;r<i;)a.remove(this.emptyLines,r++)}getTokenTree(e){return null==this.tokens?null:(null==e&&(e=la.TypeLevel),null==this.root&&(this.root=aa.buildTokenTree(this.tokens,this.file.content,e),this.makeTokenList()),this.root)}removeBOM(){null==this.file.content||this.file.content.length<=2||239==this.file.content.b[0]&&187==this.file.content.b[1]&&191==this.file.content.b[2]&&(this.file.content=this.file.content.sub(3,this.file.content.length-3))}makeTokenList(){this.tokenList=new ke,this.tokenList.buildList(this.root)}makePosIndices(){let e=this.file.content;this.linesIdx=[];let t=0,n=!1,r=!1,i=0,s=e.length;for(;i<s;){let s=i++,a=e.b[s];r&&10==a?r=!1:(10!=a&&13!=a||(13==a&&s+1<e.length&&10==e.b[s+1]?(r=!0,this.linesIdx.push({l:t,r:s+1}),t=s+2):(this.linesIdx.push({l:t,r:s}),t=s+1)),n=!0)}n&&this.linesIdx.push({l:t,r:e.length})}getLinePos(e){let t=0,n=this.linesIdx.length-1;if(this.linesIdx.length<=0)throw Me.thrown("Bad offset");if(e<0)throw Me.thrown("Bad offset");if(e>this.linesIdx[n].r)throw Me.thrown("Bad offset");for(;;){if(t>n)throw Me.thrown("Bad offset");let r=t+Math.floor((n-t)/2),i=this.linesIdx[r].l<=e,s=this.linesIdx[r].r>=e;if(i&&s)return{line:r,ofs:e-this.linesIdx[r].l};i?t=r+1:s&&(n=r-1)}}getString(e,t){let n=this.file.content;return e>=n.length||e+(t-e)>n.length?"":n.sub(e,t-e).toString()}isOriginalNewlineBefore(e){if(null==e)return!1;let t=this.tokenList.getPreviousToken(e);return null!=t&&!this.isOriginalSameLine(t.token,e)}isOriginalSameLine(e,t){return this.getLinePos(e.pos.max).line==this.getLinePos(t.pos.min).line}linesBetweenOriginal(e,t){let n=this.getLinePos(e.pos.min).line;return this.getLinePos(t.pos.min).line-n}detectLineSeparator(){let e=this.file.content.toString(),t=0,n=e.length;for(;t<n;){let n=t++,r=e.charAt(n);if("\r"==r||"\n"==r)return this.lineSeparator=r,void("\r"==r&&n+1<e.length&&(r=e.charAt(n+1),"\n"==r&&(this.lineSeparator+=r)))}this.lineSeparator="\n"}makeLines(){this.lines=this.file.content.toString().split(this.lineSeparator),this.emptyLines=[];let e=0,t=this.lines.length;for(;e<t;){let t=e++,n=this.lines[t];if(n.startsWith("<<<<<<<"))throw Me.thrown('not formatting "'+this.file.name+'" - file contains a merge conflict');new s("^\\s*$","").match(n)&&this.emptyLines.push(t)}}makeTokens(){try{this.tokens=[],this.root=null;let e=new bi(this.file.content,this.file.name),t=e.token(bi.tok);for(;t.tok!=oi.Eof;)this.tokens.push(t),t=e.token(bi.tok)}catch(e){We.lastError=e;let t=Me.caught(e).unwrap();if(t instanceof Ai){let e=t;throw Me.thrown("failed to make tokens - ParserError: "+re.string(e)+" ("+re.string(e.pos)+")")}if(t instanceof pi){let e=t;throw Me.thrown("failed to make tokens - LexerError: "+re.string(e.msg)+" ("+re.string(e.pos)+")")}throw Me.thrown("failed to make tokens "+(null==t?"null":re.string(t)))}}}xe.__name__="formatter.codedata.ParsedCode",Object.assign(xe.prototype,{__class__:xe});class ke{constructor(){this.tokens=[],this.leadingEmptyLInes=0,this.closeTokenCache=new Qe}buildList(e){if(null==e.children)return;let t=0,n=e.children;for(;t<n.length;){let e=n[t];++t;let r=e.index;r<0||e.inserted||(e.index>=this.tokens.length&&this.fill(e.index-this.tokens.length),this.tokens[r]={token:e,whitespaceAfter:we.None,spacesBefore:0,spacesAfter:0,emptyLinesAfter:0,wrapAfter:!1,text:null,additionalIndent:0},this.buildList(e))}}fill(e){for(;e-- >0;)this.tokens.push(null)}getCloseToken(e){if(null==e||e.tok==oa.Root)return null;if(e.index<0||e.index>=this.tokens.length)return null;if(this.closeTokenCache.m.has(e.index))return this.closeTokenCache.m.get(e.index);let t;switch(e.tok._hx_index){case 16:t=sa.firstOf(e,oa.BkClose);break;case 18:t=sa.firstOf(e,oa.BrClose);break;case 20:t=sa.firstOf(e,oa.PClose);break;default:return null}return null==t?null:(this.closeTokenCache.m.set(e.index,t),t)}getTokenAtOffset(e){if(this.tokens.length<=0)throw Me.thrown("Bad offset");if(e<0)throw Me.thrown("Bad offset");if(e>this.tokens[this.tokens.length-1].token.pos.max)throw Me.thrown("Bad offset");let t=0,n=this.tokens;for(;t<n.length;){let r=n[t];if(++t,null!=r&&r.token.pos.max>=e)return r}throw Me.thrown("Bad offset")}getTokenAt(e){return e<0||e>=this.tokens.length?null:this.tokens[e]}getPreviousToken(e){if(null==e||e.index<=0)return null;let t=null,n=e.index-1;if(n>=this.tokens.length)return null;for(;null==t;)if(t=this.tokens[n--],n<0)return null;return t}getNextToken(e){if(null==e||e.index<=0)return null;let t=null,n=e.index+1;if(n>=this.tokens.length)return null;for(;null==t;)if(t=this.tokens[n++],n<0)return null;return t}whitespace(e,t){if(e.index<0)return;let n=this.tokens[e.index];if(null==n)return;let r=null,i=e.index-1;for(;null==r&&!(i<0);)r=this.tokens[i--];switch(null!=r&&this.needsLineBreak(r.token)&&(r=null),t){case"after":this.applyWhitespace(n,we.Space);break;case"around":this.applyWhitespace(n,we.Space),this.applyWhitespace(r,we.Space);break;case"before":this.applyWhitespace(r,we.Space);break;case"none":this.applyWhitespace(n,we.None),this.applyWhitespace(r,we.None);break;case"noneAfter":this.applyWhitespace(n,we.None);break;case"noneBefore":this.applyWhitespace(r,we.None);break;case"onlyAfter":this.applyWhitespace(r,we.None),this.applyWhitespace(n,we.Space);break;case"onlyBefore":this.applyWhitespace(r,we.Space),this.applyWhitespace(n,we.None)}}applyWhitespace(e,t){if(null!=e)switch(e.whitespaceAfter._hx_index){case 0:switch(e.whitespaceAfter=t,t._hx_index){case 0:e.spacesAfter=0;break;case 1:this.shouldHaveOneSpaceAfter(e)}break;case 1:switch(t._hx_index){case 0:e.whitespaceAfter=we.None,e.spacesAfter=0;break;case 1:this.shouldHaveOneSpaceAfter(e);break;case 2:e.whitespaceAfter=t}break;case 2:switch(t._hx_index){case 0:e.spacesAfter>0?e.whitespaceAfter=we.Space:(e.whitespaceAfter=we.None,e.spacesAfter=0);break;case 1:e.whitespaceAfter=t,this.shouldHaveOneSpaceAfter(e)}}}shouldHaveOneSpaceAfter(e){null!=e&&e.spacesAfter<=0&&(e.spacesAfter=1)}spacesBefore(e,t){if(e.index<0)return;let n=this.tokens[e.index];null!=n&&(n.spacesBefore=t)}lineEndAfter(e){if(e.index<0)return;let t=this.tokens[e.index];if(null!=t)switch(t.whitespaceAfter._hx_index){case 0:case 1:t.whitespaceAfter=we.Newline}}lineEndBefore(e){let t=this.getPreviousToken(e);if(null!=t)switch(t.whitespaceAfter._hx_index){case 0:case 1:t.whitespaceAfter=we.Newline}}needsLineBreak(e){return null!=e&&8==e.tok._hx_index}noLineEndAfter(e){if(e.index<0)return;let t=this.tokens[e.index];if(null!=t)if(this.needsLineBreak(t.token))t.whitespaceAfter=we.Newline;else switch(t.whitespaceAfter._hx_index){case 0:return;case 1:break;case 2:t.spacesAfter<=0?t.whitespaceAfter=we.None:(t.whitespaceAfter=we.Space,this.shouldHaveOneSpaceAfter(t))}}noLineEndBefore(e){let t=this.getPreviousToken(e);if(null!=t)if(this.needsLineBreak(t.token))t.whitespaceAfter=we.Newline;else switch(t.whitespaceAfter._hx_index){case 0:return;case 1:break;case 2:t.spacesAfter<=0?t.whitespaceAfter=we.None:(t.whitespaceAfter=we.Space,this.shouldHaveOneSpaceAfter(t))}}emptyLinesAfter(e,t){if(e.index<0)return;let n=this.tokens[e.index];null!=n&&(n.emptyLinesAfter=t)}emptyLinesBefore(e,t){if(e.index<=0)return void(this.leadingEmptyLInes=t);let n=this.getPreviousToken(e);null!=n&&(n.emptyLinesAfter=t)}emptyLinesAfterSubTree(e,t){let n=fa.getLastToken(e);if(null==n)return;let r=this.tokens[n.index];null!=r&&(r.emptyLinesAfter=t)}tokenText(e,t){if(e.index<0)return;let n=this.tokens[e.index];null!=n&&(n.text=t)}wrapAfter(e,t){if(e.index<0)return;let n=this.tokens[e.index];null!=n&&(n.wrapAfter=t)}wrapBefore(e,t){let n=this.getPreviousToken(e);null!=n&&(n.wrapAfter=t)}noWrappingBetween(e,t,n,r){if(null==r&&(r=!0),null==e||null==t)return;let i=e.index;for(;i<t.index;){let t=i==e.index,s=this.tokens[i++],a=this.tokens[i];if(null==s)continue;let l=s.token.tok;switch(l._hx_index){case 1:switch(l.k._hx_index){case 0:case 41:let e=fa.getLastToken(s.token);if(null!=e){e.index>i&&(i=e.index);continue}}break;case 7:case 8:continue;case 14:let e=fa.getLastToken(s.token);if(null!=e){e.index>i&&(i=e.index);continue}break;case 15:if(r)continue;break;case 16:if(!t){let e=this.getCloseToken(s.token);if(null!=e){i=e.index;continue}}break;case 18:if(!t){let e=this.getCloseToken(s.token);if(null!=e){i=e.index;continue}}break;case 20:if(!t){let e=this.getCloseToken(s.token);if(null!=e){i=e.index;continue}}}if(s.wrapAfter=!1,null!=a&&18==a.token.tok._hx_index)switch(n.lineEnds.leftCurly){case"after":case"none":break;case"before":case"both":continue}switch(s.whitespaceAfter._hx_index){case 0:case 1:break;case 2:s.spacesAfter<=0?s.whitespaceAfter=we.None:(s.whitespaceAfter=we.Space,this.shouldHaveOneSpaceAfter(s))}}}additionalIndent(e,t){if(null==t||null==e||e.index<0)return;let n=this.tokens[e.index];null!=n&&(n.additionalIndent=t)}increaseIndentBetween(e,t,n,r,i,s){if(0==n||null==e||e.index<0||null==t||t.index<0)return;let a=e.index;n>0&&++a;let l=t.index,o=Ae.outputLineSeparator(r.lineEnds,i),c=a;for(;c<l;){let e=this.tokens[c++];if(null!=e&&(e.additionalIndent+=n,7==e.token.tok._hx_index)){let t=e.text.split(o),r=s.makeIndentString(n);if(t.length>0){let n=1,i=t.length;for(;n<i;){let e=n++;t[e]=r+t[e]}e.text=t.join(o)}}}}findTokenAtOffset(e){let t=null,n=0,r=this.tokens;for(;n<r.length;){let i=r[n];if(++n,null!=i){if(i.token.pos.min>=e)return t;t=i}}return t}isSameLine(e,t){let n=e.index,r=t.index;if(n==r)return!0;if(n<0||r<0)return!1;for(n>r&&(n=t.index,r=e.index);n<r;){let e=this.tokens[n++];if(null!=e&&e.whitespaceAfter==we.Newline)return!1}return!0}findLowestIndex(e){let t=e;if(!e.hasChildren())return e;let n=0,r=e.children;for(;n<r.length;){let e=this.findLowestIndex(r[n++]);e.index<t.index&&(t=e)}return t}calcLength(e){if(null==e||e.index<0)return 0;let t=this.tokens[e.index];if(null==t)return 0;let n=0;t.whitespaceAfter==we.Space&&(n=1),null==t.text&&(t.text=""+re.string(t.token));let r=t.text.length+n;if(null==e.children||e.children.length<=0)return r;let i=0,s=e.children;for(;i<s.length;)r+=this.calcLength(s[i++]);return r}isMultilineToken(e){if(null==e||e.index<0)return!1;let t=this.tokens[e.index];return null!=t&&(t.text.indexOf("\r")>=0||t.text.indexOf("\n")>=0)}calcLengthUntilNewline(e,t){if(null==e||e.index<0)return 0;let n=this.tokens.length-1;null!=t&&(n=t.index);let r=e.index,i=0;for(;r<=n;){let e=this.tokens[r++];if(null!=e){if(null==e.text&&(e.text=""+re.string(e.token)),e.text.indexOf("\r")>=0){i+=e.text.indexOf("\r");break}if(e.text.indexOf("\n")>=0){i+=e.text.indexOf("\n");break}if(i+=e.spacesBefore,e.whitespaceAfter==we.Space&&(i+=e.spacesAfter),i+=e.text.length,e.whitespaceAfter==we.Newline)break}}return i}calcLengthBetween(e,t){if(null==e||null==t)return 0;if(e.index<0||t.index<0)return 0;let n=0,r=e.index,i=t.index;for(;r<i;){let e=this.tokens[r++];null!=e&&(null==e.text&&(e.text=""+re.string(e.token)),n+=e.text.length,e.whitespaceAfter==we.Space&&++n)}return n}calcLineLength(e){if(null==e||e.index<0)return 0;let t=e.index-1;for(;t>=0;){let e=this.tokens[t--];if(null!=e&&e.whitespaceAfter==we.Newline){t+=2;break}}let n=0;e:for(;t<this.tokens.length;){let e=this.tokens[t++];if(null!=e)switch(n+=e.text.length,e.whitespaceAfter._hx_index){case 0:break;case 1:n+=e.spacesAfter;break;case 2:break e}}return n}calcLineLengthBefore(e){if(null==e||e.index<0)return 0;let t=e.index-1,n=0;e:for(;t>=0;){let e=this.tokens[t--];if(null!=e){switch(e.whitespaceAfter._hx_index){case 0:break;case 1:n+=e.spacesAfter;break;case 2:break e}n+=e.text.length}}return n}calcLineLengthAfter(e){if(null==e||e.index<0)return 0;let t=e.index+1,n=0;e:for(;t<this.tokens.length;){let e=this.tokens[t++];if(null==e)continue;let r=e.text.length,i=e.text.lastIndexOf("\r");switch(i>=0&&(r-=i),i=e.text.lastIndexOf("\n"),i>=0&&(r-=i),n+=r,e.whitespaceAfter._hx_index){case 0:break;case 1:n+=e.spacesAfter;break;case 2:break e}}return n}calcTokenLength(e){if(null==e||e.index<0)return 0;let t=this.tokens[e.index];if(null==t)return 0;let n=t.text.length;switch(t.whitespaceAfter._hx_index){case 0:case 2:break;case 1:n+=t.spacesAfter}return n}isNewLineBefore(e){let t=this.getPreviousToken(e);return null!=t&&t.whitespaceAfter==we.Newline}isNewLineAfter(e){let t=this.getTokenAt(e.index);return null!=t&&t.whitespaceAfter==we.Newline}isSameLineBetween(e,t,n){if(null==e||null==t)return!0;let r=e.index,i=t.index;n&&++r;let s=r;for(;s<i;){let e=this.tokens[s++];if(null!=e){if(e.whitespaceAfter==we.Newline)return!1;if(null!=e.text&&(e.text.indexOf("\r")>=0||e.text.indexOf("\n")>=0))return!1}}return!0}findLineStartToken(e){if(null==e||e.index<0)return null;let t=e.index-1;for(;;){if(t<0)return this.tokens[0].token;let n=this.tokens[t--];if(null!=n){switch(n.whitespaceAfter._hx_index){case 0:case 1:break;case 2:return e}e=n.token}}}}ke.__name__="formatter.codedata.TokenList",Object.assign(ke.prototype,{__class__:ke});class ye extends _e{constructor(e){super(0),this.content=e,this.verbatim=!0}applyWrapping(e,t,n,r){return[this]}print(e,t){return this.content}}ye.__name__="formatter.codedata.VerbatimCodeLine",ye.__super__=_e,Object.assign(ye.prototype,{__class__:ye});var we=r["formatter.codedata.WhitespaceAfterType"]={__ename__:!0,__constructs__:null,None:{_hx_name:"None",_hx_index:0,__enum__:"formatter.codedata.WhitespaceAfterType",toString:n},Space:{_hx_name:"Space",_hx_index:1,__enum__:"formatter.codedata.WhitespaceAfterType",toString:n},Newline:{_hx_name:"Newline",_hx_index:2,__enum__:"formatter.codedata.WhitespaceAfterType",toString:n}};we.__constructs__=[we.None,we.Space,we.Newline];class be{constructor(){this.excludes=[],this.readConfigFromString("{}","hxformat.json")}readConfig(e){zs.exists(e)&&this.readConfigFromString(Ei.readFileSync(e,{encoding:"utf8"}),e)}readConfigFromString(e,t){let n=(new o).fromJson(e,t);this.emptyLines=n.emptyLines,this.indentation=n.indentation,this.lineEnds=n.lineEnds,this.sameLine=n.sameLine,this.whitespace=n.whitespace,this.wrapping=n.wrapping,this.disableFormatting=n.disableFormatting,this.excludes=[],this.configFileName=t;let r=0,i=n.excludes;for(;r<i.length;)this.excludes.push(new s(i[r++],""))}isExcluded(e){let t=0,n=this.excludes;for(;t<n.length;)if(n[t++].match(e))return!0;return!1}}be.__name__="formatter.config.Config",Object.assign(be.prototype,{__class__:be});class Te{static has(e,t){return Te.remove(e,t)!=e}static remove(e,t){switch(t){case"after":case"before":break;case"around":return"none";case"none":return e;case"noneAfter":case"onlyAfter":t="after";break;case"noneBefore":case"onlyBefore":t="before"}switch(e){case"after":case"onlyAfter":if("after"==t)return"none";break;case"around":if("before"==t)return"after";if("after"==t)return"before";break;case"before":case"onlyBefore":if("before"==t)return"none";break;case"none":return"none";case"noneAfter":return"noneAfter";case"noneBefore":return"noneBefore"}return e}static add(e,t){switch(t){case"after":case"before":break;case"around":return"none";case"none":return e;case"noneAfter":case"onlyAfter":t="after";break;case"noneBefore":case"onlyBefore":t="before"}switch(e){case"after":case"onlyAfter":if("before"==t)return"around";break;case"around":break;case"before":case"onlyBefore":if("after"==t)return"around";break;case"none":return t;case"noneAfter":case"noneBefore":if("before"==t)return"onlyBefore";if("after"==t)return"onlyAfter"}return e}}class Se{constructor(e){this.config=e,this.indentOffset=0,"tab"==e.character.toLowerCase()&&(e.character="\t")}setParsedCode(e){this.parsedCode=e}setIndentOffset(e){e<0&&(e=0),this.indentOffset=e}makeIndentString(e){return se.lpad("",this.config.character,this.config.character.length*e)}calcAbsoluteIndent(e){return"\t"==this.config.character?e*this.config.tabWidth:e*this.config.character.length}calcIndent(e){return this.calcRealIndent(e)+this.indentOffset}calcRealIndent(e){if(null==e)return 0;if(3==e.tok._hx_index){if("fixedZero"==this.config.conditionalPolicy)return 0;if("fixedZeroIncrease"==this.config.conditionalPolicy)return this.calcConditionalLevel(e);if("fixedZeroIncreaseBlocks"==this.config.conditionalPolicy)return this.hasBlockParent(e)?this.calcConditionalLevel(e):0}return this.calcFromCandidates(this.findEffectiveParent(e))}calcConditionalLevel(e){let t=-1;for(;null!=e&&e.tok!=oa.Root;){let n=e.tok;3==n._hx_index&&"if"==n.s&&++t,e=e.parent}return t<=0?0:t}calcConsecutiveConditionalLevel(e){let t=-1,n=-1;for(;null!=e&&e.tok!=oa.Root;){let r=e.tok;3==r._hx_index?"if"==r.s&&++t:(t>n&&(n=t),t=-1),e=e.parent}return t>n&&(n=t),n<=0?0:n}shouldAddTrailingWhitespace(){return this.config.trailingWhitespace}findEffectiveParent(e){if(e.tok==oa.Root)return e.getFirstChild();let t=e.tok;switch(t._hx_index){case 1:switch(t.k._hx_index){case 0:let t=e.parent;if(t.tok==oa.Root)return e;if(20==t.tok._hx_index)return this.parsedCode.tokenList.isNewLineBefore(e)?e:this.findEffectiveParent(e.parent);break;case 3:let n=this.parsedCode.tokenList.getPreviousToken(e);if(null==n)return e;if(n.whitespaceAfter==we.Newline)return e;let r=sa.firstOf(e,oa.At);if(null!=r){if(!this.parsedCode.tokenList.isSameLineBetween(r,e,!1))return e;if(n=this.parsedCode.tokenList.getPreviousToken(r),null==n)return e;if(n.whitespaceAfter==we.Newline)return e}let i=e.parent;if(i.tok==oa.Root)return e;let s=i.tok;switch(s._hx_index){case 1:if(4!=s.k._hx_index)return e;break;case 6:return e}return this.findEffectiveParent(e.parent);case 5:let a,l=e.parent;if(l.tok==oa.Root)return e;if(null!=l){let e=l.tok;a=1==e._hx_index&&6==e.k._hx_index}else a=!1;if(a)return this.findEffectiveParent(e.parent);break;case 4:case 21:return this.findEffectiveParent(e.parent)}break;case 3:switch(t.s){case"else":case"elseif":case"end":return this.findEffectiveParent(e.parent)}break;case 7:let n=this.parsedCode.tokenList.getNextToken(e);if(null==n)return e;let r=n.token.tok;if(1!=r._hx_index)return e;switch(r.k._hx_index){case 4:case 21:return this.findEffectiveParent(n.token);default:return e}break;case 8:let i=this.parsedCode.tokenList.getNextToken(e);if(null==i)return e;let s=i.token.tok;if(1!=s._hx_index)return e;switch(s.k._hx_index){case 4:case 21:return this.findEffectiveParent(i.token);default:return e}break;case 14:case 17:case 19:case 21:return this.findEffectiveParent(e.parent);case 18:let a=e.parent;if(a.tok==oa.Root)return e;let l=this.findEffectiveParentLineStart(e);if(null!=l)return l;switch(fa.getBrOpenType(e)._hx_index){case 0:case 4:break;case 1:return e.parent;case 2:case 3:return e}let o=a.tok;switch(o._hx_index){case 1:switch(o.k._hx_index){case 0:return this.parsedCode.tokenList.isNewLineBefore(a)?a:this.findEffectiveParent(a);case 3:case 4:case 5:case 6:case 7:case 14:case 20:case 21:case 29:return this.findEffectiveParent(a);case 22:let e=a.parent.tok;if(1==e._hx_index&&0==e.k._hx_index)return this.findEffectiveParent(a.parent)}break;case 2:if(3==o.c._hx_index){let e=a.parent.tok;if(1==e._hx_index&&0==e.k._hx_index)return this.findEffectiveParent(a.parent)}break;case 6:switch(o.op._hx_index){case 4:let e=sa.matches(sa.parent(sa.parent(a)),oa.Kwd(li.KwdTypedef));if(null!=e)return e;break;case 20:let t=sa.matches(sa.parent(sa.parent(a)),oa.Kwd(li.KwdTypedef));if(null!=t)return t}}break;case 20:let c=this.findEffectiveParentLineStart(e);if(null!=c)return c}return e}findEffectiveParentLineStart(e){let t=this.parsedCode.tokenList.findLineStartToken(e);if(null==t)return null;if(t.index==e.index)return null;switch(t.tok._hx_index){case 17:case 19:let e=this.parsedCode.tokenList.getNextToken(t);if(null!=e)switch(e.token.tok._hx_index){case 6:case 11:case 15:case 17:case 19:case 21:return this.findEffectiveParent(t)}break;case 21:let n=this.parsedCode.tokenList.getNextToken(t);if(null!=n)switch(n.token.tok._hx_index){case 6:case 11:return this.findEffectiveParent(t)}}return null}countLineBreaks(e,t){let n,r=0,i=null,s=null,a=null,l=null,o=0;for(;o<e.length;){let c=e[o];if(++o,i=s,null==i&&(i=c),s=c,null!=l){if(c.index>=l.index)continue;i=l,l=null}if(i.index==c.index)continue;switch(c.tok._hx_index){case 16:case 18:let e=this.parsedCode.tokenList.getCloseToken(c);if(null!=e&&e.index>=0&&e.index<i.index){s=i;continue}}n=!1;let u=i.tok;switch(u._hx_index){case 1:switch(u.k._hx_index){case 0:if(20==c.tok._hx_index){if(this.parsedCode.tokenList.isSameLineBetween(c,i,!1))continue;if(!this.parsedCode.tokenList.isNewLineBefore(i)){let e=this.parsedCode.tokenList.getPreviousToken(i);for(;null!=e&&!this.parsedCode.tokenList.isNewLineBefore(e.token);)e=this.parsedCode.tokenList.getPreviousToken(e.token);let t=sa.firstOf(i,oa.BrOpen);if(null!=t&&!this.parsedCode.tokenList.isSameLineBetween(i,t,!1))continue;return r+this.calcIndent(e.token)}}break;case 3:let e=c.tok;if(6==e._hx_index){if(4==e.op._hx_index)t&&(n=!0);else if(this.parsedCode.tokenList.isSameLineBetween(c,i,!1)){let e=sa.firstOf(i,oa.Kwd(li.KwdElse));if(null!=e){if(this.parsedCode.tokenList.isSameLineBetween(i,e,!1))continue;t&&(n=!0)}let r=sa.firstOf(i,oa.BrOpen);if(null!=r&&0==fa.getBrOpenType(r)._hx_index)continue}}else if(this.parsedCode.tokenList.isSameLineBetween(c,i,!1)){let e=sa.firstOf(i,oa.Kwd(li.KwdElse));if(null!=e){if(this.parsedCode.tokenList.isSameLineBetween(i,e,!1))continue;t&&(n=!0)}let r=sa.firstOf(i,oa.BrOpen);if(null!=r&&0==fa.getBrOpenType(r)._hx_index)continue}break;case 4:continue;case 14:switch(c.tok._hx_index){case 6:t&&(n=!0);break;case 20:switch(fa.getPOpenType(c)._hx_index){case 0:case 2:case 8:case 9:break;case 1:case 3:case 4:case 5:case 6:case 7:n=!0}}break;case 15:case 16:if(!this.config.indentCaseLabels)continue;break;case 21:let s=c.tok;if(1==s._hx_index&&20==s.k._hx_index)continue}break;case 2:let e=u.c;if(3==e._hx_index)switch(e.s){case"from":case"to":this.isAbstractFromTo(c)&&this.parsedCode.tokenList.isNewLineBefore(i)&&(n=!0)}break;case 3:if("if"==u.s&&c.matches(oa.Dot)&&i.hasChildren()){let e=!1,t=0,n=i.children;for(;t<n.length;)if(n[t++].matches(oa.Dot)){e=!0;break}if(e)continue}break;case 11:let s=c.tok;switch(s._hx_index){case 1:switch(s.k._hx_index){case 15:case 16:continue;case 10:case 22:case 29:if(!this.parsedCode.tokenList.isNewLineBefore(i))continue;break;default:if(this.parsedCode.tokenList.isNewLineBefore(i)){++r;continue}}break;case 6:switch(s.op._hx_index){case 4:if(this.parsedCode.tokenList.isSameLineBetween(c,i,!1))continue;if(!this.parsedCode.tokenList.isNewLineBefore(i)){let e=this.parsedCode.tokenList.getPreviousToken(i);for(;null!=e&&!this.parsedCode.tokenList.isNewLineBefore(e.token);)e=this.parsedCode.tokenList.getPreviousToken(e.token);return r+this.calcIndent(e.token)}break;case 20:if(this.parsedCode.tokenList.isSameLineBetween(c,i,!1))continue;if(!this.parsedCode.tokenList.isNewLineBefore(i)){let e=this.parsedCode.tokenList.getPreviousToken(i);for(;null!=e&&!this.parsedCode.tokenList.isNewLineBefore(e.token);)e=this.parsedCode.tokenList.getPreviousToken(e.token);return r+this.calcIndent(e.token)}break;default:if(this.parsedCode.tokenList.isNewLineBefore(i)){++r;continue}}break;case 11:if(i.pos.min!=c.pos.min||!this.parsedCode.tokenList.isNewLineBefore(c))continue;break;case 16:case 18:case 20:if(this.parsedCode.tokenList.isSameLine(c,i))continue;n=!0;break;default:if(this.parsedCode.tokenList.isNewLineBefore(i)){++r;continue}}break;case 12:let l=c.tok;if(1==l._hx_index)switch(l.k._hx_index){case 15:case 16:if(null!=a&&a.pos.min==i.pos.min)continue;n=!0}break;case 14:case 16:if(20==c.tok._hx_index){if(this.parsedCode.tokenList.isSameLineBetween(c,i,!1))continue;if(!this.parsedCode.tokenList.isNewLineBefore(i)){let e=this.parsedCode.tokenList.getPreviousToken(i);for(;null!=e&&!this.parsedCode.tokenList.isNewLineBefore(e.token);)e=this.parsedCode.tokenList.getPreviousToken(e.token);let t=sa.firstOf(i,oa.BrOpen);if(null!=t&&!this.parsedCode.tokenList.isSameLineBetween(i,t,!1))continue;return r+this.calcIndent(e.token)}}break;case 18:let o=c.tok;switch(o._hx_index){case 1:switch(o.k._hx_index){case 0:case 3:case 4:case 5:case 6:case 7:case 10:case 14:case 20:case 21:case 29:case 40:if(2!=fa.getBrOpenType(i)._hx_index)continue;{let e=this.parsedCode.tokenList.getCloseToken(i);if(null!=e&&!this.parsedCode.tokenList.isSameLine(i,e)&&!this.config.indentObjectLiteral)continue}}break;case 6:switch(o.op._hx_index){case 4:switch(fa.getBrOpenType(i)._hx_index){case 1:continue;case 2:let e=this.parsedCode.tokenList.getCloseToken(i);if(null!=e&&!this.parsedCode.tokenList.isSameLine(i,e)&&!this.config.indentObjectLiteral)continue}break;case 20:switch(fa.getBrOpenType(i)._hx_index){case 1:continue;case 2:let e=this.parsedCode.tokenList.getCloseToken(i);if(null!=e&&!this.parsedCode.tokenList.isSameLine(i,e)&&!this.config.indentObjectLiteral)continue}}break;case 12:switch(fa.getBrOpenType(i)._hx_index){case 1:continue;case 2:let e=this.parsedCode.tokenList.getCloseToken(i);if(null!=e&&!this.parsedCode.tokenList.isSameLine(i,e)&&!this.config.indentObjectLiteral)continue}break;case 14:if(2!=fa.getBrOpenType(i)._hx_index)continue;{let e=this.parsedCode.tokenList.getCloseToken(i);if(null!=e&&!this.parsedCode.tokenList.isSameLine(i,e)&&!this.config.indentObjectLiteral)continue}break;case 16:case 20:this.parsedCode.tokenList.isNewLineBefore(i)}}!n&&this.parsedCode.tokenList.isSameLineBetween(c,i,!1)||(l=this.findSkippingToken(c),this.isIndentingToken(c,i)&&(a=c,++r))}return r}findSkippingToken(e){let t=this.parsedCode.tokenList.findLineStartToken(e);if(null==t)return null;if(t.index==e.index)return null;let n=null;switch(t.tok._hx_index){case 17:case 19:case 21:return n=this.findSkippingToken(t.parent),null==n&&(n=t.parent),n;default:return null}}isFieldLevelVar(e){let t=e.slice();t.reverse();let n=0;for(;n<t.length;){let e=t[n++].tok;switch(e._hx_index){case 1:switch(e.k._hx_index){case 0:return!1;case 2:return!0}break;case 6:if(4==e.op._hx_index)return!0}}return!1}calcFromCandidates(e){let t=this.findIndentingCandidates(e);if(t.length<=0)return 0;let n=this.config.indentComplexValueExpressions;this.isFieldLevelVar(t)&&(n=!0),n&&(t=this.compressElseIfCandidates(t));let r=this.countLineBreaks(t,n);if(this.hasConditional(t))switch(this.config.conditionalPolicy){case"aligned":case"alignedIncrease":case"fixedZero":break;case"alignedDecrease":--r;break;case"alignedNestedIncrease":r+=this.calcConsecutiveConditionalLevel(e);break;case"fixedZeroIncrease":--r,this.calcConditionalLevel(e)==r&&++r;break;case"fixedZeroIncreaseBlocks":this.hasBlock(t)&&(--r,this.calcConditionalLevel(e)==r&&++r)}return r}hasConditional(e){let t=0;for(;t<e.length;){let n=e[t++].tok;if(3==n._hx_index&&"if"==n.s)return!0}return!1}hasBlock(e){let t=0;for(;t<e.length;)if(18==e[t++].tok._hx_index)return!0;return!1}hasBlockParent(e){let t=e.parent;for(;null!=t&&t.tok!=oa.Root;){if(18==t.tok._hx_index)return!0;t=t.parent}return!1}findIndentingCandidates(e){let t=[],n=null;11==e.tok._hx_index&&(n=e),t.push(e);let r=e;for(;null!=r.parent&&r.parent.tok!=oa.Root;)if(r=r.parent,!(r.pos.min>e.pos.min))if(this.isIndentingToken(r,r)){if(null!=n&&11==n.tok._hx_index&&11==r.tok._hx_index)continue;t.push(r),n=r}else this.parsedCode.tokenList.isNewLineBefore(r)&&(t.push(r),n=r);return t}compressElseIfCandidates(e){let t=[],n=Ce.Copy,r=0;for(;r<e.length;){let i=e[r];++r;let s=i.tok;if(1==s._hx_index)switch(s.k._hx_index){case 3:switch(n._hx_index){case 0:null!=sa.firstOf(i,oa.Kwd(li.KwdElse))&&(n=Ce.SkipElseIf);break;case 1:n=Ce.SkipElseIf;break;case 2:continue}break;case 4:if(n==Ce.SeenElse||n==Ce.SkipElseIf){n=Ce.SkipElseIf;continue}n=Ce.SeenElse;break;default:n=Ce.Copy}else n=Ce.Copy;t.push(i)}return t}isIndentingToken(e,t){if(null==e)return!1;let n=e.tok;switch(n._hx_index){case 1:switch(n.k._hx_index){case 0:case 2:case 3:case 4:case 6:case 7:case 14:case 15:case 16:case 20:case 21:case 24:case 10:case 29:case 40:return!0;case 5:let t,n=e.parent;if(null!=n){let e=n.tok;t=1==e._hx_index&&6==e.k._hx_index}else t=!1;return!t;case 22:let r=e.parent.tok;return 1!=r._hx_index||0!=r.k._hx_index}break;case 2:let r=n.c;if(3==r._hx_index)switch(r.s){case"from":case"to":return this.isAbstractFromTo(e);default:if(11==t.tok._hx_index)return!0}break;case 3:if("if"==n.s)switch(this.config.conditionalPolicy){case"aligned":case"alignedNestedIncrease":case"fixedZero":return!1;case"alignedDecrease":case"alignedIncrease":case"fixedZeroIncrease":return!0;case"fixedZeroIncreaseBlocks":return this.hasBlockParent(e)}break;case 6:switch(n.op._hx_index){case 4:case 20:return!0;case 9:return fa.isTypeParameter(e)}break;case 11:case 16:case 18:case 20:case 14:return!0;case 12:let i,s=e.parent.tok;if(1!=s._hx_index||15!=s.k._hx_index){let t=e.parent.tok;i=1==t._hx_index&&16==t.k._hx_index}else i=!0;if(i)return!0;let a=this.parsedCode.tokenList.getTokenAt(e.index);if(null==a)return!1;switch(a.whitespaceAfter._hx_index){case 0:case 1:return!1;case 2:return!0}}return!1}isAbstractFromTo(e){let t=e.parent;if(null==t)return!1;let n=t.tok;if(2!=n._hx_index)return!1;if(3!=n.c._hx_index)return!1;if(t=t.parent,null==t)return!1;let r=t.tok;return 1==r._hx_index&&40==r.k._hx_index}}Se.__name__="formatter.marker.Indenter",Object.assign(Se.prototype,{__class__:Se});var Ce=r["formatter.marker.IndentationCompressElseIf"]={__ename__:!0,__constructs__:null,Copy:{_hx_name:"Copy",_hx_index:0,__enum__:"formatter.marker.IndentationCompressElseIf",toString:n},SeenElse:{_hx_name:"SeenElse",_hx_index:1,__enum__:"formatter.marker.IndentationCompressElseIf",toString:n},SkipElseIf:{_hx_name:"SkipElseIf",_hx_index:2,__enum__:"formatter.marker.IndentationCompressElseIf",toString:n}};Ce.__constructs__=[Ce.Copy,Ce.SeenElse,Ce.SkipElseIf];class ve{constructor(e,t,n){this.config=e,this.parsedCode=t,this.indenter=n}getCloseToken(e){return this.parsedCode.tokenList.getCloseToken(e)}getNextToken(e){return this.parsedCode.tokenList.getNextToken(e)}getPreviousToken(e){return this.parsedCode.tokenList.getPreviousToken(e)}getTokenInfo(e){return this.parsedCode.tokenList.getTokenAt(e.index)}getTokenAt(e){return this.parsedCode.tokenList.getTokenAt(e)}whitespace(e,t){this.parsedCode.tokenList.whitespace(e,t)}spacesBefore(e,t){this.parsedCode.tokenList.spacesBefore(e,t)}lineEndAfter(e){this.parsedCode.tokenList.lineEndAfter(e)}lineEndBefore(e){this.parsedCode.tokenList.lineEndBefore(e)}noLineEndAfter(e){this.parsedCode.tokenList.noLineEndAfter(e)}noLineEndBefore(e){this.parsedCode.tokenList.noLineEndBefore(e)}emptyLinesAfter(e,t){this.parsedCode.tokenList.emptyLinesAfter(e,t)}emptyLinesBefore(e,t){this.parsedCode.tokenList.emptyLinesBefore(e,t)}emptyLinesAfterSubTree(e,t){this.parsedCode.tokenList.emptyLinesAfterSubTree(e,t)}tokenText(e,t){this.parsedCode.tokenList.tokenText(e,t)}wrapAfter(e,t){this.parsedCode.tokenList.wrapAfter(e,t)}wrapBefore(e,t){this.parsedCode.tokenList.wrapBefore(e,t)}noWrappingBetween(e,t,n){null==n&&(n=!0),this.parsedCode.tokenList.noWrappingBetween(e,t,this.config,n)}additionalIndent(e,t){this.parsedCode.tokenList.additionalIndent(e,t)}increaseIndentBetween(e,t,n){this.parsedCode.tokenList.increaseIndentBetween(e,t,n,this.config,this.parsedCode,this.indenter)}findTokenAtOffset(e){return this.parsedCode.tokenList.findTokenAtOffset(e)}isSameLine(e,t){return this.parsedCode.tokenList.isSameLine(e,t)}calcLength(e){return this.parsedCode.tokenList.calcLength(e)}isMultilineToken(e){return this.parsedCode.tokenList.isMultilineToken(e)}calcLengthUntilNewline(e,t){return this.parsedCode.tokenList.calcLengthUntilNewline(e,t)}calcLengthBetween(e,t){return this.parsedCode.tokenList.calcLengthBetween(e,t)}calcLineLength(e){return this.parsedCode.tokenList.calcLineLength(e)}calcLineLengthBefore(e){return this.parsedCode.tokenList.calcLineLengthBefore(e)}calcLineLengthAfter(e){return this.parsedCode.tokenList.calcLineLengthAfter(e)}calcTokenLength(e){return this.parsedCode.tokenList.calcTokenLength(e)}isNewLineBefore(e){return this.parsedCode.tokenList.isNewLineBefore(e)}isNewLineAfter(e){return this.parsedCode.tokenList.isNewLineAfter(e)}isSameLineBetween(e,t,n){return this.parsedCode.tokenList.isSameLineBetween(e,t,n)}findLineStartToken(e){return this.parsedCode.tokenList.findLineStartToken(e)}}ve.__name__="formatter.marker.MarkerBase",Object.assign(ve.prototype,{__class__:ve});class Pe extends ve{constructor(e,t,n){super(e,t,n)}run(){let e=this;this.parsedCode.root.filterCallback((function(t,n){let r=t.tok;return 3==r._hx_index&&"if"==r.s&&(e.markBlockBreakingConditional(t,e.calcDepthDifferenceLeftCurly(t)),e.markBlockBreakingConditional(t,e.calcDepthDifferenceRightCurly(t))),ia.GoDeeper}))}markBlockBreakingConditional(e,t){if(null==e.children)return;let n=sa.firstOf(e,oa.Sharp("end")),r=n;if(null==n)return;if(0==t)return;t<0&&(r=e);let i=e.parent,s=null;for(;null!=i&&i.tok!=oa.Root;)s=i,i=i.parent;if(null==s)return;let a=s.nextSibling;for(;null!=a;){if(19==a.tok._hx_index)return void this.increaseIndentBetween(r,a,t);a=a.nextSibling}this.increaseIndentBetween(r,fa.getLastToken(s),t)}calcDepthDifferenceLeftCurly(e){if(null==e.children)return 0;let t=0,n=0,r=e.children;for(;n<r.length;){let e=r[n++].filterCallback((function(e,t){switch(e.tok._hx_index){case 3:return ia.SkipSubtree;case 18:return ia.FoundGoDeeper;default:return ia.GoDeeper}}));if(e.length<=0)continue;let i=0,s=0;for(;s<e.length;)null==sa.firstOf(e[s++],oa.BrClose)&&++i;i>t&&(t=i)}return t}calcDepthDifferenceRightCurly(e){if(null==e.children)return 0;let t=0,n=0,r=e.children;for(;n<r.length;){let e=r[n++].filterCallback((function(e,t){return 19==e.tok._hx_index?ia.FoundGoDeeper:ia.GoDeeper}));if(e.length<=0)continue;let i=0,s=0;for(;s<e.length;)null==sa.matches(sa.parent(e[s++]),oa.BrOpen)&&++i;i>t&&(t=i)}return-t}}Pe.__name__="formatter.marker.MarkAdditionalIndentation",Pe.__super__=ve,Object.assign(Pe.prototype,{__class__:Pe});class Le extends ve{constructor(e,t,n){super(e,t,n)}run(){this.keepExistingEmptyLines();let e=this.parsedCode.root.filterCallback((function(e,t){let n=e.tok;return 1==n._hx_index?34==n.k._hx_index?ia.FoundSkipSubtree:ia.SkipSubtree:ia.GoDeeper}));e.reverse();let t=0;for(;t<e.length;){let n=e[t];++t,fa.isMetadata(n)||(this.emptyLinesBefore(n,this.config.emptyLines.beforePackage),this.emptyLinesAfter(n,this.config.emptyLines.afterPackage))}this.betweenTypes(),this.markImports(),this.markClassesAndAbstracts(),this.markMacroClasses(),this.markInterfaces(),this.markEnums(),this.markTypedefs(),this.markSharp(),"ignore"==this.config.emptyLines.beforeDocCommentEmptyLines&&"ignore"==this.config.emptyLines.afterFieldsWithDocComments||this.markDocComments(),this.markMultilineComments(),this.markFileHeader(),"remove"==this.config.emptyLines.beforeRightCurly&&this.markRightCurly(),"remove"==this.config.emptyLines.afterLeftCurly&&this.markLeftCurly(),"remove"==this.config.emptyLines.afterReturn&&this.markReturn(),"remove"!=this.config.emptyLines.beforeBlocks&&"remove"!=this.config.emptyLines.afterBlocks||this.markAroundBlocks()}finalRun(e){if(e.lines.length<=0)return;let t=0,n=e.lines;for(;t<n.length;){let e=n[t];++t,e.verbatim||e.emptyLinesAfter>this.config.emptyLines.maxAnywhereInFile&&(e.emptyLinesAfter=this.config.emptyLines.maxAnywhereInFile)}let r=e.lines[e.lines.length-1];r.verbatim||(r.emptyLinesAfter=this.config.emptyLines.finalNewline?1:0)}markImports(){let e=this.parsedCode.root.filterCallback((function(e,t){let n=e.tok;if(1!=n._hx_index)return ia.GoDeeper;switch(n.k._hx_index){case 13:case 36:return fa.isMetadata(e)?ia.SkipSubtree:ia.FoundSkipSubtree;default:return ia.GoDeeper}}));if(e.length<=0)return;let t=e[e.length-1],n=this.getNextToken(fa.getLastToken(t));if(null!=n){let e=n.token.tok;if(3==e._hx_index)switch(e.s){case"else":case"elseif":break;case"end":this.emptyLinesAfterSubTree(n.token,this.config.emptyLines.importAndUsing.beforeType);break;default:this.emptyLinesAfterSubTree(t,this.config.emptyLines.importAndUsing.beforeType)}else this.emptyLinesAfterSubTree(t,this.config.emptyLines.importAndUsing.beforeType)}let r=null,i=0;for(;i<e.length;){let t=e[i];++i;let n=this.getImportInfo(t),s=this.getNextToken(fa.getLastToken(t));if(null!=s){let e=s.token.tok;3==e._hx_index&&"end"==e.s&&(n.token=s.token)}if(null!=r){if(r.isImport==n.isImport)switch(this.config.emptyLines.importAndUsing.betweenImportsLevel){case"all":this.emptyLinesAfterSubTree(r.token,this.config.emptyLines.importAndUsing.betweenImports);break;case"fifthLevelPackage":r.fifthLevelPackage!=n.fifthLevelPackage&&this.emptyLinesAfterSubTree(r.token,this.config.emptyLines.importAndUsing.betweenImports);break;case"firstLevelPackage":r.firstLevelPackage!=n.firstLevelPackage&&this.emptyLinesAfterSubTree(r.token,this.config.emptyLines.importAndUsing.betweenImports);break;case"fourthLevelPackage":r.fourthLevelPackage!=n.fourthLevelPackage&&this.emptyLinesAfterSubTree(r.token,this.config.emptyLines.importAndUsing.betweenImports);break;case"fullPackage":r.fullPackage!=n.fullPackage&&this.emptyLinesAfterSubTree(r.token,this.config.emptyLines.importAndUsing.betweenImports);break;case"secondLevelPackage":r.secondLevelPackage!=n.secondLevelPackage&&this.emptyLinesAfterSubTree(r.token,this.config.emptyLines.importAndUsing.betweenImports);break;case"thirdLevelPackage":r.thirdLevelPackage!=n.thirdLevelPackage&&this.emptyLinesAfterSubTree(r.token,this.config.emptyLines.importAndUsing.betweenImports)}else this.emptyLinesAfterSubTree(r.token,this.config.emptyLines.importAndUsing.beforeUsing);r=n}else r=n}}getImportInfo(e){let t={token:e,isImport:!1,firstLevelPackage:"",secondLevelPackage:"",thirdLevelPackage:"",fourthLevelPackage:"",fifthLevelPackage:"",fullPackage:"",moduleName:""},n=e.tok;if(1==n._hx_index)switch(n.k._hx_index){case 13:t.isImport=!0;break;case 36:t.isImport=!1}let r=[];e=e.getFirstChild();do{let t=e.tok;switch(t._hx_index){case 1:r.push(""+re.string(e));break;case 2:let n=t.c;3==n._hx_index&&r.push(n.s)}if(null==(e=e.getFirstChild())||11!=e.tok._hx_index)break;e=e.getFirstChild()}while(null!=e);return t.moduleName=r.pop(),t.fullPackage=r.join("."),r.length>0&&(t.firstLevelPackage=r[0]),r.length>1?t.secondLevelPackage=r.slice(0,2).join("."):t.secondLevelPackage=t.firstLevelPackage,r.length>2?t.thirdLevelPackage=r.slice(0,3).join("."):t.thirdLevelPackage=t.secondLevelPackage,r.length>3?t.fourthLevelPackage=r.slice(0,4).join("."):t.fourthLevelPackage=t.thirdLevelPackage,r.length>4?t.fifthLevelPackage=r.slice(0,5).join("."):t.fifthLevelPackage=t.fourthLevelPackage,t}markClassesAndAbstracts(){let e=this.parsedCode.root.filterCallback((function(e,t){let n=e.tok;if(1!=n._hx_index)return ia.GoDeeper;switch(n.k._hx_index){case 1:case 40:return ia.FoundSkipSubtree;default:return ia.GoDeeper}})),t=0;for(;t<e.length;){let n=e[t];if(++t,fa.isTypeEnumAbstract(n)){this.markEnumAbstracts(n);continue}let r=null,i=n.tok;if(1!=i._hx_index)continue;switch(i.k._hx_index){case 1:if(r=this.config.emptyLines.classEmptyLines,null!=sa.firstOf(sa.firstChild(n),oa.Kwd(li.KwdExtern))){this.markExternClass(n,this.config.emptyLines.externClassEmptyLines);continue}break;case 40:r=this.config.emptyLines.abstractEmptyLines;break;default:continue}this.markBeginAndEndType(sa.firstOf(sa.firstChild(n),oa.BrOpen),r.beginType,r.endType);let s=this.findClassAndAbstractFields(n),a=null,l=null,o=null,c=0;for(;c<s.length;){let e=s[c];++c,o=ua.getFieldType(e,da.Private),this.markClassFieldEmptyLines(a,l,e,o,r),a=e,l=o}}}markMacroClasses(){let e=this.parsedCode.root.filterCallback((function(e,t){let n=e.tok;if(1==n._hx_index){if(1==n.k._hx_index){if(null==e.parent||e.parent.tok==oa.Root)return ia.GoDeeper;let t=e.parent.tok;return 1==t._hx_index&&41==t.k._hx_index?ia.FoundSkipSubtree:ia.GoDeeper}return ia.GoDeeper}return ia.GoDeeper})),t=0;for(;t<e.length;){let n=e[t];++t;let r=this.config.emptyLines.macroClassEmptyLines;this.markBeginAndEndType(sa.firstOf(sa.firstChild(n),oa.BrOpen),r.beginType,r.endType);let i=this.findClassAndAbstractFields(n),s=null,a=null,l=null,o=0;for(;o<i.length;){let e=i[o];++o,l=ua.getFieldType(e,da.Private),this.markClassFieldEmptyLines(s,a,e,l,r),s=e,a=l}}}findClassAndAbstractFields(e){return e.filterCallback((function(e,t){let n=e.tok;switch(n._hx_index){case 1:switch(n.k._hx_index){case 0:case 2:case 42:return ia.FoundSkipSubtree;default:return ia.GoDeeper}break;case 23:return ia.SkipSubtree;default:return ia.GoDeeper}}))}markBeginAndEndType(e,t,n){if(null==e)return;this.emptyLinesAfter(e,t);let r=this.getCloseToken(e);null!=r&&this.emptyLinesBefore(r,n)}markClassFieldEmptyLines(e,t,n,r,i){if(null==e)return;let s=!1,a=!1,l=!1,o=!1,c=!1,u=!1;switch(t._hx_index){case 0:s=!1,l=t.isStatic,c=t.visibility==da.Private;break;case 1:case 2:s=!0,l=t.isStatic,c=t.visibility==da.Private;break;case 3:return}switch(r._hx_index){case 0:a=!1,o=r.isStatic,u=r.visibility==da.Private;break;case 1:case 2:a=!0,o=r.isStatic,u=r.visibility==da.Private;break;case 3:return}if(a||(this.markLineCommentsBefore(n,this.config.emptyLines.lineCommentsBetweenFunctions),this.markLineCommentsAfter(n,1)),null!=(e=this.skipSharpFields(e)))if("keep"==i.existingBetweenFields&&this.hasEmptyLinesBetweenFields(e,n))this.emptyLinesAfterSubTree(e,1);else{if(s==a){if(s)return l!=o?void this.emptyLinesAfterSubTree(e,i.afterStaticVars):l?void this.emptyLinesAfterSubTree(e,i.betweenStaticVars):c!=u?void this.emptyLinesAfterSubTree(e,i.afterPrivateVars):void this.emptyLinesAfterSubTree(e,i.betweenVars);{if(l!=o)return void this.emptyLinesAfterSubTree(e,i.afterStaticFunctions);if(l)return void this.emptyLinesAfterSubTree(e,i.betweenStaticFunctions);if(c!=u)return void this.emptyLinesAfterSubTree(e,i.afterPrivateFunctions);let t=e.tok;if(3==t._hx_index&&"end"==t.s){let t=this.getPreviousToken(e);if(null!=t)switch(t.token.tok._hx_index){case 10:case 19:break;default:return}}return void this.emptyLinesAfterSubTree(e,i.betweenFunctions)}}this.emptyLinesAfterSubTree(e,i.afterVars)}}hasEmptyLinesBetweenFields(e,t){let n=fa.getLastToken(e);if(null==n)return!1;let r=this.parsedCode.getLinePos(n.pos.max).line,i=this.parsedCode.getLinePos(t.pos.min).line,s=0,a=this.parsedCode.emptyLines;for(;s<a.length;){let e=a[s];if(++s,!(r>=e))return i>e}return!1}markLineCommentsBefore(e,t){if("none"==t)return;if(null==e.previousSibling)return;let n=e.previousSibling;for(;null!=n;){switch(n.tok._hx_index){case 7:break;case 8:let r=this.getPreviousToken(n);if(null==r||r.whitespaceAfter==we.Newline)switch(t){case"keep":this.parsedCode.linesBetweenOriginal(n,e)>1&&this.emptyLinesAfter(n,1);break;case"none":break;case"one":this.emptyLinesAfter(n,1)}return;default:return}n=n.previousSibling}}markLineCommentsAfter(e,t){if(t<=0)return;if(null==e.nextSibling)return;let n=e.nextSibling;8==n.tok._hx_index&&this.isNewLineBefore(n)&&this.emptyLinesBefore(n,t)}markExternClass(e,t){let n=sa.firstOf(sa.firstChild(e),oa.BrOpen);if(null==n)return;this.markBeginAndEndType(n,t.beginType,t.endType);let r=this.findClassAndAbstractFields(n),i=null,s=null,a=null,l=0;for(;l<r.length;){let e=r[l];++l,a=ua.getFieldType(e,da.Public),this.markInterfaceEmptyLines(i,s,e,a,t),i=e,s=a}}markInterfaces(){let e=this.parsedCode.root.filterCallback((function(e,t){let n=e.tok;return 1==n._hx_index?28==n.k._hx_index?ia.FoundSkipSubtree:ia.SkipSubtree:ia.GoDeeper})),t=0;for(;t<e.length;)this.markExternClass(e[t++],this.config.emptyLines.interfaceEmptyLines)}markInterfaceEmptyLines(e,t,n,r,i){if(null==e)return;let s=!1,a=!1;switch(t._hx_index){case 0:s=!1;break;case 1:case 2:s=!0;break;case 3:return}switch(r._hx_index){case 0:a=!1;break;case 1:case 2:a=!0;break;case 3:return}if(null!=(e=this.skipSharpFields(e)))if("keep"==i.existingBetweenFields&&this.hasEmptyLinesBetweenFields(e,n))this.emptyLinesAfterSubTree(e,1);else{if(s==a)return s?void this.emptyLinesAfterSubTree(e,i.betweenVars):void this.emptyLinesAfterSubTree(e,i.betweenFunctions);this.emptyLinesAfterSubTree(e,i.afterVars)}}markEnumAbstracts(e){this.markBeginAndEndType(sa.firstOf(sa.firstChild(e),oa.BrOpen),this.config.emptyLines.enumAbstractEmptyLines.beginType,this.config.emptyLines.enumAbstractEmptyLines.endType);let t=this.findClassAndAbstractFields(e),n=null,r=null,i=null,s=0;for(;s<t.length;){let e=t[s];++s,i=ua.getFieldType(e,da.Public),this.markEnumAbstractFieldEmptyLines(n,r,e,i),n=e,r=i}}markEnumAbstractFieldEmptyLines(e,t,n,r){if(null==e)return;let i=!1,s=!1;switch(t._hx_index){case 0:i=!1;break;case 1:case 2:i=!0;break;case 3:return}switch(r._hx_index){case 0:s=!1;break;case 1:case 2:s=!0;break;case 3:return}if(null!=(e=this.skipSharpFields(e)))if("keep"==this.config.emptyLines.enumAbstractEmptyLines.existingBetweenFields&&this.hasEmptyLinesBetweenFields(e,n))this.emptyLinesAfterSubTree(e,1);else{if(i==s)return i?void this.emptyLinesAfterSubTree(e,this.config.emptyLines.enumAbstractEmptyLines.betweenVars):void this.emptyLinesAfterSubTree(e,this.config.emptyLines.enumAbstractEmptyLines.betweenFunctions);this.emptyLinesAfterSubTree(e,this.config.emptyLines.enumAbstractEmptyLines.afterVars)}}markEnums(){let e=this.parsedCode.root.filterCallback((function(e,t){let n=e.tok;return 1==n._hx_index?26==n.k._hx_index?ia.FoundSkipSubtree:ia.SkipSubtree:ia.GoDeeper})),t=0;for(;t<e.length;){let n=e[t];if(++t,n.parent.tok!=oa.Root)switch(n.parent.tok._hx_index){case 2:case 12:case 23:continue}let r=sa.firstOf(sa.firstChild(n),oa.BrOpen);null!=r&&this.markEnumFields(r,this.config.emptyLines.enumEmptyLines)}}markEnumFields(e,t){if(this.markBeginAndEndType(e,t.beginType,t.endType),null==e.children||e.children.length<=0)return;let n=null,r=0,i=e.children;for(;r<i.length;){let e=i[r];switch(++r,e.tok._hx_index){case 7:case 8:continue;case 19:return}null!=n?"keep"==t.existingBetweenFields&&this.hasEmptyLinesBetweenFields(n,e)?(this.emptyLinesAfterSubTree(n,1),n=e):(this.emptyLinesAfterSubTree(n,t.betweenFields),n=e):n=e}}markTypedefs(){let e=this.parsedCode.root.filterCallback((function(e,t){let n=e.tok;return 1==n._hx_index?32==n.k._hx_index?ia.FoundSkipSubtree:ia.SkipSubtree:ia.GoDeeper})),t=0;for(;t<e.length;){let n=sa.firstOf(sa.firstOf(sa.firstChild(e[t++]),oa.Binop(ht.OpAssign)),oa.BrOpen);null!=n&&this.markEnumFields(n,this.config.emptyLines.typedefEmptyLines)}}skipSharpFields(e){let t=e.nextSibling;if(null==t){if(t=e.parent,3!=t.tok._hx_index)return e;t=t.nextSibling}let n=t.tok;if(3==n._hx_index)switch(n.s){case"end":let n=this.getPreviousToken(t);if(null!=n)switch(n.token.tok._hx_index){case 10:case 19:return t;default:let e=t.parent,n=null!=e?e.nextSibling:null;if(null!=n)return n}return t;case"if":return e;default:return null}return e}betweenTypes(){if(this.config.emptyLines.betweenTypes<=0&&this.config.emptyLines.betweenSingleLineTypes<=0)return;let e=this.parsedCode.root.filterCallback((function(e,t){let n=e.tok;switch(n._hx_index){case 1:switch(n.k._hx_index){case 0:case 2:case 1:case 26:case 28:case 32:case 40:case 42:return ia.FoundSkipSubtree;default:return ia.GoDeeper}break;case 18:return ia.SkipSubtree;default:return ia.GoDeeper}}));if(e.length<=1)return;let t=null,n=0;for(;n<e.length;){let r=e[n];++n;let i=this.getTypeInfo(r);if(this.markLineCommentsBefore(r,this.config.emptyLines.lineCommentsBetweenTypes),this.markLineCommentsAfter(r,1),null==t){t=i;continue}let s=this.getNextToken(t.lastToken);if(null!=s){let e=s.token.tok;if(3==e._hx_index)switch(e.s){case"else":case"elseif":t=i;continue}}let a=this.config.emptyLines.betweenTypes;t.oneLine&&i.oneLine&&(a=this.config.emptyLines.betweenSingleLineTypes);let l=!1,o=t.lastToken.tok;if(3==o._hx_index&&"end"==o.s){let e=this.getTokenInfo(t.lastToken);null!=e&&e.whitespaceAfter!=we.Newline&&(l=!0)}t.typeToken.index==t.lastToken.index&&(l=!0),l||this.emptyLinesAfterSubTree(t.lastToken,a),this.markLineCommentsAfter(t.typeToken,1),t=i}}getTypeInfo(e){let t={lastToken:fa.getLastToken(e),typeToken:e,oneLine:!1};switch(t.lastToken.tok._hx_index){case 10:case 19:break;default:let e=this.getNextToken(t.lastToken);if(null!=e){let n=e.token.tok;if(3==n._hx_index)switch(n.s){case"else":case"elseif":case"end":let n=fa.getLastToken(e.token.parent.getLastChild());null!=n&&(t.lastToken=n)}}}let n=this.parsedCode.tokenList.findLowestIndex(e);if(null!=e.previousSibling){let t=e.previousSibling.tok;if(3==t._hx_index&&"if"==t.s&&e.previousSibling.hasChildren()){let t=!0,r=0,i=e.previousSibling.children;e:for(;r<i.length;){let e=i[r++].tok;switch(e._hx_index){case 2:case 23:break;case 3:if("end"!=e.s){t=!1;break e}break;default:t=!1;break e}}t&&(n=e.previousSibling)}}for(this.isSameLine(n,t.lastToken)&&(t.oneLine=!0);;){let e=this.getNextToken(t.lastToken);if(null==e)break;let n=e.token.tok;if(3!=n._hx_index)break;if("end"!=n.s)break;t.lastToken=e.token}return t}markLeftCurly(){let e=this.parsedCode.root.filterCallback((function(e,t){return 18==e.tok._hx_index?ia.FoundGoDeeper:ia.GoDeeper})),t=0;for(;t<e.length;)this.emptyLinesAfter(e[t++],0)}markRightCurly(){let e=this.parsedCode.root.filterCallback((function(e,t){return 19==e.tok._hx_index?ia.FoundGoDeeper:ia.GoDeeper})),t=0;for(;t<e.length;)this.emptyLinesBefore(e[t++],0)}markReturn(){let e=this.parsedCode.root.filterCallback((function(e,t){let n=e.tok;return 1==n._hx_index&&10==n.k._hx_index?ia.FoundGoDeeper:ia.GoDeeper})),t=0;for(;t<e.length;){let n=e[t];if(++t,this.isReturnBody(n))continue;let r=fa.getLastToken(n);if(null==r)continue;let i=this.getNextToken(r);null!=i&&(19==i.token.tok._hx_index&&this.emptyLinesAfterSubTree(n,0))}}isReturnBody(e){let t=e.parent;for(;null!=t&&t.tok!=oa.Root;){let e=t.tok;switch(e._hx_index){case 1:if(0==e.k._hx_index)return!0;t=t.parent;break;case 18:return!1;default:t=t.parent}}return!0}markSharp(){let e=this.parsedCode.root.filterCallback((function(e,t){return 3==e.tok._hx_index?ia.FoundGoDeeper:ia.GoDeeper})),t=0;for(;t<e.length;){let n=e[t];++t;let r=this.getPreviousToken(n);if(null!=r&&r.whitespaceAfter!=we.Newline)continue;let i=n.tok;if(3==i._hx_index)switch(i.s){case"else":this.emptyLinesBefore(n,this.config.emptyLines.conditionalsEmptyLines.beforeElse),this.emptyLinesAfter(n,this.config.emptyLines.conditionalsEmptyLines.afterElse);break;case"elseif":this.emptyLinesBefore(n,this.config.emptyLines.conditionalsEmptyLines.beforeElse),this.emptyLinesAfterSubTree(n.getFirstChild(),this.config.emptyLines.conditionalsEmptyLines.afterIf);break;case"end":this.emptyLinesBefore(n,this.config.emptyLines.conditionalsEmptyLines.beforeEnd);break;case"error":this.emptyLinesBefore(n,this.config.emptyLines.conditionalsEmptyLines.beforeError),this.emptyLinesAfterSubTree(n,this.config.emptyLines.conditionalsEmptyLines.afterError);break;case"if":this.emptyLinesAfterSubTree(n.getFirstChild(),this.config.emptyLines.conditionalsEmptyLines.afterIf)}}}markDocComments(){let e=this.parsedCode.root.filterCallback((function(e,t){let n=e.tok;return 7==n._hx_index&&n.s.startsWith("*")?ia.FoundGoDeeper:ia.GoDeeper})),t=0;for(;t<e.length;){let n=e[t];++t;let r=null;if(r=n,null!=n.previousSibling)null!=n.parent&&3==n.parent.tok._hx_index&&n.parent.getFirstChild()==n.previousSibling&&(r=n.parent);else if(null==n.parent||n.parent.tok==oa.Root)continue;if(null==n.nextSibling)continue;let i=n.nextSibling,s=!0;for(;null!=i;){let e=i.tok;switch(e._hx_index){case 1:switch(e.k._hx_index){case 0:case 1:case 2:case 26:case 28:case 32:case 40:case 42:break;default:s=!1}break;case 2:3!=e.c._hx_index&&(s=!1);break;case 3:i=null;break;case 8:i=i.nextSibling;continue;default:s=!1}break}if(!s)continue;if(!this.isField(i))continue;switch(this.config.emptyLines.beforeDocCommentEmptyLines){case"ignore":break;case"none":this.emptyLinesBefore(r,0);break;case"one":this.emptyLinesBefore(r,1)}if(null==i)continue;let a=fa.getLastToken(i),l=this.getNextToken(a);if(null==l)continue;let o=l.token.tok;if(3==o._hx_index)switch(o.s){case"end":a=l.token;break;case"error":case"if":break;default:continue}switch(this.config.emptyLines.afterFieldsWithDocComments){case"ignore":break;case"none":this.emptyLinesAfter(a,0);break;case"one":this.emptyLinesAfter(a,1)}}}isField(e){if(null==e)return!1;let t=e.parent;if(null==t)return!0;let n=t.tok;switch(n._hx_index){case 1:switch(n.k._hx_index){case 1:case 26:case 28:case 32:case 40:return!0;default:return!1}break;case 11:case 12:case 13:case 14:case 15:case 16:case 20:return!1;default:return this.isField(t)}}markMultilineComments(){let e=this.parsedCode.root.filterCallback((function(e,t){return 7==e.tok._hx_index?ia.FoundSkipSubtree:ia.GoDeeper})),t=0;for(;t<e.length;){let n=e[t];++t;let r=n.nextSibling;null!=r&&(this.isNewLineAfter(n)&&7==r.tok._hx_index&&this.emptyLinesAfter(n,this.config.emptyLines.betweenMultilineComments))}}markAroundBlocks(){let e=this;this.parsedCode.root.filterCallback((function(t,n){let r=t.tok;if(1==r._hx_index)switch(r.k._hx_index){case 0:break;case 3:if(null!=t.children&&t.children.length>1){let n=0,r=t.children;for(;n<r.length;){let t=r[n];++n,20!=t.tok._hx_index&&e.removeEmptyLinesAroundBlock(t,e.config.emptyLines.beforeBlocks,"keep")}}let n=sa.previousSibling(sa.firstOf(t,oa.Kwd(li.KwdElse)));null!=n&&e.removeEmptyLinesAroundBlock(n,"keep",e.config.emptyLines.afterBlocks);break;case 4:if(null!=t.children){let n=0,r=t.children;for(;n<r.length;)e.removeEmptyLinesAroundBlock(r[n++],e.config.emptyLines.beforeBlocks,"keep")}break;case 5:let r;if(null!=t.children&&t.children.length>0)if(null!=t.parent){let e=t.parent.tok;r=!(1==e._hx_index&&6==e.k._hx_index)}else r=!0;else r=!1;r&&e.removeEmptyLinesAroundBlock(t.children[1],e.config.emptyLines.beforeBlocks,"keep");break;case 6:e.removeEmptyLinesAroundBlock(t.getFirstChild(),e.config.emptyLines.beforeBlocks,"keep");let i=sa.previousSibling(sa.lastChild(t));e.removeEmptyLinesAroundBlock(i,"keep",e.config.emptyLines.afterBlocks);break;case 7:null!=t.children&&t.children.length>1&&e.removeEmptyLinesAroundBlock(t.children[1],e.config.emptyLines.beforeBlocks,"keep");break;case 15:case 16:let s=sa.firstChild(sa.firstOf(t,oa.DblDot));e.removeEmptyLinesAroundBlock(s,e.config.emptyLines.beforeBlocks,"keep");break;case 20:e.removeEmptyLinesAroundBlock(t.getFirstChild(),e.config.emptyLines.beforeBlocks,"keep");let a=sa.previousSibling(sa.lastChild(t));e.removeEmptyLinesAroundBlock(a,"keep",e.config.emptyLines.afterBlocks);break;case 21:null!=t.children&&t.children.length>0&&e.removeEmptyLinesAroundBlock(t.children[1],e.config.emptyLines.beforeBlocks,"keep")}return ia.GoDeeper}))}removeEmptyLinesAroundBlock(e,t,n){if(null!=e){if("remove"==t){let t=this.getPreviousToken(e);null!=t&&this.emptyLinesAfter(t.token,0)}"remove"==n&&this.emptyLinesAfterSubTree(e,0)}}keepExistingEmptyLines(){let e=this.parsedCode.root.filterCallback((function(e,t){let n=e.tok;return 1==n._hx_index&&0==n.k._hx_index?ia.FoundGoDeeper:ia.GoDeeper})),t=0;for(;t<e.length;){let n=e[t];++t;let r=sa.matches(sa.firstChild(n),oa.BrOpen),i=r;if(null==r&&(i=sa.firstOf(sa.firstChild(n),oa.BrOpen)),null==i&&(i=sa.firstOf(n,oa.BrOpen)),null==i)continue;let s=i.getPos(),a=this.parsedCode.getLinePos(s.min).line,l=this.parsedCode.getLinePos(s.max).line,o=0,c=this.parsedCode.emptyLines;for(;o<c.length;){let e=c[o];if(++o,a>=e||l<=e)continue;let t=this.findTokenAtOffset(this.parsedCode.linesIdx[e].l);null!=t&&(fa.isMetadata(t.token)||t.emptyLinesAfter++)}}}markFileHeader(){let e=this.getTokenAt(0),t=this.getTokenAt(1),n=this.parsedCode.root.filterCallback((function(e,t){let n=e.tok;if(1!=n._hx_index)return ia.GoDeeper;switch(n.k._hx_index){case 13:case 34:case 36:return ia.FoundSkipSubtree;default:return ia.SkipSubtree}}));if(null!=e&&7==e.token.tok._hx_index){if(0==n.length&&7!=t.token.tok._hx_index)return;e.emptyLinesAfter=this.config.emptyLines.afterFileHeaderComment}}}Le.__name__="formatter.marker.MarkEmptyLines",Le.__super__=ve,Object.assign(Le.prototype,{__class__:Le});class Ae extends ve{constructor(e,t,n){super(e,t,n)}run(){let e=this.parsedCode.root.filterCallback((function(e,t){return 10==e.tok._hx_index?ia.FoundGoDeeper:ia.GoDeeper})),t=0;for(;t<e.length;)this.lineEndAfter(e[t++]);this.markBrOpenClose(),this.markAt(),this.markDblDot(),this.markSharp(),this.markComments(),this.markStructureExtension()}markComments(){let e=this.parsedCode.root.filterCallback((function(e,t){switch(e.tok._hx_index){case 7:case 8:return ia.FoundSkipSubtree;default:return ia.GoDeeper}})),t=0;for(;t<e.length;){let n=e[t];switch(++t,n.tok._hx_index){case 7:let e=this.getPreviousToken(n),t=!1;null!=e&&this.parsedCode.isOriginalSameLine(n,e.token)&&(e.whitespaceAfter==we.Newline&&this.lineEndAfter(n),this.noLineEndBefore(n),t=!this.isMultilineToken(n));let r=this.parsedCode.getLinePos(n.pos.min),i=this.parsedCode.getString(this.parsedCode.linesIdx[r.line].l,n.pos.min);r=this.parsedCode.getLinePos(n.pos.max);let a=this.parsedCode.getString(n.pos.max,this.parsedCode.linesIdx[r.line].r);if(new s("^\\s*$","").match(i)&&new s("^\\s*$","").match(a)){this.lineEndAfter(n);continue}let l=this.getNextToken(n);if(null==l)continue;this.parsedCode.isOriginalSameLine(n,l.token)&&this.noLineEndAfter(n);let o=l.token.tok;switch(o._hx_index){case 1:t||this.lineEndAfter(n);continue;case 2:let e=o.c;if(3==e._hx_index&&"final"==e.s){t||this.lineEndAfter(n);continue}}break;case 8:let c=this.getPreviousToken(n);null!=c&&this.parsedCode.isOriginalSameLine(n,c.token)&&this.noLineEndBefore(n),this.lineEndAfter(n)}}}markBrOpenClose(){let e=this.parsedCode.root.filterCallback((function(e,t){return 18==e.tok._hx_index?ia.FoundGoDeeper:ia.GoDeeper})),t=0;for(;t<e.length;){let n=e[t];++t;let r=this.detectCurlyPolicy(n);this.fixMissingSemicolonsInBlock(n);let i=this.getCloseToken(n);if(null==i){switch(r.leftCurly){case"after":this.lineEndAfter(n);break;case"before":this.beforeLeftCurly(n);break;case"both":this.beforeLeftCurly(n),this.lineEndAfter(n)}continue}let s=this.getPreviousToken(n);if(null!=s){let e=s.token.tok;if(4==e._hx_index)switch(e.s){case"":case"a":case"b":case"e":case"i":case"p":case"v":if(this.parsedCode.isOriginalSameLine(n,i)){this.noLineEndAfter(n),this.noLineEndBefore(i),this.whitespace(n,"none"),this.whitespace(i,"noneBefore");let e=this.getNextToken(i);null!=e&&12==e.token.tok._hx_index&&this.whitespace(i,"after");continue}this.whitespace(n,"noneBefore")}}let a=this.getNextToken(n),l=!1;if(null!=a&&19==a.token.tok._hx_index&&"noBreak"==r.emptyCurly&&(l=!0),!l)switch(r.leftCurly){case"after":this.lineEndAfter(n);break;case"before":this.beforeLeftCurly(n);break;case"both":this.beforeLeftCurly(n),this.lineEndAfter(n)}let o=l,c=!1;switch(a=this.getNextToken(i),null!=a&&12==a.token.tok._hx_index&&(c=!0),r.rightCurly){case"after":c||this.afterRightCurly(i);break;case"before":o||this.beforeRightCurly(i);break;case"both":o||this.beforeRightCurly(i),c||this.afterRightCurly(i)}}}fixMissingSemicolonsInBlock(e){switch(fa.getBrOpenType(e)._hx_index){case 0:break;case 1:case 2:case 3:case 4:return}if(!e.hasChildren())return;let t=0,n=e.children;for(;t<n.length;){let e=n[t];switch(++t,e.tok._hx_index){case 3:continue;case 19:return;default:let t=fa.getLastToken(e);if(null==t)continue;if(10==t.tok._hx_index)continue;this.isMissingSemicolon(t)&&this.lineEndAfter(t)}}}isMissingSemicolon(e){for(;;){let t=this.getNextToken(e);if(null==t)return!0;switch((e=t.token).tok._hx_index){case 10:return!1;case 17:case 21:continue;default:return!0}}}detectCurlyPolicy(e){let t=fa.getBrOpenType(e),n={leftCurly:this.config.lineEnds.leftCurly,rightCurly:this.config.lineEnds.rightCurly,emptyCurly:this.config.lineEnds.emptyCurly};switch(t._hx_index){case 0:if(null!=e.parent&&null!=this.config.lineEnds.anonFunctionCurly){let t=e.parent.tok;switch(t._hx_index){case 1:if(0==t.k._hx_index)return this.config.lineEnds.anonFunctionCurly;break;case 14:return this.config.lineEnds.anonFunctionCurly}}if(null!=this.config.lineEnds.blockCurly)return this.config.lineEnds.blockCurly;break;case 1:if(null!=this.config.lineEnds.typedefCurly)return this.config.lineEnds.typedefCurly;break;case 2:if(null!=this.config.lineEnds.objectLiteralCurly)return this.config.lineEnds.objectLiteralCurly;break;case 3:if(null!=this.config.lineEnds.anonTypeCurly)return this.config.lineEnds.anonTypeCurly;{let t=this.getCloseToken(e);if(this.parsedCode.isOriginalSameLine(e,t)){let e=n.leftCurly;if(null!=e)switch(e){case"before":n.leftCurly="none";break;case"both":n.leftCurly="after"}}}}return n}beforeLeftCurly(e){this.lineEndBefore(e)}beforeRightCurly(e){this.lineEndBefore(e)}afterRightCurly(e){let t=e.index+1;if(this.parsedCode.tokenList.tokens.length<=t)return void this.lineEndAfter(e);let n=this.getTokenAt(t);if(null==n)return void this.lineEndAfter(e);let r=n.token.tok;switch(r._hx_index){case 2:let t=r.c;3==t._hx_index?"is"!=t.s&&this.lineEndAfter(e):this.lineEndAfter(e);break;case 6:switch(r.op._hx_index){case 4:case 7:case 11:break;default:this.lineEndAfter(e)}break;case 10:case 11:case 14:case 15:case 17:case 21:break;case 18:switch(fa.getBrOpenType(n.token)._hx_index){case 0:case 1:case 3:case 4:break;case 2:this.lineEndAfter(e)}break;default:this.lineEndAfter(e)}}markAt(){let e=this.parsedCode.root.filterCallback((function(e,t){return 23==e.tok._hx_index?ia.FoundSkipSubtree:ia.GoDeeper})),t=this,n=function(e){let n=t.getPreviousToken(e);if(null==n)return void t.lineEndBefore(e);let r=n.token.tok;switch(r._hx_index){case 1:switch(r.k._hx_index){case 0:case 2:case 42:t.noLineEndBefore(e);break;case 4:t.lineEndBefore(e)}break;case 18:t.lineEndBefore(e)}},r=0;for(;r<e.length;){let t=e[r];++r;let i=this.determineMetadataPolicy(t),s=fa.getLastToken(t);if(null==s)continue;let a=null!=t.previousSibling&&23==t.previousSibling.tok._hx_index;if(a||n(t),"after"==i){this.lineEndAfter(s);continue}if(a)continue;let l=t.nextSibling,o=[t];for(;null!=l&&23==l.tok._hx_index;)o.push(l),l=l.nextSibling;let c=0;for(;c<o.length;)if(s=fa.getLastToken(o[c++]),null!=s)switch(i){case"after":this.lineEndAfter(s);break;case"afterLast":let e=this.getNextToken(s);if(null!=e&&!this.parsedCode.isOriginalSameLine(s,e.token)){this.lineEndAfter(s);continue}this.whitespace(s,"after");break;case"forceAfterLast":this.whitespace(s,"after");break;case"none":let t=this.getNextToken(s);if(null!=t&&!this.parsedCode.isOriginalSameLine(s,t.token)){this.lineEndAfter(s);continue}this.whitespace(s,"after")}"afterLast"!=i&&"forceAfterLast"!=i||this.lineEndAfter(s)}}determineMetadataPolicy(e){if(null==e)return this.config.lineEnds.metadataOther;let t=e.parent;if(null==t||t.tok==oa.Root)return this.config.lineEnds.metadataType;let n=t.tok;switch(n._hx_index){case 1:switch(n.k._hx_index){case 0:return this.config.lineEnds.metadataFunction;case 22:if(null==t.parent)return this.config.lineEnds.metadataOther;let e=t.parent.tok;if(1!=e._hx_index)return this.config.lineEnds.metadataOther;switch(e.k._hx_index){case 0:return this.config.lineEnds.metadataFunction;case 2:return this.config.lineEnds.metadataVar;case 1:case 26:case 28:case 32:case 40:return this.config.lineEnds.metadataType;default:return this.config.lineEnds.metadataOther}break;default:return this.config.lineEnds.metadataOther}break;case 2:if(3!=n.c._hx_index)return this.config.lineEnds.metadataOther;{if(null==t.parent)return this.config.lineEnds.metadataOther;let e=t.parent.tok;if(1!=e._hx_index)return this.config.lineEnds.metadataOther;switch(e.k._hx_index){case 0:return this.config.lineEnds.metadataFunction;case 2:return this.config.lineEnds.metadataVar;case 1:case 26:case 28:case 32:case 40:return this.config.lineEnds.metadataType;default:return this.config.lineEnds.metadataOther}}break;case 3:default:return this.config.lineEnds.metadataOther;case 4:if(null==t.parent)return this.config.lineEnds.metadataOther;let e=t.parent.tok;if(1!=e._hx_index)return this.config.lineEnds.metadataOther;switch(e.k._hx_index){case 0:return this.config.lineEnds.metadataFunction;case 2:return this.config.lineEnds.metadataVar;case 1:case 26:case 28:case 32:case 40:return this.config.lineEnds.metadataType;default:return this.config.lineEnds.metadataOther}}}markDblDot(){let e=this.parsedCode.root.filterCallback((function(e,t){return 12==e.tok._hx_index?ia.FoundGoDeeper:ia.GoDeeper})),t=0;for(;t<e.length;){let n,r=e[t];++t;let i=r.parent.tok;if(1!=i._hx_index||15!=i.k._hx_index){let e=r.parent.tok;n=!(1==e._hx_index&&16==e.k._hx_index)}else n=!1;if(n)continue;"none"!=this.config.lineEnds.caseColon&&this.lineEndAfter(r);let s=fa.getLastToken(r);null!=s&&this.lineEndAfter(s)}}markSharp(){let e=this.parsedCode.root.filterCallback((function(e,t){let n=e.tok;if(3!=n._hx_index)return ia.GoDeeper;switch(n.s){case"else":case"elseif":case"end":case"error":case"if":return ia.FoundGoDeeper;default:return ia.GoDeeper}})),t=0;for(;t<e.length;){let n=e[t];++t;let r=n.tok;if(3==r._hx_index)switch(r.s){case"else":if(this.isInlineSharp(n)){this.noLineEndBefore(n);continue}this.lineEndBefore(n),this.lineEndAfter(n);break;case"elseif":case"if":let e=fa.getLastToken(n.getFirstChild());if(null==e)continue;if("none"==this.config.lineEnds.sharp){this.whitespace(e,"after");continue}if(this.isInlineSharp(n)){let e=n.tok;if(3==e._hx_index&&"if"==e.s&&this.isOnlyWhitespaceBeforeToken(n))continue;this.noLineEndBefore(n);continue}this.lineEndBefore(n),this.lineEndAfter(e);break;case"end":this.isInlineSharp(n)?this.noLineEndBefore(n):this.lineEndBefore(n);let t=this.getNextToken(n);if(null!=t)switch(t.token.tok._hx_index){case 10:case 15:continue}if(!this.isOnlyWhitespaceAfterToken(n,!0))continue;this.lineEndAfter(n);break;case"error":let r=fa.getLastToken(n.getFirstChild());null==r&&(r=n),this.lineEndAfter(r);break;default:this.lineEndAfter(n)}else this.lineEndAfter(n)}}isInlineSharp(e){let t=e.tok;if(3!=t._hx_index)return!1;switch(t.s){case"else":case"elseif":case"end":return this.isInlineSharp(e.parent);case"if":let t=e.getLastChild();if(null==t)return!1;let n=t.tok;switch(n._hx_index){case 3:if("end"!=n.s)return!1;{let n=this.parsedCode.linesBetweenOriginal(e,t),r=this.getNextToken(t);if(null!=r)switch(r.token.tok._hx_index){case 10:case 15:return!(n>5)}if(0==n)return!0;if(n>3)return!1}break;case 10:case 15:if(t=t.previousSibling,null==t)return!1;let r=t.tok;if(3!=r._hx_index||"end"!=r.s)return!1;break;default:return!1}if(!this.isOnlyWhitespaceAfterToken(t,!0))return!0;if(!this.isOnlyWhitespaceBeforeToken(e))return!0;let r=this.getPreviousToken(e);if(null==r)return!this.isOnlyWhitespaceBeforeToken(e);if(r.whitespaceAfter==we.Newline)return!1;switch(r.token.tok._hx_index){case 6:default:return!0;case 7:case 8:case 10:case 15:case 16:case 19:return!1;case 21:return!!this.parsedCode.isOriginalSameLine(r.token,e)}break;default:return!1}}isOnlyWhitespaceBeforeToken(e){let t=this.parsedCode.getLinePos(e.pos.min),n=this.parsedCode.getString(this.parsedCode.linesIdx[t.line].l,e.pos.min);return new s("^\\s*$","").match(n)}isOnlyWhitespaceAfterToken(e,t){let n=this.parsedCode.getLinePos(e.pos.max),r=this.parsedCode.getString(e.pos.max,this.parsedCode.linesIdx[n.line].r);return t?new s("^\\s*(|//.*)$","").match(r):new s("^\\s*$","").match(r)}findTypedefBrOpen(e){let t=sa.firstOf(sa.isCIdent(sa.firstChild(e)),oa.Binop(ht.OpAssign));return null==t?null:sa.firstOf(t,oa.BrOpen)}markStructureExtension(){let e=this.parsedCode.root.filterCallback((function(e,t){let n=e.tok;return 1==n._hx_index?32==n.k._hx_index?ia.FoundSkipSubtree:ia.SkipSubtree:ia.GoDeeper})),t=0;for(;t<e.length;){let n=e[t];++t,this.markAfterTypedef(n);let r=this.findTypedefBrOpen(n);if(null==r)continue;if(null==r.children||r.children.length<=0)continue;let i=r.parent;if(i.children.length>1){let e=0,t=i.children;for(;e<t.length;){let n=fa.getLastToken(t[e++]);if(null==n)continue;let r=this.getNextToken(n);if(null!=r){if(19==n.tok._hx_index){let e=r.token.tok;switch(e._hx_index){case 6:if(11==e.op._hx_index){this.noLineEndAfter(n);continue}break;case 10:this.whitespace(n,"noneAfter");continue;case 14:this.whitespace(n,"none");continue}}switch(r.token.tok._hx_index){case 10:case 18:continue}this.lineEndAfter(n)}}}let s=0,a=r.children;for(;s<a.length;){let e=a[s];++s;let t=e.tok;switch(t._hx_index){case 2:if(3==t.c._hx_index){let t=fa.getLastToken(e);if(null==t)continue;let n=this.getNextToken(t);if(null!=n)switch(n.token.tok._hx_index){case 7:if(this.parsedCode.isOriginalSameLine(t,n.token)){this.lineEndAfter(n.token);continue}break;case 8:if(this.parsedCode.isOriginalSameLine(t,n.token))continue}this.lineEndAfter(t)}break;case 6:if(7==t.op._hx_index){let t=fa.getLastToken(e);if(null==t)continue;let n=this.getNextToken(t);if(null!=n)switch(n.token.tok._hx_index){case 7:if(this.parsedCode.isOriginalSameLine(t,n.token)){this.lineEndAfter(n.token);continue}break;case 8:if(this.parsedCode.isOriginalSameLine(t,n.token))continue}this.lineEndAfter(t)}break;case 19:let n=this.getNextToken(e);if(null==n)continue;let r=n.token.tok;6==r._hx_index&&11==r.op._hx_index&&this.noLineEndAfter(e);let i=n.token.tok;6==i._hx_index&&7==i.op._hx_index&&this.whitespace(e,"noneAfter");break;case 22:let s=fa.getLastToken(e);if(null==s)continue;let a=this.getNextToken(s);if(null!=a)switch(a.token.tok._hx_index){case 7:if(this.parsedCode.isOriginalSameLine(s,a.token)){this.lineEndAfter(a.token);continue}break;case 8:if(this.parsedCode.isOriginalSameLine(s,a.token))continue}this.lineEndAfter(s)}}}}markAfterTypedef(e){let t=fa.getLastToken(e);if(null==t)return;let n=this.getNextToken(t);if(null!=n)switch(n.token.tok._hx_index){case 8:if(!this.parsedCode.isOriginalNewlineBefore(n.token))return;break;case 10:return void this.whitespace(t,"noneAfter")}this.lineEndAfter(t)}static outputLineSeparator(e,t){let n=e.lineEndCharacter;if(null==n)return t.lineSeparator;switch(n){case"CR":return"\r";case"CRLF":return"\r\n";case"LF":return"\n";default:return t.lineSeparator}}}Ae.__name__="formatter.marker.MarkLineEnds",Ae.__super__=ve,Object.assign(Ae.prototype,{__class__:Ae});class Fe extends ve{constructor(e,t,n){super(e,t,n)}run(){this.markDollarSameLine();let e=this;this.parsedCode.root.filterCallback((function(t,n){if(null!=t.parent&&23==t.parent.tok._hx_index)return ia.GoDeeper;let r=t.tok;if(1==r._hx_index)switch(r.k._hx_index){case 0:e.markFunction(t);break;case 3:e.markIf(t);break;case 4:e.markElse(t);break;case 5:let n;if(null!=t.parent){let e=t.parent.tok;n=1==e._hx_index&&6==e.k._hx_index}else n=!1;if(n)return ia.GoDeeper;e.markWhile(t);break;case 6:e.markDoWhile(t);break;case 7:e.markFor(t);break;case 10:e.markReturn(t);break;case 15:case 16:e.markCase(t);break;case 20:e.markTry(t);break;case 21:e.markCatch(t);break;case 29:e.markUntyped(t);break;case 41:e.markMacro(t)}return ia.GoDeeper}))}isExpression(e){if(null==e)return!1;let t=e.parent,n=t.tok;switch(n._hx_index){case 1:switch(n.k._hx_index){case 4:return this.shouldElseBeSameLine(t);case 5:case 7:if(16==t.parent.tok._hx_index)return!0;break;case 10:return!0;case 29:case 41:return this.isExpression(t)}break;case 6:case 14:case 16:return!0;case 12:let r=t.getLastChild();return null!=r&&(r.index==e.index&&this.isReturnExpression(t));case 18:let i=t.parent.tok;if(1==i._hx_index&&7==i.k._hx_index)return this.isExpression(t);break;case 20:let s=t.getPos();if(s.min<e.pos.min&&s.max>e.pos.max)return!0}return!1}isReturnExpression(e){let t=e;for(;t.parent.tok!=oa.Root;){t=t.parent;let e=t.tok;switch(e._hx_index){case 1:switch(e.k._hx_index){case 0:return!1;case 10:return!0}break;case 6:case 12:case 14:case 20:return!0;case 16:return!1;case 18:switch(fa.getBrOpenType(t)._hx_index){case 0:case 1:case 3:case 4:break;case 2:return!0}}}return!1}shouldIfBeSameLine(e){if(null==e)return!1;let t=e.tok;return 1==t._hx_index&&3==t.k._hx_index&&(null!=this.getBodyAfterCondition(e)&&this.isExpression(e))}shouldElseBeSameLine(e){if(null==e)return!1;let t=e.tok;return 1==t._hx_index&&4==t.k._hx_index&&this.shouldIfBeSameLine(e.parent)}shouldTryBeSameLine(e){if(null==e)return!1;let t=e.tok;return 1==t._hx_index&&20==t.k._hx_index&&this.isExpression(e)}shouldCatchBeSameLine(e){if(null==e)return!1;let t=e.tok;if(1!=t._hx_index||21!=t.k._hx_index)return!1;let n=this.getPreviousToken(e);return(null==n||19!=n.token.tok._hx_index)&&this.shouldTryBeSameLine(e.parent)}markIf(e){if(this.shouldIfBeSameLine(e))switch(this.config.sameLine.expressionIf){case"keep":return void this.markBodyAfterPOpen(e,"keep",this.config.sameLine.expressionIfWithBlocks);case"next":break;case"same":return void this.markBodyAfterPOpen(e,"same",this.config.sameLine.expressionIfWithBlocks)}this.markBodyAfterPOpen(e,this.config.sameLine.ifBody,!1);let t,n=this.getPreviousToken(e);if(null!=n){let e=n.token.tok;t=1==e._hx_index&&4==e.k._hx_index}else t=!1;t&&this.applySameLinePolicy(e,this.config.sameLine.elseIf)}markElse(e){if(this.shouldElseBeSameLine(e))switch(this.config.sameLine.expressionIf){case"keep":this.markBody(e,"keep",this.config.sameLine.expressionIfWithBlocks),this.parsedCode.isOriginalNewlineBefore(e)&&this.lineEndBefore(e);let t=this.getPreviousToken(e);if(null==t)return;return void(19==t.token.tok._hx_index&&this.applySameLinePolicyChained(e,"keep","keep"));case"next":break;case"same":this.markBody(e,"same",this.config.sameLine.expressionIfWithBlocks);let n=this.getPreviousToken(e);if(null==n)return;return void(19==n.token.tok._hx_index&&this.applySameLinePolicyChained(e,this.config.sameLine.ifBody,this.config.sameLine.ifElse))}this.markBody(e,this.config.sameLine.elseBody,!1);let t=this.config.sameLine.ifElse,n=this.getPreviousToken(e);if(null!=n)switch(n.token.tok._hx_index){case 10:if(this.config.sameLine.ifElseSemicolonNextLine)switch(t){case"keep":case"next":break;case"same":t="next"}break;case 19:if(null==sa.matches(sa.parent(sa.matches(sa.parent(n.token),oa.BrOpen)),oa.Kwd(li.KwdIf)))switch(t){case"keep":case"next":break;case"same":t="next"}}this.applySameLinePolicyChained(e,this.config.sameLine.ifBody,t)}markTry(e){this.shouldTryBeSameLine(e)&&"same"==this.config.sameLine.expressionTry?this.markBody(e,"same",!1):this.markBody(e,this.config.sameLine.tryBody,!1)}markCatch(e){if(this.shouldCatchBeSameLine(e)&&"same"==this.config.sameLine.expressionTry)return this.markBodyAfterPOpen(e,"same",!1),void this.applySameLinePolicy(e,this.config.sameLine.expressionTry);this.markBodyAfterPOpen(e,this.config.sameLine.catchBody,!1),this.applySameLinePolicyChained(e,this.config.sameLine.tryBody,this.config.sameLine.tryCatch)}markCase(e){if(null==e)return;let t=sa.firstOf(e,oa.DblDot);if(null==t)return;if(this.isReturnExpression(e))return void this.markExpressionCase(e,t);if(null==t.children||t.children.length>1)return;switch(this.config.sameLine.caseBody){case"keep":if(!this.parsedCode.isOriginalSameLine(t,t.getFirstChild()))return;break;case"next":return}let n=t.getFirstChild(),r=fa.getLastToken(n);this.parsedCode.linesBetweenOriginal(n,r)>2||this.noLineEndAfter(t)}markExpressionCase(e,t){if(null!=t.children){switch(this.config.sameLine.expressionCase){case"keep":if(!this.parsedCode.isOriginalSameLine(t,t.getFirstChild()))return;break;case"next":return}if(2==t.children.length){let e=t.children[1];if(8!=e.tok._hx_index)return;{let n=this.getPreviousToken(e);if(null!=n&&!this.parsedCode.isOriginalSameLine(t,n.token))return}}t.children.length>2||this.noLineEndAfter(t)}}isArrayComprehension(e){if(null==e)return!1;let t=e.parent;for(;null!=t;){let e=t.tok;switch(e._hx_index){case 1:switch(e.k._hx_index){case 3:case 4:case 5:case 7:t=t.parent;break;default:return!1}break;case 16:return!0;default:return!1}}return!1}markFor(e){if(null==e)return;let t=e.parent;if(null==t||t.tok==oa.Root)return;if(this.isArrayComprehension(e))return void this.markArrayComprehension(e,t);let n=t.tok;if(1==n._hx_index&&41==n.k._hx_index){let t=fa.getLastToken(e);if(null==t)return;if(this.parsedCode.isOriginalSameLine(e,t))return void this.markBodyAfterPOpen(e,"same",!1)}this.markBodyAfterPOpen(e,this.config.sameLine.forBody,!1)}markWhile(e){if(null==e)return;let t=e.parent;null!=t&&t.tok!=oa.Root&&(this.isArrayComprehension(e)?this.markArrayComprehension(e,t):this.markBodyAfterPOpen(e,this.config.sameLine.whileBody,!1))}markArrayComprehension(e,t){let n=this.getCloseToken(t);switch(this.config.sameLine.comprehensionFor){case"keep":this.parsedCode.isOriginalNewlineBefore(e)&&this.lineEndBefore(e),this.markBodyAfterPOpen(e,this.config.sameLine.comprehensionFor,!1),null!=n&&this.parsedCode.isOriginalNewlineBefore(n)&&this.lineEndBefore(n);break;case"next":break;case"same":let r=!1;if(null!=n)r=this.parsedCode.isOriginalSameLine(t,n);else{let e=fa.getLastToken(t);null!=e&&(r=this.parsedCode.isOriginalSameLine(t,e))}r?(this.markBodyAfterPOpen(e,this.config.sameLine.comprehensionFor,!1),null!=n&&(Te.has(this.config.whitespace.bracketConfig.comprehensionBrackets.openingPolicy,"after")||this.whitespace(e,"noneBefore"),Te.has(this.config.whitespace.bracketConfig.comprehensionBrackets.closingPolicy,"before")||this.whitespace(n,"noneBefore"))):this.markBodyAfterPOpen(e,this.config.sameLine.forBody,!1)}}getBodyAfterCondition(e){let t=sa.firstOf(sa.firstOf(e,oa.POpen),oa.PClose);if(null!=t){let e=this.getNextToken(t);if(null!=e&&12!=e.token.tok._hx_index)return e.token}if(null==e.children)return null;let n=0,r=e.children;for(;n<r.length;){let e=r[n];++n;let t=e.tok;switch(t._hx_index){case 1:switch(t.k._hx_index){case 37:case 38:case 39:return e.nextSibling}break;case 2:if(3==t.c._hx_index)return e.nextSibling;break;case 18:return e}}return null}markBodyAfterPOpen(e,t,n){let r=this.getBodyAfterCondition(e);e:for(;null!=r;){let e=r.tok;switch(e._hx_index){case 3:switch(e.s){case"else":case"elseif":case"end":return;default:break e}break;case 8:let i=this.getPreviousToken(r);if(null!=i&&!this.parsedCode.isOriginalSameLine(r,i.token))return void this.applySameLinePolicy(r,t);r=r.nextSibling;break;case 18:switch(fa.getBrOpenType(r)._hx_index){case 0:return void(n&&this.markBlockBody(r,t));case 1:case 3:case 4:break;case 2:this.applySameLinePolicy(r,t)}r=r.nextSibling;break;default:break e}}null!=r&&this.applySameLinePolicy(r,t)}markBody(e,t,n){let r=sa.firstChild(e);if(null!=r)if(18!=r.tok._hx_index)this.applySameLinePolicy(r,t);else switch(fa.getBrOpenType(r)._hx_index){case 0:return void(n&&this.markBlockBody(r,t));case 1:case 3:case 4:break;case 2:this.applySameLinePolicy(r,t)}}markBlockBody(e,t){if(null==e)return;if(18!=e.tok._hx_index)return;if(null==e.children)return;if(10==e.getLastChild().tok._hx_index){if(e.children.length>3)return}else if(e.children.length>2)return;this.noLineEndAfter(e);let n=0,r=e.children;for(;n<r.length;){let e=r[n];if(++n,19==e.tok._hx_index){let t=this.getNextToken(e).token.tok;switch(t._hx_index){case 1:switch(t.k._hx_index){case 4:case 21:this.noLineEndAfter(e)}break;case 10:case 15:this.whitespace(e,"noneAfter")}return}{let t=fa.getLastToken(e);if(null==t)return;this.noLineEndAfter(t)}}}applySameLinePolicyChained(e,t,n){if("same"==n){let r=this.getPreviousToken(e);null==r&&(n="next"),19!=r.token.tok._hx_index&&"same"!=t&&(n="next")}this.applySameLinePolicy(e,n)}applySameLinePolicy(e,t){switch(t){case"keep":this.parsedCode.isOriginalNewlineBefore(e)?this.applySameLinePolicy(e,"next"):this.applySameLinePolicy(e,"same");break;case"next":switch(e.tok._hx_index){case 8:if(!this.parsedCode.isOriginalNewlineBefore(e))return;break;case 16:if(null!=sa.matches(sa.parent(e),oa.Kwd(li.KwdFor)))return}let t=this.getPreviousToken(e);if(null==t||!fa.isMetadata(t.token))return void this.lineEndBefore(e);this.lineEndBefore(this.parsedCode.tokenList.findLowestIndex(e));break;case"same":this.wrapBefore(e,!0);let n=this.getPreviousToken(e);if(null==n)this.noLineEndBefore(e);else if(23==e.tok._hx_index)switch(n.token.tok._hx_index){case 1:case 3:case 10:case 12:case 18:case 19:break;case 6:this.lineEndBefore(e);break;case 11:case 20:this.whitespace(e,"noneBefore");break;default:this.noLineEndBefore(e)}else switch(n.token.tok._hx_index){case 11:case 20:this.whitespace(e,"noneBefore");break;default:this.noLineEndBefore(e)}let r=fa.getLastToken(e);if(null==r)return;let i=this.getNextToken(r);if(null==i)return;let s=i.token.tok;return void(1==s._hx_index&&4==s.k._hx_index&&this.noLineEndAfter(r))}}markDollarSameLine(){let e=this.parsedCode.root.filterCallback((function(e,t){let n=e.tok;if(4!=n._hx_index)return ia.GoDeeper;switch(n.s){case"":case"a":case"b":case"e":case"i":case"p":case"v":return ia.FoundSkipSubtree;default:return ia.SkipSubtree}})),t=0;for(;t<e.length;){let n=sa.matches(sa.firstChild(e[t++]),oa.BrOpen);if(null==n)continue;let r=this.getCloseToken(n);if(!this.parsedCode.isOriginalSameLine(n,r))continue;this.whitespace(n,"none");let i=this.getNextToken(r);if(null!=i)switch(i.token.tok._hx_index){case 10:case 11:case 15:this.whitespace(r,"none");break;case 12:case 16:case 17:case 19:case 20:case 21:break;default:this.whitespace(r,"onlyAfter")}else this.noLineEndAfter(r);this.wrapBefore(n,!1),this.wrapAfter(n,!1),this.wrapBefore(r,!1),this.wrapAfter(r,!1)}}markFunction(e){let t=sa.isCIdent(sa.firstChild(e)),n=t;null==t&&(n=sa.matches(sa.firstChild(e),oa.Kwd(li.KwdNew)));let r=this.config.sameLine.functionBody;if(null==n&&(n=e,r=this.config.sameLine.anonFunctionBody),null==n||null==n.children)return;let i=sa.firstOf(n,oa.POpen);if(n=i,null==i)return;if(null==i.nextSibling)return;if(n=i.nextSibling,12==n.tok._hx_index&&(n=n.nextSibling),null==n)return;let s=n.tok;switch(s._hx_index){case 3:if("if"==s.s)return;break;case 8:case 10:case 18:return}this.applySameLinePolicy(n,r)}markDoWhile(e){this.markBody(e,this.config.sameLine.doWhileBody,!1);let t=sa.firstOf(e,oa.Kwd(li.KwdWhile));null!=t&&this.applySameLinePolicy(t,this.config.sameLine.doWhile)}markMacro(e){let t=this.getNextToken(e);if(null==t||18!=t.token.tok._hx_index)return;let n=this.getCloseToken(t.token);this.parsedCode.isOriginalSameLine(t.token,n)&&(this.noLineEndAfter(t.token),this.noLineEndBefore(n),this.noWrappingBetween(t.token,n))}markReturn(e){this.isFunctionBody(e)||(this.shouldReturnBeSameLine(e)?this.markBody(e,this.config.sameLine.returnBodySingleLine,!1):this.markBody(e,this.config.sameLine.returnBody,!1))}isFunctionBody(e){let t=e.parent;return null!=t&&(!t.matches(oa.BrOpen)&&(t=t.parent,null!=t&&t.matches(oa.Kwd(li.KwdFunction))))}markUntyped(e){if(null==sa.matches(sa.firstChild(e),oa.BrOpen))return;let t=e.parent;if(null!=t&&e.tok!=oa.Root){if(18==t.tok._hx_index)switch(fa.getBrOpenType(t)._hx_index){case 0:case 1:return}this.applySameLinePolicy(e,this.config.sameLine.untypedBody)}}shouldReturnBeSameLine(e){let t=fa.getLastToken(e);return null==t||(!!this.isSameLineBetween(e,t,!1)||this.shouldReturnChildsBeSameLine(e))}shouldReturnChildsBeSameLine(e){if(null==e.children)return!0;let t=0,n=e.children;for(;t<n.length;){let e=n[t];++t;let r=e.tok;if(1==r._hx_index)switch(r.k._hx_index){case 3:case 5:case 7:case 14:case 20:return!1;default:if(!this.shouldReturnChildsBeSameLine(e))return!1}else if(!this.shouldReturnChildsBeSameLine(e))return!1}return!0}}Fe.__name__="formatter.marker.MarkSameLine",Fe.__super__=ve,Object.assign(Fe.prototype,{__class__:Fe});class Ne extends ve{constructor(e,t,n){super(e,t,n)}run(){let e=this;this.parsedCode.root.filterCallback((function(t,n){let r=t.tok;switch(r._hx_index){case 2:switch(r.c._hx_index){case 2:e.tokenText(t,e.printStringToken(t));break;case 4:e.tokenText(t,e.printEregToken(t));break;default:e.tokenText(t,t.toString())}break;case 8:e.tokenText(t,e.printCommentLine(r.s));break;default:e.tokenText(t,t.toString())}return ia.GoDeeper}))}finalRun(){let e=this;this.parsedCode.root.filterCallback((function(t,n){let r=t.tok;return 7==r._hx_index&&e.tokenText(t,e.printComment(r.s,t)),ia.GoDeeper}))}printStringToken(e){let t=this.parsedCode.getString(e.pos.min,e.pos.max);if(!this.config.whitespace.formatStringInterpolation)return t;if(t.startsWith("'")){let e,n=0;for(;e=t.indexOf("${",n),e>=0;){if(this.isDollarEscaped(t,e))return t;n=e+1;let r=t.indexOf("}",e+2),i=t.substring(e+2,r);if(i.indexOf("{")>=0)continue;let s=this.formatFragment(i);n+=s.length,t=a.substr(t,0,e+2)+s+a.substr(t,r,null)}}return t}isDollarEscaped(e,t){let n=!1;for(;--t>=0;){if(36!=e.charCodeAt(t))return n;n=!n}return n}formatFragment(e){try{let t=this.makeTokens(it.ofString(e),"string interpolation"),n=new ea(t,it.ofString(e)),r=new na(oa.Root,"",null,-1),i=new ta(n);for(;i.streamHasChanged();)n.hasMore()&&Ga.walkStatement(n,r);let s=new xe({fileName:"string interpolation",content:it.ofString(e),tokenList:t,tokenTree:r,config:this.config,entryPoint:la.ExpressionLevel}),a=new Se(this.config.indentation);a.setParsedCode(s);let l=new Ie(this.config,s,a);new Ne(this.config,s,a).run(),l.run();let o=Ae.outputLineSeparator(this.config.lineEnds,s);return se.trim(new ge(s,a).print(o))}catch(e){We.lastError=e}return e}makeTokens(e,t){let n=[];try{let r=new bi(e,t),i=r.token(bi.tok);for(;i.tok!=oi.Eof;)n.push(i),i=r.token(bi.tok)}catch(e){We.lastError=e;let t=Me.caught(e).unwrap();throw Me.thrown("failed to make tokens "+(null==t?"null":re.string(t)))}return n}printEregToken(e){return this.parsedCode.getString(e.pos.min,e.pos.max)}printComment(e,t){let n=e.split(this.parsedCode.lineSeparator),r=this.indenter.calcIndent(t),i=n.length>=3,l=1,o=n.length-1;for(;l<o;)if(!new s("^\\s*\\*(\\s|$)","").match(n[l++])){i=!1;break}let c=[],u=0;for(;u<n.length;)c.push(this.convertLeadingIndent(n[u++]));n=this.removeCommentPrefix(c);let h=Ae.outputLineSeparator(this.config.lineEnds,this.parsedCode);e="/*"+n[0];let d=1,p=n.length;for(;d<p;){let t=d++;e+=h;let l=n[t],o=r,c=t==n.length-1;if(c||(o=r+1),i&&(o=r),!c&&l.length<=0&&(o=0),!c&&i&&(l=" "+l),c){if(new s("^\\s*\\*\\s*[^\\s\\*]","").match(l)&&(l=" "+l),new s("^\\s*}","").match(l))l=se.trim(l);else{new s("^\\s*[^*\\s]","").match(l)&&(o=r+1);let e=l.length,t=0;for(;t<e&&se.isSpace(l,e-t-1);)++t;t>0&&(l=a.substr(l,0,e-t)),l.endsWith("*")||(l+=" ")}new s("^\\s*$","").match(l)&&(l=" ")}e+=this.indenter.makeIndentString(o)+l}return e+"*/"}removeCommentPrefix(e){let t=new s("^(\\s*)",""),n=null,r=[],i=e.length-1,l=e[e.length-1];new s("^\\s*(\\**$|\\})","").match(l)||(i=e.length);let o=1,c=i;for(;o<c;){t.match(e[o++]);let r=t.matched(1);r.length<=0||(null==n||n.length>r.length)&&(n=r)}if(null!=n){r=[];let t=n+" *",i=0;for(;i<e.length;){let s=e[i];++i,s.startsWith(t)&&(s=a.substr(s,t.length-1,null)),s.startsWith(n)&&(s=a.substr(s,n.length,null)),r.push(s)}e=r}let u=e[e.length-1];if(new s("^\\s*\\*\\**$","").match(u)){let t=e.length-1,n=u.length,r=0;for(;r<n&&se.isSpace(u,r);)++r;e[t]=r>0?a.substr(u,r,n-r):u}return e}convertLeadingIndent(e){let t=se.lpad(""," ",this.config.indentation.tabWidth),n=this.config.indentation.character,r=new s("^\\s+","");if(!r.match(e))return e;let i=r.matched(0);return e="\t"==this.config.indentation.character?se.replace(i,t,n)+a.substr(e,i.length,null):se.replace(i,"\t",n)+a.substr(e,i.length,null)}printCommentLine(e){if(new s("^[/\\*\\-\\s]+","").match(e)){let t=e.length,n=0;for(;n<t&&se.isSpace(e,t-n-1);)++n;return"//"+(n>0?a.substr(e,0,t-n):e)}return this.config.whitespace.addLineCommentSpace?"// "+se.trim(e):"//"+se.trim(e)}}Ne.__name__="formatter.marker.MarkTokenText",Ne.__super__=ve,Object.assign(Ne.prototype,{__class__:Ne});class Ie extends ve{constructor(e,t,n){super(e,t,n)}run(){let e=this;this.parsedCode.root.filterCallback((function(t,n){let r=t.tok;switch(r._hx_index){case 1:27==r.k._hx_index?e.markIn(t):e.markKeyword(t);break;case 2:let n=r.c;if(3==n._hx_index)switch(n.s){case"is":e.markIs(t);break;case"from":case"to":null!=sa.matches(sa.parent(sa.parent(t)),oa.Kwd(li.KwdAbstract))&&(e.whitespace(t,"around"),e.wrapBefore(t,!0)),e.fixConstAfterConst(t);break;default:e.fixConstAfterConst(t)}else e.fixConstAfterConst(t);break;case 3:e.markSharp(t);break;case 4:e.markDollar(t);break;case 5:e.markUnop(t);break;case 6:switch(r.op._hx_index){case 1:fa.isImport(t.parent)?e.whitespace(t,"none"):e.whitespace(t,e.config.whitespace.binopPolicy);break;case 3:if(fa.filterOpSub(t)){let n=Te.remove(e.config.whitespace.binopPolicy,"after");switch(e.getPreviousToken(t).token.tok._hx_index){case 16:case 20:n=Te.remove(n,"before")}e.whitespace(t,n)}else e.whitespace(t,e.config.whitespace.binopPolicy);break;case 4:e.markOpAssign(t);break;case 7:e.markGt(t);break;case 9:fa.isTypeParameter(t)?e.whitespace(t,e.config.whitespace.typeParamOpenPolicy):e.whitespace(t,e.config.whitespace.binopPolicy);break;case 21:e.markOpSpread(t);break;case 23:e.markIn(t);break;default:e.whitespace(t,e.config.whitespace.binopPolicy)}break;case 7:e.markComment(t);break;case 8:e.whitespace(t,"before");break;case 10:e.markSemicolon(t);break;case 12:e.markDblDot(t);break;case 14:e.markArrow(t);break;case 15:e.whitespace(t,e.config.whitespace.commaPolicy);break;case 16:e.markBkOpen(t);break;case 17:e.markBkClose(t);break;case 18:e.markBrOpen(t);break;case 19:e.markBrClose(t);break;case 20:e.markPOpen(t);break;case 21:e.markPClose(t);break;case 22:fa.isTernary(t)?e.whitespace(t,e.config.whitespace.ternaryPolicy):e.whitespace(t,"noneAfter");break;case 23:e.markAt(t);break;case 25:e.markOpSpread(t)}return ia.GoDeeper}))}markOpSpread(e){let t=this.getPreviousToken(e),n=this.config.whitespace.intervalPolicy;null!=t&&(n=15==t.token.tok._hx_index?Te.add(this.config.whitespace.intervalPolicy,"before"):this.config.whitespace.intervalPolicy),this.whitespace(e,n)}markGt(e){if(fa.isOpGtTypedefExtension(e))this.whitespace(e,this.config.whitespace.typeExtensionPolicy);else if(fa.isTypeParameter(e)){let t=this.config.whitespace.typeParamClosePolicy,n=this.getNextToken(e);if(null!=n){let e=n.token.tok;switch(e._hx_index){case 1:t=Te.add(t,"after");break;case 6:7==e.op._hx_index&&(t=Te.remove(t,"after"));break;case 10:case 15:case 19:case 21:t=Te.remove(t,"after")}}this.whitespace(e,t)}else this.whitespace(e,this.config.whitespace.binopPolicy)}fixConstAfterConst(e){let t=this.getNextToken(e);if(null!=t)switch(t.token.tok._hx_index){case 1:case 2:this.whitespace(e,"after")}}successiveParenthesis(e,t,n,r){let i=this.getPreviousToken(e);if(null!=i){let t=i.token.tok;switch(t._hx_index){case 6:switch(t.op._hx_index){case 4:case 20:n=Te.add(n,"before")}break;case 12:case 22:n=Te.add(n,"before");break;case 21:if(e.matches(oa.BkOpen)){let e=i.token;switch(fa.getPOpenType(null!=e?e.parent:null)._hx_index){case 0:case 1:case 3:case 4:case 5:case 6:case 7:case 8:n=Te.add(n,"before")}}}}let s=this.getNextToken(e);if(null!=s){let r=s.token.tok;switch(r._hx_index){case 1:t&&(n=Te.add(n,"after"));break;case 6:switch(r.op._hx_index){case 7:19==e.tok._hx_index&&(n=Te.remove(n,"after"));break;case 22:n=Te.add(n,"after")}break;case 10:case 11:case 12:case 13:case 15:n=Te.remove(n,"after")}}if(r){if(t){if(null!=s){let t=s.token.tok;switch(t._hx_index){case 6:7==t.op._hx_index&&fa.isTypeParameter(s.token)&&(n=Te.remove(n,"after"));break;case 16:case 17:case 18:case 20:case 21:if(21==e.tok._hx_index)switch(fa.getPOpenType(e.parent)._hx_index){case 1:case 3:case 4:case 5:case 6:case 7:case 8:n=Te.add(n,"after");break;case 0:case 2:case 9:n=Te.remove(n,"after")}else n=Te.remove(n,"after");break;case 19:n=Te.remove(n,"after")}}}else if(null!=i){let t=i.token.tok;switch(t._hx_index){case 2:let r=t.c;if(3==r._hx_index)switch(r.s){case"from":case"to":let e=i.token.parent;null!=e&&2==e.tok._hx_index&&(n=Te.add(n,"before"))}break;case 6:switch(t.op._hx_index){case 9:if(18==e.tok._hx_index)return;break;case 21:n=Te.remove(n,"before")}break;case 9:case 16:case 18:case 20:case 25:n=Te.remove(n,"before");break;case 12:switch(i.whitespaceAfter._hx_index){case 0:n=Te.remove(n,"before");break;case 1:n=Te.add(n,"before")}break;case 14:return;case 15:let s=this.config.whitespace.commaPolicy;if(null!=s)switch(s){case"after":case"around":case"onlyAfter":n=Te.add(n,"before")}break;case 21:switch(fa.getPOpenType(i.token)._hx_index){case 3:case 4:case 5:case 6:case 7:n=Te.add(n,"before")}}}this.whitespace(e,n)}else this.whitespace(e,n)}markKeyword(e){let t=this.getPreviousToken(e);if(null!=t)switch(t.token.tok._hx_index){case 2:case 21:t.whitespaceAfter=we.Space;break;case 23:return}let n=e.tok;if(1==n._hx_index)switch(n.k._hx_index){case 3:this.whitespace(e,this.config.whitespace.ifPolicy);break;case 4:this.whitespace(e,Te.add(this.config.whitespace.ifPolicy,"after"));break;case 5:this.whitespace(e,this.config.whitespace.whilePolicy);break;case 6:this.whitespace(e,this.config.whitespace.doPolicy);break;case 7:this.whitespace(e,this.config.whitespace.forPolicy);break;case 9:case 16:case 23:case 37:case 38:case 39:let t=this.getNextToken(e);if(null!=t){let n=t.token.tok;switch(n._hx_index){case 1:case 22:return void this.whitespace(e,"after");case 2:if(3==n.c._hx_index)return void this.whitespace(e,"after")}}this.whitespace(e,"noneAfter");break;case 10:case 29:this.whitespace(e,"after");break;case 11:case 12:this.whitespace(e,"around");break;case 14:this.whitespace(e,this.config.whitespace.switchPolicy);break;case 20:this.whitespace(e,this.config.whitespace.tryPolicy);break;case 21:this.whitespace(e,this.config.whitespace.catchPolicy);break;default:let n=this.getNextToken(e);if(null!=n)switch(n.token.tok._hx_index){case 11:case 20:return}this.whitespace(e,"after")}}markIs(e){let t=this.getPreviousToken(e),n="around";if(null!=t)switch(t.token.tok._hx_index){case 11:case 20:n=Te.remove(n,"before")}this.whitespace(e,n)}markIn(e){if(!fa.hasAtParent(e))return void this.whitespace(e,"around");let t="after";e.hasChildren()&&(t="none"),this.whitespace(e,t)}markOpAssign(e){let t=this.getPreviousToken(e);if(null==t)return void this.whitespace(e,this.config.whitespace.binopPolicy);let n=this.config.whitespace.binopPolicy,r=t.token.tok;if(6==r._hx_index)switch(r.op._hx_index){case 14:case 15:t.whitespaceAfter=we.None,n=Te.remove(n,"before")}this.whitespace(e,n)}markUnop(e){let t=this.getNextToken(e);if(null!=t)switch(t.token.tok._hx_index){case 10:case 15:case 17:case 19:case 21:return;case 11:let t=e.tok;if(5==t._hx_index&&2==t.op._hx_index)return void this.whitespace(e,"none")}let n=this.getPreviousToken(e);if(null==n)return;let r=n.token.tok;if(2==r._hx_index&&3==r.c._hx_index){let t=e.tok;if(5==t._hx_index)switch(t.op._hx_index){case 2:case 3:case 4:return}this.whitespace(e,"after")}}markDollar(e){let t=this.getNextToken(e);if(null!=t)switch(t.token.tok._hx_index){case 1:case 2:this.whitespace(e,"after")}}markDblDot(e){let t=fa.getColonType(e);null==t&&(t=ka.Unknown);let n=this.config.whitespace.colonPolicy;switch(t._hx_index){case 0:n=this.config.whitespace.caseColonPolicy;break;case 1:n=this.config.whitespace.typeHintColonPolicy;let t=e.parent;if(null!=t){let e=t.tok;1==e._hx_index&&41==e.k._hx_index&&(n=Te.add(n,"before"))}break;case 2:n=this.config.whitespace.typeCheckColonPolicy;break;case 3:n=this.config.whitespace.ternaryPolicy;break;case 4:n=this.config.whitespace.objectFieldColonPolicy;break;case 5:return void this.whitespace(e,"none");case 6:n=this.config.whitespace.colonPolicy}n=this.correctDblDotSharp(e,n),this.whitespace(e,n)}correctDblDotSharp(e,t){let n=this.getPreviousToken(e);if(null==n)return t;let r=n.token.tok;switch(r._hx_index){case 2:if(null==n.token.parent)return t;let e=n.token.parent.tok;3==e._hx_index&&"if"==e.s&&n.token.parent.getFirstChild().index==n.token.index&&(t=Te.add(t,"before"));break;case 3:"end"!=r.s&&(t=Te.add(t,"before"));break;case 21:if(null==n.token.parent)return t;let i=n.token.parent.tok;3==i._hx_index&&"if"==i.s&&n.token.parent.getFirstChild().index==n.token.index&&(t=Te.add(t,"before"))}return t}markSemicolon(e){let t=this.getNextToken(e),n=this.config.whitespace.semicolonPolicy;null!=t&&19==t.token.tok._hx_index&&(n=Te.remove(n,"after")),this.whitespace(e,n)}markSharp(e){let t=e.tok;if(3==t._hx_index)switch(t.s){case"else":case"elseif":case"error":this.whitespace(e,"around");break;case"end":let t=this.getPreviousToken(e);if(null!=t)switch(t.token.tok._hx_index){case 16:case 18:case 20:break;default:this.whitespace(e,"before")}let n=this.getNextToken(e);if(null!=n)switch(n.token.tok._hx_index){case 1:case 2:case 16:case 18:case 20:case 22:this.whitespace(e,"after")}break;case"if":this.whitespace(e,"after");let r=this.getPreviousToken(e);if(null!=r)switch(r.token.tok._hx_index){case 1:case 2:case 6:this.whitespace(e,"before")}if(null!=this.getNextToken(e)){let t=fa.getLastToken(e.getFirstChild());null!=t&&this.whitespace(t,"after")}}}markArrow(e){let t=fa.getArrowType(e);switch(null==t&&(t=xa.ArrowFunction),t._hx_index){case 0:this.whitespace(e,this.config.whitespace.arrowFunctionsPolicy);break;case 1:this.whitespace(e,this.config.whitespace.functionTypeHaxe3Policy);break;case 2:this.whitespace(e,this.config.whitespace.functionTypeHaxe4Policy)}}determinePOpenPolicy(e){let t=fa.getPOpenType(e);switch(null==t&&(t=ga.Expression),t._hx_index){case 0:return this.config.whitespace.parenConfig.metadataParens.openingPolicy=Te.remove(this.config.whitespace.parenConfig.metadataParens.openingPolicy,"before"),this.config.whitespace.parenConfig.metadataParens;case 1:let t=e.parent.tok;switch(t._hx_index){case 1:switch(t.k._hx_index){case 10:let e={openingPolicy:this.config.whitespace.parenConfig.anonFuncParamParens.openingPolicy,closingPolicy:this.config.whitespace.parenConfig.anonFuncParamParens.closingPolicy,removeInnerWhenEmpty:this.config.whitespace.parenConfig.anonFuncParamParens.removeInnerWhenEmpty};switch(e.openingPolicy){case"after":case"onlyAfter":e.openingPolicy="around";break;case"around":case"before":case"onlyBefore":break;case"none":case"noneBefore":e.openingPolicy="before";break;case"noneAfter":e.openingPolicy="onlyBefore"}return e;case 22:return this.config.whitespace.parenConfig.funcParamParens;default:return this.config.whitespace.parenConfig.anonFuncParamParens}break;case 2:return 3==t.c._hx_index?this.config.whitespace.parenConfig.funcParamParens:this.config.whitespace.parenConfig.anonFuncParamParens;default:return this.config.whitespace.parenConfig.anonFuncParamParens}break;case 2:return this.config.whitespace.parenConfig.callParens;case 3:return null!=this.config.whitespace.parenConfig.switchConditionParens?this.config.whitespace.parenConfig.switchConditionParens:this.config.whitespace.parenConfig.conditionParens;case 4:return null!=this.config.whitespace.parenConfig.whileConditionParens?this.config.whitespace.parenConfig.whileConditionParens:this.config.whitespace.parenConfig.conditionParens;case 5:return null!=this.config.whitespace.parenConfig.ifConditionParens?this.config.whitespace.parenConfig.ifConditionParens:this.config.whitespace.parenConfig.conditionParens;case 6:return null!=this.config.whitespace.parenConfig.sharpConditionParens?this.config.whitespace.parenConfig.sharpConditionParens:this.config.whitespace.parenConfig.conditionParens;case 7:return null!=this.config.whitespace.parenConfig.catchParens?this.config.whitespace.parenConfig.catchParens:this.config.whitespace.parenConfig.conditionParens;case 8:return this.config.whitespace.parenConfig.forLoopParens;case 9:return this.config.whitespace.parenConfig.expressionParens}}markPOpen(e){let t=this.determinePOpenPolicy(e),n=t.openingPolicy,r=this.getPreviousToken(e);if(null!=r)switch(r.token.tok._hx_index){case 5:n=Te.remove(n,"before");break;case 6:case 7:r.spacesAfter>0&&(n=Te.add(n,"before"))}if(t.removeInnerWhenEmpty){let t=this.getNextToken(e);null!=t&&21==t.token.tok._hx_index&&(n=Te.remove(n,"after"))}this.successiveParenthesis(e,!1,n,this.config.whitespace.compressSuccessiveParenthesis)}markPClose(e){let t=this.determinePOpenPolicy(e.parent),n=t.closingPolicy;if(t.removeInnerWhenEmpty){let t=this.getPreviousToken(e);null!=t&&20==t.token.tok._hx_index&&(n=Te.remove(n,"before"))}this.successiveParenthesis(e,!0,n,this.config.whitespace.compressSuccessiveParenthesis)}determineBrOpenPolicy(e){let t=fa.getBrOpenType(e);switch(null==t&&(t=ma.Unknown),t._hx_index){case 0:return this.config.whitespace.bracesConfig.blockBraces;case 1:return this.config.whitespace.bracesConfig.typedefBraces;case 2:return this.config.whitespace.bracesConfig.objectLiteralBraces;case 3:return this.config.whitespace.bracesConfig.anonTypeBraces;case 4:return this.config.whitespace.bracesConfig.unknownBraces}}markBrOpen(e){let t=this.determineBrOpenPolicy(e),n=t.openingPolicy;if(t.removeInnerWhenEmpty){let t=this.getNextToken(e);null!=t&&19==t.token.tok._hx_index&&(n=Te.remove(n,"after"))}this.successiveParenthesis(e,!1,n,this.config.whitespace.compressSuccessiveParenthesis)}markBrClose(e){let t=this.determineBrOpenPolicy(e.parent),n=t.closingPolicy;if(t.removeInnerWhenEmpty){let t=this.getPreviousToken(e);null!=t&&18==t.token.tok._hx_index&&(n=Te.remove(n,"before"))}this.successiveParenthesis(e,!0,n,this.config.whitespace.compressSuccessiveParenthesis)}determineBkOpenPolicy(e){let t=fa.getBkOpenType(e);switch(null==t&&(t=_a.Unknown),t._hx_index){case 0:return this.config.whitespace.bracketConfig.accessBrackets;case 1:return this.config.whitespace.bracketConfig.arrayLiteralBrackets;case 2:return this.config.whitespace.bracketConfig.comprehensionBrackets;case 3:return this.config.whitespace.bracketConfig.mapLiteralBrackets;case 4:return this.config.whitespace.bracketConfig.unknownBrackets}}markBkOpen(e){let t=this.determineBkOpenPolicy(e),n=t.openingPolicy;if(t.removeInnerWhenEmpty){let t=this.getNextToken(e);null!=t&&17==t.token.tok._hx_index&&(n=Te.remove(n,"after"))}this.successiveParenthesis(e,!1,n,this.config.whitespace.compressSuccessiveParenthesis)}markBkClose(e){let t=this.determineBkOpenPolicy(e.parent),n=t.closingPolicy;if(t.removeInnerWhenEmpty){let t=this.getPreviousToken(e);null!=t&&16==t.token.tok._hx_index&&(n=Te.remove(n,"before"))}this.successiveParenthesis(e,!0,n,this.config.whitespace.compressSuccessiveParenthesis)}markComment(e){let t="around",n=this.getPreviousToken(e);if(null!=n){let e=n.token.tok;switch(e._hx_index){case 6:9==e.op._hx_index&&fa.isTypeParameter(n.token)&&(t=Te.remove(t,"before"));break;case 16:case 18:case 20:t=Te.remove(t,"before")}}let r=this.getNextToken(e);if(null!=r)switch(r.token.tok._hx_index){case 15:case 17:case 19:case 21:t=Te.remove(t,"after")}this.whitespace(e,t)}markAt(e){let t=this.getPreviousToken(e);if(null==t)return;switch(t.whitespaceAfter._hx_index){case 0:break;case 1:case 2:return}let n=t.token.tok;switch(n._hx_index){case 0:case 7:case 8:case 10:case 16:case 18:case 20:case 24:return;case 1:case 2:case 3:case 4:case 5:case 9:case 11:case 12:case 13:case 14:case 15:case 17:case 19:case 21:case 22:case 23:case 25:break;case 6:if(9==n.op._hx_index&&fa.isTypeParameter(t.token))return}this.whitespace(e,"before")}}Ie.__name__="formatter.marker.MarkWhitespace",Ie.__super__=ve,Object.assign(Ie.prototype,{__class__:Ie});class Oe extends ve{constructor(e,t,n){super(e,t,n),this.wrappingQueue=[]}noWrap(e,t){let n=sa.matches(sa.parent(sa.matches(e,oa.BrOpen)),oa.DblDot);if(null!=n)switch(fa.getColonType(n)._hx_index){case 0:case 1:case 2:case 3:case 5:case 6:break;case 4:this.noLineEndBefore(e)}if(this.noWrappingBetween(e,t),null!=e.children){let t=0,n=e.children;e:for(;t<n.length;){let e=n[t];++t;let r=e.tok;switch(r._hx_index){case 6:if(7==r.op._hx_index)continue;break;case 10:case 15:continue;case 17:case 19:case 21:break e}let i=fa.getLastToken(e);if(null!=i)switch(i.tok._hx_index){case 10:case 15:this.noLineEndAfter(i)}}}this.noLineEndBefore(t)}keep2(e,t,n,r,i){let s=[],a=[],l=0;for(;l<n.length;)a.push(n[l++].last);s=a,n.length>0&&a.unshift(n[0].first);let o=[],c=0;for(;c<n.length;)o.push(n[c++].first);s=a.concat(o),null!=t&&s.push(t),s.push(t);let u=0;for(;u<s.length;){let e=s[u];++u,this.parsedCode.isOriginalNewlineBefore(e)?(this.lineEndBefore(e),this.additionalIndent(e,r)):(this.noLineEndBefore(e),this.wrapBefore(e,!1))}}keep(e,t,n){if(this.noWrappingBetween(e,t),null!=e.children){let t=0,r=e.children;for(;t<r.length;){let e=r[t];++t;let i=!1,s=e.tok;switch(s._hx_index){case 6:if(7==s.op._hx_index)continue;break;case 10:case 15:continue;case 17:case 19:case 21:i=!0}if(this.parsedCode.isOriginalNewlineBefore(e)?(this.lineEndBefore(e),this.additionalIndent(e,n)):(this.noLineEndBefore(e),this.wrapBefore(e,!1)),i)break}}this.parsedCode.isOriginalNewlineBefore(e)||this.noLineEndBefore(e)}wrapChildOneLineEach2(e,t,n,r,i,s){if(null==s&&(s=!1),null==r&&(r=0),!(n.length<=0)){switch(i){case"afterLast":let e=0;for(;e<n.length;){let t=n[e];++e,this.additionalIndent(t.first,r),this.lineEndBefore(t.first)}break;case"beforeLast":let t=n[0];this.additionalIndent(t.first,r),this.lineEndBefore(t.first),t=n.pop();let i=0;for(;i<n.length;){let e=n[i];++i,this.additionalIndent(e.last,r),this.lineEndBefore(e.last)}n.push(t)}if(s){null!=e&&this.noLineEndAfter(e);let t=n[n.length-1].last;if(10!=t.tok._hx_index){let e=this.getNextToken(t);if(null==e)return void this.noLineEndAfter(t);let n=e.token.tok;switch(n._hx_index){case 1:switch(n.k._hx_index){case 22:case 23:case 37:this.noLineEndAfter(t)}break;case 10:break;default:this.noLineEndAfter(t)}}}else{let e=n[n.length-1].last,t=this.getNextToken(e);if(null==t)return void this.lineEndAfter(e);let r=t.token.tok;switch(r._hx_index){case 1:switch(r.k._hx_index){case 22:case 23:case 37:this.lineEndAfter(e)}break;case 10:case 15:case 16:case 18:case 20:break;default:this.lineEndAfter(e)}}}}wrapChildOneLineEach(e,t,n,r){if(null==r&&(r=!1),null==n&&(n=0),r||this.lineEndAfter(e),null==e.children)return;let i=0,s=e.children;for(;i<s.length;){let e=s[i];++i;let t=e.tok;switch(t._hx_index){case 3:this.wrapChildOneLineEachSharp(e,n,r);break;case 6:if(7==t.op._hx_index)return void(r&&this.noLineEndBefore(e));this.additionalIndent(e,n);break;case 8:let i=this.getPreviousToken(e);null!=i&&this.parsedCode.isOriginalSameLine(e,i.token)&&this.noLineEndBefore(e),this.lineEndAfter(e),this.additionalIndent(e,n);continue;case 17:case 19:case 21:return void(r&&this.noLineEndBefore(e));default:this.additionalIndent(e,n)}let a=fa.getLastToken(e);null==a?this.lineEndAfter(e):this.lineEndAfter(a)}if(null!=t)switch(t.tok._hx_index){case 17:case 19:case 21:this.lineEndBefore(t)}}wrapChildOneLineEachSharp(e,t,n){null==n&&(n=!1),null==t&&(t=0);let r=e.children,i=!1;this.lineEndBefore(e);let s=e.tok;if(3==s._hx_index)switch(s.s){case"else":this.lineEndAfter(e);break;case"elseif":case"if":this.lineEndAfter(fa.getLastToken(e.getFirstChild())),i=!0;break;case"end":return void this.lineEndAfter(e)}let a=0;for(;a<r.length;){let e=r[a];if(++a,i){i=!1;continue}let s=e.tok;switch(s._hx_index){case 3:this.wrapChildOneLineEachSharp(e,t,n);break;case 6:if(7==s.op._hx_index)return void(n&&this.whitespace(e,"noneBefore"));this.additionalIndent(e,t);break;case 8:let r=this.getPreviousToken(e);null!=r&&this.parsedCode.isOriginalSameLine(e,r.token)&&this.noLineEndBefore(e),this.lineEndAfter(e),this.additionalIndent(e,t);continue;case 17:case 19:case 21:return void(n&&this.whitespace(e,"noneBefore"));default:this.additionalIndent(e,t)}}}wrapFillLine2AfterLast(e,t,n,r,i,s){if(null==s&&(s=!1),null==i&&(i=0),n.length<=0)return;let a=e;if(null==e&&(a=n[0].first),a=this.findLineStartToken(a),null==a)return;let l=this.indenter.calcIndent(a),o=this.calcLineLengthBefore(e)+this.indenter.calcAbsoluteIndent(l)+this.calcTokenLength(e),c=0;for(;c<n.length;){let e=n[c];++c;let t=e.firstLineLength;o+t>=r?(this.lineEndBefore(e.first),this.additionalIndent(e.first,i),o=this.indenter.calcAbsoluteIndent(l+1+i),e.multiline?o=e.lastLineLength:o+=e.firstLineLength):(this.noLineEndBefore(e.first),o+=t,e.multiline&&(o=e.lastLineLength))}if(s){let e=n[n.length-1];o+this.calcLineLengthAfter(e.last)>r&&(this.lineEndBefore(e.first),this.additionalIndent(e.first,i))}this.noLineEndAfter(e),this.wrapAfter(e,!1)}wrapFillLineWithLeading2AfterLast(e,t,n,r,i){if(null==i&&(i=0),n.length<=0)return;let s=e;if(null==e&&(s=n[0].first),s=this.findLineStartToken(s),null==s)return;let a=this.indenter.calcIndent(s),l=this.indenter.calcAbsoluteIndent(a+1+i),o=!0,c=0;for(;c<n.length;){let e=n[c];++c;let t=e.firstLineLength;l+t>=r?(this.lineEndBefore(e.first),this.additionalIndent(e.first,i),l=this.indenter.calcAbsoluteIndent(a+1+i),e.multiline?l=e.lastLineLength:l+=e.firstLineLength):(o?this.lineEndBefore(e.first):this.noLineEndBefore(e.first),l+=t,o=!1,e.multiline&&(l=e.lastLineLength))}let u=n[n.length-1];switch(u.last.tok._hx_index){case 10:case 12:break;case 17:case 19:case 21:this.isNewLineAfter(u.last)&&this.lineEndAfter(u.last);break;default:this.lineEndAfter(u.last)}}wrapFillLine2BeforeLast(e,t,n,r,i,s){if(null==s&&(s=!1),null==i&&(i=0),n.length<=0)return;let a=e;if(null==e&&(a=n[0].first),a=this.findLineStartToken(a),null==a)return;let l=this.indenter.calcIndent(a),o=this.calcLineLengthBefore(e)+this.indenter.calcAbsoluteIndent(l)+this.calcTokenLength(e),c=!0,u=0;for(;u<n.length;){let e=n[u];++u;let t=e.firstLineLength;if(!c&&o+t>=r){o=this.indenter.calcAbsoluteIndent(l+1+i);let t=this.getPreviousToken(e.first);null!=t&&(this.lineEndBefore(t.token),this.additionalIndent(t.token,i),o+=t.text.length),e.multiline?o+=e.lastLineLength:o+=e.firstLineLength}else{if(c)this.noLineEndBefore(e.first);else{let t=this.getPreviousToken(e.first);null!=t&&this.noLineEndBefore(t.token)}o+=t,c=!1,e.multiline&&(o=this.indenter.calcAbsoluteIndent(l+1+i)+e.lastLineLength)}}if(s){let e=n[n.length-1],t=this.calcLineLengthAfter(e.last),s=this.getPreviousToken(e.first);null!=s&&o+t>=r&&(this.lineEndBefore(s.token),this.additionalIndent(s.token,i))}this.noLineEndAfter(e),this.wrapAfter(e,!1)}wrapFillLine(e,t,n,r,i){null==i&&(i=!1),null==r&&(r=0);let s=this.findLineStartToken(e);if(null==s)return;let a=this.indenter.calcIndent(s),l=this.calcLineLengthBefore(e)+this.indenter.calcAbsoluteIndent(a+r),o=!0;if(null==e.children)return;let c=0,u=e.children;for(;c<u.length;){let e=u[c];++c;let t=e.tok;switch(t._hx_index){case 1:if(0==t.k._hx_index)continue;this.additionalIndent(e,r);break;case 6:if(7==t.op._hx_index)return void this.whitespace(e,"noneBefore");this.additionalIndent(e,r);break;case 8:let s=this.getPreviousToken(e);null!=s&&this.parsedCode.isOriginalSameLine(e,s.token)&&this.noLineEndBefore(e),this.lineEndAfter(e),this.additionalIndent(e,r);continue;case 17:case 19:case 21:if(this.whitespace(e,"noneBefore"),i&&this.calcLineLengthAfter(e)+l>n){let t=e.previousSibling;if(null==t)return;this.lineEndBefore(t),this.additionalIndent(t,r)}return;case 18:continue;default:this.additionalIndent(e,r)}let s=this.calcLength(e),h=fa.getLastToken(e);null==h&&(h=e),l+=s,l>n?(this.lineEndBefore(e),this.noLineEndAfter(h),a=this.indenter.calcIndent(e),l=s+this.indenter.calcAbsoluteIndent(a)):this.noLineEndAfter(h),o&&(o=!1,this.noLineEndBefore(e))}}calcLineLength(e){let t=this.indenter.calcIndent(e);return super.calcLineLength(e)+this.indenter.calcAbsoluteIndent(t)}hasEmptyFunctionBody(e){if(10==e.getLastChild().tok._hx_index)return!0;let t=e.nextSibling;if(null==t)return!0;for(12==t.tok._hx_index&&(t=t.nextSibling);null!=t&&23==t.tok._hx_index;)t=t.nextSibling;if(null==t)return!0;switch(t.tok._hx_index){case 10:return!0;case 18:let e=t.getFirstChild();return null!=e&&19==e.tok._hx_index;default:return!1}}makeWrappableItems(e){let t=[],n=-1;if(null==e.children)return t;let r=0,i=e.children;for(;r<i.length;){let e=i[r];++r;let s=e.tok;switch(s._hx_index){case 6:if(7==s.op._hx_index)return t;break;case 17:case 19:case 21:return t}if(e.index<=n)continue;let a=this.findItemEnd(e);if(null==a)continue;n=a.index;let l=this.isSameLineBetween(e,a,!1),o=this.calcLengthUntilNewline(e,a);this.isMultilineToken(a)&&(l=!1);let c=0;l||(c=this.calcLineLengthAfter(a)),t.push({first:e,last:a,multiline:!l,firstLineLength:o,lastLineLength:c})}return t}findItemEnd(e){let t=fa.getLastToken(e);if(null==t)return null;if(t.index==e.index)switch(e.tok._hx_index){case 7:let t=e.nextSibling;if(null!=t)return this.findItemEnd(t);break;case 8:let n=e.nextSibling;if(null!=n)return this.findItemEnd(n)}if(15==t.tok._hx_index){let e=this.getNextToken(t);if(null==e)return t;switch(e.token.tok._hx_index){case 7:case 8:if(this.parsedCode.isOriginalSameLine(t,e.token))return e.token}return t}let n=this.getNextToken(t);if(null==n)return t;let r=n.token.tok;switch(r._hx_index){case 6:return 7==r.op._hx_index&&null!=sa.matches(sa.parent(n.token),oa.Binop(ht.OpLt))?t:this.findItemEnd(n.token);case 7:case 8:return this.findItemEnd(n.token)}return t}determineWrapType2(e,t,n){let r=n.length;if(n.length<=0)return{conditions:[],type:e.defaultWrap,location:e.defaultLocation,additionalIndent:e.defaultAdditionalIndent};let i=9999,s=0,a=0,l=this.calcLineLength(t),o=!1,c=!0,u=-1,h=0,d=0;for(;d<n.length;){let e=n[d];++d,++h,a+=e.firstLineLength+e.lastLineLength,e.multiline&&(o=!0);let t=Math.floor(Math.max(e.firstLineLength,e.lastLineLength));if(t<i&&(i=t),t>s&&(s=t),u<0)u=t;else if(u!=t){if(h==n.length&&t+2==u)continue;c=!1}}let p=0,f=e.rules;for(;p<f.length;){let e=f[p];if(++p,this.matchesRule(e,r,i,s,a,l,o,c))return e}return{conditions:[],type:e.defaultWrap,location:e.defaultLocation,additionalIndent:e.defaultAdditionalIndent}}determineWrapType(e,t,n,r,i,s){let a=0,l=e.rules;for(;a<l.length;){let e=l[a];if(++a,this.matchesRule(e,t,n,r,i,s,!1,!1))return e}return{conditions:[],type:e.defaultWrap,location:e.defaultLocation,additionalIndent:e.defaultAdditionalIndent}}matchesRule(e,t,n,r,i,s,a,l){let o=0,c=e.conditions;for(;o<c.length;){let e=c[o];switch(++o,e.cond){case"allItemLengths <= n":if(r>e.value)return!1;break;case"allItemLengths >= n":if(n<e.value)return!1;break;case"anyItemLength <= n":if(n>e.value)return!1;break;case"anyItemLength >= n":if(r<e.value)return!1;break;case"equalItemLengths":if(1==e.value){if(!l)return!1}else if(l)return!1;break;case"exceedsMaxLineLength":if(1==e.value){if(s<=this.config.wrapping.maxLineLength)return!1}else if(s>this.config.wrapping.maxLineLength)return!1;break;case"hasMultilineItems":if(1==e.value){if(!a)return!1}else if(a)return!1;break;case"itemCount <= n":if(t>e.value)return!1;break;case"itemCount >= n":if(t<e.value)return!1;break;case"lineLength <= n":if(s>e.value)return!1;break;case"lineLength >= n":if(s<e.value)return!1;break;case"totalItemLength <= n":if(i>e.value)return!1;break;case"totalItemLength >= n":if(i<e.value)return!1}}return!0}applyRule(e,t,n,r,i,s,a){let l="afterLast";switch(null!=t.location&&(l=t.location),t.type){case"equalNumber":break;case"fillLine":switch(l){case"afterLast":this.wrapFillLine2AfterLast(n,r,i,this.config.wrapping.maxLineLength,s,a);break;case"beforeLast":this.wrapFillLine2BeforeLast(n,r,i,this.config.wrapping.maxLineLength,s,a)}break;case"fillLineWithLeadingBreak":switch(l){case"afterLast":this.wrapFillLineWithLeading2AfterLast(n,r,i,this.config.wrapping.maxLineLength,s);break;case"beforeLast":this.wrapFillLine2BeforeLast(n,r,i,this.config.wrapping.maxLineLength,s,a)}break;case"keep":this.keep2(n,r,i,s,l);break;case"noWrap":this.noWrappingBetween(n,r,!1);break;case"onePerLine":this.wrapChildOneLineEach2(n,r,i,s,l);break;case"onePerLineAfterFirst":this.wrapChildOneLineEach2(n,r,i,s,l,!0)}}applyWrappingQueue(){let e=0,t=this.wrappingQueue;for(;e<t.length;)this.applyWrappingPlace(t[e++])}applyWrappingPlace(e){let t=this.determineWrapType2(e.rules,e.start,e.items),n=t.additionalIndent;null!=e.overrideAdditionalIndent&&(n=e.overrideAdditionalIndent),this.applyRule(e.origin,t,e.start,e.end,e.items,n,e.useTrailing)}queueWrapping(e,t){if(null==e.items||e.items.length<=0)return;let n=this.getPlaceStartIndex(e),r=this.getPlaceEndIndex(e);if(n<0||r<0)return;let i=0,s=this.wrappingQueue.length;for(;i<s;){let t=i++,s=this.wrappingQueue[t],a=this.getPlaceStartIndex(s);if(!(n>a)){if(n!=a)return void this.wrappingQueue.splice(t,0,e);if(r>this.getPlaceEndIndex(s))return void this.wrappingQueue.splice(t,0,e)}}this.wrappingQueue.push(e)}getPlaceStartIndex(e){return null==e.items||e.items.length<=0?-1:null!=e.start?e.start.index:e.items[0].first.index}getPlaceEndIndex(e){return null==e.items||e.items.length<=0?-1:null!=e.end?e.end.index:e.items[e.items.length-1].last.index}}Oe.__name__="formatter.marker.wrapping.MarkWrappingBase",Oe.__super__=ve,Object.assign(Oe.prototype,{__class__:Oe});class Ee extends Oe{constructor(e,t,n){super(e,t,n)}run(){let e=this,t=this.parsedCode.root.filterCallback((function(t,n){let r=t.tok;switch(r._hx_index){case 6:switch(r.op._hx_index){case 0:case 9:case 22:return ia.FoundGoDeeper}break;case 8:case 11:case 14:case 16:case 18:case 20:return ia.FoundGoDeeper;case 15:return e.wrapAfter(t,!0),ia.GoDeeper}return ia.GoDeeper}));t.reverse();let n=0;for(;n<t.length;){let e=t[n];++n;let r=e.tok;switch(r._hx_index){case 6:switch(r.op._hx_index){case 0:case 22:this.wrapAfter(e,!0);break;case 9:fa.isTypeParameter(e)&&this.wrapTypeParameter(e)}break;case 8:this.wrapBefore(e,!1);break;case 11:break;case 14:this.wrapAfter(e,!0);break;case 16:this.arrayWrapping(e);break;case 18:this.markBrWrapping(e);break;case 20:this.markPWrapping(e)}}this.markMethodChaining(this.parsedCode.root),this.markMultiVarChaining(),this.markImplementsExtendsChaining(),this.markOpBoolChaining(),this.markOpAddChaining(),this.markCasePatternChaining(),this.applyWrappingQueue()}wrapTypeParameter(e){sa.firstOf(e,oa.Binop(ht.OpGt)),null==e.children||e.children.length<=0||this.queueWrapping({origin:De.TypeParameterWrapping,start:e,end:null,items:this.makeWrappableItems(e),rules:this.config.wrapping.typeParameter,useTrailing:!0,overrideAdditionalIndent:null},"wrapTypeParameter")}markBrWrapping(e){switch(fa.getBrOpenType(e)._hx_index){case 0:case 4:break;case 1:this.typedefWrapping(e);break;case 2:this.objectLiteralWrapping(e);break;case 3:this.anonTypeWrapping(e)}}typedefWrapping(e){let t=this.getCloseToken(e);this.isNewLineBefore(e)||this.parsedCode.isOriginalSameLine(e,t)&&this.noWrap(e,t)}anonTypeWrapping(e){let t=this.getCloseToken(e);if(null==e.children||e.children.length<=0)return;if(e.index+1==t.index)return this.whitespace(e,"noneAfter"),void this.whitespace(t,"noneBefore");let n=this.getNextToken(t);if(null!=n){let e=n.token.tok;switch(e._hx_index){case 1:this.lineEndAfter(t);break;case 2:let n=e.c;if(3==n._hx_index)switch(n.s){case"from":case"to":this.noLineEndAfter(t);break;default:this.lineEndAfter(t)}else this.lineEndAfter(t);break;case 6:7==e.op._hx_index&&this.noLineEndAfter(t);break;case 18:switch(this.config.lineEnds.leftCurly){case"after":case"none":this.noLineEndAfter(t)}}}this.parsedCode.isOriginalSameLine(e,t)?this.applyWrappingPlace({origin:De.AnonTypeWrapping,start:e,end:t,items:this.makeWrappableItems(e),rules:this.config.wrapping.anonType,useTrailing:!0,overrideAdditionalIndent:null}):this.wrapChildOneLineEach(e,t,0)}objectLiteralWrapping(e){let t=this.getCloseToken(e);if(null==e.children||e.children.length<=1)return;if(e.index+1==t.index)return this.whitespace(e,"noneAfter"),void this.whitespace(t,"noneBefore");if(!this.parsedCode.isOriginalSameLine(e,t))return void this.wrapChildOneLineEach(e,t,0);let n=9999,r=0,i=0,s=0,a=0,l=e.children;e:for(;a<l.length;){let o=l[a];switch(++a,o.tok._hx_index){case 8:return void this.wrapChildOneLineEach(e,t,0);case 19:break e}let c=this.calcLength(o);i+=c,c>r&&(r=c),c<n&&(n=c),++s}let o=this.calcLineLength(e),c=this.determineWrapType(this.config.wrapping.objectLiteral,s,n,r,i,o);switch(c.type){case"equalNumber":break;case"fillLine":case"fillLineWithLeadingBreak":this.wrapFillLine(e,t,this.config.wrapping.maxLineLength,c.additionalIndent);break;case"keep":this.keep(e,t,c.additionalIndent);break;case"noWrap":this.noWrap(e,t);let n=this.getNextToken(t);if(null!=n)switch(n.token.tok._hx_index){case 12:this.noLineEndAfter(t);break;case 11:case 15:this.whitespace(t,"noneAfter")}let r=this.getPreviousToken(e);if(null!=r)switch(r.token.tok._hx_index){case 1:this.noLineEndBefore(e),this.whitespace(e,"before");break;case 6:case 15:case 20:this.noLineEndBefore(e)}break;case"onePerLine":this.wrapChildOneLineEach(e,t,c.additionalIndent);break;case"onePerLineAfterFirst":this.wrapChildOneLineEach(e,t,c.additionalIndent,!0)}}markPWrapping(e){switch(this.getCloseToken(e),fa.getPOpenType(e)._hx_index){case 0:this.wrapMetadataCallParameter(e);break;case 1:this.wrapFunctionSignature(e);break;case 2:this.wrapCallParameter(e)}}arrayWrapping(e){switch(fa.getBkOpenType(e)._hx_index){case 3:this.mapLiteralWrapping(e);break;case 0:case 1:case 2:case 4:this.arrayLiteralWrapping(e)}}arrayLiteralWrapping(e){let t=this.getCloseToken(e);if(null==e.children||e.children.length<=0)return;let n=this.makeWrappableItems(e),r=[],i=0;for(;i<n.length;){let t=n[i];++i;let s=t.first.tok;switch(s._hx_index){case 1:switch(s.k._hx_index){case 5:case 7:if("keep"==this.config.sameLine.comprehensionFor)return;r.push(t);break;default:r.push(t)}break;case 23:t.firstLineLength>30&&(this.lineEndBefore(e),this.lineEndBefore(t.first));break;default:r.push(t)}}"noMatrixWrap"!=this.config.wrapping.arrayMatrixWrap&&this.tryMatrixWrap(e,t,r)||this.applyWrappingPlace({origin:De.ArrayWrapping,start:e,end:t,items:r,rules:this.config.wrapping.arrayWrap,useTrailing:!0,overrideAdditionalIndent:null})}tryMatrixWrap(e,t,n){let r=null,i=1,s=0,a=0,l=n.length;for(;a<l;){let e=n[a++];if(null!=r){if(e.multiline)return!1;if(this.parsedCode.isOriginalSameLine(r.first,e.first))++i,r=e;else{if(0!=s&&s!=i)return!1;s=i,i=1,r=e}}else r=e}if(s<=1)return!1;if(s!=i)return!1;if(this.lineEndAfter(e),"matrixWrapWithAlign"==this.config.wrapping.arrayMatrixWrap){let e=[],t=0,r=s;for(;t<r;)++t,e.push(0);let i=0,a=n.length;for(;i<a;){let t=i++,r=n[t],a=t%s;r.firstLineLength>e[a]&&(e[a]=r.firstLineLength)}let l=0,o=n.length;for(;l<o;){let t=l++,r=n[t],i=e[t%s];t==n.length-1&&(15==r.last.tok._hx_index?--i:i-=2),r.firstLineLength<i&&this.spacesBefore(r.first,i-r.firstLineLength)}}let o=s-1;for(;o<n.length;)this.lineEndAfter(n[o].last),o+=s;return!0}mapLiteralWrapping(e){let t=this.getCloseToken(e);if(null==e.children||e.children.length<=0)return;let n=this.makeWrappableItems(e),r=[],i=0;for(;i<n.length;){let t=n[i];++i,23==t.first.tok._hx_index?t.firstLineLength>30&&(this.lineEndBefore(e),this.lineEndBefore(t.first)):r.push(t)}this.applyWrappingPlace({origin:De.MapWrapping,start:e,end:t,items:r,rules:this.config.wrapping.mapWrap,useTrailing:!0,overrideAdditionalIndent:null})}calcLineLength(e){return null==e?0:super.calcLineLength(e)}wrapFunctionSignature(e){let t=this.getCloseToken(e);if(null==e.children||e.children.length<=0)return;let n=this.config.wrapping.functionSignature,r=e.parent.tok;1==r._hx_index&&0==r.k._hx_index&&(n=this.config.wrapping.anonFunctionSignature);let i=this.hasEmptyFunctionBody(e),s=this.makeWrappableItems(e),a=null;i&&(a=0),this.queueWrapping({origin:De.FunctionSignatureWrapping,start:e,end:t,items:s,rules:n,useTrailing:!0,overrideAdditionalIndent:a},"wrapFunctionSignature")}wrapCallParameter(e){let t=this.getCloseToken(e);null==e.children||e.children.length<=0||this.queueWrapping({origin:De.CallParameterWrapping,start:e,end:t,items:this.makeWrappableItems(e),rules:this.config.wrapping.callParameter,useTrailing:!0,overrideAdditionalIndent:null},"wrapCallParameter")}wrapMetadataCallParameter(e){let t=this.getCloseToken(e);null==e.children||e.children.length<=0||this.queueWrapping({origin:De.MetadataCallParameterWrapping,start:e,end:t,items:this.makeWrappableItems(e),rules:this.config.wrapping.metadataCallParameter,useTrailing:!1,overrideAdditionalIndent:null},"wrapMetadataCallParameter")}markMethodChaining(e){if(null==e)return;let t=this,n=e.filterCallback((function(e,n){if(11==e.tok._hx_index){let n=t.getPreviousToken(e);e:for(;null!=n;){switch(n.token.tok._hx_index){case 7:case 8:break;case 21:return t.wrapBefore(e,!0),ia.FoundSkipSubtree;default:break e}n=t.getPreviousToken(n.token)}}return ia.GoDeeper})),r=0;for(;r<n.length;){let e=n[r];++r,this.markInternalMethodChaining(e),this.markSingleMethodChain(e)}}markInternalMethodChaining(e){let t=this;e.filterCallback((function(e,n){switch(e.tok._hx_index){case 16:case 18:case 20:t.markMethodChaining(e)}return ia.GoDeeper}))}markSingleMethodChain(e){let t=this,n=e.filterCallback((function(e,n){let r=e.tok;switch(r._hx_index){case 3:if("if"==r.s&&e.hasChildren()){let t=0,n=e.children;for(;t<n.length;)if(n[t++].matches(oa.Dot))return ia.FoundSkipSubtree}break;case 11:let n=t.getPreviousToken(e);e:for(;null!=n;){let e=n.token.tok;switch(e._hx_index){case 3:if("end"!=e.s)break e;break;case 7:case 8:break;case 21:return ia.FoundGoDeeper;default:break e}n=t.getPreviousToken(n.token)}return ia.GoDeeper;case 16:case 18:case 20:return ia.SkipSubtree}return ia.GoDeeper})),r=sa.matches(sa.parent(sa.isCIdent(sa.parent(e))),oa.Dot);null!=r&&(n.unshift(r),e=r);let i=[],s=fa.getLastToken(e),a=this.getPreviousToken(e),l=e.parent;null!=a&&(l=a.token);let o=0,c=n.length;for(;o<c;){let e=o++,t=n[e],r=s;e+1<n.length&&(a=this.getPreviousToken(n[e+1]),null!=a&&(r=a.token)),i.push(this.makeWrappableItem(t,r))}s=null,null!=l&&(s=this.getCloseToken(l)),this.queueWrapping({origin:De.MethodChainWrapping,start:l,end:s,items:i,rules:this.config.wrapping.methodChain,useTrailing:!1,overrideAdditionalIndent:null},"markSingleMethodChain")}markOpBoolChaining(){let e=this.parsedCode.root.filterCallback((function(e,t){if(!e.hasChildren())return ia.SkipSubtree;let n=0,r=e.children;for(;n<r.length;){let e=r[n++].tok;if(6==e._hx_index)switch(e.op._hx_index){case 14:case 15:return ia.FoundGoDeeper}}return ia.GoDeeper})),t=0;for(;t<e.length;)this.markSingleOpBoolChain(e[t++])}markSingleOpBoolChain(e){let t=[],n=e;6==e.tok._hx_index&&null!=e.previousSibling&&(n=e.previousSibling);let r=this.getPreviousToken(n),i=e;null!=r&&(i=r.token);let s=e.getLastChild();if(null!=s)switch(s=fa.getLastToken(s),s.tok._hx_index){case 10:case 15:case 21:break;default:let e=this.getNextToken(s);null!=e&&(s=e.token)}let a=!0;if(null!=e.children){let r=0,i=e.children;for(;r<i.length;){let s=i[r];++r;let l=s.tok;if(6==l._hx_index)switch(l.op._hx_index){case 14:case 15:a&&(e=n,a=!1),t.push(this.makeWrappableItem(e,s));let r=this.getNextToken(s);if(null==r)return;e=r.token;break;default:continue}}}t.push(this.makeWrappableItem(e,fa.getLastToken(e))),this.queueWrapping({origin:De.OpBoolChainWrapping,start:i,end:s,items:t,rules:this.config.wrapping.opBoolChain,useTrailing:!1,overrideAdditionalIndent:null},"markSingleOpBoolChain")}markCasePatternChaining(){let e=this.parsedCode.root.filterCallback((function(e,t){let n=e.tok;return 1==n._hx_index&&15==n.k._hx_index?ia.FoundGoDeeper:ia.GoDeeper})),t=0;for(;t<e.length;)this.markSingleCasePatternChain(e[t++])}markSingleCasePatternChain(e){let t=[],n=sa.firstOf(e,oa.DblDot);if(null!=this.getNextToken(e)){if(null!=e.children){let n=0,r=e.children;for(;n<r.length;){let e=r[n];if(++n,12==e.tok._hx_index)break;t.push(this.makeWrappableItem(e,fa.getLastToken(e)))}}this.queueWrapping({origin:De.CasePatternWrapping,start:e,end:n,items:t,rules:this.config.wrapping.casePattern,useTrailing:!1,overrideAdditionalIndent:null},"markSingleCasePatternChain")}}markOpAddChaining(){let e=this.parsedCode.root.filterCallback((function(e,t){if(!e.hasChildren())return ia.SkipSubtree;let n=0,r=e.children;for(;n<r.length;){let e=r[n++].tok;if(6==e._hx_index)switch(e.op._hx_index){case 0:case 3:return ia.FoundGoDeeper}}return ia.GoDeeper})),t=0;for(;t<e.length;)this.markSingleOpAddChain(e[t++])}markSingleOpAddChain(e){let t=[];this.getPreviousToken(this.findOpAddItemStart(e));let n=this.findOpAddItemStart(e),r=e.getLastChild();if(20==n.tok._hx_index&&0===fa.getPOpenType(n)._hx_index)return;if(null!=r)switch(r=fa.getLastToken(r),r.tok._hx_index){case 10:case 15:break;default:this.getNextToken(r)}let i=this.getNextToken(n);if(null==i)return;let s=i.token;if(null!=e.children){let n=0,r=e.children;for(;n<r.length;){let e=r[n];++n;let i=e.tok;if(6==i._hx_index)switch(i.op._hx_index){case 0:case 3:t.push(this.makeWrappableItem(s,e));let n=this.getNextToken(e);if(null==n)continue;s=n.token;break;default:continue}}}t.push(this.makeWrappableItem(s,fa.getLastToken(s))),this.queueWrapping({origin:De.OpAddChainWrapping,start:n,end:null,items:t,rules:this.config.wrapping.opAddSubChain,useTrailing:!1,overrideAdditionalIndent:null},"markSingleOpAddChain")}findOpAddItemStart(e){if(null==e||e.tok==oa.Root)return e;let t=e;for(;null!=t&&t.tok!=oa.Root;){let n=t.tok;switch(n._hx_index){case 1:switch(n.k._hx_index){case 23:case 29:case 37:break;default:return t}break;case 6:switch(n.op._hx_index){case 4:case 20:return t}break;case 16:let r=sa.firstOf(t,oa.BkClose);if(null==r||r.index>e.index)return t;break;case 18:let i=sa.firstOf(t,oa.BrClose);if(null==i||i.index>e.index)return t;break;case 20:let s=sa.firstOf(t,oa.PClose);if(null==s||s.index>e.index)return t}e=t,t=t.parent}return e}makeWrappableItem(e,t){let n=this.isSameLineBetween(e,t,!1),r=0,i=0;return n?r=this.calcLengthBetween(e,t)+this.calcTokenLength(t):(r=this.calcLengthUntilNewline(e,t),i=this.calcLineLengthBefore(t)+this.calcTokenLength(t)),{first:e,last:t,multiline:!n,firstLineLength:r,lastLineLength:i}}markImplementsExtendsChaining(){let e=this.parsedCode.root.filterCallback((function(e,t){let n=e.tok;if(1!=n._hx_index)return ia.GoDeeper;switch(n.k._hx_index){case 1:case 28:return ia.FoundSkipSubtree;case 26:case 32:case 40:return ia.SkipSubtree;default:return ia.GoDeeper}})),t=0;for(;t<e.length;){let n=[],r=e[t++].filterCallback((function(e,t){let n=e.tok;if(1!=n._hx_index)return ia.GoDeeper;switch(n.k._hx_index){case 0:case 2:return ia.SkipSubtree;case 11:case 12:return ia.FoundSkipSubtree;default:return ia.GoDeeper}})),i=0;for(;i<r.length;){let e=r[i];++i,n.push(this.makeWrappableItem(e,fa.getLastToken(e)))}if(n.length<=0)continue;let s=n[0].first,a=this.getPreviousToken(n[0].first);null!=a&&(s=a.token),this.queueWrapping({origin:De.ImplementsWrapping,start:s,end:n[n.length-1].last,items:n,rules:this.config.wrapping.implementsExtends,useTrailing:!1,overrideAdditionalIndent:null},"markImplementsExtendsChaining")}}markMultiVarChaining(){let e=this.parsedCode.root.filterCallback((function(e,t){let n=e.tok;return 1==n._hx_index&&2==n.k._hx_index?e.hasChildren()&&e.children.length>1?ia.FoundSkipSubtree:ia.SkipSubtree:ia.GoDeeper})),t=0;for(;t<e.length;){let n=e[t];++t;let r=[];if(null==n.children)continue;let i=0,s=n.children;for(;i<s.length;){let e=s[i];++i,r.push(this.makeWrappableItem(e,fa.getLastToken(e)))}r.length<=0||this.queueWrapping({origin:De.MultiVarWrapping,start:n,end:fa.getLastToken(n),items:r,rules:this.config.wrapping.multiVar,useTrailing:!1,overrideAdditionalIndent:null},"markMultiVarChaining")}}}Ee.__name__="formatter.marker.wrapping.MarkWrapping",Ee.__super__=Oe,Object.assign(Ee.prototype,{__class__:Ee});var De=r["formatter.marker.wrapping.WrappingOrigin"]={__ename__:!0,__constructs__:null,AnonTypeWrapping:{_hx_name:"AnonTypeWrapping",_hx_index:0,__enum__:"formatter.marker.wrapping.WrappingOrigin",toString:n},ArrayWrapping:{_hx_name:"ArrayWrapping",_hx_index:1,__enum__:"formatter.marker.wrapping.WrappingOrigin",toString:n},MapWrapping:{_hx_name:"MapWrapping",_hx_index:2,__enum__:"formatter.marker.wrapping.WrappingOrigin",toString:n},CallParameterWrapping:{_hx_name:"CallParameterWrapping",_hx_index:3,__enum__:"formatter.marker.wrapping.WrappingOrigin",toString:n},CasePatternWrapping:{_hx_name:"CasePatternWrapping",_hx_index:4,__enum__:"formatter.marker.wrapping.WrappingOrigin",toString:n},FunctionSignatureWrapping:{_hx_name:"FunctionSignatureWrapping",_hx_index:5,__enum__:"formatter.marker.wrapping.WrappingOrigin",toString:n},ImplementsWrapping:{_hx_name:"ImplementsWrapping",_hx_index:6,__enum__:"formatter.marker.wrapping.WrappingOrigin",toString:n},MetadataCallParameterWrapping:{_hx_name:"MetadataCallParameterWrapping",_hx_index:7,__enum__:"formatter.marker.wrapping.WrappingOrigin",toString:n},MethodChainWrapping:{_hx_name:"MethodChainWrapping",_hx_index:8,__enum__:"formatter.marker.wrapping.WrappingOrigin",toString:n},MultiVarWrapping:{_hx_name:"MultiVarWrapping",_hx_index:9,__enum__:"formatter.marker.wrapping.WrappingOrigin",toString:n},OpAddChainWrapping:{_hx_name:"OpAddChainWrapping",_hx_index:10,__enum__:"formatter.marker.wrapping.WrappingOrigin",toString:n},OpBoolChainWrapping:{_hx_name:"OpBoolChainWrapping",_hx_index:11,__enum__:"formatter.marker.wrapping.WrappingOrigin",toString:n},TypeParameterWrapping:{_hx_name:"TypeParameterWrapping",_hx_index:12,__enum__:"formatter.marker.wrapping.WrappingOrigin",toString:n}};De.__constructs__=[De.AnonTypeWrapping,De.ArrayWrapping,De.MapWrapping,De.CallParameterWrapping,De.CasePatternWrapping,De.FunctionSignatureWrapping,De.ImplementsWrapping,De.MetadataCallParameterWrapping,De.MethodChainWrapping,De.MultiVarWrapping,De.OpAddChainWrapping,De.OpBoolChainWrapping,De.TypeParameterWrapping];var Be=r["haxe.StackItem"]={__ename__:!0,__constructs__:null,CFunction:{_hx_name:"CFunction",_hx_index:0,__enum__:"haxe.StackItem",toString:n},Module:(t=function(e){return{_hx_index:1,m:e,__enum__:"haxe.StackItem",toString:n,__params__:function(){return[this.m]}}},t._hx_name="Module",t),FilePos:(t=function(e,t,r,i){return{_hx_index:2,s:e,file:t,line:r,column:i,__enum__:"haxe.StackItem",toString:n,__params__:function(){return[this.s,this.file,this.line,this.column]}}},t._hx_name="FilePos",t),Method:(t=function(e,t){return{_hx_index:3,classname:e,method:t,__enum__:"haxe.StackItem",toString:n,__params__:function(){return[this.classname,this.method]}}},t._hx_name="Method",t),LocalFunction:(t=function(e){return{_hx_index:4,v:e,__enum__:"haxe.StackItem",toString:n,__params__:function(){return[this.v]}}},t._hx_name="LocalFunction",t)};Be.__constructs__=[Be.CFunction,Be.Module,Be.FilePos,Be.Method,Be.LocalFunction];class Re{static callStack(){return We.toHaxe(We.callStack())}static exceptionStack(e){null==e&&(e=!1);let t=We.toHaxe(We.exceptionStack());return e?t:Re.subtract(t,Re.callStack())}static toString(e){let t=new ie,n=0,r=e;for(;n<r.length;){let e=r[n++];t.b+="\nCalled from ",Re.itemToString(t,e)}return t.b}static subtract(e,t){let n=-1,r=-1;for(;++r<e.length;){let i=0,s=t.length;for(;i<s;)if(Re.equalItems(e[r],t[i++])){if(n<0&&(n=r),++r,r>=e.length)break}else n=-1;if(n>=0)break}return n>=0?e.slice(0,n):e}static equalItems(e,t){if(null==e)return null==t;switch(e._hx_index){case 0:return null!=t&&0==t._hx_index;case 1:return null!=t&&(1==t._hx_index&&e.m==t.m);case 2:return null!=t&&(2==t._hx_index&&(e.file==t.file&&e.line==t.line&&e.column==t.column&&Re.equalItems(e.s,t.s)));case 3:return null!=t&&(3==t._hx_index&&(e.classname==t.classname&&e.method==t.method));case 4:return null!=t&&(4==t._hx_index&&e.v==t.v)}}static itemToString(e,t){switch(t._hx_index){case 0:e.b+="a C function";break;case 1:let n=t.m;e.b=(e.b+="module ")+(null==n?"null":""+n);break;case 2:let r=t.s,i=t.file,s=t.line,a=t.column;null!=r&&(Re.itemToString(e,r),e.b+=" ("),e.b=(e.b+=null==i?"null":""+i)+" line ",e.b+=null==s?"null":""+s,null!=a&&(e.b=(e.b+=" column ")+(null==a?"null":""+a)),null!=r&&(e.b+=")");break;case 3:let l=t.classname,o=t.method;e.b=(e.b+=re.string(null==l?"<unknown>":l))+".",e.b+=null==o?"null":""+o;break;case 4:let c=t.v;e.b=(e.b+="local function #")+(null==c?"null":""+c)}}}class je{}je.__name__="haxe.IMap",je.__isInterface__=!0;class Me extends Error{constructor(e,t,n){super(e),this.message=e,this.__previousException=t,this.__nativeException=null!=n?n:this,this.__skipStack=0;let r=Error.prepareStackTrace;if(Error.prepareStackTrace=function(e){return e.stack},n instanceof Error)this.stack=n.stack;else{let e=null;if(Error.captureStackTrace)Error.captureStackTrace(this,Me),e=this;else if(e=new Error,void 0===e.stack){try{throw e}catch(e){}this.__skipStack++}this.stack=e.stack}Error.prepareStackTrace=r}unwrap(){return this.__nativeException}toString(){return this.get_message()}details(){if(null==this.get_previous()){let e="Exception: "+this.toString(),t=this.get_stack();return e+(null==t?"null":Re.toString(t))}{let e="",t=this,n=null;for(;null!=t;){if(null==n){let n="Exception: "+t.get_message(),r=t.get_stack();e=n+(null==r?"null":Re.toString(r))+e}else{let r=Re.subtract(t.get_stack(),n.get_stack());e="Exception: "+t.get_message()+(null==r?"null":Re.toString(r))+"\n\nNext "+e}n=t,t=t.get_previous()}return e}}__shiftStack(){this.__skipStack++}get_message(){return this.message}get_previous(){return this.__previousException}get_native(){return this.__nativeException}get_stack(){let e=this.__exceptionStack;if(null==e){let e=We.toHaxe(We.normalize(this.stack),this.__skipStack);return this.setProperty("__exceptionStack",e),e}return e}setProperty(e,t){try{Object.defineProperty(this,e,{value:t})}catch(n){this[e]=t}}static caught(e){return e instanceof Me?e:e instanceof Error?new Me(e.message,null,e):new Je(e,null,e)}static thrown(e){if(e instanceof Me)return e.get_native();if(e instanceof Error)return e;{let t=new Je(e);return t.__skipStack++,t}}}Me.__name__="haxe.Exception",Me.__super__=Error,Object.assign(Me.prototype,{__class__:Me});class He{static formatOutput(e,t){let n=re.string(e);if(null==t)return n;let r=t.fileName+":"+t.lineNumber;if(null!=t.customParams){let e=0,r=t.customParams;for(;e<r.length;)n+=", "+re.string(r[e++])}return r+": "+n}static trace(e,t){let n=He.formatOutput(e,t);"undefined"!=typeof console&&null!=console.log&&console.log(n)}}He.__name__="haxe.Log";class We{static saveStack(e){We.lastError=e}static callStack(){let e=new Error(""),t=We.tryHaxeStack(e);if(void 0===t){try{throw e}catch(e){}t=e.stack}return We.normalize(t,2)}static exceptionStack(){return We.normalize(We.tryHaxeStack(We.lastError))}static toHaxe(e,t){if(null==t&&(t=0),null==e)return[];if("string"==typeof e){let n=e.split("\n");"Error"==n[0]&&n.shift();let r=[],i=0,s=n.length;for(;i<s;){let e=i++;if(t>e)continue;let s=n[e],a=s.match(/^    at ([$A-Za-z0-9_. ]+) \(([^)]+):([0-9]+):([0-9]+)\)$/);if(null!=a){let e=a[1].split(".");"$hxClasses"==e[0]&&e.shift();let t=e.pop(),n=a[2],i=re.parseInt(a[3]),s=re.parseInt(a[4]);r.push(Be.FilePos("Anonymous function"==t?Be.LocalFunction():"Global code"==t?null:Be.Method(e.join("."),t),n,i,s))}else r.push(Be.Module(se.trim(s)))}return r}return t>0&&Array.isArray(e)?e.slice(t):e}static tryHaxeStack(e){if(null==e)return[];let t=Error.prepareStackTrace;Error.prepareStackTrace=We.prepareHxStackTrace;let n=e.stack;return Error.prepareStackTrace=t,n}static prepareHxStackTrace(e,t){let n=[],r=0;for(;r<t.length;){let e=t[r];++r,null!=We.wrapCallSite&&(e=We.wrapCallSite(e));let i=null,s=e.getFunctionName();if(null!=s){let e=s.lastIndexOf(".");i=e>=0?Be.Method(s.substring(0,e),s.substring(e+1)):Be.Method(null,s)}let a=e.getFileName(),l=null==a?-1:a.indexOf("file:");null!=We.wrapCallSite&&l>0&&(a=a.substring(l+6)),n.push(Be.FilePos(i,a,e.getLineNumber(),e.getColumnNumber()))}return n}static normalize(e,t){if(null==t&&(t=0),Array.isArray(e)&&t>0)return e.slice(t);if("string"==typeof e){switch(e.substring(0,6)){case"Error\n":case"Error:":++t}return We.skipLines(e,t)}return e}static skipLines(e,t,n){for(null==n&&(n=0);;){if(t>0){if((n=e.indexOf("\n",n))<0)return"";t=--t,n+=1;continue}return e.substring(n)}}}We.__name__="haxe.NativeStackTrace";class Ue{constructor(e){let t=this;this.id=setInterval((function(){t.run()}),e)}stop(){null!=this.id&&(clearInterval(this.id),this.id=null)}run(){}static delay(e,t){let n=new Ue(t);return n.run=function(){n.stop(),e()},n}}Ue.__name__="haxe.Timer",Object.assign(Ue.prototype,{__class__:Ue});class Je extends Me{constructor(e,t,n){super(String(e),t,n),this.value=e,this.__skipStack++}unwrap(){return this.value}}Je.__name__="haxe.ValueException",Je.__super__=Me,Object.assign(Je.prototype,{__class__:Je}),(r["haxe.display.NoData"]={__ename__:!0,__constructs__:null}).__constructs__=[];class Ve{static sort(e,t){Ve.rec(e,t,0,e.length)}static rec(e,t,n,r){let i=n+r>>1;if(r-n<12){if(r<=n)return;let i=n+1;for(;i<r;){let r=i++;for(;r>n&&t(e[r],e[r-1])<0;)Ve.swap(e,r-1,r),--r}}else Ve.rec(e,t,n,i),Ve.rec(e,t,i,r),Ve.doMerge(e,t,n,i,r,i-n,r-i)}static doMerge(e,t,n,r,i,s,a){for(;;){let l,o,c,u;if(0==s||0==a)return;if(s+a==2)return void(t(e[r],e[n])<0&&Ve.swap(e,r,n));s>a?(c=s>>1,l=n+c,o=Ve.lower(e,t,r,i,l),u=o-r):(u=a>>1,o=r+u,l=Ve.upper(e,t,n,r,o),c=l-n),Ve.rotate(e,t,l,r,o);let h=l+u;Ve.doMerge(e,t,n,l,h,c,u),n=h,r=o,s-=c,a-=u}}static rotate(e,t,n,r,i){if(n==r||r==i)return;let s=Ve.gcd(i-n,r-n);for(;0!=s--;){let t=e[n+s],a=r-n,l=n+s,o=n+s+a;for(;o!=n+s;)e[l]=e[o],l=o,i-o>a?o+=a:o=n+(a-(i-o));e[l]=t}}static gcd(e,t){for(;0!=t;){let n=e%t;e=t,t=n}return e}static upper(e,t,n,r,i){let s,a,l=r-n;for(;l>0;)s=l>>1,a=n+s,t(e[i],e[a])<0?l=s:(n=a+1,l=l-s-1);return n}static lower(e,t,n,r,i){let s,a,l=r-n;for(;l>0;)s=l>>1,a=n+s,t(e[a],e[i])<0?(n=a+1,l=l-s-1):l=s;return n}static swap(e,t,n){let r=e[t];e[t]=e[n],e[n]=r}}Ve.__name__="haxe.ds.ArraySort";class Ke{constructor(){}set(e,t){this.root=this.setLoop(e,t,this.root)}get(e){let t=this.root;for(;null!=t;){let n=this.compare(e,t.key);if(0==n)return t.value;t=n<0?t.left:t.right}return null}iterator(){let e=[];return Ke.iteratorLoop(this.root,e),new ct(e)}keys(){let e=[];return this.keysLoop(this.root,e),new ct(e)}setLoop(e,t,n){if(null==n)return new Ge(null,e,t,null);let r=this.compare(e,n.key);if(0==r)return new Ge(n.left,e,t,n.right,null==n?0:n._height);if(r<0)return this.balance(this.setLoop(e,t,n.left),n.key,n.value,n.right);{let r=this.setLoop(e,t,n.right);return this.balance(n.left,n.key,n.value,r)}}keysLoop(e,t){null!=e&&(this.keysLoop(e.left,t),t.push(e.key),this.keysLoop(e.right,t))}balance(e,t,n,r){let i=null==e?0:e._height,s=null==r?0:r._height;if(i>s+2){let i=e.left,s=e.right;return(null==i?0:i._height)>=(null==s?0:s._height)?new Ge(e.left,e.key,e.value,new Ge(e.right,t,n,r)):new Ge(new Ge(e.left,e.key,e.value,e.right.left),e.right.key,e.right.value,new Ge(e.right.right,t,n,r))}if(s>i+2){let i=r.right,s=r.left;return(null==i?0:i._height)>(null==s?0:s._height)?new Ge(new Ge(e,t,n,r.left),r.key,r.value,r.right):new Ge(new Ge(e,t,n,r.left.left),r.left.key,r.left.value,new Ge(r.left.right,r.key,r.value,r.right))}return new Ge(e,t,n,r,(i>s?i:s)+1)}compare(e,t){return ne.compare(e,t)}static iteratorLoop(e,t){for(;;){if(null==e)return;Ke.iteratorLoop(e.left,t),t.push(e.value),e=e.right}}}Ke.__name__="haxe.ds.BalancedTree",Ke.__interfaces__=[je],Object.assign(Ke.prototype,{__class__:Ke});class Ge{constructor(e,t,n,r,i){if(null==i&&(i=-1),this.left=e,this.key=t,this.value=n,this.right=r,-1==i){let e,t=this.left,n=this.right;if((null==t?0:t._height)>(null==n?0:n._height)){let t=this.left;e=null==t?0:t._height}else{let t=this.right;e=null==t?0:t._height}this._height=e+1}else this._height=i}}Ge.__name__="haxe.ds.TreeNode",Object.assign(Ge.prototype,{__class__:Ge});class qe extends Ke{constructor(){super()}compare(e,t){let n=e._hx_index-t._hx_index;if(0!=n)return n;let r=oe.enumParameters(e),i=oe.enumParameters(t);return 0==r.length&&0==i.length?0:this.compareArgs(r,i)}compareArgs(e,t){let n=e.length-t.length;if(0!=n)return n;let r=0,i=e.length;for(;r<i;){let n=r++,i=this.compareArg(e[n],t[n]);if(0!=i)return i}return 0}compareArg(e,t){return ne.isEnumValue(e)&&ne.isEnumValue(t)?this.compare(e,t):e instanceof Array&&t instanceof Array?this.compareArgs(e,t):ne.compare(e,t)}}qe.__name__="haxe.ds.EnumValueMap",qe.__interfaces__=[je],qe.__super__=Ke,Object.assign(qe.prototype,{__class__:qe});class $e{constructor(e,t){this.elt=e,this.next=t}}$e.__name__="haxe.ds.GenericCell",Object.assign($e.prototype,{__class__:$e});class ze{constructor(){}}ze.__name__="haxe.ds.GenericStack",Object.assign(ze.prototype,{__class__:ze});class Qe{constructor(){this.m=new Map}}Qe.__name__="haxe.ds.IntMap",Qe.__interfaces__=[je],Object.assign(Qe.prototype,{__class__:Qe});class Ze{constructor(){this.length=0}push(e){let t=new Xe(e,this.h);this.h=t,null==this.q&&(this.q=t),this.length++}remove(e){let t=null,n=this.h;for(;null!=n;){if(n.item==e)return null==t?this.h=n.next:t.next=n.next,this.q==n&&(this.q=t),this.length--,!0;t=n,n=n.next}return!1}}Ze.__name__="haxe.ds.List",Object.assign(Ze.prototype,{__class__:Ze});class Xe{constructor(e,t){this.item=e,this.next=t}}Xe.__name__="haxe.ds._List.ListNode",Object.assign(Xe.prototype,{__class__:Xe});class Ye{constructor(){this.m=new Map}}Ye.__name__="haxe.ds.ObjectMap",Ye.__interfaces__=[je],Object.assign(Ye.prototype,{__class__:Ye});var et=r["haxe.ds.Option"]={__ename__:!0,__constructs__:null,Some:(t=function(e){return{_hx_index:0,v:e,__enum__:"haxe.ds.Option",toString:n,__params__:function(){return[this.v]}}},t._hx_name="Some",t),None:{_hx_name:"None",_hx_index:1,__enum__:"haxe.ds.Option",toString:n}};et.__constructs__=[et.Some,et.None];class tt{constructor(){this.m=new Map}}tt.__name__="haxe.ds.StringMap",tt.__interfaces__=[je],Object.assign(tt.prototype,{__class__:tt});class nt extends Me{constructor(e,t,n){super(e,t),this.posInfos=null==n?{fileName:"(unknown)",lineNumber:0,className:"(unknown)",methodName:"(unknown)"}:n,this.__skipStack++}toString(){return super.toString()+" in "+this.posInfos.className+"."+this.posInfos.methodName+" at "+this.posInfos.fileName+":"+this.posInfos.lineNumber}}nt.__name__="haxe.exceptions.PosException",nt.__super__=Me,Object.assign(nt.prototype,{__class__:nt});class rt extends nt{constructor(e,t,n){null==e&&(e="Not implemented"),super(e,t,n),this.__skipStack++}}rt.__name__="haxe.exceptions.NotImplementedException",rt.__super__=nt,Object.assign(rt.prototype,{__class__:rt});class it{constructor(e){this.length=e.byteLength,this.b=new Uint8Array(e),this.b.bufferValue=e,e.hxBytes=this,e.bytes=this.b}sub(e,t){if(e<0||t<0||e+t>this.length)throw Me.thrown(lt.OutsideBounds);return new it(this.b.buffer.slice(e+this.b.byteOffset,e+this.b.byteOffset+t))}getString(e,t,n){if(e<0||t<0||e+t>this.length)throw Me.thrown(lt.OutsideBounds);null==n&&(n=st.UTF8);let r="",i=this.b,s=e,a=e+t;switch(n._hx_index){case 0:for(;s<a;){let e=i[s++];if(e<128){if(0==e)break;r+=String.fromCodePoint(e)}else if(e<224){let t=(63&e)<<6|127&i[s++];r+=String.fromCodePoint(t)}else if(e<240){let t=(31&e)<<12|(127&i[s++])<<6|127&i[s++];r+=String.fromCodePoint(t)}else{let t=(15&e)<<18|(127&i[s++])<<12|(127&i[s++])<<6|127&i[s++];r+=String.fromCodePoint(t)}}break;case 1:for(;s<a;){let e=i[s++]|i[s++]<<8;r+=String.fromCodePoint(e)}}return r}toString(){return this.getString(0,this.length)}static ofString(e,t){if(t==st.RawNative){let t=new Uint8Array(e.length<<1),n=0,r=e.length;for(;n<r;){let r=n++,i=e.charCodeAt(r);t[r<<1]=255&i,t[r<<1|1]=i>>8}return new it(t.buffer)}let n=[],r=0;for(;r<e.length;){let t=e.charCodeAt(r++);55296<=t&&t<=56319&&(t=t-55232<<10|1023&e.charCodeAt(r++)),t<=127?n.push(t):t<=2047?(n.push(192|t>>6),n.push(128|63&t)):t<=65535?(n.push(224|t>>12),n.push(128|t>>6&63),n.push(128|63&t)):(n.push(240|t>>18),n.push(128|t>>12&63),n.push(128|t>>6&63),n.push(128|63&t))}return new it(new Uint8Array(n).buffer)}}it.__name__="haxe.io.Bytes",Object.assign(it.prototype,{__class__:it});var st=r["haxe.io.Encoding"]={__ename__:!0,__constructs__:null,UTF8:{_hx_name:"UTF8",_hx_index:0,__enum__:"haxe.io.Encoding",toString:n},RawNative:{_hx_name:"RawNative",_hx_index:1,__enum__:"haxe.io.Encoding",toString:n}};st.__constructs__=[st.UTF8,st.RawNative];class at{constructor(){}toString(){return"Eof"}}at.__name__="haxe.io.Eof",Object.assign(at.prototype,{__class__:at});var lt=r["haxe.io.Error"]={__ename__:!0,__constructs__:null,Blocked:{_hx_name:"Blocked",_hx_index:0,__enum__:"haxe.io.Error",toString:n},Overflow:{_hx_name:"Overflow",_hx_index:1,__enum__:"haxe.io.Error",toString:n},OutsideBounds:{_hx_name:"OutsideBounds",_hx_index:2,__enum__:"haxe.io.Error",toString:n},Custom:(t=function(e){return{_hx_index:3,e:e,__enum__:"haxe.io.Error",toString:n,__params__:function(){return[this.e]}}},t._hx_name="Custom",t)};lt.__constructs__=[lt.Blocked,lt.Overflow,lt.OutsideBounds,lt.Custom];class ot{constructor(e){switch(e){case".":case"..":return this.dir=e,void(this.file="")}let t=e.lastIndexOf("/"),n=e.lastIndexOf("\\");t<n?(this.dir=a.substr(e,0,n),e=a.substr(e,n+1,null),this.backslash=!0):n<t?(this.dir=a.substr(e,0,t),e=a.substr(e,t+1,null)):this.dir=null;let r=e.lastIndexOf(".");-1!=r?(this.ext=a.substr(e,r+1,null),this.file=a.substr(e,0,r)):(this.ext=null,this.file=e)}toString(){return(null==this.dir?"":this.dir+(this.backslash?"\\":"/"))+this.file+(null==this.ext?"":"."+this.ext)}static withoutDirectory(e){let t=new ot(e);return t.dir=null,t.toString()}static directory(e){let t=new ot(e);return null==t.dir?"":t.dir}static join(e){let t=[],n=0;for(;n<e.length;){let r=e[n];++n,null!=r&&""!=r&&t.push(r)}if(0==t.length)return"";let r=t[0],i=1,s=t.length;for(;i<s;)r=ot.addTrailingSlash(r),r+=t[i++];return ot.normalize(r)}static normalize(e){let t="/";if((e=e.split("\\").join(t))==t)return t;let n=[],r=0,i=e.split(t);for(;r<i.length;){let t=i[r];++r,".."==t&&n.length>0&&".."!=n[n.length-1]?n.pop():""==t?(n.length>0||47==a.cca(e,0))&&n.push(t):"."!=t&&n.push(t)}let s="",l=!1,o=!1,c=0,u=n.join(t);for(;c<u.length;){let e=u,t=c++,n=e.charCodeAt(t);n>=55296&&n<=56319&&(n=n-55232<<10|1023&e.charCodeAt(t+1));n>=65536&&++c;let r=n;switch(r){case 47:if(l){let e=r;l=!1,o&&(s+="/",o=!1),s+=String.fromCodePoint(e)}else o=!0;break;case 58:s+=":",l=!0;break;default:let e=r;l=!1,o&&(s+="/",o=!1),s+=String.fromCodePoint(e)}}return s}static addTrailingSlash(e){if(0==e.length)return"/";let t=e.lastIndexOf("/"),n=e.lastIndexOf("\\");return t<n?n!=e.length-1?e+"\\":e:t!=e.length-1?e+"/":e}static removeTrailingSlashes(e){e:for(;;){let t=a.cca(e,e.length-1);if(null==t)break;switch(t){case 47:case 92:e=a.substr(e,0,-1);break;default:break e}}return e}static isAbsolute(e){return!!e.startsWith("/")||(":"==e.charAt(1)||!!e.startsWith("\\\\"))}}ot.__name__="haxe.io.Path",Object.assign(ot.prototype,{__class__:ot});class ct{constructor(e){this.current=0,this.array=e}hasNext(){return this.current<this.array.length}next(){return this.array[this.current++]}}ct.__name__="haxe.iterators.ArrayIterator",Object.assign(ct.prototype,{__class__:ct});var ut=r["haxe.macro.StringLiteralKind"]={__ename__:!0,__constructs__:null,DoubleQuotes:{_hx_name:"DoubleQuotes",_hx_index:0,__enum__:"haxe.macro.StringLiteralKind",toString:n},SingleQuotes:{_hx_name:"SingleQuotes",_hx_index:1,__enum__:"haxe.macro.StringLiteralKind",toString:n}};ut.__constructs__=[ut.DoubleQuotes,ut.SingleQuotes];var ht=r["haxe.macro.Binop"]={__ename__:!0,__constructs__:null,OpAdd:{_hx_name:"OpAdd",_hx_index:0,__enum__:"haxe.macro.Binop",toString:n},OpMult:{_hx_name:"OpMult",_hx_index:1,__enum__:"haxe.macro.Binop",toString:n},OpDiv:{_hx_name:"OpDiv",_hx_index:2,__enum__:"haxe.macro.Binop",toString:n},OpSub:{_hx_name:"OpSub",_hx_index:3,__enum__:"haxe.macro.Binop",toString:n},OpAssign:{_hx_name:"OpAssign",_hx_index:4,__enum__:"haxe.macro.Binop",toString:n},OpEq:{_hx_name:"OpEq",_hx_index:5,__enum__:"haxe.macro.Binop",toString:n},OpNotEq:{_hx_name:"OpNotEq",_hx_index:6,__enum__:"haxe.macro.Binop",toString:n},OpGt:{_hx_name:"OpGt",_hx_index:7,__enum__:"haxe.macro.Binop",toString:n},OpGte:{_hx_name:"OpGte",_hx_index:8,__enum__:"haxe.macro.Binop",toString:n},OpLt:{_hx_name:"OpLt",_hx_index:9,__enum__:"haxe.macro.Binop",toString:n},OpLte:{_hx_name:"OpLte",_hx_index:10,__enum__:"haxe.macro.Binop",toString:n},OpAnd:{_hx_name:"OpAnd",_hx_index:11,__enum__:"haxe.macro.Binop",toString:n},OpOr:{_hx_name:"OpOr",_hx_index:12,__enum__:"haxe.macro.Binop",toString:n},OpXor:{_hx_name:"OpXor",_hx_index:13,__enum__:"haxe.macro.Binop",toString:n},OpBoolAnd:{_hx_name:"OpBoolAnd",_hx_index:14,__enum__:"haxe.macro.Binop",toString:n},OpBoolOr:{_hx_name:"OpBoolOr",_hx_index:15,__enum__:"haxe.macro.Binop",toString:n},OpShl:{_hx_name:"OpShl",_hx_index:16,__enum__:"haxe.macro.Binop",toString:n},OpShr:{_hx_name:"OpShr",_hx_index:17,__enum__:"haxe.macro.Binop",toString:n},OpUShr:{_hx_name:"OpUShr",_hx_index:18,__enum__:"haxe.macro.Binop",toString:n},OpMod:{_hx_name:"OpMod",_hx_index:19,__enum__:"haxe.macro.Binop",toString:n},OpAssignOp:(t=function(e){return{_hx_index:20,op:e,__enum__:"haxe.macro.Binop",toString:n,__params__:function(){return[this.op]}}},t._hx_name="OpAssignOp",t),OpInterval:{_hx_name:"OpInterval",_hx_index:21,__enum__:"haxe.macro.Binop",toString:n},OpArrow:{_hx_name:"OpArrow",_hx_index:22,__enum__:"haxe.macro.Binop",toString:n},OpIn:{_hx_name:"OpIn",_hx_index:23,__enum__:"haxe.macro.Binop",toString:n},OpNullCoal:{_hx_name:"OpNullCoal",_hx_index:24,__enum__:"haxe.macro.Binop",toString:n}};ht.__constructs__=[ht.OpAdd,ht.OpMult,ht.OpDiv,ht.OpSub,ht.OpAssign,ht.OpEq,ht.OpNotEq,ht.OpGt,ht.OpGte,ht.OpLt,ht.OpLte,ht.OpAnd,ht.OpOr,ht.OpXor,ht.OpBoolAnd,ht.OpBoolOr,ht.OpShl,ht.OpShr,ht.OpUShr,ht.OpMod,ht.OpAssignOp,ht.OpInterval,ht.OpArrow,ht.OpIn,ht.OpNullCoal];var dt=r["haxe.macro.Unop"]={__ename__:!0,__constructs__:null,OpIncrement:{_hx_name:"OpIncrement",_hx_index:0,__enum__:"haxe.macro.Unop",toString:n},OpDecrement:{_hx_name:"OpDecrement",_hx_index:1,__enum__:"haxe.macro.Unop",toString:n},OpNot:{_hx_name:"OpNot",_hx_index:2,__enum__:"haxe.macro.Unop",toString:n},OpNeg:{_hx_name:"OpNeg",_hx_index:3,__enum__:"haxe.macro.Unop",toString:n},OpNegBits:{_hx_name:"OpNegBits",_hx_index:4,__enum__:"haxe.macro.Unop",toString:n},OpSpread:{_hx_name:"OpSpread",_hx_index:5,__enum__:"haxe.macro.Unop",toString:n}};dt.__constructs__=[dt.OpIncrement,dt.OpDecrement,dt.OpNot,dt.OpNeg,dt.OpNegBits,dt.OpSpread];class pt{constructor(e){null==e&&(e="\t"),this.tabs="",this.tabString=e}printUnop(e){switch(e._hx_index){case 0:return"++";case 1:return"--";case 2:return"!";case 3:return"-";case 4:return"~";case 5:return"..."}}printBinop(e){switch(e._hx_index){case 0:return"+";case 1:return"*";case 2:return"/";case 3:return"-";case 4:return"=";case 5:return"==";case 6:return"!=";case 7:return">";case 8:return">=";case 9:return"<";case 10:return"<=";case 11:return"&";case 12:return"|";case 13:return"^";case 14:return"&&";case 15:return"||";case 16:return"<<";case 17:return">>";case 18:return">>>";case 19:return"%";case 20:return re.string(this.printBinop(e.op))+"=";case 21:return"...";case 22:return"=>";case 23:return"in";case 24:return"??"}}}pt.__name__="haxe.macro.Printer",Object.assign(pt.prototype,{__class__:pt});class ft{constructor(e,t,n){this.xml=t,this.message=e,this.position=n,this.lineNumber=1,this.positionAtLine=0;let r=0;for(;r<n;){let e=t.charCodeAt(r++);10==e?(this.lineNumber++,this.positionAtLine=0):13!=e&&this.positionAtLine++}}toString(){return Yn.getClass(this).__name__+": "+this.message+" at line "+this.lineNumber+" char "+this.positionAtLine}}ft.__name__="haxe.xml.XmlParserException",Object.assign(ft.prototype,{__class__:ft});class mt{static parse(e,t){null==t&&(t=!1);let n=ue.createDocument();return mt.doParse(e,t,0,n),n}static doParse(e,t,n,r){null==n&&(n=0);let i=null,s=1,l=1,o=null,c=0,u=0,h=0,d=new ie,p=1,f=-1;for(;n<e.length;){let m=e.charCodeAt(n);switch(s){case 0:switch(m){case 9:case 10:case 13:case 32:break;default:s=l;continue}break;case 1:if(60!=m){c=n,s=13;continue}s=0,l=2;break;case 2:switch(m){case 33:if(91==e.charCodeAt(n+1)){if(n+=2,"CDATA["!=a.substr(e,n,6).toUpperCase())throw Me.thrown(new ft("Expected <![CDATA[",e,n));s=17,c=(n+=5)+1}else if(68==e.charCodeAt(n+1)||100==e.charCodeAt(n+1)){if("OCTYPE"!=a.substr(e,n+2,6).toUpperCase())throw Me.thrown(new ft("Expected <!DOCTYPE",e,n));s=16,c=(n+=8)+1}else{if(45!=e.charCodeAt(n+1)||45!=e.charCodeAt(n+2))throw Me.thrown(new ft("Expected \x3c!--",e,n));s=15,c=(n+=2)+1}break;case 47:if(null==r)throw Me.thrown(new ft("Expected node name",e,n));c=n+1,s=0,l=10;break;case 63:s=14,c=n;break;default:s=3,c=n;continue}break;case 3:if(!(m>=97&&m<=122||m>=65&&m<=90||m>=48&&m<=57||58==m||46==m||95==m||45==m)){if(n==c)throw Me.thrown(new ft("Expected node name",e,n));i=ue.createElement(a.substr(e,c,n-c)),r.addChild(i),++u,s=0,l=4;continue}break;case 4:switch(m){case 47:s=11;break;case 62:s=9;break;default:s=5,c=n;continue}break;case 5:if(!(m>=97&&m<=122||m>=65&&m<=90||m>=48&&m<=57||58==m||46==m||95==m||45==m)){if(c==n)throw Me.thrown(new ft("Expected attribute name",e,n));if(o=a.substr(e,c,n-c),i.exists(o))throw Me.thrown(new ft("Duplicate attribute ["+o+"]",e,n));s=0,l=6;continue}break;case 6:if(61!=m)throw Me.thrown(new ft("Expected =",e,n));s=0,l=7;break;case 7:switch(m){case 34:case 39:d=new ie,s=8,c=n+1,f=m;break;default:throw Me.thrown(new ft('Expected "',e,n))}break;case 8:switch(m){case 38:let r=n-c;d.b+=null==r?a.substr(e,c,null):a.substr(e,c,r),s=18,p=8,c=n+1;break;case 60:case 62:if(t)throw Me.thrown(new ft("Invalid unescaped "+String.fromCodePoint(m)+" in attribute value",e,n));if(m==f){let t=n-c;d.b+=null==t?a.substr(e,c,null):a.substr(e,c,t);let r=d.b;d=new ie,i.set(o,r),s=0,l=4}break;default:if(m==f){let t=n-c;d.b+=null==t?a.substr(e,c,null):a.substr(e,c,t);let r=d.b;d=new ie,i.set(o,r),s=0,l=4}}break;case 9:c=n=mt.doParse(e,t,n,i),s=1;break;case 10:if(!(m>=97&&m<=122||m>=65&&m<=90||m>=48&&m<=57||58==m||46==m||95==m||45==m)){if(c==n)throw Me.thrown(new ft("Expected node name",e,n));let t=a.substr(e,c,n-c);if(null==r||0!=r.nodeType)throw Me.thrown(new ft("Unexpected </"+t+">, tag is not open",e,n));if(r.nodeType!=ue.Element)throw Me.thrown("Bad node type, expected Element but found "+(null==r.nodeType?"null":ce.toString(r.nodeType)));if(t!=r.nodeName){if(r.nodeType!=ue.Element)throw Me.thrown("Bad node type, expected Element but found "+(null==r.nodeType?"null":ce.toString(r.nodeType)));throw Me.thrown(new ft("Expected </"+r.nodeName+">",e,n))}s=0,l=12;continue}break;case 11:if(62!=m)throw Me.thrown(new ft("Expected >",e,n));s=1;break;case 12:if(62==m)return 0==u&&r.addChild(ue.createPCData("")),n;throw Me.thrown(new ft("Expected >",e,n));case 13:if(60==m){let t=n-c;d.b+=null==t?a.substr(e,c,null):a.substr(e,c,t);let i=ue.createPCData(d.b);d=new ie,r.addChild(i),++u,s=0,l=2}else if(38==m){let t=n-c;d.b+=null==t?a.substr(e,c,null):a.substr(e,c,t),s=18,p=13,c=n+1}break;case 14:63==m&&62==e.charCodeAt(n+1)&&(++n,r.addChild(ue.createProcessingInstruction(a.substr(e,c+1,n-c-2))),++u,s=1);break;case 15:45==m&&45==e.charCodeAt(n+1)&&62==e.charCodeAt(n+2)&&(r.addChild(ue.createComment(a.substr(e,c,n-c))),++u,n+=2,s=1);break;case 16:91==m?++h:93==m?--h:62==m&&0==h&&(r.addChild(ue.createDocType(a.substr(e,c,n-c))),++u,s=1);break;case 17:93==m&&93==e.charCodeAt(n+1)&&62==e.charCodeAt(n+2)&&(r.addChild(ue.createCData(a.substr(e,c,n-c))),++u,n+=2,s=1);break;case 18:if(59==m){let r=a.substr(e,c,n-c).toLowerCase();if(35==r.charCodeAt(0)){let e=120==r.charCodeAt(1)?re.parseInt("0"+a.substr(r,1,r.length-1)):re.parseInt(a.substr(r,1,r.length-1));d.b+=String.fromCodePoint(e)}else if(mt.escapes.m.has(r))d.b+=re.string(mt.escapes.m.get(r));else{if(t)throw Me.thrown(new ft("Undefined entity: "+r,e,n));d.b+=re.string("&"+r+";")}c=n+1,s=p}else if(!(m>=97&&m<=122||m>=65&&m<=90||m>=48&&m<=57||58==m||46==m||95==m||45==m)&&35!=m){if(t)throw Me.thrown(new ft("Invalid character in entity: "+String.fromCodePoint(m),e,n));d.b+=String.fromCodePoint(38);let r=n-c;d.b+=null==r?a.substr(e,c,null):a.substr(e,c,r),c=--n+1,s=p}}++n}if(1==s&&(c=n,s=13),13==s){if(0==r.nodeType){if(r.nodeType!=ue.Element)throw Me.thrown("Bad node type, expected Element but found "+(null==r.nodeType?"null":ce.toString(r.nodeType)));throw Me.thrown(new ft("Unclosed node <"+r.nodeName+">",e,n))}if(n!=c){let t=n-c;d.b+=null==t?a.substr(e,c,null):a.substr(e,c,t)}return(d.b.length>0||0==u)&&(r.addChild(ue.createPCData(d.b)),++u),n}if(!t&&18==s&&13==p){d.b+=String.fromCodePoint(38);let t=n-c;return d.b+=null==t?a.substr(e,c,null):a.substr(e,c,t),r.addChild(ue.createPCData(d.b)),++u,n}throw Me.thrown(new ft("Unexpected end",e,n))}}mt.__name__="haxe.xml.Parser";class _t{constructor(e){this.output=new ie,this.pretty=e}writeNode(e,t){switch(e.nodeType){case 0:if(this.output.b+=re.string(t+"<"),e.nodeType!=ue.Element)throw Me.thrown("Bad node type, expected Element but found "+(null==e.nodeType?"null":ce.toString(e.nodeType)));this.output.b+=re.string(e.nodeName);let n=e.attributes();for(;n.hasNext();){let t=n.next();this.output.b+=re.string(" "+t+'="');let r=se.htmlEscape(e.get(t),!0);this.output.b+=re.string(r),this.output.b+='"'}if(this.hasChildren(e)){if(this.output.b+=">",this.pretty&&(this.output.b+="\n"),e.nodeType!=ue.Document&&e.nodeType!=ue.Element)throw Me.thrown("Bad node type, expected Element or Document but found "+(null==e.nodeType?"null":ce.toString(e.nodeType)));let n=e.children,r=0;for(;r<n.length;)this.writeNode(n[r++],this.pretty?t+"\t":t);if(this.output.b+=re.string(t+"</"),e.nodeType!=ue.Element)throw Me.thrown("Bad node type, expected Element but found "+(null==e.nodeType?"null":ce.toString(e.nodeType)));this.output.b+=re.string(e.nodeName),this.output.b+=">",this.pretty&&(this.output.b+="\n")}else this.output.b+="/>",this.pretty&&(this.output.b+="\n");break;case 1:if(e.nodeType==ue.Document||e.nodeType==ue.Element)throw Me.thrown("Bad node type, unexpected "+(null==e.nodeType?"null":ce.toString(e.nodeType)));let r=e.nodeValue;if(0!=r.length){let e=t+se.htmlEscape(r);this.output.b+=re.string(e),this.pretty&&(this.output.b+="\n")}break;case 2:if(this.output.b+=re.string(t+"<![CDATA["),e.nodeType==ue.Document||e.nodeType==ue.Element)throw Me.thrown("Bad node type, unexpected "+(null==e.nodeType?"null":ce.toString(e.nodeType)));this.output.b+=re.string(e.nodeValue),this.output.b+="]]>",this.pretty&&(this.output.b+="\n");break;case 3:if(e.nodeType==ue.Document||e.nodeType==ue.Element)throw Me.thrown("Bad node type, unexpected "+(null==e.nodeType?"null":ce.toString(e.nodeType)));let i=e.nodeValue,s=new RegExp("[\n\r\t]+","g".split("u").join(""));i=i.replace(s,""),i="\x3c!--"+i+"--\x3e",this.output.b+=null==t?"null":""+t,this.output.b+=re.string(se.trim(i)),this.pretty&&(this.output.b+="\n");break;case 4:if(e.nodeType==ue.Document||e.nodeType==ue.Element)throw Me.thrown("Bad node type, unexpected "+(null==e.nodeType?"null":ce.toString(e.nodeType)));this.output.b+=re.string("<!DOCTYPE "+e.nodeValue+">"),this.pretty&&(this.output.b+="\n");break;case 5:if(e.nodeType==ue.Document||e.nodeType==ue.Element)throw Me.thrown("Bad node type, unexpected "+(null==e.nodeType?"null":ce.toString(e.nodeType)));this.output.b+=re.string("<?"+e.nodeValue+"?>"),this.pretty&&(this.output.b+="\n");break;case 6:if(e.nodeType!=ue.Document&&e.nodeType!=ue.Element)throw Me.thrown("Bad node type, expected Element or Document but found "+(null==e.nodeType?"null":ce.toString(e.nodeType)));let a=e.children,l=0;for(;l<a.length;)this.writeNode(a[l++],t)}}hasChildren(e){if(e.nodeType!=ue.Document&&e.nodeType!=ue.Element)throw Me.thrown("Bad node type, expected Element or Document but found "+(null==e.nodeType?"null":ce.toString(e.nodeType)));let t=e.children,n=0;for(;n<t.length;){let e=t[n++];switch(e.nodeType){case 0:case 1:return!0;case 2:case 3:if(e.nodeType==ue.Document||e.nodeType==ue.Element)throw Me.thrown("Bad node type, unexpected "+(null==e.nodeType?"null":ce.toString(e.nodeType)));let t=e.nodeValue,n=t.length,r=0;for(;r<n&&se.isSpace(t,r);)++r;if(0!=(r>0?a.substr(t,r,n-r):t).length)return!0}}return!1}static print(e,t){null==t&&(t=!1);let n=new _t(t);return n.writeNode(e,""),n.output.b}}_t.__name__="haxe.xml.Printer",Object.assign(_t.prototype,{__class__:_t});var gt=r["haxeLanguageServer.ConfigurationKind"]={__ename__:!0,__constructs__:null,User:{_hx_name:"User",_hx_index:0,__enum__:"haxeLanguageServer.ConfigurationKind",toString:n},DisplayArguments:{_hx_name:"DisplayArguments",_hx_index:1,__enum__:"haxeLanguageServer.ConfigurationKind",toString:n},DisplayServer:{_hx_name:"DisplayServer",_hx_index:2,__enum__:"haxeLanguageServer.ConfigurationKind",toString:n}};gt.__constructs__=[gt.User,gt.DisplayArguments,gt.DisplayServer];class xt{constructor(e,t){this.sendMethodResults=!1,this.onDidChange=t,e.onNotification("workspace/didChangeConfiguration",nl(this,this.onDidChangeConfiguration)),e.onNotification("haxe/didChangeDisplayArguments",nl(this,this.onDidChangeDisplayArguments)),e.onNotification("haxe/didChangeDisplayServerConfig",nl(this,this.onDidChangeDisplayServerConfig))}onInitialize(e){let t=e.initializationOptions;null==t?t=xt.DefaultInitOptions:(null==t.displayArguments&&(t.displayArguments=xt.DefaultInitOptions.displayArguments),null==t.displayServerConfig&&(t.displayServerConfig=xt.DefaultInitOptions.displayServerConfig),null==t.displayServerConfig.arguments&&(t.displayServerConfig.arguments=xt.DefaultInitOptions.displayServerConfig.arguments),null==t.displayServerConfig.env&&(t.displayServerConfig.env=xt.DefaultInitOptions.displayServerConfig.env),null==t.displayServerConfig.path&&(t.displayServerConfig.path=xt.DefaultInitOptions.displayServerConfig.path),null==t.displayServerConfig.print&&(t.displayServerConfig.print=xt.DefaultInitOptions.displayServerConfig.print),null==t.displayServerConfig.print.addedDirectory&&(t.displayServerConfig.print.addedDirectory=xt.DefaultInitOptions.displayServerConfig.print.addedDirectory),null==t.displayServerConfig.print.arguments&&(t.displayServerConfig.print.arguments=xt.DefaultInitOptions.displayServerConfig.print.arguments),null==t.displayServerConfig.print.cachedModules&&(t.displayServerConfig.print.cachedModules=xt.DefaultInitOptions.displayServerConfig.print.cachedModules),null==t.displayServerConfig.print.changedDirectories&&(t.displayServerConfig.print.changedDirectories=xt.DefaultInitOptions.displayServerConfig.print.changedDirectories),null==t.displayServerConfig.print.completion&&(t.displayServerConfig.print.completion=xt.DefaultInitOptions.displayServerConfig.print.completion),null==t.displayServerConfig.print.defines&&(t.displayServerConfig.print.defines=xt.DefaultInitOptions.displayServerConfig.print.defines),null==t.displayServerConfig.print.displayPosition&&(t.displayServerConfig.print.displayPosition=xt.DefaultInitOptions.displayServerConfig.print.displayPosition),null==t.displayServerConfig.print.foundDirectories&&(t.displayServerConfig.print.foundDirectories=xt.DefaultInitOptions.displayServerConfig.print.foundDirectories),null==t.displayServerConfig.print.message&&(t.displayServerConfig.print.message=xt.DefaultInitOptions.displayServerConfig.print.message),null==t.displayServerConfig.print.modulePathChanged&&(t.displayServerConfig.print.modulePathChanged=xt.DefaultInitOptions.displayServerConfig.print.modulePathChanged),null==t.displayServerConfig.print.newContext&&(t.displayServerConfig.print.newContext=xt.DefaultInitOptions.displayServerConfig.print.newContext),null==t.displayServerConfig.print.notCached&&(t.displayServerConfig.print.notCached=xt.DefaultInitOptions.displayServerConfig.print.notCached),null==t.displayServerConfig.print.parsed&&(t.displayServerConfig.print.parsed=xt.DefaultInitOptions.displayServerConfig.print.parsed),null==t.displayServerConfig.print.removedDirectory&&(t.displayServerConfig.print.removedDirectory=xt.DefaultInitOptions.displayServerConfig.print.removedDirectory),null==t.displayServerConfig.print.reusing&&(t.displayServerConfig.print.reusing=xt.DefaultInitOptions.displayServerConfig.print.reusing),null==t.displayServerConfig.print.signature&&(t.displayServerConfig.print.signature=xt.DefaultInitOptions.displayServerConfig.print.signature),null==t.displayServerConfig.print.skippingDep&&(t.displayServerConfig.print.skippingDep=xt.DefaultInitOptions.displayServerConfig.print.skippingDep),null==t.displayServerConfig.print.socketMessage&&(t.displayServerConfig.print.socketMessage=xt.DefaultInitOptions.displayServerConfig.print.socketMessage),null==t.displayServerConfig.print.stats&&(t.displayServerConfig.print.stats=xt.DefaultInitOptions.displayServerConfig.print.stats),null==t.displayServerConfig.print.uncaughtError&&(t.displayServerConfig.print.uncaughtError=xt.DefaultInitOptions.displayServerConfig.print.uncaughtError),null==t.displayServerConfig.print.unchangedContent&&(t.displayServerConfig.print.unchangedContent=xt.DefaultInitOptions.displayServerConfig.print.unchangedContent),null==t.displayServerConfig.useSocket&&(t.displayServerConfig.useSocket=xt.DefaultInitOptions.displayServerConfig.useSocket),null==t.experimentalClientCapabilities&&(t.experimentalClientCapabilities=xt.DefaultInitOptions.experimentalClientCapabilities),null==t.experimentalClientCapabilities.forceCommandResolveSupport&&(t.experimentalClientCapabilities.forceCommandResolveSupport=xt.DefaultInitOptions.experimentalClientCapabilities.forceCommandResolveSupport),null==t.experimentalClientCapabilities.supportedCommands&&(t.experimentalClientCapabilities.supportedCommands=xt.DefaultInitOptions.experimentalClientCapabilities.supportedCommands),null==t.haxelibConfig&&(t.haxelibConfig=xt.DefaultInitOptions.haxelibConfig),null==t.haxelibConfig.executable&&(t.haxelibConfig.executable=xt.DefaultInitOptions.haxelibConfig.executable),null==t.sendMethodResults&&(t.sendMethodResults=xt.DefaultInitOptions.sendMethodResults)),this.displayServer=t.displayServerConfig,this.displayArguments=t.displayArguments,this.haxelib=t.haxelibConfig,this.sendMethodResults=t.sendMethodResults}onDidChangeConfiguration(e){let t=null!=this.user,n=e.settings.haxe;null==n&&(n={});let r=JSON.stringify(n),i=null!=this.unmodifiedUserConfig&&JSON.stringify(this.unmodifiedUserConfig)==r;t&&i||(this.unmodifiedUserConfig=JSON.parse(r),this.processSettings(n),this.onDidChange(gt.User))}processSettings(e){ne.deleteField(e,"displayServer"),ne.deleteField(e,"displayConfigurations"),ne.deleteField(e,"configurations"),ne.deleteField(e,"executable"),this.user=e,null!=e.codeGeneration&&(e.codeGeneration.switch_=ne.field(e.codeGeneration,"switch"),ne.deleteField(e.codeGeneration,"switch")),null==this.user?this.user=xt.DefaultUserSettings:(null==this.user.buildCompletionCache&&(this.user.buildCompletionCache=xt.DefaultUserSettings.buildCompletionCache),null==this.user.codeGeneration&&(this.user.codeGeneration=xt.DefaultUserSettings.codeGeneration),null==this.user.codeGeneration.functions&&(this.user.codeGeneration.functions=xt.DefaultUserSettings.codeGeneration.functions),null==this.user.codeGeneration.functions.anonymous&&(this.user.codeGeneration.functions.anonymous=xt.DefaultUserSettings.codeGeneration.functions.anonymous),null==this.user.codeGeneration.functions.anonymous.argumentTypeHints&&(this.user.codeGeneration.functions.anonymous.argumentTypeHints=xt.DefaultUserSettings.codeGeneration.functions.anonymous.argumentTypeHints),null==this.user.codeGeneration.functions.anonymous.explicitNull&&(this.user.codeGeneration.functions.anonymous.explicitNull=xt.DefaultUserSettings.codeGeneration.functions.anonymous.explicitNull),null==this.user.codeGeneration.functions.anonymous.explicitPrivate&&(this.user.codeGeneration.functions.anonymous.explicitPrivate=xt.DefaultUserSettings.codeGeneration.functions.anonymous.explicitPrivate),null==this.user.codeGeneration.functions.anonymous.explicitPublic&&(this.user.codeGeneration.functions.anonymous.explicitPublic=xt.DefaultUserSettings.codeGeneration.functions.anonymous.explicitPublic),null==this.user.codeGeneration.functions.anonymous.placeOpenBraceOnNewLine&&(this.user.codeGeneration.functions.anonymous.placeOpenBraceOnNewLine=xt.DefaultUserSettings.codeGeneration.functions.anonymous.placeOpenBraceOnNewLine),null==this.user.codeGeneration.functions.anonymous.returnTypeHint&&(this.user.codeGeneration.functions.anonymous.returnTypeHint=xt.DefaultUserSettings.codeGeneration.functions.anonymous.returnTypeHint),null==this.user.codeGeneration.functions.anonymous.useArrowSyntax&&(this.user.codeGeneration.functions.anonymous.useArrowSyntax=xt.DefaultUserSettings.codeGeneration.functions.anonymous.useArrowSyntax),null==this.user.codeGeneration.functions.field&&(this.user.codeGeneration.functions.field=xt.DefaultUserSettings.codeGeneration.functions.field),null==this.user.codeGeneration.functions.field.argumentTypeHints&&(this.user.codeGeneration.functions.field.argumentTypeHints=xt.DefaultUserSettings.codeGeneration.functions.field.argumentTypeHints),null==this.user.codeGeneration.functions.field.explicitNull&&(this.user.codeGeneration.functions.field.explicitNull=xt.DefaultUserSettings.codeGeneration.functions.field.explicitNull),null==this.user.codeGeneration.functions.field.explicitPrivate&&(this.user.codeGeneration.functions.field.explicitPrivate=xt.DefaultUserSettings.codeGeneration.functions.field.explicitPrivate),null==this.user.codeGeneration.functions.field.explicitPublic&&(this.user.codeGeneration.functions.field.explicitPublic=xt.DefaultUserSettings.codeGeneration.functions.field.explicitPublic),null==this.user.codeGeneration.functions.field.placeOpenBraceOnNewLine&&(this.user.codeGeneration.functions.field.placeOpenBraceOnNewLine=xt.DefaultUserSettings.codeGeneration.functions.field.placeOpenBraceOnNewLine),null==this.user.codeGeneration.functions.field.returnTypeHint&&(this.user.codeGeneration.functions.field.returnTypeHint=xt.DefaultUserSettings.codeGeneration.functions.field.returnTypeHint),null==this.user.codeGeneration.functions.field.useArrowSyntax&&(this.user.codeGeneration.functions.field.useArrowSyntax=xt.DefaultUserSettings.codeGeneration.functions.field.useArrowSyntax),null==this.user.codeGeneration.imports&&(this.user.codeGeneration.imports=xt.DefaultUserSettings.codeGeneration.imports),null==this.user.codeGeneration.imports.enableAutoImports&&(this.user.codeGeneration.imports.enableAutoImports=xt.DefaultUserSettings.codeGeneration.imports.enableAutoImports),null==this.user.codeGeneration.imports.style&&(this.user.codeGeneration.imports.style=xt.DefaultUserSettings.codeGeneration.imports.style),null==this.user.codeGeneration.switch_&&(this.user.codeGeneration.switch_=xt.DefaultUserSettings.codeGeneration.switch_),null==this.user.codeGeneration.switch_.parentheses&&(this.user.codeGeneration.switch_.parentheses=xt.DefaultUserSettings.codeGeneration.switch_.parentheses),null==this.user.diagnosticsForAllOpenFiles&&(this.user.diagnosticsForAllOpenFiles=xt.DefaultUserSettings.diagnosticsForAllOpenFiles),null==this.user.diagnosticsPathFilter&&(this.user.diagnosticsPathFilter=xt.DefaultUserSettings.diagnosticsPathFilter),null==this.user.disableInlineValue&&(this.user.disableInlineValue=xt.DefaultUserSettings.disableInlineValue),null==this.user.disableRefactorCache&&(this.user.disableRefactorCache=xt.DefaultUserSettings.disableRefactorCache),null==this.user.displayHost&&(this.user.displayHost=xt.DefaultUserSettings.displayHost),null==this.user.displayPort&&(this.user.displayPort=xt.DefaultUserSettings.displayPort),null==this.user.enableCodeLens&&(this.user.enableCodeLens=xt.DefaultUserSettings.enableCodeLens),null==this.user.enableCompletionCacheWarning&&(this.user.enableCompletionCacheWarning=xt.DefaultUserSettings.enableCompletionCacheWarning),null==this.user.enableDiagnostics&&(this.user.enableDiagnostics=xt.DefaultUserSettings.enableDiagnostics),null==this.user.enableServerView&&(this.user.enableServerView=xt.DefaultUserSettings.enableServerView),null==this.user.enableSignatureHelpDocumentation&&(this.user.enableSignatureHelpDocumentation=xt.DefaultUserSettings.enableSignatureHelpDocumentation),null==this.user.exclude&&(this.user.exclude=xt.DefaultUserSettings.exclude),null==this.user.importsSortOrder&&(this.user.importsSortOrder=xt.DefaultUserSettings.importsSortOrder),null==this.user.inlayHints&&(this.user.inlayHints=xt.DefaultUserSettings.inlayHints),null==this.user.inlayHints.conditionals&&(this.user.inlayHints.conditionals=xt.DefaultUserSettings.inlayHints.conditionals),null==this.user.inlayHints.functionReturnTypes&&(this.user.inlayHints.functionReturnTypes=xt.DefaultUserSettings.inlayHints.functionReturnTypes),null==this.user.inlayHints.parameterNames&&(this.user.inlayHints.parameterNames=xt.DefaultUserSettings.inlayHints.parameterNames),null==this.user.inlayHints.parameterTypes&&(this.user.inlayHints.parameterTypes=xt.DefaultUserSettings.inlayHints.parameterTypes),null==this.user.inlayHints.variableTypes&&(this.user.inlayHints.variableTypes=xt.DefaultUserSettings.inlayHints.variableTypes),null==this.user.maxCompletionItems&&(this.user.maxCompletionItems=xt.DefaultUserSettings.maxCompletionItems),null==this.user.postfixCompletion&&(this.user.postfixCompletion=xt.DefaultUserSettings.postfixCompletion),null==this.user.postfixCompletion.level&&(this.user.postfixCompletion.level=xt.DefaultUserSettings.postfixCompletion.level),null==this.user.renameSourceFolders&&(this.user.renameSourceFolders=xt.DefaultUserSettings.renameSourceFolders),null==this.user.serverRecording&&(this.user.serverRecording=xt.DefaultUserSettings.serverRecording),null==this.user.serverRecording.enabled&&(this.user.serverRecording.enabled=xt.DefaultUserSettings.serverRecording.enabled),null==this.user.serverRecording.exclude&&(this.user.serverRecording.exclude=xt.DefaultUserSettings.serverRecording.exclude),null==this.user.serverRecording.excludeUntracked&&(this.user.serverRecording.excludeUntracked=xt.DefaultUserSettings.serverRecording.excludeUntracked),null==this.user.serverRecording.path&&(this.user.serverRecording.path=xt.DefaultUserSettings.serverRecording.path),null==this.user.serverRecording.watch&&(this.user.serverRecording.watch=xt.DefaultUserSettings.serverRecording.watch),null==this.user.useLegacyCompletion&&(this.user.useLegacyCompletion=xt.DefaultUserSettings.useLegacyCompletion),null==this.user.useLegacyDiagnostics&&(this.user.useLegacyDiagnostics=xt.DefaultUserSettings.useLegacyDiagnostics))}onDidChangeDisplayArguments(e){this.displayArguments=e.arguments,this.onDidChange(gt.DisplayArguments)}onDidChangeDisplayServerConfig(e){this.displayServer=e,this.onDidChange(gt.DisplayServer)}}xt.__name__="haxeLanguageServer.Configuration",Object.assign(xt.prototype,{__class__:xt});class kt{constructor(e){this.invalidated=new tt,this.progressId=0,this.initialized=!1,this.latestActiveFilePackage="",this.languageServerProtocol=e,this.serverRecording=new qr,this.haxeDisplayProtocol=new Ji(nl(this,this.writeMessage)),this.haxeServer=new Vr(this),this.documents=new St;let n=this;this.config=new xt(e,(function(e){n.restartServer(re.string(e)+" configuration was changed")})),e.onRequest("initialize",nl(this,this.onInitialize)),e.onRequest("shutdown",nl(this,this.onShutdown)),e.onNotification("exit",nl(this,this.onExit)),e.onNotification("textDocument/didOpen",nl(this,this.onDidOpenTextDocument)),e.onNotification("textDocument/didChange",nl(this,this.onDidChangeTextDocument)),e.onNotification("textDocument/didClose",nl(this,this.onDidCloseTextDocument)),e.onNotification("textDocument/didSave",nl(this,this.onDidSaveTextDocument)),e.onNotification("workspace/didChangeWatchedFiles",nl(this,this.onDidChangeWatchedFiles)),e.onNotification("haxe/didChangeActiveTextEditor",nl(this,this.onDidChangeActiveTextEditor)),e.onRequest("haxe/runMethod",nl(this,this.runMethod)),e.onRequest("haxe/exportServerRecording",nl(t=this.serverRecording,t.export))}writeMessage(e,t){let n=ne.field(e,"method");if("$/cancelRequest"==n)return;let r=n.startsWith("display/")||"server/readClassPaths"==n,i=this;this.callDisplay(n,[JSON.stringify(e)],null,t,(function(t){switch(t._hx_index){case 0:break;case 1:let r=t.msg;""==r&&"display/diagnostics"==n?i.haxeDisplayProtocol.handleMessage({jsonrpc:"2.0",id:e.id,result:{result:[]}}):i.haxeDisplayProtocol.handleMessage(JSON.parse(r))}}),(function(e){let t,n=i.haxeDisplayProtocol;try{t=JSON.parse(e)}catch(n){We.lastError=n;let r=i.haxeDisplayProtocol.nextRequestId-1,s=[{severity:1,message:e}],a={code:-32603,message:"Compiler error"};null!=s&&(a.data=s),t={jsonrpc:"2.0",id:r,error:a}}n.handleMessage(t)}),r)}startProgress(e){let t=this.capabilities.window;if(0==(null!=t?t.workDoneProgress:null))return function(){};let n=this.progressId++;this.languageServerProtocol.sendRequest("window/workDoneProgress/create",{token:n});let r=this.languageServerProtocol,i={token:n,value:{kind:"begin",title:"Haxe: "+e+"..."}},s={jsonrpc:"2.0",method:"$/progress"};null!=i&&(s.params=i),r.writeMessage(s,null),null!=r.didSendNotification&&r.didSendNotification(s);let a=this;return function(){let e=a.languageServerProtocol,t={token:n,value:{kind:"end"}},r={jsonrpc:"2.0",method:"$/progress"};null!=t&&(r.params=t),e.writeMessage(r,null),null!=e.didSendNotification&&e.didSendNotification(r)}}resetInvalidatedFiles(){this.invalidated=new tt}onInitialize(e,t,n,r){null!=e.rootUri&&(this.workspacePath=vt(e.rootUri)),this.capabilities=e.capabilities;let i=e.initializationOptions,s=null!=i?i.experimentalClientCapabilities:null;this.experimental=null!=s?s:{},this.config.onInitialize(e),this.serverRecording.onInitialize(this),new Bn(this),new Hn(this),new Xt(this),new Gt(this),new sn(this);let a=this.capabilities,l=null!=a?a.textDocument:null,o=this.capabilities,c=null!=o?o.workspace:null,u=[],h=function(e,t,n,r){null==r&&(r={documentSelector:n}),u.push({id:null!=t?t:""+e,method:e,registerOptions:r})},d={textDocumentSync:{openClose:!0,change:2,save:{includeText:!1}}},p=[".","@",":"," ",">","$"],f=null!=l?l.completion:null;1==(null!=f?f.dynamicRegistration:null)?(h("textDocument/completion","haxeDocument/completion",null,{documentSelector:kt.haxeSelector,triggerCharacters:p,resolveProvider:!0}),h("textDocument/completion","hxmlDocument/completion",null,{documentSelector:kt.hxmlSelector,triggerCharacters:["-","/","\\","="," "],resolveProvider:!0})):d.completionProvider={triggerCharacters:p,resolveProvider:!0};let m=["(",","],_=null!=l?l.signatureHelp:null;1==(null!=_?_.dynamicRegistration:null)?h("textDocument/signatureHelp",null,null,{documentSelector:kt.haxeSelector,triggerCharacters:m}):d.signatureHelpProvider={triggerCharacters:m};let g=null!=l?l.definition:null;1==(null!=g?g.dynamicRegistration:null)?h("textDocument/definition",null,kt.haxeSelector):d.definitionProvider=!0;let x=null!=l?l.hover:null;1==(null!=x?x.dynamicRegistration:null)?(h("textDocument/hover","haxeDocument/hover",kt.haxeSelector),h("textDocument/hover","hxmlDocument/hover",kt.hxmlSelector)):d.hoverProvider=!0;let k=null!=l?l.references:null;1==(null!=k?k.dynamicRegistration:null)?h("textDocument/references",null,kt.haxeSelector):d.referencesProvider=!0;let y=null!=l?l.documentSymbol:null;1==(null!=y?y.dynamicRegistration:null)?h("textDocument/documentSymbol",null,kt.haxeSelector):d.documentSymbolProvider=!0;let w=null!=c?c.symbol:null;1==(null!=w?w.dynamicRegistration:null)?h("workspace/symbol",null,kt.haxeSelector):d.workspaceSymbolProvider=!0;let b=null!=l?l.formatting:null;1==(null!=b?b.dynamicRegistration:null)?h("textDocument/formatting",null,kt.haxeSelector):d.documentFormattingProvider=!0;let T=null!=l?l.rangeFormatting:null;1==(null!=T?T.dynamicRegistration:null)?h("textDocument/rangeFormatting",null,kt.haxeSelector):d.documentRangeFormattingProvider=!0;let S=null!=l?l.rename:null;if(1==(null!=S?S.dynamicRegistration:null))h("textDocument/rename",null,null,{documentSelector:kt.haxeSelector,prepareProvider:!0});else{let e=null!=l?l.rename:null;1==(null!=e?e.prepareSupport:null)?d.renameProvider={prepareProvider:!0}:d.renameProvider=!0}let C=null!=l?l.foldingRange:null;1==(null!=C?C.dynamicRegistration:null)?h("textDocument/foldingRange",null,kt.haxeSelector):d.foldingRangeProvider=!0;let v=null!=l?l.colorProvider:null;1==(null!=v?v.dynamicRegistration:null)?h("textDocument/documentColor",null,kt.haxeSelector):d.colorProvider=!0;let P=null!=l?l.inlayHint:null;1==(null!=P?P.dynamicRegistration:null)?h("textDocument/inlayHint",null,kt.haxeSelector):d.inlayHintProvider=!0;let L=null!=l?l.inlineValue:null;1==(null!=L?L.dynamicRegistration:null)?h("textDocument/inlineValue",null,kt.haxeSelector):d.inlineValueProvider=!0,n({capabilities:d}),this.languageServerProtocol.sendRequest("client/registerCapability",{registrations:u},null,(function(e){}),(function(e){He.trace(e,{fileName:"src/haxeLanguageServer/Context.hx",lineNumber:314,className:"haxeLanguageServer.Context",methodName:"onInitialize"})}))}onShutdown(e,t,n,r){this.haxeServer.stop(),n(null)}onExit(e){null!=this.haxeServer?(this.haxeServer.stop(),process.exit(1)):process.exit(0)}onServerStarted(){this.displayOffsetConverter=ir.create(this.haxeServer.haxeVersion),this.handleRegistration("display/typeDefinition","textDocument/typeDefinition",{documentSelector:kt.haxeSelector}),this.handleRegistration("display/implementation","textDocument/implementation",{documentSelector:kt.haxeSelector})}handleRegistration(e,t,n){this.haxeServer.supports(e)?this.registerCapability(t,null,n):this.unregisterCapability(t)}registerCapability(e,t,n){this.languageServerProtocol.sendRequest("client/registerCapability",{registrations:[{id:null!=t?t:""+e,method:e,registerOptions:n}]},null,(function(e){}),(function(e){He.trace(e,{fileName:"src/haxeLanguageServer/Context.hx",lineNumber:356,className:"haxeLanguageServer.Context",methodName:"registerCapability"})}))}unregisterCapability(e,t){this.languageServerProtocol.sendRequest("client/unregisterCapability",{unregisterations:[{id:null!=t?t:""+e,method:e}]},null,(function(e){}),(function(e){He.trace(e,{fileName:"src/haxeLanguageServer/Context.hx",lineNumber:367,className:"haxeLanguageServer.Context",methodName:"unregisterCapability"})}))}hasClientCommandSupport(e){let t,n=this.experimental,r=null!=n?n.supportedCommands:null;return null!=r&&(t=r,t.includes(e))}restartServer(e){this.serverRecording.restartServer(e,this);let t=this;this.initialized?this.haxeServer.restart(e,(function(){t.onServerStarted(),t.refactorCache.initClassPaths(),null!=t.activeEditor&&t.publishDiagnostics(t.activeEditor)})):this.haxeServer.start((function(){t.onServerStarted(),new Jt(t),new Vt(t),new un(t),t.gotoDefinition=new en(t),new tn(t),new nn(t),t.findReferences=new Yt(t),t.determinePackage=new $t(t),t.refactorCache=new qn(t),new cn(t,t.refactorCache),t.diagnostics=new zt(t),new pn(t),new Kt(t),new hn(t),new an(t,t.refactorCache);let e=t.documents.documents.m.values(),n=e.next();for(;!n.done;){let r=n.value;n=e.next(),t.publishDiagnostics(r.uri)}t.initialized=!0}))}isUriSupported(e){return!!Pt(e)||function(e){return e.startsWith("untitled:")}(e)}onDidOpenTextDocument(e){let t=e.textDocument.uri;this.isUriSupported(t)&&(this.activeEditor=t,this.documents.onDidOpenTextDocument(e),this.publishDiagnostics(t))}onDidChangeTextDocument(e){let t=e.textDocument.uri;this.isUriSupported(t)&&(this.serverRecording.onDidChangeTextDocument(e),this.invalidateFile(t),this.documents.onDidChangeTextDocument(e),this.refactorCache.invalidateFile(vt(t)))}onDidCloseTextDocument(e){let t=e.textDocument.uri;this.isUriSupported(t)&&(this.documents.onDidCloseTextDocument(e),this.diagnostics.clearDiagnostics(t))}onDidSaveTextDocument(e){let t=e.textDocument.uri;this.isUriSupported(t)&&(this.publishDiagnostics(t),this.invalidated.m.delete(t),this.refactorCache.invalidateFile(vt(t)))}onDidChangeWatchedFiles(e){let t=0,n=e.changes;for(;t<n.length;){let e=n[t];switch(++t,this.serverRecording.onFileEvent(e),e.type){case 1:this.callFileParamsMethod(e.uri,"server/moduleCreated");break;case 3:this.diagnostics.clearDiagnostics(e.uri),this.invalidateFile(e.uri)}Lt(e.uri)&&this.refactorCache.invalidateFile(vt(e.uri))}}invalidateFile(e){this.invalidated.m.has(e)||(this.callFileParamsMethod(e,"server/invalidate"),this.invalidated.m.set(e,!0))}callFileParamsMethod(e,t){Pt(e)&&Lt(e)&&this.haxeServer.supports(t)&&this.callHaxeMethod(t,{file:vt(e)},null,(function(e){return null}),(function(e){He.trace("Error during "+t+" "+e,{fileName:"src/haxeLanguageServer/Context.hx",lineNumber:482,className:"haxeLanguageServer.Context",methodName:"callFileParamsMethod"})}))}onDidChangeActiveTextEditor(e){if(!Pt(e.uri)||!Lt(e.uri))return;this.activeEditor=e.uri;let t=e.uri,n=this.documents.documents.m.get(t),r=n instanceof bt?n:null;null==r&&Lt(t)&&(r=new bt(t,"hx",1,Ei.readFileSync(vt(t),{encoding:"utf8"})));let i=r;if(null==i)return;let s=process.hrtime();s[0]+s[1]/1e9-i.openTimestamp>.1&&(this.publishDiagnostics(e.uri),this.invalidated.m.delete(this.activeEditor)),this.updateActiveEditorPackage(this.activeEditor)}updateActiveEditorPackage(e){if(null==this.determinePackage||!Lt(e))return void(this.latestActiveFilePackage="");let t=this;this.determinePackage.onDeterminePackage({fsPath:vt(e)},null,(function(e){t.latestActiveFilePackage=e.pack}),(function(e){t.latestActiveFilePackage=""}))}publishDiagnostics(e){null!=this.diagnostics&&this.config.user.enableDiagnostics&&this.diagnostics.publishDiagnostics(e)}runMethod(e,t,n,r){this.callHaxeMethod(e.method,e.params,t,(function(e){return n(e),null}),(function(e){let t={code:0,message:e};r(t)}))}callHaxeMethod(e,t,n,r,i){let s=(new Date).getTime(),a=this;this.haxeDisplayProtocol.sendRequest(e,t,n,(function(t){let n=(new Date).getTime();if(!a.config.sendMethodResults)return void r(t.result);let l,o=(new Date).getTime();try{l=r(t.result)}catch(e){let t=Me.caught(e);i(t.toString()),He.trace(t,{fileName:"src/haxeLanguageServer/Context.hx",lineNumber:548,className:"haxeLanguageServer.Context",methodName:"callHaxeMethod"});let n=t.get_stack();He.trace(null==n?"null":Re.toString(n),{fileName:"src/haxeLanguageServer/Context.hx",lineNumber:549,className:"haxeLanguageServer.Context",methodName:"callHaxeMethod"}),l=null}let c=(new Date).getTime(),u={kind:"Haxe",method:e,debugInfo:l,additionalTimes:{beforeCall:s,arrival:n,beforeProcessing:o,afterProcessing:c},response:t},h=a.languageServerProtocol,d={jsonrpc:"2.0",method:"haxe/didRunHaxeMethod"};null!=u&&(d.params=u),h.writeMessage(d,null),null!=h.didSendNotification&&h.didSendNotification(d)}),(function(e){i(null!=e.data?e.data[0].message:"unknown error")}))}callDisplay(e,t,n,r,i,s,a){null==a&&(a=!0);let l=[];a&&(l=l.concat(["--cwd",this.workspacePath,"-D","display-details","--no-output"])),this.haxeServer.supports("initialize")&&this.config.user.enableServerView&&(l=l.concat(["--times","-D","macro-times"])),a&&null!=this.config.displayArguments&&(l=l.concat(this.config.displayArguments)),l.push("--display"),l=l.concat(t),this.haxeServer.process(e,l,r,!0,n,Gr.Processed(i,s))}startTimer(e){let t=(new Date).getTime(),n=this;return function(r,i){if(n.config.sendMethodResults){let s=n.languageServerProtocol,a={kind:"Haxe",method:e,debugInfo:i,response:{timestamp:0,timers:{name:e,time:((new Date).getTime()-t)/1e3},result:r}},l={jsonrpc:"2.0",method:"haxe/didRunHaxeMethod"};null!=a&&(l.params=a),s.writeMessage(l,null),null!=s.didSendNotification&&s.didSendNotification(l)}}}}function yt(e){return new s("[^a-zA-Z0-9_.:/\\\\-]","").match(e)?e.startsWith('"')&&e.endsWith('"')?e:'"'+se.replace(e,'"','\\"')+'"':e}kt.__name__="haxeLanguageServer.Context",Object.assign(kt.prototype,{__class__:kt});class wt{constructor(e,t,n,r){this.onUpdateListeners=[],this.uri=e,this.languageId=t;let i=process.hrtime();this.openTimestamp=i[0]+i[1]/1e9,this.version=n,this.content=r}update(e,t){let n=0,r=this.onUpdateListeners;for(;n<r.length;)r[n++](this,e,t);this.version=t;let i=0;for(;i<e.length;){let t=e[i];if(++i,null==t.range)this.content=t.text,this.lineOffsets=null;else{let e=this.offsetAt(t.range.start),n=this.offsetAt(t.range.end);this.content=this.content.substring(0,e)+t.text+this.content.substring(n);let r=0|Math.max(t.range.start.line,0),i=0|Math.max(t.range.end.line,0),s=this.computeLineOffsets(t.text,!1,e);if(i-r==s.length){let e=0,t=s.length;for(;e<t;){let t=e++,n=this.lineOffsets;if(null==n)throw new $s("Null pointer in .sure() call");n[t+r+1]=s[t]}}else{let e=this.lineOffsets;if(null==e)throw new $s("Null pointer in .sure() call");let t=e.slice(0,r+1).concat(s),n=this.lineOffsets;if(null==n)throw new $s("Null pointer in .sure() call");this.lineOffsets=t.concat(n.slice(i+1))}let a=t.text.length-(n-e);if(0!=a){let e=r+1+s.length,t=this.lineOffsets;if(null==t)throw new $s("Null pointer in .sure() call");let n=t.length;for(;e<n;){let t=e++,n=this.lineOffsets;if(null==n)throw new $s("Null pointer in .sure() call");let r=this.lineOffsets;if(null==r)throw new $s("Null pointer in .sure() call");n[t]=r[t]+a}}}}}positionAt(e,t){null==t&&(t=1),0==t&&(e=this.utf8Offset(this.content,e,1)),e=0|Math.max(Math.min(e,this.content.length),0);let n=this.getLineOffsets(),r=0,i=n.length;if(0==i)return{line:0,character:e};for(;r<i;){let t=(r+i)/2|0;n[t]>e?i=t:r=t+1}let s=r-1;return{line:s,character:e-n[s]}}lineRangeAt(e){let t=this.positionAt(e),n=this.lineAt(t.line),r={line:t.line,character:0},i=t.line,s=n.length,l=0;for(;l<s&&se.isSpace(n,s-l-1);)++l;return{start:r,end:{line:i,character:(l>0?a.substr(n,0,s-l):n).length}}}lineAt(e){let t=this.getLineOffsets();return e>=t.length?"":e==t.length-1?this.content.substring(t[e]):this.content.substring(t[e],t[e+1])}offsetAt(e){let t=this.getLineOffsets();if(e.line>=t.length)return this.content.length;if(e.line<0)return 0;let n=t[e.line];return 0|Math.max(Math.min(n+e.character,e.line+1<t.length?t[e.line+1]:this.content.length),n)}indentAt(e){let t=new s("^\\s*","");return t.match(this.lineAt(e)),t.matched(0)}getText(e){return null==e?this.content:this.content.substring(this.offsetAt(e.start),this.offsetAt(e.end))}addUpdateListener(e){this.onUpdateListeners.push(e)}removeUpdateListener(e){a.remove(this.onUpdateListeners,e)}getLineOffsets(){return null==this.lineOffsets&&(this.lineOffsets=this.computeLineOffsets(this.content,!0)),this.lineOffsets}computeLineOffsets(e,t,n){null==n&&(n=0);let r=t?[n]:[],i=0;for(;i<e.length;){let t=a.cca(e,i);13==t&&i+1<e.length&&10==a.cca(e,i+1)&&++i,++i,13!=t&&10!=t||r.push(n+i)}return r}utf8Offset(e,t,n){let r=t,i=0,s=0;for(;s<e.length&&i<t;){let t=a.cca(e,s);if(null==t)throw new $s("Null pointer in .sure() call");t>=0&&t<=127||(t>=128&&t<=2047?r-=n:t>=55296&&t<56320?(r-=2*n,++s):t>=2048&&t<=65535?r-=2*n:t>=65536&&t<=1114111&&(r-=3*n)),++i,++s}return r}}wt.__name__="haxeLanguageServer.documents.HxTextDocument",Object.assign(wt.prototype,{__class__:wt});class bt extends wt{constructor(e,t,n,r){super(e,t,n,r)}update(e,t){super.update(e,t),this._tokens=null}get_tokens(){if(null==this._tokens)try{this._tokens=ai.create(this.content)}catch(e){}return this._tokens}}bt.__name__="haxeLanguageServer.documents.HaxeDocument",bt.__super__=wt,Object.assign(bt.prototype,{__class__:bt});class Tt extends wt{constructor(e,t,n,r){super(e,t,n,r)}}Tt.__name__="haxeLanguageServer.documents.HxmlDocument",Tt.__super__=wt,Object.assign(Tt.prototype,{__class__:Tt});class St{constructor(){this.documents=new tt}iterator(){return new Ii(this.documents.m.values())}onDidOpenTextDocument(e){let t=e.textDocument,n=t.uri;if(Lt(n)){let e=this.documents,n=t.uri,r=new bt(t.uri,t.languageId,t.version,t.text);e.m.set(n,r)}else{if(!At(n))throw Me.thrown((null==n?"null":n)+" has unsupported file type (must be .hx or .hxml)");{let e=this.documents,n=t.uri,r=new Tt(t.uri,t.languageId,t.version,t.text);e.m.set(n,r)}}}onDidChangeTextDocument(e){let t=e.textDocument,n=e.contentChanges;if(0==n.length)return;let r=this.documents.m.get(t.uri);null!=r&&r.update(n,t.version)}onDidCloseTextDocument(e){this.documents.m.delete(e.textDocument.uri)}}function Ct(e,t){let n=[],r=0;for(;r<e.length;){let i=e[r];++r;let s=!1,a=0;for(;a<n.length;)t(n[a++],i)&&(s=!0);s||n.push(i)}return n}function vt(e){if(!ul.match(e)||"file"!=ul.matched(2))throw Me.thrown("Invalid uri: "+(null==e?"null":e));let t=ul.matched(5),n=decodeURIComponent(t.split("+").join(" "));return cl.match(n)?n.charAt(1).toLowerCase()+a.substr(n,2,null):n}function Pt(e){return e.startsWith("file://")}function Lt(e){return e.endsWith(".hx")}function At(e){return e.endsWith(".hxml")}function Ft(e){let t=e;t=se.replace(t,"\\","/"),47!=t.charCodeAt(0)&&(t="/"+t);let n=["file://"];hl.match(t)&&(t=hl.matched(1)+hl.matched(2).toLowerCase()+hl.matchedRight());let r=0;for(;;){let e=t.indexOf("/",r);if(-1==e){n.push(Nt(t.substring(r)));break}n.push(Nt(t.substring(r,e))),n.push("/"),r=e+1}return n.join("")}function Nt(e){return new s("[!'()*]","g").map(encodeURIComponent(e),(function(e){return"%"+se.hex(e.matched(0).charCodeAt(0))}))}function It(e,t){if(1==e.useArrowSyntax)return!1;let n=e.returnTypeHint;return"always"==n||"non-void"==n&&"StdTypes.Void"!=Cr(t.ret)}St.__name__="haxeLanguageServer.documents.TextDocuments",Object.assign(St.prototype,{__class__:St});class Ot{static Min(e,t){return Et(e,t)?e:t}static Max(e,t){return Dt(e,t)?e:t}}function Et(e,t){return e.line<t.line||!(t.line<e.line)&&e.character<t.character}function Dt(e,t){return!function(e,t){return e.line<t.line||!(t.line<e.line)&&e.character<=t.character}(e,t)}function Bt(e,t){return!Et(t,e.start)&&!Et(e.end,t)}function Rt(e,t){return Bt(e,t.start)&&Bt(e,t.end)?e:Bt(t,e.start)&&Bt(t,e.end)?t:{start:Ot.Min(t.start,e.start),end:Ot.Max(t.end,e.end)}}function jt(e){return function(t){let n={code:-32603,message:t};e(n)}}function Mt(e,t){let n={code:-32603,message:"Invalid xml data: "+t};e(n)}function Ht(e){let t={code:-32603,message:"Unable to build token tree"};e(t)}function Wt(e,t){let n={code:-32603,message:"Unable to find document for URI "+(null==t?"null":t)+", or feature is not supported for this file type / scheme"};e(n)}function Ut(e){let t=e.lastIndexOf(".");return-1==t?e:e.substring(0,t)}Ot.__name__="haxeLanguageServer.extensions.PositionStatics";class Jt{constructor(e){this.haxe=new Nn(e),this.hxml=new $n(e),e.languageServerProtocol.onRequest("textDocument/completion",nl(this,this.onCompletion)),e.languageServerProtocol.onRequest("completionItem/resolve",nl(this,this.onCompletionResolve))}onCompletion(e,t,n,r){let i=e.textDocument.uri;Lt(i)?this.haxe.onCompletion(e,t,n,r):At(i)?this.hxml.onCompletion(e,t,n,r):Wt(r,i)}onCompletionResolve(e,t,n,r){null!=e.data?this.haxe.onCompletionResolve(e,t,n,r):n(e)}}Jt.__name__="haxeLanguageServer.features.CompletionFeature",Object.assign(Jt.prototype,{__class__:Jt});class Vt{constructor(e){this.haxe=new rn(e),this.hxml=new zn(e),e.languageServerProtocol.onRequest("textDocument/hover",nl(this,this.onHover))}onHover(e,t,n,r){let i=e.textDocument.uri;Lt(i)?this.haxe.onHover(e,t,n,r):At(i)?this.hxml.onHover(e,t,n,r):Wt(r,i)}}Vt.__name__="haxeLanguageServer.features.HoverFeature",Object.assign(Vt.prototype,{__class__:Vt});class Kt{constructor(e){this.cache=new tt,this.context=e,e.registerCapability("textDocument/codeLens",null,{documentSelector:kt.haxeSelector}),e.languageServerProtocol.onRequest("textDocument/codeLens",nl(this,this.onCodeLens))}getCodeLensFromStatistics(e,t){let n=[],r=function(t,r,i,s){null==s&&(s=[]);let a,l=s.length+" "+t+(1==s.length?"":r);if(0==s.length)a={command:{title:l,command:"",arguments:[]},range:i};else{let t=e,n=i.start,r=[],o=0,c=s;for(;o<c.length;){let e=c[o];++o,null!=e.range&&r.push(e)}let u=new Array(r.length),h=0,d=r.length;for(;h<d;){let e=h++,t=r[e],n=t.range;t.range.start.line!=t.range.end.line&&(n={start:t.range.start,end:{character:0,line:t.range.start.line+1}}),u[e]={range:n,uri:Ft(t.file)}}a={command:{title:l,command:"haxe.showReferences",arguments:[t,n,u]},range:i}}n.push(a)},i=0;for(;i<t.length;){let e=t[i];if(++i,null==e.kind)continue;let n=e.range;switch(e.kind){case"class field":null!=e.overrides&&r("override","s",n,e.overrides),r("reference","s",n,e.references),null!=e.implementers&&r("implementation","s",n,e.implementers);break;case"class type":null!=e.subclasses&&r("subclass","es",n,e.subclasses);break;case"enum field":case"enum type":r("reference","s",n,e.references);break;case"interface type":r("implementation","s",n,e.implementers),null!=e.subclasses&&r("subinterface","s",n,e.subclasses)}}return n}onCodeLens(e,t,n,r){if(0==this.context.config.user.enableCodeLens)return void n([]);let i=e.textDocument.uri,s=this.context.documents.documents.m.get(i),a=s instanceof bt?s:null;null==a&&Lt(i)&&(a=new bt(i,"hx",1,Ei.readFileSync(vt(i),{encoding:"utf8"})));let l=a;if(null==l||!Pt(i))return void Wt(r,i);let o=this.context.startTimer("@statistics"),c=this,u=this.context,h=vt(l.uri);u.callDisplay("@statistics",[(null==h?"null":h)+"@0@statistics"],l.content,t,(function(e){switch(e._hx_index){case 0:n([]);break;case 1:let t,s=e.msg;try{t=JSON.parse(s)}catch(e){let t=r,n=null,i={code:-32603,message:"Error parsing stats response"};return null!=n&&(i.data=n),void t(i)}o(t);let a=0;for(;a<t.length;){let e=t[a];if(++a,Ft(e.file)==i){let t=c.getCodeLensFromStatistics(i,e.statistics);c.cache.m.set(i,t),n(t)}}}}),(function(e){let t=c.cache.m.get(i);if(null!=t)n(t),He.trace("Reusing cached code lens - failed with:\n\t"+e,{fileName:"src/haxeLanguageServer/features/haxe/CodeLensFeature.hx",lineNumber:130,className:"haxeLanguageServer.features.haxe.CodeLensFeature",methodName:"onCodeLens"});else{let t=r,n=null,i={code:-32603,message:e};null!=n&&(i.data=n),t(i)}}))}}Kt.__name__="haxeLanguageServer.features.haxe.CodeLensFeature",Object.assign(Kt.prototype,{__class__:Kt});class Gt{constructor(e){this.upperCaseHexRegex=new s("0x([A-F0-9]{6})","g"),this.context=e,this.computer=new qt,e.languageServerProtocol.onRequest("textDocument/documentColor",nl(this,this.onDocumentColor)),e.languageServerProtocol.onRequest("textDocument/colorPresentation",nl(this,this.onColorPresentation))}onDocumentColor(e,t,n,r){let i=this.context.startTimer("textDocument/documentColor"),s=e.textDocument.uri,a=this.context.documents.documents.m.get(s),l=a instanceof bt?a:null;null==l&&Lt(s)&&(l=new bt(s,"hx",1,Ei.readFileSync(vt(s),{encoding:"utf8"})));let o=l;if(null==o)return void Wt(r,s);let c=this.computer.compute(o);n(c),i(null,c.length+" colors")}onColorPresentation(e,t,n,r){let i=this.context.startTimer("textDocument/colorPresentation"),s=e.textDocument.uri,l=this.context.documents.documents.m.get(s),o=l instanceof bt?l:null;null==o&&Lt(s)&&(o=new bt(s,"hx",1,Ei.readFileSync(vt(s),{encoding:"utf8"})));let c=o;if(null==c)return void Wt(r,s);let u=this.toHexColor(Math.round(255*e.color.alpha),Math.round(255*e.color.red),Math.round(255*e.color.green),Math.round(255*e.color.blue));e.range.end.character-e.range.start.character==8&&1==e.color.alpha&&(u=a.substr(u,2,null));let h=c.getText(e.range);this.upperCaseHexRegex.match(h)||(u=u.toLowerCase());let d=[{label:"0x"+u,textEdit:{range:e.range,newText:"0x"+u}}];n(d),i(null,d.length+" color presentations")}toHexColor(e,t,n,r){return e=this.clamp(e,0,255),t=this.clamp(t,0,255),n=this.clamp(n,0,255),r=this.clamp(r,0,255),""+this.asHex(e)+this.asHex(t)+this.asHex(n)+this.asHex(r)}asHex(e){return se.hex(Math.round(e),2)}clamp(e,t,n){return Math.min(Math.max(t,e),n)}}Gt.__name__="haxeLanguageServer.features.haxe.ColorProviderFeature",Object.assign(Gt.prototype,{__class__:Gt});class qt{constructor(){this.rgbHexRegex=new s("0x([A-Fa-f0-9]{6})(\\W|$)","g"),this.argbHexRegex=new s("0x([A-Fa-f0-9]{8})(\\W|$)","g")}compute(e){let t=e.getText(),n=[],r=this;return t=this.argbHexRegex.map(t,(function(t){let i=r.fromArgb(t.matched(1)),s=t.matchedPos();return n.push({range:r.toRange(e,s.pos,s.len-1),color:i}),"0xAARRGGBB"+t.matched(2)})),this.rgbHexRegex.map(t,(function(t){let i=r.fromRgb(t.matched(1)),s=t.matchedPos();return n.push({range:r.toRange(e,s.pos,s.len-1),color:i}),"0xRRGGBB"+t.matched(2)})),n}toRange(e,t,n){return{start:e.positionAt(t),end:e.positionAt(t+n)}}fromArgb(e){let t=re.parseInt("0x"+a.substr(e,0,2)),n=re.parseInt("0x"+a.substr(e,2,2)),r=re.parseInt("0x"+a.substr(e,4,2)),i=re.parseInt("0x"+a.substr(e,6,2));return{red:(null!=n?n:255)/255,green:(null!=r?r:255)/255,blue:(null!=i?i:255)/255,alpha:(null!=t?t:255)/255}}fromRgb(e){let t=re.parseInt("0x"+a.substr(e,0,2)),n=re.parseInt("0x"+a.substr(e,2,2)),r=re.parseInt("0x"+a.substr(e,4,2));return{red:(null!=t?t:255)/255,green:(null!=n?n:255)/255,blue:(null!=r?r:255)/255,alpha:1}}}qt.__name__="haxeLanguageServer.features.haxe._ColorProviderFeature.ColorComputer",Object.assign(qt.prototype,{__class__:qt});class $t{constructor(e){this.context=e,e.languageServerProtocol.onRequest("haxe/determinePackage",nl(this,this.onDeterminePackage))}onDeterminePackage(e,t,n,r){(this.context.haxeServer.supports("display/package")?nl(this,this.handleJsonRpc):nl(this,this.handleLegacy))(e.fsPath,t,n,r)}handleJsonRpc(e,t,n,r){let i=this.context,s=jt(r);i.callHaxeMethod("display/package",{file:e},t,(function(e){if(null==e){let e=r,t=null,n={code:-32603,message:"unable to determine package of module"};return null!=t&&(n.data=t),e(n),null}return n({pack:e.join(".")}),null}),s)}handleLegacy(e,t,n,r){this.context.callDisplay("@package",[(null==e?"null":e)+"@0@package"],null,t,(function(e){switch(e._hx_index){case 0:n({pack:""});break;case 1:n({pack:e.msg})}}),jt(r))}}$t.__name__="haxeLanguageServer.features.haxe.DeterminePackageFeature",Object.assign($t.prototype,{__class__:$t});class zt{constructor(e){this.context=e,this.diagnosticsArguments=new tt,this.pendingRequests=new tt,this.errorUri=Ft(ot.join([e.workspacePath,"Error"])),this.useJsonRpc=e.haxeServer.supports("display/diagnostics"),e.config.user.useLegacyDiagnostics&&(this.useJsonRpc=!1),this.timerName=this.useJsonRpc?"display/diagnostics":"@diagnostics";let t=this;Oi.exec(yt(e.config.haxelib.executable)+" config",{shell:!0},(function(e,n,r){t.haxelibPath=se.trim(n)})),e.languageServerProtocol.onNotification("haxe/runGlobalDiagnostics",nl(this,this.onRunGlobalDiagnostics))}onRunGlobalDiagnostics(e){let t=this.context.startProgress("Collecting Diagnostics"),n=this.context.startTimer(this.timerName),r=this;this.useJsonRpc?this.context.callHaxeMethod("display/diagnostics",{},null,(function(e){r.processDiagnosticsReply(null,n,e);let i=r.context.languageServerProtocol,s={jsonrpc:"2.0",method:"haxe/didRunGlobalDiagnostics"};return i.writeMessage(s,null),null!=i.didSendNotification&&i.didSendNotification(s),t(),null}),(function(e){r.processErrorReply(null,e),t()})):this.context.callDisplay("global diagnostics",["diagnostics"],null,null,(function(e){let i=r.parseLegacyDiagnostics(e);null==i?r.clearDiagnosticsOnClient(r.errorUri):r.processDiagnosticsReply(null,n,i);let s=r.context.languageServerProtocol,a={jsonrpc:"2.0",method:"haxe/didRunGlobalDiagnostics"};s.writeMessage(a,null),null!=s.didSendNotification&&s.didSendNotification(a),t()}),(function(e){r.processErrorReply(null,e),t()}))}parseLegacyDiagnostics(e){switch(e._hx_index){case 0:return null;case 1:let t=e.msg;try{return JSON.parse(t)}catch(e){return He.trace("Error parsing diagnostics response: "+re.string(Me.caught(e)),{fileName:"src/haxeLanguageServer/features/haxe/DiagnosticsFeature.hx",lineNumber:98,className:"haxeLanguageServer.features.haxe.DiagnosticsFeature",methodName:"parseLegacyDiagnostics"}),null}}}processErrorReply(e,t){this.extractDiagnosticsFromHaxeError(e,t)||this.extractDiagnosticsFromHaxeError2(t)||(null!=e&&this.clearDiagnosticsOnClient(e),this.clearDiagnosticsOnClient(this.errorUri)),He.trace(t,{fileName:"src/haxeLanguageServer/features/haxe/DiagnosticsFeature.hx",lineNumber:112,className:"haxeLanguageServer.features.haxe.DiagnosticsFeature",methodName:"processErrorReply"})}extractDiagnosticsFromHaxeError(e,t){let n=new s("(.+):(\\d+): (?:lines \\d+-(\\d+)|character(?:s (\\d+)-| )(\\d+)) : (?:(Warning) : )?(.*)","");if(!n.match(t))return!1;let r=n.matched(1);ot.isAbsolute(r)||(r=ot.join([ot.addTrailingSlash(process.cwd()),r]));let i=Ft(r);if(i!=e)return!1;if(this.isPathFiltered(vt(i)))return!1;let a=re.parseInt(n.matched(2)),l=re.parseInt(n.matched(3)),o=re.parseInt(n.matched(4)),c=re.parseInt(n.matched(5));if(null==a)return!1;let u=this,h=function(e,t){return{line:e-1,character:null==t?0:u.context.displayOffsetConverter.positionCharToZeroBasedColumn(t)}};null==l&&(l=a);let d=h(a,o),p=h(l,c),f=n.matched(7);return this.publishDiagnostic(i,{range:{start:d,end:p},severity:1,message:f},t),!0}extractDiagnosticsFromHaxeError2(e){let t=new s("^(Error): (.*)$","");if(!t.match(e))return!1;let n=t.matched(2);return this.publishDiagnostic(this.errorUri,{range:{start:{line:0,character:0},end:{line:0,character:0}},severity:1,message:n},e),!0}publishDiagnostic(e,t,n){let r=this.context.languageServerProtocol,i={uri:e,diagnostics:[t]},s={jsonrpc:"2.0",method:"textDocument/publishDiagnostics"};null!=i&&(s.params=i),r.writeMessage(s,null),null!=r.didSendNotification&&r.didSendNotification(s);let a=new Zt;this.diagnosticsArguments.m.set(e,a),a.set({code:2,range:t.range},n)}processDiagnosticsReply(e,t,n){this.clearDiagnosticsOnClient(this.errorUri);let r=0,i=new Map,s=0,a=n;for(;s<a.length;){let e=a[s];++s,r+=e.diagnostics.length;let t=e.file;if(null==t&&(t=vt(this.errorUri)),this.isPathFiltered(t))continue;let n=Ft(t),l=new Zt;this.diagnosticsArguments.m.set(n,l);let o=this.context.documents.documents.m.get(n),c=o instanceof bt?o:null;null==c&&Lt(n)&&(c=new bt(n,"hx",1,Ei.readFileSync(vt(n),{encoding:"utf8"})));let u=c,h=[],d=0,p=this.filterRelevantDiagnostics(e.diagnostics);for(;d<p.length;){let e=p[d];++d;let t,n=e.kind,r=null==e.range?{start:{line:0,character:0},end:{line:0,character:0}}:this.context.displayOffsetConverter.byteRangeToCharacterRange(e.range,u),i=e.code,s=e.severity,a=Qt.getMessage(e.kind,u,e.args,r),o={kind:e.kind},c=e.relatedInformation;if(null!=c){let e=new Array(c.length),n=0,r=c.length;for(;n<r;){let t=n++,r=c[t],i=r.location;e[t]={location:null==i?null:{uri:Ft(i.file),range:i.range},message:this.convertIndentation(r.message,r.depth)}}t=e}else t=null;let f={range:r,code:i,severity:s,message:a,data:o,relatedInformation:t};(3==n||0==n||f.message.includes("has no effect")||6==n)&&(f.severity=4,f.tags=[1]),"This case is unused"==f.message&&(f.tags=[1]),5==n&&(f.tags=[2]),l.set({code:n,range:f.range},e.args),h.push(f)}let f=this.context.languageServerProtocol,m={uri:n,diagnostics:h},_={jsonrpc:"2.0",method:"textDocument/publishDiagnostics"};null!=m&&(_.params=m),f.writeMessage(_,null),null!=f.didSendNotification&&f.didSendNotification(_),i.set(n,!0)}if(null==e){let e=new Ii(this.diagnosticsArguments.m.keys());for(;e.hasNext();){let t=e.next();i.has(t)||this.clearDiagnosticsOnClient(t)}}else i.has(e)||this.clearDiagnosticsOnClient(e);t(n,r+" diagnostics")}isPathFiltered(e){return!_r.matches(e,_r.preparePathFilter(this.context.config.user.diagnosticsPathFilter,this.haxelibPath,this.context.workspacePath))}filterRelevantDiagnostics(e){if(null!=te.find(e,(function(e){return 4==e.kind&&"Missing ;"!=e.args}))){let t=[],n=0,r=e;for(;n<r.length;){let e,i=r[n];switch(++n,i.kind){case 1:case 2:e=!1;break;default:e=!0}e&&t.push(i)}e=t}if(null!=te.find(e,(function(e){return 2==e.kind}))){let t=[],n=0,r=e;for(;n<r.length;){let e=r[n];++n,0!=e.kind&&t.push(e)}e=t}let t=[],n=0,r=e;for(;n<r.length;){let i=r[n];++n;let s=i;6==s.kind&&te.exists(e,(function(e){if(s!=e&&null!=s.range&&null!=e.range){let t=e.range,n=s.range;return!!Bt(t,n.start)&&Bt(t,n.end)}return!1}))||t.push(i)}return e=t}convertIndentation(e,t){if(e.startsWith("... ")&&(e=a.substr(e,4,null),++t),t<2)return e;let n="",r=1,i=t;for(;r<i;)++r,n+="⋅⋅⋅";return n+=" ",n+=null==e?"null":""+e,n}clearDiagnostics(e){this.cancelPendingRequest(e),this.clearDiagnosticsOnClient(e)}clearDiagnosticsOnClient(e){if(this.diagnosticsArguments.m.delete(e)){let t=this.context.languageServerProtocol,n={uri:e,diagnostics:[]},r={jsonrpc:"2.0",method:"textDocument/publishDiagnostics"};null!=n&&(r.params=n),t.writeMessage(r,null),null!=t.didSendNotification&&t.didSendNotification(r)}}publishDiagnostics(e){if(!Pt(e)||this.isPathFiltered(vt(e)))return void this.clearDiagnosticsOnClient(e);this.cancelPendingRequest(e);let t=new Wi,n=global.setImmediate(nl(this,this.invokePendingRequest),e,t);t.callback=function(){global.clearImmediate(n)},this.pendingRequests.m.set(e,t)}invokePendingRequest(e,t){let n=this.context.documents.documents.m.get(e),r=n instanceof bt?n:null;null==r&&Lt(e)&&(r=new bt(e,"hx",1,Ei.readFileSync(vt(e),{encoding:"utf8"})));let i=r,s=this;if(null!=i){let n=this.context.startTimer(this.timerName);if(this.useJsonRpc){let r={fileContents:[]};this.context.config.user.diagnosticsForAllOpenFiles?te.iter(this.context.documents,(function(e){let t=vt(e.uri);if("haxe"==e.languageId&&!s.isPathFiltered(t)){let e=r.fileContents;if(null==e)throw new $s("Null pointer in .sure() call");e.push({file:t,contents:null})}})):r.file=vt(i.uri),this.context.callHaxeMethod("display/diagnostics",r,t,(function(t){return s.pendingRequests.m.delete(e),s.processDiagnosticsReply(e,n,t),null}),(function(t){s.pendingRequests.m.delete(e),s.processErrorReply(e,t)}))}else{let r=this.context,a=vt(i.uri);r.callDisplay("@diagnostics",[(null==a?"null":a)+"@0@diagnostics"],null,t,(function(t){s.pendingRequests.m.delete(e);let r=s.parseLegacyDiagnostics(t);null==r?s.clearDiagnosticsOnClient(s.errorUri):s.processDiagnosticsReply(null,n,r)}),(function(t){s.pendingRequests.m.delete(e),s.processErrorReply(e,t)}))}}else this.pendingRequests.m.delete(e)}cancelPendingRequest(e){if(this.useJsonRpc&&this.context.config.user.diagnosticsForAllOpenFiles){let e=this.pendingRequests.m.values(),t=e.next();for(;!t.done;){let n=t.value;t=e.next(),n.canceled||(n.canceled=!0,null!=n.callback&&n.callback())}this.pendingRequests.m.clear()}else{let t=this.pendingRequests.m.get(e);null!=t&&(this.pendingRequests.m.delete(e),t.canceled||(t.canceled=!0,null!=t.callback&&t.callback()))}}getArguments(e,t,n){let r=this.diagnosticsArguments.m.get(e);return null==r?null:r.get({code:t,range:n})}getArgumentsMap(e){return this.diagnosticsArguments.m.get(e)}}zt.__name__="haxeLanguageServer.features.haxe.DiagnosticsFeature",Object.assign(zt.prototype,{__class__:zt});class Qt{static make(e){return e}static getMessage(e,t,n,r){switch(e){case 0:return"Unused import/using";case 1:let e="Unknown identifier";return null!=t&&(e="Unknown identifier : "+t.getText(r)),e;case 2:return se.trim(n);case 3:return n.description;case 4:case 5:return n;case 6:return"Inactive conditional compilation block";case 7:let i=new Sr(null,Tr.Never),s=n.entries,a=new Array(s.length),l=0,o=s.length;for(;l<o;){let e,t=l++,n=s[t];switch(n.cause.kind){case"AbstractParent":case"ImplementedInterface":e=i.printPathWithParams(n.cause.args.parent);break;case"FieldAccess":case"FinalFields":e="this";break;case"PropertyAccessor":e=n.cause.args.property.name}a[t]=e}return"Missing fields for "+a.join(", ")}}}Qt.__name__="haxeLanguageServer.features.haxe.DiagnosticKindHelper";class Zt extends Ke{constructor(){super()}compare(e,t){if(e.code!=t.code)return e.code-t.code;if(null==e.range&&null==t.range)return 0;if(null==e.range)return-1;if(null==t.range)return 1;let n=e.range.start,r=t.range.start,i=e.range.end,s=t.range.end,a=n.line,l=r.line;if(a<l)return-1;if(a>l)return 1;{let e=n.character,t=r.character;if(e<t)return-1;if(e>t)return 1;{let e=i.line,t=s.line;if(e<t)return-1;if(e>t)return 1;{let e=i.character,t=s.character;return e<t?-1:e>t?1:0}}}}}Zt.__name__="haxeLanguageServer.features.haxe._DiagnosticsFeature.DiagnosticsMap",Zt.__super__=Ke,Object.assign(Zt.prototype,{__class__:Zt});class Xt{constructor(e){this.context=e,e.languageServerProtocol.onRequest("textDocument/formatting",nl(this,this.onDocumentFormatting)),e.languageServerProtocol.onRequest("textDocument/rangeFormatting",nl(this,this.onDocumentRangeFormatting))}onDocumentFormatting(e,t,n,r){this.format(e.textDocument.uri,null,n,r)}onDocumentRangeFormatting(e,t,n,r){this.format(e.textDocument.uri,e.range,n,r)}format(e,t,n,r){let i=this.context.startTimer("textDocument/formatting"),s=this.context.documents.documents.m.get(e),a=s instanceof bt?s:null;null==a&&Lt(e)&&(a=new bt(e,"hx",1,Ei.readFileSync(vt(e),{encoding:"utf8"})));let l=a;if(null==l)return void Wt(r,e);let o,c,u=l.get_tokens();if(null==u)return void Ht(r);if(Pt(l.uri)){let e=vt(l.uri);o=e,c=me.SourceFile(e)}else o=this.context.workspacePath,c=me.Snippet;let h=pe.loadConfig(o),d=null;if(null!=t){t.start.character=0;let e=new sr,n=function(t){return e.characterOffsetToByteOffset(l.content,l.offsetAt(t))};d={startPos:n(t.start),endPos:n(t.end)}}let p=pe.format(fe.Tokens(u.list,u.tree,u.bytes,c),h,null,null,d);switch(p._hx_index){case 0:let e,s=p.formattedCode;if(null==t){let t=l.getLineOffsets().length-1,n=l,r=l.getLineOffsets().length-1;e={start:{line:0,character:0},end:{line:t,character:n.lineAt(r).length}}}else e=t;let a=l.getText(e)!=s?[{range:e,newText:s}]:[];n(a),i(null,a.length+" changes");break;case 1:let o=null,c={code:-32603,message:p.errorMessage};null!=o&&(c.data=o),r(c);break;case 2:let u=null,h={code:-32603,message:"Formatting is disabled for this file"};null!=u&&(h.data=u),r(h)}}}Xt.__name__="haxeLanguageServer.features.haxe.DocumentFormattingFeature",Object.assign(Xt.prototype,{__class__:Xt});class Yt{constructor(e){this.context=e,e.languageServerProtocol.onRequest("textDocument/references",nl(this,this.onFindReferences))}onFindReferences(e,t,n,r){let i=e.textDocument.uri,s=this.context.documents.documents.m.get(i),a=s instanceof bt?s:null;null==a&&Lt(i)&&(a=new bt(i,"hx",1,Ei.readFileSync(vt(i),{encoding:"utf8"})));let l=a;null!=l&&Pt(i)?(this.context.haxeServer.supports("display/references")?nl(this,this.handleJsonRpc):nl(this,this.handleLegacy))(e,t,n,r,l,this.context.displayOffsetConverter.characterOffsetToByteOffset(l.content,l.offsetAt(e.position))):Wt(r,i)}handleJsonRpc(e,t,n,r,i,s){this.context.callHaxeMethod("display/references",{file:vt(i.uri),contents:i.content,offset:s,kind:"withBaseAndDescendants"},t,(function(e){let t=n,r=[],i=0;for(;i<e.length;){let t=e[i];++i,null!=t&&r.push(t)}let s=new Array(r.length),a=0,l=r.length;for(;a<l;){let e=a++,t=r[e];s[e]={uri:Ft(t.file),range:t.range}}return t(s),null}),jt(r))}handleLegacy(e,t,n,r,i,s){let a=vt(i.uri),l=this;this.context.callDisplay("@usage",[(null==a?"null":a)+"@"+s+"@usage"],i.content,t,(function(e){switch(e._hx_index){case 0:n(null);break;case 1:let t,s=e.msg;try{t=ue.parse(s).firstElement()}catch(e){We.lastError=e,t=null}if(null==t)return void Mt(r,s);let a=[],o=t.elements();for(;o.hasNext();){let e=o.next();if(e.nodeType!=ue.Document&&e.nodeType!=ue.Element)throw Me.thrown("Bad node type, expected Element or Document but found "+(null==e.nodeType?"null":ce.toString(e.nodeType)));let t=e.children[0];if(t.nodeType==ue.Document||t.nodeType==ue.Element)throw Me.thrown("Bad node type, unexpected "+(null==t.nodeType?"null":ce.toString(t.nodeType)));a.push(t.nodeValue)}if(0==a.length)return void n([]);let c=[],u=new tt,h=0;for(;h<a.length;){let e=a[h];++h;let t=ur.parse(e,i,u,l.context.displayOffsetConverter);null!=t?c.push(t):He.trace("Got invalid position: "+e,{fileName:"src/haxeLanguageServer/features/haxe/FindReferencesFeature.hx",lineNumber:69,className:"haxeLanguageServer.features.haxe.FindReferencesFeature",methodName:"handleLegacy"})}n(c)}}),jt(r))}}Yt.__name__="haxeLanguageServer.features.haxe.FindReferencesFeature",Object.assign(Yt.prototype,{__class__:Yt});class en{constructor(e){this.context=e,e.languageServerProtocol.onRequest("textDocument/definition",nl(this,this.onGotoDefinition))}onGotoDefinition(e,t,n,r){let i=e.textDocument.uri,s=this.context.documents.documents.m.get(i),a=s instanceof bt?s:null;null==a&&Lt(i)&&(a=new bt(i,"hx",1,Ei.readFileSync(vt(i),{encoding:"utf8"})));let l=a;null!=l&&Pt(i)?(this.context.haxeServer.supports("display/definition")?nl(this,this.handleJsonRpc):nl(this,this.handleLegacy))(e,t,n,r,l,this.context.displayOffsetConverter.characterOffsetToByteOffset(l.content,l.offsetAt(e.position))):Wt(r,i)}handleJsonRpc(e,t,n,r,i,s){let a=this;this.context.callHaxeMethod("display/definition",{file:vt(i.uri),contents:i.content,offset:s},t,(function(e){null==e&&(e=[]);let t=n,r=new Array(e.length),i=0,s=e.length;for(;i<s;){let t=i++,n=e[t],s=a.getHaxeDocument(Ft(n.file)),l=null!=s?s.get_tokens():null,o=n.range;if(null!=s&&null!=l){let e=null!=l?l.getTokenAtOffset(s.offsetAt(n.range.start)):null,t=null!=e?e.parent:null,r=null!=t?t.getPos():null;if(null!=r){let e=r.max;o={start:s.positionAt(r.min,1),end:s.positionAt(e,1)}}}r[t]={targetUri:Ft(n.file),targetRange:o,targetSelectionRange:n.range}}return t(r),null}),jt(r))}getHaxeDocument(e){let t=this.context.documents.documents.m.get(e),n=t instanceof bt?t:null;null==n&&Lt(e)&&(n=new bt(e,"hx",1,Ei.readFileSync(vt(e),{encoding:"utf8"})));let r=n;if(null==r){let t=vt(e);if(!zs.exists(t))return null;let n=Ei.readFileSync(t,{encoding:"utf8"});r=new bt(e,"haxe",0,n)}return r}handleLegacy(e,t,n,r,i,s){let a=vt(i.uri),l=this;this.context.callDisplay("@position",[(null==a?"null":a)+"@"+s+"@position"],i.content,t,(function(e){switch(e._hx_index){case 0:n([]);break;case 1:let t,s=e.msg;try{t=ue.parse(s).firstElement()}catch(e){We.lastError=e,t=null}if(null==t)return void Mt(r,s);let a=[],o=t.elements();for(;o.hasNext();){let e=o.next();if(e.nodeType!=ue.Document&&e.nodeType!=ue.Element)throw Me.thrown("Bad node type, expected Element or Document but found "+(null==e.nodeType?"null":ce.toString(e.nodeType)));let t=e.children[0];if(t.nodeType==ue.Document||t.nodeType==ue.Element)throw Me.thrown("Bad node type, unexpected "+(null==t.nodeType?"null":ce.toString(t.nodeType)));a.push(t.nodeValue)}0==a.length&&n([]);let c=[],u=0;for(;u<a.length;){let e=a[u];++u;let t=ur.parse(e,i,null,l.context.displayOffsetConverter);null!=t?c.push({targetUri:t.uri,targetRange:t.range,targetSelectionRange:t.range}):He.trace("Got invalid position: "+e,{fileName:"src/haxeLanguageServer/features/haxe/GotoDefinitionFeature.hx",lineNumber:93,className:"haxeLanguageServer.features.haxe.GotoDefinitionFeature",methodName:"handleLegacy"})}n(c)}}),jt(r))}}en.__name__="haxeLanguageServer.features.haxe.GotoDefinitionFeature",Object.assign(en.prototype,{__class__:en});class tn{constructor(e){this.context=e,e.languageServerProtocol.onRequest("textDocument/implementation",nl(this,this.onGotoImplementation))}onGotoImplementation(e,t,n,r){let i=e.textDocument.uri,s=this.context.documents.documents.m.get(i),a=s instanceof bt?s:null;null==a&&Lt(i)&&(a=new bt(i,"hx",1,Ei.readFileSync(vt(i),{encoding:"utf8"})));let l=a;null!=l&&Pt(i)?this.handleJsonRpc(e,t,n,r,l,this.context.displayOffsetConverter.characterOffsetToByteOffset(l.content,l.offsetAt(e.position))):Wt(r,i)}handleJsonRpc(e,t,n,r,i,s){this.context.callHaxeMethod("display/implementation",{file:vt(i.uri),contents:i.content,offset:s},t,(function(e){let t=n,r=new Array(e.length),i=0,s=e.length;for(;i<s;){let t=i++,n=e[t];r[t]={uri:Ft(n.file),range:n.range}}return t(r),null}),jt(r))}}tn.__name__="haxeLanguageServer.features.haxe.GotoImplementationFeature",Object.assign(tn.prototype,{__class__:tn});class nn{constructor(e){this.context=e,e.languageServerProtocol.onRequest("textDocument/typeDefinition",nl(this,this.onGotoTypeDefinition))}onGotoTypeDefinition(e,t,n,r){let i=e.textDocument.uri,s=this.context.documents.documents.m.get(i),a=s instanceof bt?s:null;null==a&&Lt(i)&&(a=new bt(i,"hx",1,Ei.readFileSync(vt(i),{encoding:"utf8"})));let l=a;if(null==l||!Pt(i))return void Wt(r,i);let o=this.context.displayOffsetConverter.characterOffsetToByteOffset(l.content,l.offsetAt(e.position));this.context.callHaxeMethod("display/typeDefinition",{file:vt(i),contents:l.content,offset:o},t,(function(e){let t=n,r=new Array(e.length),i=0,s=e.length;for(;i<s;){let t=i++,n=e[t];r[t]={uri:Ft(n.file),range:n.range}}return t(r),null}),jt(r))}}nn.__name__="haxeLanguageServer.features.haxe.GotoTypeDefinitionFeature",Object.assign(nn.prototype,{__class__:nn});class rn{constructor(e){this.context=e}onHover(e,t,n,r){let i=e.textDocument.uri,s=this.context.documents.documents.m.get(i),a=s instanceof bt?s:null;null==a&&Lt(i)&&(a=new bt(i,"hx",1,Ei.readFileSync(vt(i),{encoding:"utf8"})));let l=a;null!=l&&Pt(i)?(this.context.haxeServer.supports("display/hover")?nl(this,this.handleJsonRpc):nl(this,this.handleLegacy))(e,t,n,r,l,this.context.displayOffsetConverter.characterOffsetToByteOffset(l.content,l.offsetAt(e.position))):Wt(r,i)}handleJsonRpc(e,t,n,r,i,s){let a=this;this.context.callHaxeMethod("display/hover",{file:vt(i.uri),contents:i.content,offset:s},t,(function(e){if(null==e||null==e.range)n(null);else{let t=a.context.displayOffsetConverter.byteRangeToCharacterRange(e.range,i);n(a.createHover(a.printContent(i,e),Pr(e.item),t))}return null}),jt(r))}printContent(e,t){let n,r=new Sr(!0,Tr.Qualified,{argumentTypeHints:!0,returnTypeHint:"non-void",useArrowSyntax:!1,placeOpenBraceOnNewLine:!1,explicitPublic:!0,explicitPrivate:!0,explicitNull:!0}),i=t.item,s=function(){let e=t.item.type;if(null==e)throw new $s("Null pointer in .sure() call");return e},a=function(){return{definition:lr.printCodeBlock(r.printType(s()),"haxe.type")}};switch(i.kind){case"Define":let l=i.args.value;n={definition:null==l?"_not defined_":lr.printCodeBlock('"'+l+'"',"haxe")};break;case"ClassField":case"EnumAbstractField":n={definition:lr.printCodeBlock(r.printClassFieldDefinition(i.args,s(),"EnumAbstractField"==i.kind),"haxe"),origin:r.printClassFieldOrigin(i.args.origin,i.kind)};break;case"EnumField":let o=i.args.field,c=s();n={definition:lr.printCodeBlock(r.printEnumField(o,c,!1,!0),"haxe"),origin:r.printEnumFieldOrigin(i.args.origin)};break;case"Literal":let u=i.args.name;if(u!=e.getText(t.range)&&"String"!=Cr(s()))return{definition:lr.printCodeBlock(u,"haxe")};n=a();break;case"Local":let h=1==i.args.origin?"haxe.argument":"haxe";n={definition:lr.printCodeBlock(r.printLocalDefinition(t.item.args,s()),h),origin:r.printLocalOrigin(i.args.origin)};break;case"Metadata":n={definition:lr.printCodeBlock(i.args.name,"haxe")};break;case"Type":n={definition:lr.printCodeBlock(r.printEmptyTypeDefinition(t.item.args),"haxe")};break;default:n=a()}let l=t.expected;if(null!=l&&null!=l.name&&0==l.name.kind){let e=l.name.name;null!=l.type&&(e+=":"+new Sr(null,Tr.Never).printType(l.type)),n.additionalSections=["*for argument `"+e+"`*"],null!=l.name.doc&&n.additionalSections.push(lr.markdownFormat(l.name.doc))}return n}handleLegacy(e,t,n,r,i,s){let a=vt(i.uri),l=this;this.context.callDisplay("@type",[(null==a?"null":a)+"@"+s+"@type"],i.content,t,(function(e){switch(e._hx_index){case 0:n(null);break;case 1:let t,s=e.msg;try{t=ue.parse(s).firstElement()}catch(e){We.lastError=e,t=null}if(null==t)return void Mt(r,s);if(t.nodeType!=ue.Document&&t.nodeType!=ue.Element)throw Me.thrown("Bad node type, expected Element or Document but found "+(null==t.nodeType?"null":ce.toString(t.nodeType)));let a=t.children[0];if(a.nodeType==ue.Document||a.nodeType==ue.Element)throw Me.thrown("Bad node type, unexpected "+(null==a.nodeType?"null":ce.toString(a.nodeType)));let o=se.trim(a.nodeValue);if(t.nodeType!=ue.Element)throw Me.thrown("Bad node type, expected Element but found "+(null==t.nodeType?"null":ce.toString(t.nodeType)));if("metadata"==t.nodeName){if(0==o.length){let e=r,t=null,n={code:0,message:"No metadata information"};return null!=t&&(n.data=t),void e(n)}n({contents:o})}else{if(0==o.length){let e=r,t=null,n={code:0,message:"No type information"};return null!=t&&(n.data=t),void e(n)}let e,s=yr.parseDisplayType(o);switch(s._hx_index){case 0:let t=s.type;e=null==t?"unknown":t;break;case 1:e=yr.printFunctionType(s.args,s.ret)}let a=t.get("d"),c=ur.parse(t.get("p"),i,null,l.context.displayOffsetConverter),u=null;null!=c&&(u=c.range),n(l.createHover({definition:lr.printCodeBlock(e,"haxe.type")},a,u))}}}),jt(r))}createHover(e,t,n){null!=t&&""!=(t=se.trim(lr.markdownFormat(t)))&&(t="\n"+t),null!=e.origin&&(null==t&&(t=""),t="*"+e.origin+"*\n"+t);let r=[e.definition];null!=t&&""!=t&&r.push(t),null!=e.additionalSections&&(r=r.concat(e.additionalSections));let i={contents:{kind:"markdown",value:r.join("\n\n---\n")}};return null!=n&&(i.range=n),i}}rn.__name__="haxeLanguageServer.features.haxe.HoverFeature",Object.assign(rn.prototype,{__class__:rn});class sn{constructor(e){this.inlayHintsConditionls=!1,this.inlayHintsFunctionReturnTypes=!1,this.inlayHintsParameterTypes=!1,this.inlayHintsParameterNames=!1,this.inlayHintsVariableTypes=!1,this.hoverRequests=[],this.context=e,this.cache=new tt,this.converter=new sr,this.printer=new Sr(!0,Tr.Qualified,{argumentTypeHints:!0,returnTypeHint:"non-void",useArrowSyntax:!1,placeOpenBraceOnNewLine:!1,explicitPublic:!0,explicitPrivate:!0,explicitNull:!0}),e.languageServerProtocol.onRequest("textDocument/inlayHint",nl(this,this.onInlayHint))}onInlayHint(e,t,n,r){let i=this.context.startTimer("textDocument/inlayHint"),s=e.textDocument.uri,a=this.context.documents.documents.m.get(s),l=a instanceof bt?a:null;null==l&&Lt(s)&&(l=new bt(s,"hx",1,Ei.readFileSync(vt(s),{encoding:"utf8"})));let o=l;if(null==o)return void Wt(r,s);let c=vt(s);this.registerChangeHandler(o,c);let u=o.offsetAt(e.range.start),h=o.offsetAt(e.range.end),d=null!=o?o.get_tokens():null,p=null!=d?d.tree:null;if(null==p)return void Wt(r,s);this.removeCancelledRequests();let f=this.context.config.user,m=null!=f?f.inlayHints:null,_=null!=m?m.variableTypes:null;this.inlayHintsVariableTypes=null!=_&&_;let g=this.context.config.user,x=null!=g?g.inlayHints:null,k=null!=x?x.parameterNames:null;this.inlayHintsParameterNames=null!=k&&k;let y=this.context.config.user,w=null!=y?y.inlayHints:null,b=null!=w?w.parameterTypes:null;this.inlayHintsParameterTypes=null!=b&&b;let T=this.context.config.user,S=null!=T?T.inlayHints:null,C=null!=S?S.functionReturnTypes:null;this.inlayHintsFunctionReturnTypes=null!=C&&C;let v=this.context.config.user,P=null!=v?v.inlayHints:null,L=null!=P?P.conditionals:null;if(this.inlayHintsConditionls=null!=L&&L,!(this.inlayHintsVariableTypes||this.inlayHintsParameterNames||this.inlayHintsParameterTypes||this.inlayHintsFunctionReturnTypes||this.inlayHintsConditionls))return n([]),void i(null,"disabled");let A=[];if(this.inlayHintsVariableTypes&&(A=A.concat(this.findAllVars(o,c,p,u,h,t))),(this.inlayHintsParameterNames||this.inlayHintsFunctionReturnTypes||this.inlayHintsParameterTypes)&&(A=A.concat(this.findAllPOpens(o,c,p,u,h,t))),this.inlayHintsConditionls&&(A=A.concat(this.findAllConditionals(o,c,p,u,h,t))),A.length<=0)return n([]),void i(null,"0 hints");Promise.all(A).then((function(e){let t=[],r=0;for(;r<e.length;){let n=e[r];++r,null!=n&&(t=t.concat(n))}n(t),i(null,t.length+" hints")})).catch((function(e){return Promise.resolve()}))}findAllConditionals(e,t,n,r,i,s){let a=[],l=n.filterCallback((function(e,t){if(r>e.pos.min)return ia.GoDeeper;if(i<e.pos.min)return ia.GoDeeper;let n=e.tok;return 3==n._hx_index&&"end"==n.s?ia.FoundSkipSubtree:ia.GoDeeper})),o=0;for(;o<l.length;){let t=l[o];++o;let n=t.parent;for(;null!=n;){let e=n.tok;if(3==e._hx_index){if("if"==e.s)break;n=n.parent}else n=n.parent}if(null==n)continue;let r=n.getFirstChild();if(null==r)continue;let i=r.getPos(),s=this.converter.byteOffsetToCharacterOffset(e.content,i.min),c=this.converter.byteOffsetToCharacterOffset(e.content,i.max),u=" // "+e.content.substring(s,c),h=this.converter.byteOffsetToCharacterOffset(e.content,t.pos.max),d=e.content.indexOf(u,h);if(d-h>=0&&d-h<5)continue;let p={position:e.positionAt(h),label:u,kind:1,textEdits:[{range:{start:e.positionAt(h,1),end:e.positionAt(h,1)},newText:u}],paddingRight:!1,paddingLeft:!0};null!=p&&a.push(Promise.resolve([p]))}return a}findAllVars(e,t,n,r,i,s){let a=[],l=n.filterCallback((function(e,t){if(r>e.pos.min)return ia.GoDeeper;if(i<e.pos.min)return ia.GoDeeper;let n=e.tok;if(1!=n._hx_index)return ia.GoDeeper;switch(n.k._hx_index){case 2:return ia.FoundGoDeeper;case 42:return e.hasChildren()?ia.FoundSkipSubtree:ia.SkipSubtree;default:return ia.GoDeeper}})),o=this,c=0;for(;c<l.length;){let n=l[c++].getFirstChild();if(null==n)continue;if(22==n.tok._hx_index&&(n=n.getFirstChild()),null==n)continue;if(null!=sa.firstOf(n,oa.DblDot))continue;let r=n.pos.max,i=n.children;if(null!=i){let e=0;e:for(;e<i.length;){let t=i[e];switch(++e,t.tok._hx_index){case 20:r=t.getPos().max;break;case 23:break;default:break e}}}let u=this.hintFromCache(t,n.index,n.pos.min);if(null!=u){a.push(Promise.resolve([u]));continue}let h=this.converter.byteOffsetToCharacterOffset(e.content,n.pos.min);a.push(this.resolveType(t,h,s).then((function(i){if(null==i)return Promise.resolve();let s=o.makeTypeHint(e,i,r,nl(o,o.buildTypeHint));return null==s?Promise.resolve():(o.cacheHint(t,n.index,n.pos.min,s),Promise.resolve([s]))})).catch((function(e){return Promise.resolve()})))}return a}findAllPOpens(e,t,n,r,i,s){let a=[],l=n.filterCallback((function(e,t){return r>e.pos.min||i<e.pos.min?ia.GoDeeper:20==e.tok._hx_index?ia.FoundGoDeeper:ia.GoDeeper})),o=0;for(;o<l.length;){let n=l[o];switch(++o,fa.getPOpenType(n)._hx_index){case 1:this.inlayHintsFunctionReturnTypes&&(a=a.concat(this.makeFunctionInlayHints(e,t,n,s)));break;case 2:(this.inlayHintsParameterNames||this.inlayHintsParameterTypes)&&(a=a.concat(this.makeCallInlayHints(e,t,n,s)))}}return a}makeFunctionInlayHints(e,t,n,r){let i=[];if(null!=sa.firstOf(sa.parent(n),oa.DblDot))return i;if(null!=sa.matches(sa.parent(n),oa.Kwd(li.KwdNew)))return i;let s=sa.firstOf(n,oa.PClose),a=null!=s?s:null;if(null==a)return i;let l=this.hintFromCache(t,n.index,n.pos.min);if(null!=l)return i.push(Promise.resolve([l])),i;let o=a.pos.max,c=this.converter.byteOffsetToCharacterOffset(e.content,n.pos.min),u=this;return i.push(this.resolveType(t,c,r).then((function(r){if(null==r)return Promise.resolve();let i=u.makeTypeHint(e,r,o,nl(u,u.buildReturnTypeHint));return null==i?Promise.resolve():(u.cacheHint(t,n.index,n.pos.min,i),Promise.resolve([i]))})).catch((function(e){return Promise.resolve()}))),i}makeTypeHint(e,t,n,r){let i=r(t);if(null==i)return null;let s=":"+i;return{position:e.positionAt(this.converter.byteOffsetToCharacterOffset(e.content,n)),label:s,kind:1,textEdits:[{range:{start:e.positionAt(n,1),end:e.positionAt(n,1)},newText:s}],paddingRight:!1,paddingLeft:!0}}makeCallInlayHints(e,t,n,r){let i=[],s=sa.firstOf(n,oa.PClose);if(null==s)return i;if(s.pos.min==n.pos.max)return i;let a=n.children;if(null==a)return i;let l=this,o=0;for(;o<a.length;){let n=a[o];++o;let s=n.tok;switch(s._hx_index){case 2:let e=s.c;if(3==e._hx_index&&"_"==e.s)continue;break;case 6:continue;case 21:return i}let c=n.pos.min,u=this.findParamTypePos(n),h=this.findHoverTarget(n),d=[];if(this.inlayHintsParameterNames){let e=this.hintFromCache(t,h.index,h.pos.min);null!=e&&d.push(e)}if(this.inlayHintsParameterTypes){let e=this.hintFromCache(t,h.index,u);null!=e&&d.push(e)}if(d.length>0){i.push(Promise.resolve(d));continue}let p=this.converter.byteOffsetToCharacterOffset(e.content,h.pos.min);i.push(this.resolveType(t,p,r).then((function(n){if(null==n)return Promise.resolve();let r=[];if(l.inlayHintsParameterNames){let i=l.buildParameterName(n);if(null==i)return Promise.resolve();""==i&&(i="<unnamed>");let s={position:e.positionAt(l.converter.byteOffsetToCharacterOffset(e.content,c)),label:i+":",kind:2,paddingRight:!0,paddingLeft:!1};l.cacheHint(t,h.index,h.pos.min,s),r.push(s)}if(l.inlayHintsParameterTypes){let i=l.buildTypeHint(n);if(null==i)return Promise.resolve(r);if(""!=i){let n={position:e.positionAt(l.converter.byteOffsetToCharacterOffset(e.content,u)),label:" /* "+i+" */",kind:1,paddingRight:!1,paddingLeft:!0};l.cacheHint(t,h.index,u,n),r.push(n)}}return Promise.resolve(r)})).catch((function(e){return Promise.resolve()})))}return i}findHoverTarget(e){let t=null;for(;null!=e.nextSibling&&6==e.nextSibling.tok._hx_index;)t=e=e.nextSibling;if(null!=t)return t;if(!e.hasChildren())return e;let n=e.tok;switch(n._hx_index){case 1:if(23!=n.k._hx_index)return e;break;case 15:case 18:return e}let r=e.getLastChild();return null==r?e:15==r.tok._hx_index?(r=r.previousSibling,null==r?e:this.findHoverTarget(r)):this.findHoverTarget(r)}findParamTypePos(e){let t=e.getLastChild();if(null==t)return e.pos.max;if(15==t.tok._hx_index){if(null==t.previousSibling)return e.pos.max;t=t.previousSibling}return null==t?e.pos.max:t.getPos().max}resolveType(e,t,n){let r={params:{file:e,offset:t},token:n,resolve:null},i=new Promise((function(e,t){r.resolve=e}));return this.hoverRequests.push(r),1!=this.hoverRequests.length||this.requestHover(r),i}requestHover(e){if(e.token.canceled)return this.hoverRequests.shift(),void this.nextHover();let t=this;this.context.callHaxeMethod("display/hover",e.params,e.token,(function(n){return null!=e.resolve&&(null==n?e.resolve(null):e.resolve(n)),t.hoverRequests.shift(),t.nextHover(),null}),(function(n){null!=e.resolve&&e.resolve(null),t.hoverRequests.shift(),t.nextHover()}))}nextHover(){this.hoverRequests.length<=0||this.requestHover(this.hoverRequests[0])}removeCancelledRequests(){for(;this.hoverRequests.length>0;){if(!this.hoverRequests[0].token.canceled)return;this.hoverRequests.shift()}}buildParameterName(e){let t=e.expected,n=null!=t?t.name:null;return null!=n?n.name:null}buildTypeHint(e){let t=e.item,n=null!=t?t.type:null;return null==n?null:this.printer.printType(n)}buildReturnTypeHint(e){let t=e.item.type,n=null!=t?t.args:null,r=null!=n?n.ret:null;return null==r?null:this.printer.printType(r)}registerChangeHandler(e,t){this.cache.m.has(t)||(e.removeUpdateListener(nl(this,this.onDocChange)),e.addUpdateListener(nl(this,this.onDocChange)))}onDocChange(e,t,n){let r=vt(e.uri);this.cache.m.delete(r)}hintFromCache(e,t,n){let r=this.cache.m.get(e);return null==r?null:r.m.get(n+"."+t)}cacheHint(e,t,n,r){let i=this.cache.m.get(e);null==i&&(i=new tt,this.cache.m.set(e,i)),i.m.set(n+"."+t,r)}}sn.__name__="haxeLanguageServer.features.haxe.InlayHintFeature",Object.assign(sn.prototype,{__class__:sn});class an{constructor(e,t){this.context=e,this.refactorCache=t,this.converter=new sr,e.languageServerProtocol.onRequest("textDocument/inlineValue",nl(this,this.onInlineValue))}onInlineValue(e,t,n,r){let i=this.context.startTimer("textDocument/inlineValue");if(this.context.config.user.disableRefactorCache||this.context.config.user.disableInlineValue)return n([]),void i();let s=this.refactorCache.fileList.getFile(vt(e.textDocument.uri));if(null==s)return jt(r)("file not found"),void i();let a=new Jn(vt(e.textDocument.uri),new Vn,this.context,this.converter),l=[],o=[],c=e.context.stoppedLocation.start.line,u=s.findAllIdentifiers((function(t){switch(t.name){case"super":case"this":return!1}let n=t.type;switch(n._hx_index){case 18:let r=a.posToRange(t.pos);return r.start.line<=e.context.stoppedLocation.start.line&&(c=r.start.line),!1;case 31:let i=0;for(;i<o.length;){let e=o[i];++i;let n=e.type;if(33==n._hx_index&&(e.name==t.name||t.name.startsWith(e.name+"."))&&n.scopeStart<=t.pos.start&&n.scopeEnd>=t.pos.end)return!1}return!0;case 33:let s=a.posToRange({fileName:t.pos.fileName,start:n.scopeStart,end:n.scopeEnd}),u=e.context.stoppedLocation;return Bt(s,u.start)&&Bt(s,u.end)?(l.push(t.name),!0):(o.push(t),!1);default:return!1}})),h=[],d=0;for(;d<u.length;){let t=u[d];++d;let n=a.posToRange(t.pos);if(n.start.line<c)continue;let r=e.range;Bt(r,n.start)&&Bt(r,n.end)&&(e.context.stoppedLocation.end.line<n.start.line||this.isSharpCondition(e,t)||this.isTypeParam(e,t)||this.isLocalFunctionName(e,t)||!t.name.includes(".")&&this.skipIdentifier(t)||h.push({range:n,expression:t.name}))}n(h),i()}isSharpCondition(e,t){let n=e.textDocument.uri,r=this.context.documents.documents.m.get(n),i=r instanceof bt?r:null;null==i&&Lt(n)&&(i=new bt(n,"hx",1,Ei.readFileSync(vt(n),{encoding:"utf8"})));let s=null!=i?i.get_tokens():null,a=null!=s?s.getTokenAtOffset(t.pos.start):null;if(null==a)return!1;let l=a.parent;for(;null!=l;){let e=l.tok;switch(e._hx_index){case 2:if(3!=e.c._hx_index)return!1;break;case 3:switch(e.s){case"elseif":case"if":return!0;default:return!1}break;case 5:if(2!=e.op._hx_index)return!1;break;case 6:switch(e.op._hx_index){case 14:case 15:break;default:return!1}break;case 11:case 20:break;default:return!1}l=l.parent}return!1}isLocalFunctionName(e,t){let n=e.textDocument.uri,r=this.context.documents.documents.m.get(n),i=r instanceof bt?r:null;null==i&&Lt(n)&&(i=new bt(n,"hx",1,Ei.readFileSync(vt(n),{encoding:"utf8"})));let s=null!=i?i.get_tokens():null,a=null!=s?s.getTokenAtOffset(t.pos.start):null;if(null==a)return!1;let l=a.parent,o=null!=l?l.tok:null;return null!=o&&(1==o._hx_index&&0==o.k._hx_index)}isTypeParam(e,t){let n=e.textDocument.uri,r=this.context.documents.documents.m.get(n),i=r instanceof bt?r:null;null==i&&Lt(n)&&(i=new bt(n,"hx",1,Ei.readFileSync(vt(n),{encoding:"utf8"})));let s=null!=i?i.get_tokens():null,a=null!=s?s.getTokenAtOffset(t.pos.end):null;if(null==a)return!1;let l=a.parent;for(;null!=l;){let e=l.tok;switch(e._hx_index){case 2:if(3!=e.c._hx_index)return!1;break;case 3:return!0;case 6:switch(e.op._hx_index){case 4:break;case 9:return null!=sa.firstOf(l,oa.Binop(ht.OpGt));default:return!1}break;case 11:case 12:case 18:break;default:return!1}l=l.parent}return!1}skipIdentifier(e){if(this.isTypeUsed(e.defineType,e.name))return!0;let t=this.refactorCache.nameMap.getIdentifiers(e.name),n=0;for(;n<t.length;)if(27==t[n++].type._hx_index)return!0;return!1}isTypeUsed(e,t){if(null==e)return!1;let n=this.refactorCache.typeList.findTypeName(t),r=0;for(;r<n.length;){let i=n[r];switch(++r,e.file.importsModule(i.file.getPackage(),i.file.getMainModulName(),t)._hx_index){case 0:case 5:break;case 1:case 2:case 3:case 4:case 6:return!0}}return!1}}an.__name__="haxeLanguageServer.features.haxe.InlineValueFeature",Object.assign(an.prototype,{__class__:an});class ln{}ln.__name__="haxeLanguageServer.features.haxe.codeAction.CodeActionContributor",ln.__isInterface__=!0,Object.assign(ln.prototype,{__class__:ln});class on{constructor(e){this.context=e,this.refactorCache=e.refactorCache}createCodeActions(e){if(this.context.config.user.disableRefactorCache)return[];let t=[];return t=null!=e.context.only?t.concat(this.findMatchingRefactors(e,(function(t){return null!=t&&e.context.only.includes(t.codeActionKind)}))):t.concat(this.findMatchingRefactors(e,(function(e){return!0}))),t}findMatchingRefactors(e,t){let n=[],r=this.refactorCache,i=e.textDocument.uri,s=this.context.documents.documents.m.get(i),a=s instanceof bt?s:null;null==a&&Lt(i)&&(a=new bt(i,"hx",1,Ei.readFileSync(vt(i),{encoding:"utf8"})));let l=r.makeCanRefactorContext(a,e.range);if(null==l)return n;let o=[this.getRefactorInfo(dn.ExtractConstructorParamsAsFinals),this.getRefactorInfo(dn.ExtractConstructorParamsAsVars),this.getRefactorInfo(dn.ExtractInterface),this.getRefactorInfo(dn.ExtractMethod),this.getRefactorInfo(dn.ExtractType),this.getRefactorInfo(dn.RewriteFinalsToVars),this.getRefactorInfo(dn.RewriteVarsToFinals),this.getRefactorInfo(dn.RewriteWrapWithTryCatch)],c=[],u=0;for(;u<o.length;){let e=o[u];++u,t(e)&&c.push(e)}if(c.length<=0)return n;let h=Ts.rangeInSameScope(l);this.refactorCache.updateSingleFileCache(l.what.fileName);let d=0;for(;d<c.length;){let t=c[d];if(++d,null==t)continue;let r=Qi.canRefactor(t.refactorType,l,h);switch(r._hx_index){case 0:break;case 1:n.push(this.makeEmptyCodeAction(r.title,t.codeActionKind,e,t.type))}}return n}getRefactorInfo(e){switch(e._hx_index){case 0:case 1:case 2:return null;case 3:return{refactorType:Ss.RefactorExtractInterface,type:e,codeActionKind:"refactor.extract",title:"extractInterface",prefix:"[ExtractInterface]"};case 4:return{refactorType:Ss.RefactorExtractMethod,type:e,codeActionKind:"refactor.extract",title:"extractMethod",prefix:"[ExtractMethod]"};case 5:return{refactorType:Ss.RefactorExtractType,type:e,codeActionKind:"refactor.extract",title:"extractType",prefix:"[ExtractType]"};case 6:return{refactorType:Ss.RefactorExtractConstructorParams(!1),type:e,codeActionKind:"refactor.extract",title:"extractConstructorParamsAsVars",prefix:"[ExtractConstructorParams as Vars]"};case 7:return{refactorType:Ss.RefactorExtractConstructorParams(!0),type:e,codeActionKind:"refactor.extract",title:"extractConstructorParamsAsFinals",prefix:"[ExtractConstructorParams as Finals]"};case 8:return{refactorType:Ss.RefactorRewriteVarsToFinals(!0),type:e,codeActionKind:"refactor.rewrite",title:"rewriteVarsToFinals",prefix:"[RefactorRewriteVarsToFinals]"};case 9:return{refactorType:Ss.RefactorRewriteVarsToFinals(!1),type:e,codeActionKind:"refactor.rewrite",title:"rewriteFinalsToVars",prefix:"[RewriteFinalsToVars]"};case 10:return{refactorType:Ss.RefactorRewriteWrapWithTryCatch,type:e,codeActionKind:"refactor.rewrite",title:"rewriteWrapInException",prefix:"[RewriteWrapInException]"}}}makeEmptyCodeAction(e,t,n,r){return{title:e,kind:t,data:{params:n,type:r}}}createCodeActionEdits(e,t,n,r){let i=e.startProgress("Performing Refactor Operation…"),s=new Vn,a=this.refactorCache,l=r.textDocument.uri,o=e.documents.documents.m.get(l),c=o instanceof bt?o:null;null==c&&Lt(l)&&(c=new bt(l,"hx",1,Ei.readFileSync(vt(l),{encoding:"utf8"})));let u=a.makeRefactorContext(c,r.range,s);if(null==u)return Promise.reject("failed to make refactor context");let h=this.getRefactorInfo(t);if(null==h)return Promise.reject("failed to make refactor context");let d=e.startTimer("refactor/"+h.title);return Qi.doRefactor(h.refactorType,u).then((function(e){let t;switch(e._hx_index){case 0:He.trace(h.prefix+" no change",{fileName:"src/haxeLanguageServer/features/haxe/RefactorFeature.hx",lineNumber:177,className:"haxeLanguageServer.features.haxe.RefactorFeature",methodName:"createCodeActionEdits"});let n=null,r={code:-32603,message:"no change"};null!=n&&(r.data=n),t=Promise.reject(r);break;case 1:let i='could not find identifier at "'+u.what.fileName+"@"+u.what.posStart+"-"+u.what.posEnd+'"';He.trace(h.prefix+" "+i,{fileName:"src/haxeLanguageServer/features/haxe/RefactorFeature.hx",lineNumber:181,className:"haxeLanguageServer.features.haxe.RefactorFeature",methodName:"createCodeActionEdits"});let a=null,l={code:-32603,message:i};null!=a&&(l.data=a),t=Promise.reject(l);break;case 2:let o=e.name;He.trace(h.prefix+' refactoring not supported for "'+o+'"',{fileName:"src/haxeLanguageServer/features/haxe/RefactorFeature.hx",lineNumber:184,className:"haxeLanguageServer.features.haxe.RefactorFeature",methodName:"createCodeActionEdits"});let c=null,d={code:-32603,message:'refactoring not supported for "'+o+'"'};null!=c&&(d.data=c),t=Promise.reject(d);break;case 3:He.trace(h.prefix+" dry run",{fileName:"src/haxeLanguageServer/features/haxe/RefactorFeature.hx",lineNumber:187,className:"haxeLanguageServer.features.haxe.RefactorFeature",methodName:"createCodeActionEdits"});let p=null,f={code:-32603,message:"dry run"};null!=p&&(f.data=p),t=Promise.reject(f);break;case 4:t=Promise.resolve({documentChanges:s.documentChanges})}return i(),d(null,s.documentChanges.length+" changes"),t})).catch((function(e){He.trace(h.prefix+" error: "+re.string(e),{fileName:"src/haxeLanguageServer/features/haxe/RefactorFeature.hx",lineNumber:197,className:"haxeLanguageServer.features.haxe.RefactorFeature",methodName:"createCodeActionEdits"}),i(),d(null,"error");let t={code:-32603,message:""+re.string(e)};return Promise.reject(t)}))}}on.__name__="haxeLanguageServer.features.haxe.RefactorFeature",on.__interfaces__=[ln],Object.assign(on.prototype,{__class__:on});class cn{constructor(e,t){this.context=e,this.refactorCache=t,e.languageServerProtocol.onRequest("textDocument/prepareRename",nl(this,this.onPrepareRename)),e.languageServerProtocol.onRequest("textDocument/rename",nl(this,this.onRename))}onPrepareRename(e,t,n,r){if(this.context.config.user.disableRefactorCache)return void jt(r)("rename feature disabled");let i=this.context.startTimer("textDocument/prepareRename"),s=e.textDocument.uri,a=this.context.documents.documents.m.get(s),l=a instanceof bt?a:null;null==l&&Lt(s)&&(l=new bt(s,"hx",1,Ei.readFileSync(vt(s),{encoding:"utf8"})));let o=l;if(null==o||!Pt(s))return void Wt(r,s);let c=vt(s);this.refactorCache.makeUsageContext().fileName=c,this.refactorCache.updateSingleFileCache(c);let u=new Vn,h=this;Zi.canRename(this.refactorCache.makeCanRenameContext(o,c,e.position)).then((function(e){if(null==e){let e=r,t=null,n={code:-32603,message:"cannot rename identifier"};null!=t&&(n.data=t),e(n)}n({range:new Jn(c,u,h.context,h.refactorCache.converter).posToRange(e.pos),placeholder:e.name}),i()})).catch((function(e){He.trace("[canRename] error: "+re.string(e),{fileName:"src/haxeLanguageServer/features/haxe/RenameFeature.hx",lineNumber:68,className:"haxeLanguageServer.features.haxe.RenameFeature",methodName:"onPrepareRename"});let t=r,n={code:-32603,message:""+re.string(e)};t(n)}))}onRename(e,t,n,r){let i=this.context.startTimer("textDocument/rename"),s=e.textDocument.uri,a=this.context.documents.documents.m.get(s),l=a instanceof bt?a:null;null==l&&Lt(s)&&(l=new bt(s,"hx",1,Ei.readFileSync(vt(s),{encoding:"utf8"})));let o=l;if(null==o||!Pt(s))return void Wt(r,s);let c=this.context.startProgress("Performing Rename Operation…"),u=vt(s),h=new Vn;Zi.rename(this.refactorCache.makeRenameContext(o,u,e.position,e.newName,h)).then((function(t){switch(c(),t._hx_index){case 0:He.trace("[rename] no change",{fileName:"src/haxeLanguageServer/features/haxe/RenameFeature.hx",lineNumber:90,className:"haxeLanguageServer.features.haxe.RenameFeature",methodName:"onRename"});let i=r,s=null,a={code:-32603,message:"no change"};null!=s&&(a.data=s),i(a);break;case 1:He.trace('[rename] could not find identifier at "'+(null==u?"null":u)+"@"+re.string(e.position)+'"'+cn.HINT_SETTINGS,{fileName:"src/haxeLanguageServer/features/haxe/RenameFeature.hx",lineNumber:93,className:"haxeLanguageServer.features.haxe.RenameFeature",methodName:"onRename"});let l=r,o=null,c={code:-32603,message:'could not find identifier at "'+(null==u?"null":u)+"@"+re.string(e.position)+'"'+cn.HINT_SETTINGS};null!=o&&(c.data=o),l(c);break;case 2:let d=t.name;He.trace('[rename] refactoring not supported for "'+d+'"',{fileName:"src/haxeLanguageServer/features/haxe/RenameFeature.hx",lineNumber:96,className:"haxeLanguageServer.features.haxe.RenameFeature",methodName:"onRename"});let p=r,f=null,m={code:-32603,message:'refactoring not supported for "'+d+'"'};null!=f&&(m.data=f),p(m);break;case 3:He.trace("[rename] dry run",{fileName:"src/haxeLanguageServer/features/haxe/RenameFeature.hx",lineNumber:99,className:"haxeLanguageServer.features.haxe.RenameFeature",methodName:"onRename"});let _=r,g=null,x={code:-32603,message:"dry run"};null!=g&&(x.data=g),_(x);break;case 4:n({documentChanges:h.documentChanges})}i(null,h.documentChanges.length+" changes")})).catch((function(e){c(),He.trace("[rename] error: "+re.string(e)+cn.HINT_SETTINGS,{fileName:"src/haxeLanguageServer/features/haxe/RenameFeature.hx",lineNumber:107,className:"haxeLanguageServer.features.haxe.RenameFeature",methodName:"onRename"}),i(null,"error");let t=r,n={code:-32603,message:""+re.string(e)+cn.HINT_SETTINGS};t(n)}))}}cn.__name__="haxeLanguageServer.features.haxe.RenameFeature",Object.assign(cn.prototype,{__class__:cn});class un{constructor(e){this.context=e;let t=e.capabilities.textDocument,n=null!=t?t.signatureHelp:null,r=null!=n?n.signatureInformation:null,i=null!=r?r.parameterInformation:null;this.labelOffsetSupport=1==(null!=i?i.labelOffsetSupport:null),e.languageServerProtocol.onRequest("textDocument/signatureHelp",nl(this,this.onSignatureHelp))}onSignatureHelp(e,t,n,r){let i=e.textDocument.uri,s=this.context.documents.documents.m.get(i),a=s instanceof bt?s:null;null==a&&Lt(i)&&(a=new bt(i,"hx",1,Ei.readFileSync(vt(i),{encoding:"utf8"})));let l=a;null!=l&&Pt(i)?(this.context.haxeServer.supports("display/signatureHelp")?nl(this,this.handleJsonRpc):nl(this,this.handleLegacy))(e,t,n,r,l):Wt(r,i)}handleJsonRpc(e,t,n,r,i){let s=!0;if(gr.isEqualOrGreaterThan(this.context.haxeServer.haxeVersion,{major:4,minor:1,patch:0,pre:null,build:null})){let t=null!=e?e.context:null,n=null!=t?t.triggerKind:null;if(null==n)s=!1;else switch(n){case 1:case 3:s=!1;break;case 2:s=!0}}let a=i.get_tokens(),l=null!=a?a.getTokenAtOffset(i.offsetAt(e.position)):null;for(;null!=l&&!xn.isCallPOpen(l);){if(xn.isFunctionBrOpen(l))return void n(null);l=l.parent}let o={file:vt(i.uri),contents:i.content,offset:this.context.displayOffsetConverter.characterOffsetToByteOffset(i.content,i.offsetAt(e.position)),wasAutoTriggered:s},c=this;this.context.callHaxeMethod("display/signatureHelp",o,t,(function(e){return n(null==e?null:c.createSignatureHelp(e)),null}),jt(r))}createSignatureHelp(e){let t=new Sr,n=1,r=this,i=function(e){let i,s=t.printFunctionArgument(e);if(r.labelOffsetSupport){let e=[n,n+s.length];n+=s.length,n+=2,i=e}else i=s;return{label:i}},s=e.activeSignature,a=e.activeParameter,l=e.signatures,o=function(n){let s=1==e.kind?t.printArrayAccess(n):t.printType({kind:"TFun",args:{args:n.args,ret:n.ret}}),a=r.getSignatureDocumentation(n.documentation),l=n.args,o=i,c=new Array(l.length),u=0,h=l.length;for(;u<h;){let e=u++;c[e]=o(l[e])}return{label:s,documentation:a,parameters:c}},c=new Array(l.length),u=0,h=l.length;for(;u<h;){let e=u++;c[e]=o(l[e])}return{activeSignature:s,activeParameter:a,signatures:c}}handleLegacy(e,t,n,r,i){let s=this.context.displayOffsetConverter.characterOffsetToByteOffset(i.content,i.offsetAt(e.position)),a=vt(i.uri),l=this;this.context.callDisplay("@signature",[(null==a?"null":a)+"@"+s+"@signature"],i.content,t,(function(e){switch(e._hx_index){case 0:n(null);break;case 1:let t=JSON.parse(e.msg),r=0,i=t.signatures;for(;r<i.length;){let e=i[r];++r,e.documentation=l.getSignatureDocumentation(e.documentation);let t=e.parameters;if(null!=t){let e=0,n=t.length;for(;e<n;){let n=e++;t[n].label=hr.addNamesToSignatureType(t[n].label,n)}}e.label=hr.addNamesToSignatureType(e.label)}n(t)}}),jt(r))}getSignatureDocumentation(e){if(null!=e&&this.context.config.user.enableSignatureHelpDocumentation)return{kind:"markdown",value:lr.markdownFormat(e)}}}un.__name__="haxeLanguageServer.features.haxe.SignatureHelpFeature",Object.assign(un.prototype,{__class__:un});class hn{constructor(e){this.context=e,e.languageServerProtocol.onRequest("workspace/symbol",nl(this,this.onWorkspaceSymbols))}processSymbolsReply(e,t){let n=[],r=0;for(;r<e.length;){let t=e[r];++r;let i=Ft(ur.getProperFileNameCase(t.file)),s=0,a=t.symbols;for(;s<a.length;){let e=a[s];if(++s,null!=e.range)n.push(this.moduleSymbolEntryToSymbolInformation(e,i));else{let t=this.context,n="Unknown location for "+JSON.stringify(e),r=t.languageServerProtocol,i={type:1,message:n},s={jsonrpc:"2.0",method:"window/showMessage"};null!=i&&(s.params=i),r.writeMessage(s,null),null!=r.didSendNotification&&r.didSendNotification(s)}}}return n}makeRequest(e,t,n,r,i,s){let a=this.context.startTimer("@workspace-symbols"),l=this;this.context.callDisplay(e,t,null==n?null:n.content,r,(function(e){switch(e._hx_index){case 0:i([]);break;case 1:let t,n=e.msg;try{t=JSON.parse(n)}catch(e){let t=Me.caught(e),n=s,r=null,i={code:-32603,message:"Error parsing document symbol response: "+re.string(t)};return null!=r&&(i.data=r),void n(i)}let r=l.processSymbolsReply(t,s);i(r),a(t,t.length+" symbols")}}),jt(s))}onWorkspaceSymbols(e,t,n,r){this.makeRequest("@workspace-symbols",["?@0@workspace-symbols@"+e.query],null,t,n,r)}moduleSymbolEntryToSymbolInformation(e,t){let n;switch(e.kind){case 3:case 13:n=10;break;case 2:case 4:n=11;break;case 1:case 5:n=5;break;case 6:n=8;break;case 7:n=7;break;case 8:n=6;break;case 9:n=9;break;case 10:n=12;break;case 11:n=13;break;case 12:n=23;break;case 14:n=25;break;case 15:n=22;break;case 16:n=14;break;case 17:n=2}let r={name:e.name,kind:n,location:{uri:t,range:e.range}};return null!=e.containerName&&(r.containerName=e.containerName),null!=e.isDeprecated&&e.isDeprecated&&(r.tags=[1]),r}}hn.__name__="haxeLanguageServer.features.haxe.WorkspaceSymbolsFeature",Object.assign(hn.prototype,{__class__:hn});var dn=r["haxeLanguageServer.features.haxe.codeAction.CodeActionResolveType"]={__ename__:!0,__constructs__:null,MissingArg:{_hx_name:"MissingArg",_hx_index:0,__enum__:"haxeLanguageServer.features.haxe.codeAction.CodeActionResolveType",toString:n},ChangeFinalToVar:{_hx_name:"ChangeFinalToVar",_hx_index:1,__enum__:"haxeLanguageServer.features.haxe.codeAction.CodeActionResolveType",toString:n},AddTypeHint:{_hx_name:"AddTypeHint",_hx_index:2,__enum__:"haxeLanguageServer.features.haxe.codeAction.CodeActionResolveType",toString:n},ExtractInterface:{_hx_name:"ExtractInterface",_hx_index:3,__enum__:"haxeLanguageServer.features.haxe.codeAction.CodeActionResolveType",toString:n},ExtractMethod:{_hx_name:"ExtractMethod",_hx_index:4,__enum__:"haxeLanguageServer.features.haxe.codeAction.CodeActionResolveType",toString:n},ExtractType:{_hx_name:"ExtractType",_hx_index:5,__enum__:"haxeLanguageServer.features.haxe.codeAction.CodeActionResolveType",toString:n},ExtractConstructorParamsAsVars:{_hx_name:"ExtractConstructorParamsAsVars",_hx_index:6,__enum__:"haxeLanguageServer.features.haxe.codeAction.CodeActionResolveType",toString:n},ExtractConstructorParamsAsFinals:{_hx_name:"ExtractConstructorParamsAsFinals",_hx_index:7,__enum__:"haxeLanguageServer.features.haxe.codeAction.CodeActionResolveType",toString:n},RewriteVarsToFinals:{_hx_name:"RewriteVarsToFinals",_hx_index:8,__enum__:"haxeLanguageServer.features.haxe.codeAction.CodeActionResolveType",toString:n},RewriteFinalsToVars:{_hx_name:"RewriteFinalsToVars",_hx_index:9,__enum__:"haxeLanguageServer.features.haxe.codeAction.CodeActionResolveType",toString:n},RewriteWrapWithTryCatch:{_hx_name:"RewriteWrapWithTryCatch",_hx_index:10,__enum__:"haxeLanguageServer.features.haxe.codeAction.CodeActionResolveType",toString:n}};dn.__constructs__=[dn.MissingArg,dn.ChangeFinalToVar,dn.AddTypeHint,dn.ExtractInterface,dn.ExtractMethod,dn.ExtractType,dn.ExtractConstructorParamsAsVars,dn.ExtractConstructorParamsAsFinals,dn.RewriteVarsToFinals,dn.RewriteFinalsToVars,dn.RewriteWrapWithTryCatch];class pn{constructor(e){this.contributors=[],this.context=e,this.refactorFeature=new on(e),e.registerCapability("textDocument/codeAction",null,{documentSelector:kt.haxeSelector,codeActionKinds:["quickfix","source.organizeImports","source.sortImports","refactor.extract","refactor.rewrite","source.fixAll"],resolveProvider:!0});let t=e.capabilities.textDocument,n=null!=t?t.codeAction:null,r=null!=n?n.resolveSupport:null,i=null!=r?r.properties:null,s=null!=i?i.includes("command"):null;if(this.hasCommandResolveSupport=null!=s&&s,!this.hasCommandResolveSupport){let t=e.experimental,n=null!=t?t.forceCommandResolveSupport:null;this.hasCommandResolveSupport=null!=n&&n}e.languageServerProtocol.onRequest("textDocument/codeAction",nl(this,this.onCodeAction)),e.languageServerProtocol.onRequest("codeAction/resolve",nl(this,this.onCodeActionResolve)),this.registerContributor(new _n(e)),this.registerContributor(new mn(e)),this.registerContributor(new fn(e)),this.registerContributor(this.refactorFeature)}registerContributor(e){this.contributors.push(e)}onCodeAction(e,t,n,r){let i=[],s=0,a=this.contributors;for(;s<a.length;)i=i.concat(a[s++].createCodeActions(e));n(i)}onCodeActionResolve(e,t,n,r){let i=e.data,s=null!=i?i.type:null,a=null!=i?i.params:null,l=null!=i?i.diagnostic:null;if(null==s||null==a)return void n(e);switch(s._hx_index){case 0:case 1:if(null==l)return void n(e)}let o=this;switch(s._hx_index){case 0:case 1:case 2:let t;if(null==s)t=null;else switch(s._hx_index){case 0:t=Tn.createMissingArgumentsAction(this.context,e,a,l);break;case 1:t=yn.createChangeFinalToVarAction(this.context,e,a,l);break;case 2:t=kn.createAddTypeHintAction(this.context,e,a);break;default:t=null}if(null==t){let e=r,t=null,n={code:-32603,message:"failed to resolve missing arguments action"};return null!=t&&(n.data=t),void e(n)}t.then((function(e){n(e);let t=e.command;if(null==t||o.hasCommandResolveSupport)return;let r=o.context.languageServerProtocol,i=t.arguments,s={command:t.command,arguments:null!=i?i:[]},a={jsonrpc:"2.0",method:"haxe/executeClientCommand"};null!=s&&(a.params=s),r.writeMessage(a,null),null!=r.didSendNotification&&r.didSendNotification(a)})).catch((function(e){r(e)}));break;case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:this.refactorFeature.createCodeActionEdits(this.context,s,e,a).then((function(t){e.edit=t,n(e)})).catch((function(e){r(e)}))}}}pn.__name__="haxeLanguageServer.features.haxe.codeAction.CodeActionFeature",Object.assign(pn.prototype,{__class__:pn});class fn{constructor(e){this.context=e}createCodeActions(e){if(!Pt(e.textDocument.uri))return[];let t=[],n=0,r=e.context.diagnostics;for(;n<r.length;){let i=r[n];++n;let s,a=i.data,l=null!=a?a.kind:null;if(null!=l&&"number"==typeof l&&(0|l)===l){switch(Qt.make(l)){case 0:s=An.createUnusedImportActions(this.context,e,i);break;case 1:s=Ln.createUnresolvedIdentifierActions(this.context,e,i);break;case 2:s=wn.createCompilerErrorActions(this.context,e,i);break;case 3:s=Pn.createReplaceableCodeActions(this.context,e,i);break;case 4:s=vn.createParserErrorActions(this.context,e,i);break;case 7:s=Sn.createMissingFieldsActions(this.context,e,i);break;default:s=[]}t=t.concat(s)}}return t=Cn.createOrganizeImportActions(this.context,e,t).concat(t),t=Fn.createUpdateSyntaxActions(this.context,e,t).concat(t),t=kn.createAddTypeHintActions(this.context,e,t).concat(t),t=bn.createFixAllAction(this.context,e,t).concat(t),t=Ct(t,(function(e,t){return e.title==t.title})),t}}fn.__name__="haxeLanguageServer.features.haxe.codeAction.DiagnosticsCodeActionFeature",fn.__interfaces__=[ln],Object.assign(fn.prototype,{__class__:fn});class mn{constructor(e){this.context=e}createCodeActions(e){if(null!=e.context.only&&!e.context.only.includes("refactor.extract"))return[];let t=e.textDocument.uri,n=this.context.documents.documents.m.get(t),r=n instanceof bt?n:null;return null==r&&Lt(t)&&(r=new bt(t,"hx",1,Ei.readFileSync(vt(t),{encoding:"utf8"}))),this.extractConstant(r,t,e.range)}extractConstant(e,t,n){if(null==e)return[];let r=e.get_tokens();if(null==r)return[];try{let i=r.getTokenAtOffset(e.offsetAt(n.start));if(null==i)return[];let s=i.tok;if(2==s._hx_index){let n=s.c;if(2==n._hx_index){let s=this.makeExtractConstAction(e,r,t,i,n.s);return null==s?[]:[s]}return[]}return[]}catch(e){return[]}}makeExtractConstAction(e,t,n,r,i){if(null==i||""==i)return null;if(this.shouldSkipToken(r))return null;let a=t.getPos(r),l=a.max,o=e.getText({start:e.positionAt(a.min,1),end:e.positionAt(l,1)});if(o.startsWith("'")&&new s("[$]","g").match(i))return null;let c=new RegExp("[^A-Za-z0-9]","g".split("u").join("")),u=i.replace(c,"_"),h=new RegExp("^[0-9]","g".split("u").join(""));u=u.replace(h,"_");let d=new RegExp("_+","g".split("u").join(""));u=u.replace(d,"_");let p=new RegExp("(^_|_$)","g".split("u").join(""));if(u=u.replace(p,""),u=u.toUpperCase(),u.length<=0)return null;let f=this.findParentType(r);if(null==f)return null;let m=sa.firstChild(sa.firstOf(sa.isCIdent(sa.firstChild(f)),oa.BrOpen));if(null==m)return null;let _=e.positionAt(t.getTreePos(m).min),g=f.filterCallback((function(e,t){let n=e.tok;if(2==n._hx_index){let e=n.c;return 2==e._hx_index&&e.s==i?ia.FoundSkipSubtree:ia.GoDeeper}return ia.GoDeeper})),x=[],k=e.getText({start:{line:_.line,character:0},end:_});x.push(br.insertText(_,or.formatText(e,this.context,"static inline final "+u+" = "+o+";",la.FieldLevel)+"\n"+k));let y=0;for(;y<g.length;){let n=t.getPos(g[y++]),r=n.max,i=1;x.push(br.replaceText({start:e.positionAt(n.min,i),end:e.positionAt(r,i)},u))}return{title:"Extract constant",kind:"refactor.extract",edit:{documentChanges:[br.textDocumentEdit(n,x)]}}}shouldSkipToken(e){let t=e.parent;if(null==t||null==t.tok)return!0;let n=t.tok;switch(n._hx_index){case 6:switch(n.op._hx_index){case 4:let e=sa.parent(sa.isCIdent(sa.parent(t)));if(null!=e){let t=e.tok;if(1==t._hx_index)switch(t.k._hx_index){case 2:case 42:let t=sa.parent(sa.isCIdent(sa.parent(sa.matches(sa.parent(e),oa.BrOpen))));if(null==t)return!1;let n=t.tok;if(1!=n._hx_index)return!1;switch(n.k._hx_index){case 1:case 40:return!0;default:return!1}}}break;case 9:return!0}break;case 18:return!0;case 20:let e=sa.parent(sa.isCIdent(sa.parent(t)));if(null==e)return!1;switch(e.tok._hx_index){case 12:return null!=sa.matches(sa.parent(e),oa.At);case 23:return!0;default:return!1}}return!1}findParentType(e){let t=e.parent;for(;null!=t&&null!=t.tok;){let e=t.tok;if(1==e._hx_index)switch(e.k._hx_index){case 1:case 40:return t}t=t.parent}return null}}mn.__name__="haxeLanguageServer.features.haxe.codeAction.ExtractConstantFeature",mn.__interfaces__=[ln],Object.assign(mn.prototype,{__class__:mn});class _n{constructor(e){this.context=e}createCodeActions(e){if(null!=e.context.only&&!e.context.only.includes("refactor.extract"))return[];let t=e.textDocument.uri,n=this.context.documents.documents.m.get(t),r=n instanceof bt?n:null;null==r&&Lt(t)&&(r=new bt(t,"hx",1,Ei.readFileSync(vt(t),{encoding:"utf8"})));let i=r;return null==i?[]:this.extractVar(i,t,e.range)}extractVar(e,t,n){let r=e.get_tokens();if(null==r)return[];let i=r.getTokenAtOffset(e.offsetAt(n.start));if(null==i)return[];switch(i.tok._hx_index){case 2:let s=this.preDotToken(i);if(xn.isInFunctionScope(s))return[];if(this.isTypeHint(s))return[];if(xn.isAnonStructureField(s))return[];if(this.isFieldAssign(s))return[];let a=this.makeExtractVarAction(e,r,t,s,n);return null==a?[]:[a];case 16:case 17:let l=this.makeExtractVarAction(e,r,t,i,n);return null==l?[]:[l];case 18:case 19:if(xn.isAnonStructure(i)){let s=this.makeExtractVarAction(e,r,t,i,n);return null==s?[]:[s]}return[];default:return[]}}isFieldAssign(e){let t=e.tok;if(6!=t._hx_index){let t=e.getFirstChild();return null!=t&&this.isFieldAssign(t)}switch(t.op._hx_index){case 4:case 20:return!0;default:let t=e.getFirstChild();return null!=t&&this.isFieldAssign(t)}}isTypeHint(e){let t=e.parent;for(;null!=t;){if(12==t.tok._hx_index){let e=t.parent,n=null!=e?e.parent:null;return(null!=n?n.tok:null)!=oa.BrOpen}e=t,t=t.parent}return!1}makeExtractVarAction(e,t,n,r,i){let s,l=t.getTokenAtOffset(e.offsetAt(i.end)),o=(null!=l?l:r).tok;switch(o._hx_index){case 2:let e=o.c;switch(e._hx_index){case 0:let t=e.s;s=null!=t?t:"value";break;case 1:let n=e.s;s=null!=n?n:"value";break;case 2:s=e.s;break;case 3:let r=e.s;s=null!=r?r:"value";break;default:s="value"}break;case 16:case 17:s="arr";break;case 18:case 19:s="obj";break;default:s="value"}let c=new RegExp("[^A-Za-z0-9]","g".split("u").join("")),u=s.replace(c,"_"),h=new RegExp("^[0-9]","g".split("u").join(""));u=u.replace(h,"_");let d=new RegExp("_+","g".split("u").join(""));u=u.replace(d,"_");let p=new RegExp("(^_|_$)","g".split("u").join(""));if(u=u.replace(p,""),u=u.length>1&&u.charAt(1).toLowerCase()==u.charAt(1)?u.charAt(0).toLowerCase()+a.substr(u,1,null):u.toLowerCase(),u.length<=0)return null;let f=this.findParentInLocalScope(r);if(null==f)return null;let m=function(e){return t=e.end,n=e.start,t.line==n.line&&t.character==n.character;var t,n}(i)?this.getExtractionRange(e,r):i;if(null==m)return null;let _=e.getText(m),g=e.positionAt(t.getTreePos(f).min),x=this.context.hasClientCommandSupport("haxe.codeAction.insertSnippet");x&&(u="${1:"+u+"}");let k=e.getText({start:{line:g.line,character:0},end:g}),y=or.formatText(e,this.context,_+";",la.ExpressionLevel),w=0,b=[],T=tl(y.split("\n"));for(;T.hasNext();){let e=T.next();b.push(0==w++?e:""+k+e)}y=b.join("\n");let S="final "+u+" = "+y,C=S;C=S+e.getText({start:e.positionAt(e.offsetAt(g)),end:e.positionAt(e.offsetAt(m.start))}),C+=u,x&&(C+="$0");let v=Rt({start:g,end:g},m),P={title:"Extract to var in enclosing scope",kind:"refactor.extract"};if(x)P.command={title:"Insert Snippet",command:"haxe.codeAction.insertSnippet",arguments:[n,v,C]};else{let t={};null!=e&&(t[e.uri]=[br.replaceText(v,C)]),P.edit={changes:t}}return P}findParentInLocalScope(e){let t=e.parent;for(;null!=t;){let n=t.tok;switch(n._hx_index){case 1:switch(n.k._hx_index){case 0:case 7:case 15:return null}break;case 18:if(!xn.isAnonStructure(t))return e}e=t,t=t.parent}return null}getExtractionRange(e,t){let n=this.findExtractionRangeTokens(t),r=null,i=0;for(;i<n.length;){let t=n[i];if(++i,null==t)continue;let s=t.pos.max,a=0,l={start:e.positionAt(t.pos.min,a),end:e.positionAt(s,a)};null!=r?r=Rt(r,l):r=l}return r}preDotToken(e){let t=e.parent;if(null==t)return e;let n=t.tok;switch(n._hx_index){case 1:if(22==n.k._hx_index)return t;break;case 11:case 13:let r=t.parent;return null==r?e:e.isCIdent()?this.preDotToken(r):e}return e}findExtractionRangeTokens(e){if(e.tok==oa.BrClose||e.tok==oa.BkClose){let t=e.parent;if(null==t)return[];e=t}switch(e.tok._hx_index){case 16:let t=e.parent;if(null==t)return[];if(!t.isCIdent()&&!t.matches(oa.BkOpen))return[e,this.getLastNonCommaToken(e)];e=t;break;case 18:return[e,this.getLastNonCommaToken(e)]}let t=e.parent;for(;null!=t;){switch(t.tok._hx_index){case 1:let n=t.tok;if(1!=n._hx_index){let t=e.getFirstChild();return[e,this.getLastNonCommaToken((null!=t?t.tok:null)==oa.Dot||(null!=t?t.tok:null)==oa.QuestionDot?t:e)]}switch(n.k._hx_index){case 2:case 22:case 42:return[];default:let t=e.getFirstChild();return[e,this.getLastNonCommaToken((null!=t?t.tok:null)==oa.Dot||(null!=t?t.tok:null)==oa.QuestionDot?t:e)]}break;case 6:let r=t.tok;if(1!=r._hx_index){let t=e.getFirstChild();return[e,this.getLastNonCommaToken((null!=t?t.tok:null)==oa.Dot||(null!=t?t.tok:null)==oa.QuestionDot?t:e)]}switch(r.k._hx_index){case 2:case 22:case 42:return[];default:let t=e.getFirstChild();return[e,this.getLastNonCommaToken((null!=t?t.tok:null)==oa.Dot||(null!=t?t.tok:null)==oa.QuestionDot?t:e)]}break;case 12:let i=t.tok;if(1!=i._hx_index){let t=e.getFirstChild();return[e,this.getLastNonCommaToken((null!=t?t.tok:null)==oa.Dot||(null!=t?t.tok:null)==oa.QuestionDot?t:e)]}switch(i.k._hx_index){case 2:case 22:case 42:return[];default:let t=e.getFirstChild();return[e,this.getLastNonCommaToken((null!=t?t.tok:null)==oa.Dot||(null!=t?t.tok:null)==oa.QuestionDot?t:e)]}break;case 11:case 13:let s=t.parent;if(1==(null!=s?s.isCIdent():null)){let e=t.parent;if(null==e)return[];t=e}break;case 16:case 20:switch(t.tok._hx_index){case 16:case 20:break;default:return[]}let a=[e],l=e.getFirstChild();if((null!=l?l.tok:null)==oa.Arrow||null!=sa.firstOf(t,oa.Arrow))return[];if(null==l)return a;let o,c,u=e.tok,h=this.getLastToken(l.tok==oa.Dot||l.tok==oa.QuestionDot||l.tok==oa.POpen||1==u._hx_index&&22==u.k._hx_index?l:e);if(null==h)return a;switch(o=h,h.tok._hx_index){case 6:case 15:c=!0;break;default:c=!1}if(c){let e=h.parent;if(null==e)return a;o=e}return a.push(o),a}e=t,t=t.parent}return[]}getLastToken(e){return null==e?null:fa.getLastToken(e)}getLastNonCommaToken(e){let t=this.getLastToken(e);if(null==t)return t;if(t.tok==oa.Comma||t.tok==oa.Semicolon){let e=t.previousSibling;return null==e?t.parent:this.getLastNonCommaToken(e)}return t}}_n.__name__="haxeLanguageServer.features.haxe.codeAction.ExtractVarFeature",_n.__interfaces__=[ln],Object.assign(_n.prototype,{__class__:_n});class gn{static organizeImports(e,t,n){let r=e.get_tokens();if(null==r)return[];try{let i=null,s=r.tree.filterCallback((function(e,t){let n=e.tok;switch(n._hx_index){case 1:switch(n.k._hx_index){case 34:let t=e.getFirstChild();if(null==t)return ia.SkipSubtree;let n=t.tok;switch(n._hx_index){case 1:i=""+re.string(t);break;case 2:let e=n.c;3==e._hx_index&&(i=e.s)}return ia.SkipSubtree;case 13:case 36:return ia.FoundSkipSubtree;default:return ia.SkipSubtree}break;case 3:return ia.GoDeeper;case 8:let t=n.s,r=t,s=t.length,l=0;for(;l<s&&se.isSpace(t,l);)++l;return r=l>0?a.substr(t,l,s-l):t,r.startsWith("import ")||r.startsWith("using ")?ia.FoundSkipSubtree:ia.SkipSubtree;default:return ia.SkipSubtree}})),l=new Qe,o=0;for(;o<s.length;){let t=s[o];++o;let c=-1;null!=t.parent&&(c=t.parent.index);let u=l.m.get(c);null==u&&(u={id:c,startOffset:r.getPos(t).min,imports:[],usings:[],lastIndex:t.index},l.m.set(c,u));let h=e.lineRangeAt(r.getTreePos(t).min),d=!1,p=0;for(;p<n.length;){let e=n[p];if(++p,Bt(e,h.start)&&Bt(e,h.end)){d=!0;break}}if(d)continue;let f=gn.determineImportType(t,i),m=e.getText(h),_=t.tok;switch(_._hx_index){case 1:switch(_.k._hx_index){case 13:u.imports.push({token:t,text:m,sortText:m,type:f,range:h}),u.lastIndex=t.index;break;case 36:u.usings.push({token:t,text:m,sortText:m,type:f,range:h}),u.lastIndex=t.index}break;case 8:let e=_.s,n=e,r=e.length,i=0;for(;i<r&&se.isSpace(e,i);)++i;n=i>0?a.substr(e,i,r-i):e,n.startsWith("import ")&&(u.imports.push({token:t,text:m,sortText:n,type:f,range:h}),u.lastIndex=t.index),n.startsWith("using ")&&(u.usings.push({token:t,text:m,sortText:n,type:f,range:h}),u.lastIndex=t.index)}}return gn.organizeImportGroups(e,t,l)}catch(e){return[]}}static determineImportType(e,t){let n,r=e.tok;if(8==r._hx_index){let e=r.s,t=e,i=e.length,s=0;for(;s<i&&se.isSpace(e,s);)++s;t=s>0?a.substr(e,s,i-s):e,t.startsWith("import ")&&(t=a.substr(t,7,null)),t.startsWith("using ")&&(t=a.substr(t,6,null));let l=t.indexOf(".");l<0?(l=t.indexOf(";"),n=t,l>0&&(n=t.substring(0,l))):n=t.substring(0,l)}else{let t=e.getFirstChild();if(null==t)return 2;let r=t.tok;switch(r._hx_index){case 1:n=""+re.string(t);break;case 2:let e=r.c;if(3!=e._hx_index)return 2;n=e.s;break;default:return 2}}return gn.stdLibPackages.includes(n)?0:null==t||n==t?2:1}static organizeImportGroups(e,t,n){let r=[],i=n.m.get(-1);n.m.delete(-1);let s=n.m.values(),a=s.next();for(;!a.done;){let n=a.value;a=s.next(),r=r.concat(gn.organizeImportGroup(e,t,n))}return null!=i&&(r=r.concat(gn.organizeImportGroup(e,t,i))),r}static organizeImportGroup(e,t,n){let r=gn.determineSortFunction(t);if(null==r)return[];Ve.sort(n.imports,r);let i=n.imports,s=new Array(i.length),l=0,o=i.length;for(;l<o;){let e=l++;s[e]=i[e].text}let c=s.join("\n");Ve.sort(n.usings,r);let u=n.usings,h=new Array(u.length),d=0,p=u.length;for(;d<p;){let e=d++;h[e]=u[e].text}let f=h.join("\n"),m=or.formatText(e,t,c+(n.imports.length>0?"\n":"")+f+(n.usings.length>0?"\n":""),la.TypeLevel);10!=a.cca(m,m.length-1)&&(m+="\n");let _=[],g=0,x=n.imports;for(;g<x.length;){let t=x[g];++g,_.push(gn.makeImportEdit(e,t.range,t.token.index==n.lastIndex))}let k=0,y=n.usings;for(;k<y.length;){let t=y[k];++k,_.push(gn.makeImportEdit(e,t.range,t.token.index==n.lastIndex))}return _.push(br.insertText(e.positionAt(n.startOffset),m)),_}static determineSortFunction(e){switch(e.config.user.importsSortOrder){case"all-alphabetical":return gn.sortImportsAllAlpha;case"non-project -> project":return gn.sortImportsNonProjectThenProject;case"stdlib -> libs -> project":return gn.sortImportsStdlibThenLibsThenProject}}static makeImportEdit(e,t,n){return t.end.line++,t.end.character=0,se.trim(e.getText({start:t.end,end:{line:t.end.line+1,character:0}})).length<=0&&!n&&t.end.line++,br.removeText(t)}static sortImportsAllAlpha(e,t){return e.sortText<t.sortText?-1:e.sortText>t.sortText?1:0}static sortImportsStdlibThenLibsThenProject(e,t){return e.type<t.type?-1:e.type>t.type?1:e.sortText<t.sortText?-1:e.sortText>t.sortText?1:0}static sortImportsNonProjectThenProject(e,t){return 0==e.type&&(e.type=1),0==t.type&&(t.type=1),gn.sortImportsStdlibThenLibsThenProject(e,t)}}gn.__name__="haxeLanguageServer.features.haxe.codeAction.OrganizeImportsFeature";class xn{static isInFunctionScope(e){let t=e.parent;return null!=t&&xn.isFunctionBrOpen(t)}static isFunctionBrOpen(e){if(e.tok!=oa.BrOpen)return!1;let t=e.parent;if(null==t)return!1;let n,r=t.tok;switch(r._hx_index){case 1:n=0==r.k._hx_index;break;case 14:n=!0;break;default:n=!1}if(n)return!0;let i=t.parent;if(null==i)return!1;let s=i.tok;return 1==s._hx_index&&0==s.k._hx_index}static isCallPOpen(e){return e.tok==oa.POpen&&fa.getPOpenType(e)==ga.Call}static isFunctionArg(e){let t=e.parent;if(null==t)return!1;if(t.tok!=oa.POpen)return!1;let n=t.parent;if(null==n)return!1;let r,i=n.tok;switch(i._hx_index){case 1:r=0==i.k._hx_index;break;case 14:r=!0;break;default:r=!1}if(r)return!0;let s=n.parent;if(null==s)return!1;let a=s.tok;return 1==a._hx_index&&0==a.k._hx_index}static isInLoopScope(e){let t,n=e.parent;if(null==n)return!1;if(t=n,n.tok==oa.BrOpen){let e=n.parent;if(null==e)return!1;t=e}let r=t.tok;if(1!=r._hx_index)return!1;switch(r.k._hx_index){case 5:case 6:case 7:return!0;default:return!1}}static isAnonStructure(e){if(e.tok==oa.BrClose){let t=e.parent;if(null==t)return!1;e=t}let t,n=null!=e?e.getFirstChild():null;if(null==n)return!1;t=n;let r,i=t.getFirstChild();if(null==i)return!1;if(12==i.tok._hx_index){let e=i.nextSibling,t=null!=e?e.tok:null;r=!(null!=t&&10==t._hx_index)}else r=!1;return!!r}static isAnonStructureField(e){let t=e.parent;if(null==t)return!1;if(!xn.isAnonStructure(t))return!1;let n=e.getFirstChild();return null!=n&&12==n.tok._hx_index}}xn.__name__="haxeLanguageServer.features.haxe.codeAction.TokenTreeUtils";class kn{static createAddTypeHintActions(e,t,n){let r=t.textDocument.uri,i=e.documents.documents.m.get(r),s=i instanceof bt?i:null;null==s&&Lt(r)&&(s=new bt(r,"hx",1,Ei.readFileSync(vt(r),{encoding:"utf8"})));let a=s;if(null==a)return[];let l=[],o=a.get_tokens(),c=null!=o?o.getTokenAtOffset(a.offsetAt(t.range.end)):null;if(null==c)return[];if(c.isCIdent()){let e=kn.isFunctionName(c);if(kn.isVarDecl(c)||xn.isFunctionArg(c)){let e=c.getFirstChild();if(null!=e&&e.matches(oa.DblDot))return l}else{if(!e)return l;if(null!=sa.firstOf(c,oa.DblDot))return l}}else{if(!xn.isInFunctionScope(c))return l;let e,n=c.tok;if(1!=n._hx_index||10!=n.k._hx_index)return l;let r=c.parent,i=null!=r?r.parent:null;if(null==i)return l;if(e=i,null!=sa.firstOf(e,oa.DblDot))return l;let s=e.pos,o=s.max,u=0;t.range={start:a.positionAt(s.min,u),end:a.positionAt(o,u)}}return l.push({title:"Add type hint",data:{type:dn.AddTypeHint,params:t},kind:"refactor.rewrite",isPreferred:!1}),l}static createAddTypeHintAction(e,t,n){if(null!=n.context.only&&!n.context.only.includes("refactor.rewrite"))return null;let r=n.textDocument.uri,i=e.documents.documents.m.get(r),s=i instanceof bt?i:null;null==s&&Lt(r)&&(s=new bt(r,"hx",1,Ei.readFileSync(vt(r),{encoding:"utf8"})));let a=s;if(null==a)return null;let l=new Wi,o=a.get_tokens(),c=null!=o?o.getTokenAtOffset(a.offsetAt(n.range.end)):null;if(null==c)return null;let u=new Promise((function(t,r){e.findReferences.onFindReferences({textDocument:n.textDocument,position:a.positionAt(c.pos.min,0)},l,(function(e){t(null!=e?e:[])}),(function(e){r(e)}))})),h=new Promise((function(t,r){e.gotoDefinition.onGotoDefinition({textDocument:n.textDocument,position:a.positionAt(c.pos.min,0)},l,(function(e){t(e)}),(function(e){r(e)}))})),d=Promise.all([h,u]).then((function(t){let n=t[0][0];if(null==n)return null;let r,i=t[1],s=i[i.length-1],a=null!=s?s:{uri:n.targetUri,range:n.targetSelectionRange};if(null==a)return null;r=a;let o=r.uri,c=e.documents.documents.m.get(o),u=c instanceof bt?c:null;null==u&&Lt(o)&&(u=new bt(o,"hx",1,Ei.readFileSync(vt(o),{encoding:"utf8"})));let d=u;if(null==d)return null;let p=d.get_tokens(),f=null!=p?p.getTokenAtOffset(d.offsetAt(r.range.end)):null;if(null==f)return null;let m=f.getFirstChild();if(null!=m){let e;if(kn.isVarDecl(f))e=!1;else{let t=m.tok;if(6==t._hx_index)switch(t.op._hx_index){case 4:case 20:e=!0;break;default:e=!1}else e=!1}if(e){let e=m.pos,t=e.max,n=0;r.range={start:d.positionAt(e.min,n),end:d.positionAt(t,n)}}}let _=function(t){let n=vt(t.uri),r=t.uri,i=e.documents.documents.m.get(r),s=i instanceof bt?i:null;null==s&&Lt(r)&&(s=new bt(r,"hx",1,Ei.readFileSync(vt(r),{encoding:"utf8"})));let a=s;if(null==a)return Promise.resolve();let o=a.offsetAt(t.range.end)-1;return Tn.makeHoverRequest(e,n,o,l)}(r);return Promise.all([Promise.resolve(h),_])})),p=d.then((function(n){let r=n[1],i=n[0][0];if(null==i)return t;let s=i.targetUri,l=e.documents.documents.m.get(s),o=l instanceof bt?l:null;null==o&&Lt(s)&&(o=new bt(s,"hx",1,Ei.readFileSync(vt(s),{encoding:"utf8"})));let c=o;if(null==c)return t;let u=c.get_tokens(),h=null!=u?u.getTokenAtOffset(c.offsetAt(i.targetSelectionRange.end)):null;if(null==h||!h.isCIdent())return t;let d=h.getFirstChild();if(null!=d&&d.matches(oa.DblDot))return t;let p,f,m=kn.isFunctionName(h),_=Tn.printTypeHint(r.item);if(null==_)return t;if(p=_,m&&(p=kn.extractReturnType(_)),"?"==p)return t;if(m){let e,n=sa.firstOf(h,oa.POpen),r=null!=n?n:null;if(null==r)return t;e=r;let i=e.getPos(),s=i.max,l=0;f={start:a.positionAt(i.max,l),end:a.positionAt(s,l)}}else{let e=h.pos.max,t=0;f={start:a.positionAt(h.pos.max,t),end:a.positionAt(e,t)}}let g={};return null!=c&&(g[c.uri]=[{range:f,newText:":"+p}]),t.edit={changes:g},t}));return p}static isVarDecl(e){let t=e.parent;if(null==t)return!1;let n=t.tok;if(1!=n._hx_index)return!1;switch(n.k._hx_index){case 2:case 42:return!0;default:return!1}}static isFunctionName(e){let t=e.parent;if(null==t)return!1;let n=t.tok;return 1==n._hx_index&&0==n.k._hx_index}static extractReturnType(e){if(0==e.length||40!=a.cca(e,0))return e;let t=0,n=0;for(;n<e.length;){let r=n;switch(e.charCodeAt(n++)){case 40:++t;break;case 41:if(--t,0!=t)continue;let n=se.trim(a.substr(e,r+1,null));if(n.startsWith("->")){let e=a.substr(n,2,null),t=e.length,r=0;for(;r<t&&se.isSpace(e,r);)++r;return r>0?a.substr(e,r,t-r):e}return e}}return e}}kn.__name__="haxeLanguageServer.features.haxe.codeAction.diagnostics.AddTypeHintActions";class yn{static createChangeFinalToVarAction(e,t,n,r){if(null!=n.context.only&&!n.context.only.includes("quickfix"))return null;let i=n.textDocument.uri,s=e.documents.documents.m.get(i),a=s instanceof bt?s:null;null==a&&Lt(i)&&(a=new bt(i,"hx",1,Ei.readFileSync(vt(i),{encoding:"utf8"})));let l=a;if(null==l||null==r.range)return null;let o=new Wi,c=l.get_tokens(),u=null!=c?c.getTokenAtOffset(l.offsetAt(r.range.start)):null;if(null==u)return null;let h=Promise.all([new Promise((function(t,r){e.gotoDefinition.onGotoDefinition({textDocument:n.textDocument,position:l.positionAt(u.pos.min,0)},o,(function(e){t(e)}),(function(e){r(e)}))}))]).then((function(n){let r=n[0][0];if(null==r)return t;let i=r.targetUri,s=e.documents.documents.m.get(i),a=s instanceof bt?s:null;null==a&&Lt(i)&&(a=new bt(i,"hx",1,Ei.readFileSync(vt(i),{encoding:"utf8"})));let o=a;if(null==o)return t;let c=o.get_tokens(),u=yn.getFinalKwd(null!=c?c.getTokenAtOffset(o.offsetAt(r.targetSelectionRange.start)):null);if(null==u)return t;let h=u.pos.max,d={start:l.positionAt(u.pos.min,0),end:l.positionAt(h,0)},p={};return null!=o&&(p[o.uri]=[{range:d,newText:"var"}]),t.edit={changes:p},t}));return h}static getFinalKwd(e){let t=null!=e?e.parent:null;if(null==t)return null;let n=t.tok;return 1!=n._hx_index||42!=n.k._hx_index?null:t}}yn.__name__="haxeLanguageServer.features.haxe.codeAction.diagnostics.ChangeFinalToVarAction";class wn{static createCompilerErrorActions(e,t,n){if(null!=t.context.only&&!t.context.only.includes("quickfix"))return[];let r=[],i=e.diagnostics.getArguments(t.textDocument.uri,2,n.range);if(null==i)return r;let a=new s("\\(Suggestions?: (.*)\\)","");if(a.match(i)&&null!=n.range){let l=a.matched(1).split(","),o=n.range;if(null==o)throw new $s("Null pointer in .sure() call");let c=new s("has no field ([^ ]+) ","");c.match(i)&&(o.start.character=o.end.character-c.matched(1).length);let u=0;for(;u<l.length;){let i=l[u];++u,i=se.trim(i);let s=t.textDocument.uri,a=e.documents.documents.m.get(s),c=a instanceof bt?a:null;null==c&&Lt(s)&&(c=new bt(s,"hx",1,Ei.readFileSync(vt(s),{encoding:"utf8"})));let h=c,d={};null!=h&&(d[h.uri]=[{range:o,newText:i}]),r.push({title:"Change to "+i,kind:"quickfix",edit:{changes:d},diagnostics:[n]})}return r}let l=new s("Invalid package : ([\\w.]*) should be ([\\w.]*)","");if(l.match(i)&&null!=n.range){let i=l.matched(1),s=l.matched(2),a=t.textDocument.uri,o=e.documents.documents.m.get(a),c=o instanceof bt?o:null;null==c&&Lt(a)&&(c=new bt(a,"hx",1,Ei.readFileSync(vt(a),{encoding:"utf8"})));let u=c;if(null!=u){let a=se.replace(u.getText(n.range),i,s),l=n.range;if(null==l)throw new $s("Null pointer in .sure() call");let o=t.textDocument.uri,c=e.documents.documents.m.get(o),h=c instanceof bt?c:null;null==h&&Lt(o)&&(h=new bt(o,"hx",1,Ei.readFileSync(vt(o),{encoding:"utf8"})));let d=h,p={};null!=d&&(p[d.uri]=[{range:l,newText:a}]),r.push({title:"Change to "+a,kind:"quickfix.auto",edit:{changes:p},diagnostics:[n],isPreferred:!0})}}if(e.haxeServer.haxeVersion.major>=4&&null!=n.range&&i.includes("should be declared with 'override' since it is inherited from superclass")){let i=n.range.start,s=t.textDocument.uri,a=e.documents.documents.m.get(s),l=a instanceof bt?a:null;null==l&&Lt(s)&&(l=new bt(s,"hx",1,Ei.readFileSync(vt(s),{encoding:"utf8"})));let o=l;if(null!=o.get_tokens()){let e=o.get_tokens(),t=null!=e?e.getTokenAtOffset(o.offsetAt(n.range.start)):null,r=null!=t?t.parent:null,s=null!=r?r.pos:null,a=null!=s?s.min:null;null!=a&&(i=o.positionAt(a,0))}let c=t.textDocument.uri,u=e.documents.documents.m.get(c),h=u instanceof bt?u:null;null==h&&Lt(c)&&(h=new bt(c,"hx",1,Ei.readFileSync(vt(c),{encoding:"utf8"})));let d=h,p={};null!=d&&(p[d.uri]=[{range:{start:i,end:i},newText:"override "}]),r.push({title:"Add override keyword",kind:"quickfix.auto",edit:{changes:p},diagnostics:[n],isPreferred:!0})}return new s("Too many arguments([\\w.]*)","").match(i)&&r.push({title:"Add argument",data:{type:dn.MissingArg,params:t,diagnostic:n},kind:"quickfix",diagnostics:[n],isPreferred:!1}),(i.includes("Cannot assign to final")||i.includes("This expression cannot be accessed for writing"))&&r.push({title:"Change final to var",data:{type:dn.ChangeFinalToVar,params:t,diagnostic:n},kind:"quickfix",diagnostics:[n],isPreferred:!1}),r}}wn.__name__="haxeLanguageServer.features.haxe.codeAction.diagnostics.CompilerErrorActions";class bn{static createFixAllAction(e,t,n){if(null!=t.context.only&&!t.context.only.includes("source.fixAll"))return[];let r=t.textDocument.uri,i=e.documents.documents.m.get(r),s=i instanceof bt?i:null;return null==s&&Lt(r)&&(s=new bt(r,"hx",1,Ei.readFileSync(vt(r),{encoding:"utf8"}))),null==s?[]:[{title:"Fix All",kind:"source.fixAll",command:{title:"Fix All",command:"haxe.fixAll"},isPreferred:!0}]}}bn.__name__="haxeLanguageServer.features.haxe.codeAction.diagnostics.FixAllAction";class Tn{static createMissingArgumentsAction(e,t,n,r){if(null!=n.context.only&&!n.context.only.includes("quickfix"))return null;let i=n.textDocument.uri,s=e.documents.documents.m.get(i),a=s instanceof bt?s:null;null==a&&Lt(i)&&(a=new bt(i,"hx",1,Ei.readFileSync(vt(i),{encoding:"utf8"})));let l=a;if(null==l||null==r.range)return null;let o=new Wi,c=l.get_tokens(),u=null!=c?c.getTokenAtOffset(l.offsetAt(r.range.start)+1):null;if(null==u)return null;let h=Tn.getCallNamePos(l,u);if(null==h)return null;let d=new Promise((function(t,r){e.gotoDefinition.onGotoDefinition({textDocument:n.textDocument,position:h.start},o,(function(e){t(e)}),(function(e){r(e)}))})),p=vt(l.uri),f=l.offsetAt(r.range.end)-1;if(Tn.isFunctionInArg(u))if(Tn.isSingleArgArrowFunction(u)){let e=u.getFirstChild(),t=null!=e?e.pos:null,n=null!=t?t.min:null;null!=n&&(f=n)}else f=l.offsetAt(r.range.start);else if(u.matches(oa.Kwd(li.KwdNew))){let e=u.getFirstChild(),t=null!=e?e.pos:null,n=null!=t?t.min:null;null!=n&&(f=n)}let m=Promise.all([d,Tn.makeHoverRequest(e,p,f,o)]).then((function(n){let r=n[0][0];if(null==r)return t;let i=n[1].item,s=Tn.printTypeHint(i);if(null==s)return t;let a=r.targetUri,l=e.documents.documents.m.get(a),o=l instanceof bt?l:null;null==o&&Lt(a)&&(o=new bt(a,"hx",1,Ei.readFileSync(vt(a),{encoding:"utf8"})));let c=o;if(null==c)return t;let u=c.get_tokens(),h=null!=u?u.getTokenAtOffset(c.offsetAt(r.targetSelectionRange.start)):null,d=Tn.functionNewArgPos(c,h);if(null==d)return t;let p=Tn.functionArgsEndsWithComma(c,h),f=Tn.generateArgName(i),m=Tn.getArgsNames(e,c,h),_=1;for(;_<10;){let e=_++,t=f+(1==e?"":""+e);if(!m.includes(t)){f=t;break}}let g=e.hasClientCommandSupport("haxe.codeAction.insertSnippet"),x=""+f;if(g&&(x="${1:"+x+"}"),"?"!=s&&(x+=":"+s),Tn.functionArgsCount(c,h)>0&&(x=p?" "+x:", "+x),g)t.command={title:"Insert Snippet",command:"haxe.codeAction.insertSnippet",arguments:[c.uri,d,x]};else{let e={};null!=c&&(e[c.uri]=[{range:d,newText:x}]),t.edit={changes:e},t.command={title:"Highlight Insertion",command:"haxe.codeAction.highlightInsertion",arguments:[c.uri,d]}}return t}));return m}static printTypeHint(e){let t=e.type;if(null==t)return null;let n=new Sr(!0,Tr.Qualified,{argumentTypeHints:!0,returnTypeHint:"always",useArrowSyntax:!0,placeOpenBraceOnNewLine:!1,explicitPublic:!0,explicitPrivate:!0,explicitNull:!0}).printType(Dr(t).type),r=new RegExp("Null<Null<(.+?)>>","g".split("u").join(""));return n=n.replace(r,"Null<$1>"),n}static isFunctionInArg(e){return e.tok==oa.POpen?fa.getPOpenType(e)==ga.Parameter:!!Tn.isSingleArgArrowFunction(e)||e.matches(oa.Kwd(li.KwdFunction))}static isSingleArgArrowFunction(e){if(e.isCIdent()){let t=e.getFirstChild();return(null!=t?t.tok:null)==oa.Arrow}return!1}static generateArgName(e){switch(e.kind){case"AnonymousStructure":return"obj";case"ClassField":let t=e.args,n=null!=t?t.field:null,r=null!=n?n.name:null;return null!=r?r:"arg";case"Expression":let i=e.type;if("TFun"==(null!=i?i.kind:null))return"callback";break;case"Literal":break;default:let s=e.args,a=null!=s?s.name:null;return null!=a?a:"arg"}return Tn.genArgNameFromJsonType(e.type)}static genArgNameFromJsonType(e){let t,n=null!=e?Cr(e):null;if(null==n)return"arg";switch(t=n,t){case"Dynamic":return"value";case"EReg":return"regExp";case"StdTypes.Bool":return"bool";case"StdTypes.Float":return"f";case"String":return"s";case"StdTypes.Int":case"UInt":return"i";case"haxe.ds.Map":return"map";case"Array":case"haxe.ds.ReadOnlyArray":return"arr";default:return"arg"}}static getArgsNames(e,t,n){let r=Tn.getFunctionPOpen(n);if(null==r)return[];let i=r.filterCallback((function(e,t){return 0==t?ia.GoDeeper:e.isCIdent()?ia.FoundSkipSubtree:ia.SkipSubtree})),s=new Array(i.length),a=0,l=i.length;for(;a<l;){let e=a++;s[e]=i[e].toString()}return s}static makeHoverRequest(e,t,n,r){let i=null,s=new Promise((function(e,t){i=e}));return e.callHaxeMethod("display/hover",{file:t,offset:n},r,(function(e){return null!=i&&i(null==e?null:e),null}),(function(e){null!=i&&i(null)})),s}static getCallNamePos(e,t){let n=sa.findParent(t,(function(e){let t,n=null!=e?e:null;if(null==n)return!1;t=n;let r=t.tok;switch(r._hx_index){case 1:return 22==r.k._hx_index;case 2:if(3==r.c._hx_index){let e=t.parent;return null!=e&&!e.matches(oa.Kwd(li.KwdNew))}return!1;default:return!1}}));if(null==n)return null;let r=n.pos,i=r.max;return{start:e.positionAt(r.min,0),end:e.positionAt(i,0)}}static getFunctionPOpen(e){if(null==e)return null;let t=null!=e?e.parent:null,n=null!=t?t.tok:null;if(null==n||(1!=n._hx_index||0!=n.k._hx_index)){let t=e.getFirstChild();if(null==t)return null;e=t}let r=sa.firstOf(e,oa.POpen);return null!=r?r:null}static functionNewArgPos(e,t){let n=Tn.getFunctionPOpen(t);if(null==n)return null;let r=sa.firstOf(n,oa.PClose),i=null!=r?r:null;if(null==i)return null;let s=i.pos.min;return{start:e.positionAt(i.pos.min,0),end:e.positionAt(s,0)}}static functionArgsCount(e,t){let n=Tn.getFunctionPOpen(t);return null==n?0:n.filterCallback((function(e,t){return 0==t?ia.GoDeeper:e.isCIdent()?ia.FoundSkipSubtree:ia.SkipSubtree})).length}static functionArgsEndsWithComma(e,t){let n=Tn.getFunctionPOpen(t);if(null==n)return!1;let r=n.getLastChild(),i=null!=r?r.getLastChild():null;return null!=i&&i.matches(oa.Comma)}}Tn.__name__="haxeLanguageServer.features.haxe.codeAction.diagnostics.MissingArgumentsAction";class Sn{static createMissingFieldsActions(e,t,n){if(null!=t.context.only&&!t.context.only.includes("quickfix"))return[];let r=e.diagnostics.getArguments(t.textDocument.uri,7,n.range);if(null==r)return[];let i=Ft(r.moduleFile),l=e.documents.documents.m.get(i),o=l instanceof bt?l:null;null==o&&Lt(i)&&(o=new bt(i,"hx",1,Ei.readFileSync(vt(i),{encoding:"utf8"})));let c=o;if(null==c){if(!zs.exists(r.moduleFile))return[];let e=Ei.readFileSync(r.moduleFile,{encoding:"utf8"});c=new bt(i,"haxe",0,e)}let u=c.get_tokens();if(null==u)return[];let h,d=null,p=!1,f=r.moduleType.name,m=null;if("class"!=r.moduleType.kind)return[];if(m=Sn.getClassToken(u.tree,f),null==m){p=!0;let e=c.content.length-1,t=0;h={start:c.positionAt(e,t),end:c.positionAt(e,t)}}else{let e=u.getPos(m),t=e.min,n=0;d={start:c.positionAt(e.min,n),end:c.positionAt(t,n)};let r=u.getTreePos(m),i=r.max-1,s=0;h={start:c.positionAt(r.max-1,s),end:c.positionAt(i,s)}}let _=[],g=e.config.user.codeGeneration.imports,x=new Sr(!1,g.enableAutoImports?Tr.Shadowed:Tr.Qualified,e.config.user.codeGeneration.functions.field),k=[],y=e.hasClientCommandSupport("haxe.codeAction.insertSnippet"),w=null,b=[],T=0,S=r.entries;for(;T<S.length;){let e=S[T];++T;let t,i=e.fields.slice(),l=function(e){switch(e.kind){case"AbstractParent":if(null!=d){let e=_,t={};null!=c&&(t[c.uri]=[{range:d,newText:"abstract "}]),e.push({title:"Make abstract",kind:"quickfix",edit:{changes:t},diagnostics:[n]})}return et.Some("Implement methods for "+x.printPathWithParams(e.args.parent));case"FieldAccess":let t=i[0];if(null==t)return et.None;let s=p?se.replace(ot.withoutDirectory(r.moduleFile),".hx",""):f;return et.Some("Add "+t.field.name+" to "+s);case"FinalFields":let a=[],l=[];e.args.fields.sort((function(e,t){return e.pos.min-t.pos.min}));let o=0,u=e.args.fields;for(;o<u.length;){let e=u[o];++o,a.push({name:e.name,opt:!1,t:e.type});let t=e.name;l.push("this."+t+" = "+t)}let h=Sn.makeCtorJsonField(a,l,r.moduleType.pos);return i.push({field:h,type:h.type,unique:!1}),et.Some("Add constructor to "+f);case"ImplementedInterface":return et.Some("Implement fields for "+x.printPathWithParams(e.args.parent));case"PropertyAccessor":return et.Some("Implement "+(e.args.isGetter?"getter":"setter")+" for "+e.args.property.name)}},o=l(e.cause);switch(o._hx_index){case 0:t=o.v;break;case 1:return[]}let C=[],v=-1,P=x.collectQualifiedPaths();i.sort((function(e,t){return e.field.pos.min-t.field.pos.min}));let L=0;for(;L<i.length;){let e=i[L];++L;let t="";t=p?"\n\n":"\n\t";let r=[];if(null!=e.field.expr){let t=0,n=e.field.expr.string.split("\n");for(;t<n.length;)r.push(n[t++])}else{let t=Ar(e.type),n=null!=t?t.args:null;if(null!=n){let e=y&&-1==v;Sn.renameGeneratedFunctionArgs(n,e),e&&(v=C.length)}null!=t&&"StdTypes.Void"!=Cr(t.ret)&&r.push("throw new haxe.exceptions.NotImplementedException()")}t+=re.string(x.printClassFieldImplementation(e.field,e.type,!1,p,r));let s="TFun"==e.type.kind;if(null!=m)if(s){if(null!=n.range){let e=null!=u?u.getTokenAtOffset(c.offsetAt(n.range.start)):null;if(null!=e){let t=Sn.getNewClassFunctionPos(c,m,e);null!=t&&(h={start:t,end:t})}}}else{let t=Sn.getNewVariablePos(c,m,e.field.scope);null!=t&&(h={start:t,end:t})}let l=t;!s&&l.endsWith("\n")&&(l=a.substr(l,0,l.length-1));let o={range:h,newText:l};C.push(o),e.unique&&k.push(o)}let A=P();A=Ct(A,(function(e,t){return e==t})),b=b.concat(A),A.length>0&&C.push(dr(c,fr(c),A,g.style));let F={title:t,kind:"quickfix",diagnostics:[n]};if(w=C[v],null!=w){let e=w.newText,t=new s("({\n[\t ]+)(.+)\n","");t.match(e)&&(e=e.replace(t.r,"$1${0:$2}\n")),F.command={title:"Insert Snippet",command:"haxe.codeAction.insertSnippet",arguments:[c.uri,h,e]}}else{let t={};null!=c&&(t[c.uri]=C),F.edit={changes:t},"FieldAccess"==e.cause.kind&&(F.command={title:"Highlight Insertion",command:"haxe.codeAction.highlightInsertion",arguments:[c.uri,h]})}_.unshift(F)}if(r.entries.length>1){b=Ct(b,(function(e,t){return e==t})),b.length>0&&k.push(dr(c,fr(c),b,g.style));let e={title:"Implement all missing fields",kind:"quickfix",diagnostics:[n]};if(null!=w){let t=te.find(k,(function(e){return e.newText==w.newText}));null!=t&&a.remove(k,t),e.command={title:"Insert Snippet",command:"haxe.codeAction.insertSnippet",arguments:[c.uri,w.range,w.newText]}}let t={};null!=c&&(t[c.uri]=k),e.edit={changes:t},_.unshift(e)}return _.length>0&&(_[0].isPreferred=!0),_}static getClassToken(e,t){let n=e.filterCallback((function(e,t){let n=e.tok;switch(n._hx_index){case 1:return 1==n.k._hx_index?ia.FoundSkipSubtree:ia.SkipSubtree;case 3:return ia.GoDeeper;default:return ia.SkipSubtree}})),r=0;for(;r<n.length;){let e=n[r];++r;let i=fa.getNameToken(e);if(null!=i&&fa.getName(i)==t)return e}return null}static makeCtorJsonField(e,t,n){return{name:"new",type:{kind:"TFun",args:{args:e,ret:{kind:"TMono",args:null}}},isPublic:!0,isFinal:!1,isAbstract:!1,params:[],meta:[],kind:{kind:"FMethod",args:"MethNormal"},pos:n,doc:null,overloads:[],scope:2,expr:{string:t.join("\n")}}}static renameGeneratedFunctionArgs(e,t){let n=[],r=0,i=0;for(;i<e.length;){let s=e[i];++i;let a=s.name;a.startsWith("arg")&&4==a.length&&(a=Tn.genArgNameFromJsonType(s.t));let l=1;for(;l<10;){let e=l++,t=a+(1==e?"":""+e);if(!n.includes(t)){n.push(t),a=t;break}}++r,s.name.startsWith("${")||(s.name=t?"${"+r+":"+a+"}":a)}}static getNewVariablePos(e,t,n){let r=sa.firstOf(sa.firstChild(t),oa.BrOpen),i=null!=r?r:null;if(null==i)return null;if(0==n)return e.positionAt(i.pos.max,0);let s=sa.firstOf(i,oa.Kwd(li.KwdFunction)),a=null!=s?s:null,l=null!=a?a.previousSibling:null;for(;null!=l&&l.isComment();)l=l.previousSibling;return null==l?e.positionAt(i.pos.max,0):e.positionAt(l.getPos().max,0)}static getNewClassFunctionPos(e,t,n){let r=sa.firstOf(sa.firstChild(t),oa.BrOpen),i=null!=r?r:null;if(null==i)return null;if(0==i.filter([n.tok],ra.First).length)return null;let s=n.getPos(),a=i.children,l=0;for(;l<a.length;){let t=a[l];++l;let n=t.getPos();if(s.min<n.min||s.min>n.max)continue;let r=t.tok;if(1==r._hx_index&&0==r.k._hx_index)return e.positionAt(n.max+1,0)}return null}}Sn.__name__="haxeLanguageServer.features.haxe.codeAction.diagnostics.MissingFieldsActions";class Cn{static createOrganizeImportActions(e,t,n){let r=!0,i=!0,s=!0;if(null!=t.context.only&&(r=t.context.only.includes("quickfix"),i=t.context.only.includes("source.organizeImports"),s=t.context.only.includes("source.sortImports")),!r&&!i&&!s)return[];let a=t.textDocument.uri,l=e.documents.documents.m.get(a),o=l instanceof bt?l:null;null==o&&Lt(a)&&(o=new bt(a,"hx",1,Ei.readFileSync(vt(a),{encoding:"utf8"})));let c=o;if(null==c)return[];let u,h=e.diagnostics.getArgumentsMap(a);if(null==h)u=[];else{let e=[],t=h.keys();for(;t.hasNext();){let n=t.next();0==n.code&&null!=n.range&&e.push(br.removeText(lr.untrimRange(c,n.range)))}u=e}let d=gn.organizeImports(c,e,[]),p=new Array(u.length),f=0,m=u.length;for(;f<m;){let e=f++;p[e]=u[e].range}let _=u.concat(gn.organizeImports(c,e,p)),g=[],x=0;for(;x<n.length;){let e=n[x];++x,"Remove unused import/using"==e.title&&g.push(e)}let k=new Array(g.length),y=0,w=g.length;for(;y<w;){let e=y++;k[e]=g[e].diagnostics}let b=[],T=tl(k);for(;T.hasNext();){let e=tl(T.next());for(;e.hasNext();)b.push(e.next())}let S=te.array(b),C=[];if(i){let n=t.textDocument.uri,r=e.documents.documents.m.get(n),i=r instanceof bt?r:null;null==i&&Lt(n)&&(i=new bt(n,"hx",1,Ei.readFileSync(vt(n),{encoding:"utf8"})));let s=i,a={};null!=s&&(a[s.uri]=_),C.push({title:"Organize imports/usings",kind:"source.organizeImports",edit:{changes:a},diagnostics:S})}if(s){let n=t.textDocument.uri,r=e.documents.documents.m.get(n),i=r instanceof bt?r:null;null==i&&Lt(n)&&(i=new bt(n,"hx",1,Ei.readFileSync(vt(n),{encoding:"utf8"})));let s=i,a={};null!=s&&(a[s.uri]=d),C.push({title:"Sort imports/usings",kind:"source.sortImports",edit:{changes:a}})}if(r&&S.length>0&&u.length>1){let n=t.textDocument.uri,r=e.documents.documents.m.get(n),i=r instanceof bt?r:null;null==i&&Lt(n)&&(i=new bt(n,"hx",1,Ei.readFileSync(vt(n),{encoding:"utf8"})));let s=i,a={};null!=s&&(a[s.uri]=u),C.push({title:"Remove all unused imports/usings",kind:"quickfix",edit:{changes:a},diagnostics:S})}return C}}Cn.__name__="haxeLanguageServer.features.haxe.codeAction.diagnostics.OrganizeImportActions";class vn{static createParserErrorActions(e,t,n){if(null!=t.context.only&&!t.context.only.includes("quickfix"))return[];let r=[],i=e.diagnostics.getArguments(t.textDocument.uri,4,n.range);if(null==i)return r;if(i.includes("modifier is not supported for module-level fields")&&null!=n.range){let i=t.textDocument.uri,s=e.documents.documents.m.get(i),l=s instanceof bt?s:null;null==l&&Lt(i)&&(l=new bt(i,"hx",1,Ei.readFileSync(vt(i),{encoding:"utf8"})));let o,c=l,u=a.substr(c.content,c.offsetAt(n.range.end),null),h=u.split("{").length==u.split("}").length,d=null!=c?c.get_tokens():null,p=null!=d?d.getTokenAtOffset(c.offsetAt(n.range.end)):null,f=n.range;if(null==f)throw new $s("Null pointer in .sure() call");if(o=f,null!=p){let e=0,t=[p.previousSibling,p.nextSibling];for(;e<t.length;){let n,r=t[e];if(++e,null==r)continue;let i=r.tok;if(1!=i._hx_index||17!=i.k._hx_index){let e=r.tok;n=1==e._hx_index&&18==e.k._hx_index}else n=!0;if(n){let e=r.pos.max,t=0;o=Rt(o,{start:c.positionAt(r.pos.min,t),end:c.positionAt(e,t)})}}}let m=o.end;o.end={line:m.line,character:m.character+1};let _=t.textDocument.uri,g=e.documents.documents.m.get(_),x=g instanceof bt?g:null;null==x&&Lt(_)&&(x=new bt(_,"hx",1,Ei.readFileSync(vt(_),{encoding:"utf8"})));let k=x,y={};null!=k&&(y[k.uri]=[{range:o,newText:""}]),r.push({title:"Remove redundant modifiers",kind:"quickfix"+(h?".auto":""),edit:{changes:y},diagnostics:[n],isPreferred:!0})}if(i.includes("`final var` is not supported, use `final` instead")&&null!=n.range){let i=t.textDocument.uri,s=e.documents.documents.m.get(i);null==(s instanceof bt?s:null)&&Lt(i)&&new bt(i,"hx",1,Ei.readFileSync(vt(i),{encoding:"utf8"}));let a=n.range;if(null==a)throw new $s("Null pointer in .sure() call");let l=t.textDocument.uri,o=e.documents.documents.m.get(l),c=o instanceof bt?o:null;null==c&&Lt(l)&&(c=new bt(l,"hx",1,Ei.readFileSync(vt(l),{encoding:"utf8"})));let u=c,h={};null!=u&&(h[u.uri]=[{range:a,newText:"final"}]),r.push({title:"Change to final",kind:"quickfix.auto",edit:{changes:h},diagnostics:[n],isPreferred:!0})}if(i.includes("Missing ;")&&vn.createMissingSemicolonAction(e,t,n,r),i.includes("Expected }")&&null!=n.range){let i=t.textDocument.uri,s=e.documents.documents.m.get(i),a=s instanceof bt?s:null;null==a&&Lt(i)&&(a=new bt(i,"hx",1,Ei.readFileSync(vt(i),{encoding:"utf8"})));let l=a,o=null!=l?l.get_tokens():null,c=null!=o?o.getTokenAtOffset(l.offsetAt(n.range.end)):null,u=vn.getPrevNonCommentSibling(c);if(null!=u&&null!=c){let i=vn.getLastNonCommentToken(u),s=i.tok,a=c.tok;switch(s._hx_index){case 10:if(10==a._hx_index){let i=n.range;if(null==i)throw new $s("Null pointer in .sure() call");let s=t.textDocument.uri,a=e.documents.documents.m.get(s),l=a instanceof bt?a:null;null==l&&Lt(s)&&(l=new bt(s,"hx",1,Ei.readFileSync(vt(s),{encoding:"utf8"})));let o=l,c={};null!=o&&(c[o.uri]=[{range:i,newText:""}]),r.push({title:"Remove redundant ;",kind:"quickfix.auto",edit:{changes:c},diagnostics:[n],isPreferred:!0})}else{let a;switch(s._hx_index){case 15:case 18:a=!0;break;default:a=!1}if(!a&&vn.isAnonStructureField(c)){let s=i.pos.max,a=0,o={start:l.positionAt(i.pos.max,a),end:l.positionAt(s,a)},c=t.textDocument.uri,u=e.documents.documents.m.get(c),h=u instanceof bt?u:null;null==h&&Lt(c)&&(h=new bt(c,"hx",1,Ei.readFileSync(vt(c),{encoding:"utf8"})));let d=h,p={};null!=d&&(p[d.uri]=[{range:o,newText:","}]),r.push({title:"Add missing ,",kind:"quickfix.auto",edit:{changes:p},diagnostics:[n],isPreferred:!0})}}break;case 15:switch(a._hx_index){case 10:let a=c.previousSibling;if(null==a)return r;let o=a.parent;if(null==o)return r;let u=o.parent;if(null==u)return r;if(a.tok==oa.DblDot&&2==o.tok._hx_index&&u.tok==oa.BrOpen){let i=n.range;if(null==i)throw new $s("Null pointer in .sure() call");let s=t.textDocument.uri,a=e.documents.documents.m.get(s),l=a instanceof bt?a:null;null==l&&Lt(s)&&(l=new bt(s,"hx",1,Ei.readFileSync(vt(s),{encoding:"utf8"})));let o=l,c={};null!=o&&(c[o.uri]=[{range:i,newText:","}]),r.push({title:"Replace ; with ,",kind:"quickfix.auto",edit:{changes:c},diagnostics:[n],isPreferred:!0})}break;case 15:let h=n.range;if(null==h)throw new $s("Null pointer in .sure() call");let d=t.textDocument.uri,p=e.documents.documents.m.get(d),f=p instanceof bt?p:null;null==f&&Lt(d)&&(f=new bt(d,"hx",1,Ei.readFileSync(vt(d),{encoding:"utf8"})));let m=f,_={};null!=m&&(_[m.uri]=[{range:h,newText:""}]),r.push({title:"Remove redundant ,",kind:"quickfix.auto",edit:{changes:_},diagnostics:[n],isPreferred:!0});break;default:let g;switch(s._hx_index){case 15:case 18:g=!0;break;default:g=!1}if(!g&&vn.isAnonStructureField(c)){let s=i.pos.max,a=0,o={start:l.positionAt(i.pos.max,a),end:l.positionAt(s,a)},c=t.textDocument.uri,u=e.documents.documents.m.get(c),h=u instanceof bt?u:null;null==h&&Lt(c)&&(h=new bt(c,"hx",1,Ei.readFileSync(vt(c),{encoding:"utf8"})));let d=h,p={};null!=d&&(p[d.uri]=[{range:o,newText:","}]),r.push({title:"Add missing ,",kind:"quickfix.auto",edit:{changes:p},diagnostics:[n],isPreferred:!0})}}break;default:if(10==a._hx_index){let i=c.previousSibling;if(null==i)return r;let s=i.parent;if(null==s)return r;let a=s.parent;if(null==a)return r;if(i.tok==oa.DblDot&&2==s.tok._hx_index&&a.tok==oa.BrOpen){let i=n.range;if(null==i)throw new $s("Null pointer in .sure() call");let s=t.textDocument.uri,a=e.documents.documents.m.get(s),l=a instanceof bt?a:null;null==l&&Lt(s)&&(l=new bt(s,"hx",1,Ei.readFileSync(vt(s),{encoding:"utf8"})));let o=l,c={};null!=o&&(c[o.uri]=[{range:i,newText:","}]),r.push({title:"Replace ; with ,",kind:"quickfix.auto",edit:{changes:c},diagnostics:[n],isPreferred:!0})}}else{let a;switch(s._hx_index){case 15:case 18:a=!0;break;default:a=!1}if(!a&&vn.isAnonStructureField(c)){let s=i.pos.max,a=0,o={start:l.positionAt(i.pos.max,a),end:l.positionAt(s,a)},c=t.textDocument.uri,u=e.documents.documents.m.get(c),h=u instanceof bt?u:null;null==h&&Lt(c)&&(h=new bt(c,"hx",1,Ei.readFileSync(vt(c),{encoding:"utf8"})));let d=h,p={};null!=d&&(p[d.uri]=[{range:o,newText:","}]),r.push({title:"Add missing ,",kind:"quickfix.auto",edit:{changes:p},diagnostics:[n],isPreferred:!0})}}}}}if(i.includes("Expected , or ]")&&null!=n.range){let i=t.textDocument.uri,s=e.documents.documents.m.get(i),a=s instanceof bt?s:null;null==a&&Lt(i)&&(a=new bt(i,"hx",1,Ei.readFileSync(vt(i),{encoding:"utf8"})));let l=a,o=vn.getMissingSemicolonPos(l,n.range.start);if(null!=o){let i=o.start,s={line:i.line,character:i.character+-1};if(","!=l.getText({start:s,end:{line:s.line,character:s.character+1}})){let i=t.textDocument.uri,s=e.documents.documents.m.get(i),a=s instanceof bt?s:null;null==a&&Lt(i)&&(a=new bt(i,"hx",1,Ei.readFileSync(vt(i),{encoding:"utf8"})));let l=a,c={};null!=l&&(c[l.uri]=[{range:o,newText:","}]),r.push({title:"Add missing ,",kind:"quickfix.auto",edit:{changes:c},diagnostics:[n],isPreferred:!0})}}}return r}static createMissingSemicolonAction(e,t,n,r){let i=t.textDocument.uri,s=e.documents.documents.m.get(i),a=s instanceof bt?s:null;null==a&&Lt(i)&&(a=new bt(i,"hx",1,Ei.readFileSync(vt(i),{encoding:"utf8"})));let l,o=a,c=n.range;if(null==c)l=null;else{let e=c.start;l=vn.getMissingSemicolonPos(o,{line:e.line,character:e.character+1})}if(null==l)return;let u=l,h=u.start,d={line:h.line,character:h.character+-1};if(";"!=o.getText({start:d,end:{line:d.line,character:d.character+1}})){let i=t.textDocument.uri,s=e.documents.documents.m.get(i),a=s instanceof bt?s:null;null==a&&Lt(i)&&(a=new bt(i,"hx",1,Ei.readFileSync(vt(i),{encoding:"utf8"})));let l=a,o={};null!=l&&(o[l.uri]=[{range:u,newText:";"}]),r.push({title:"Add missing ;",kind:"quickfix.auto",edit:{changes:o},diagnostics:[n],isPreferred:!0})}}static getMissingSemicolonPos(e,t){let n=e.get_tokens();if(null==n)return null;let r=null!=n?n.getTokenAtOffset(e.offsetAt(t)):null;if(null==r)return null;let i=vn.getPrevNonCommentSibling(r);if(null==i||3==i.tok._hx_index)return null;let s=vn.getLastNonCommentToken(i).getPos(),a=s.max;return{start:e.positionAt(s.max,0),end:e.positionAt(a,0)}}static getPrevNonCommentSibling(e){do{e=null!=e?e.previousSibling:null}while(1==(null!=e?e.isComment():null));return e}static getLastNonCommentToken(e){let t=e;for(;;){let e=vn.getLastNonCommentChild(t);if(null==e)return t;t=e}}static getLastNonCommentChild(e){let t=e.children;if(null==t)return null;let n=t.length;for(;n-- >0;){let e=t[n];if(0==(null!=e?e.isComment():null))return e}return null}static isAnonStructure(e){if(e.tok==oa.BrClose){let t=e.parent;if(null==t)return!1;e=t}let t,n=null!=e?e.getFirstChild():null;if(null==n)return!1;t=n;let r,i=t.getFirstChild();if(null==i)return!1;if(12==i.tok._hx_index){let e=i.nextSibling,t=null!=e?e.tok:null;r=!(null!=t&&10==t._hx_index)}else r=!1;return!!r}static isAnonStructureField(e){let t=e.parent;if(null==t)return!1;if(!vn.isAnonStructure(t))return!1;let n=e.getFirstChild();return null!=n&&12==n.tok._hx_index}}vn.__name__="haxeLanguageServer.features.haxe.codeAction.diagnostics.ParserErrorActions";class Pn{static createReplaceableCodeActions(e,t,n){if(null!=t.context.only&&!t.context.only.includes("quickfix"))return[];let r=e.diagnostics.getArguments(t.textDocument.uri,3,n.range),i=null!=r?r.range:null,s=null!=r?r.newCode:null;if(null==i)return[];let a=t.textDocument.uri,l=e.documents.documents.m.get(a),o=l instanceof bt?l:null;null==o&&Lt(a)&&(o=new bt(a,"hx",1,Ei.readFileSync(vt(a),{encoding:"utf8"})));let c={};return null!=o&&(c[o.uri]=[{range:i,newText:s}]),[{title:null==s||""==s?"Remove":"Replace with "+s,kind:"quickfix",edit:{changes:c},diagnostics:[n],isPreferred:!0}]}}Pn.__name__="haxeLanguageServer.features.haxe.codeAction.diagnostics.ReplaceableCodeActions";class Ln{static createUnresolvedIdentifierActions(e,t,n){if(null!=t.context.only&&!t.context.only.includes("quickfix"))return[];let r=e.diagnostics.getArguments(t.textDocument.uri,1,n.range);if(null==r)return[];let i=[],s=te.count(r,(function(e){return 0==e.kind})),a=0;for(;a<r.length;){let l,o=r[a];switch(++a,o.kind){case 0:l=Ln.createUnresolvedImportActions(e,t,n,o,s);break;case 1:l=Ln.createTypoActions(e,t,n,o)}i=i.concat(l)}return i}static createUnresolvedImportActions(e,t,n,r,i){let s=t.textDocument.uri,a=e.documents.documents.m.get(s),l=a instanceof bt?a:null;null==l&&Lt(s)&&(l=new bt(s,"hx",1,Ei.readFileSync(vt(s),{encoding:"utf8"})));let o=l;if(null==o||null==n.range)return[];let c=e.config.user.codeGeneration.imports.style,u=fr(o),h=function(i){let s="module"==i?yr.getModule(r.name):r.name,a=[dr(o,u,[r.name],i)],l=t.textDocument.uri,c=e.documents.documents.m.get(l),h=c instanceof bt?c:null;null==h&&Lt(l)&&(h=new bt(l,"hx",1,Ei.readFileSync(vt(l),{encoding:"utf8"})));let d={};return null!=h&&(d[h.uri]=a),{title:"Import "+s,kind:"quickfix",edit:{changes:d},diagnostics:[n]}},d=h(c),p=h("type"==c?"module":"type");1==i&&(d.isPreferred=!0);let f=[d,p],m="Change to "+r.name,_=n.range;if(null==_)throw new $s("Null pointer in .sure() call");let g=[{range:_,newText:r.name}],x=t.textDocument.uri,k=e.documents.documents.m.get(x),y=k instanceof bt?k:null;null==y&&Lt(x)&&(y=new bt(x,"hx",1,Ei.readFileSync(vt(x),{encoding:"utf8"})));let w={};return null!=y&&(w[y.uri]=g),f.push({title:m,kind:"quickfix",edit:{changes:w},diagnostics:[n]}),f}static createTypoActions(e,t,n,r){if(null==n.range)return[];let i=null==r.name?"null":""+r.name,s=n.range;if(null==s)throw new $s("Null pointer in .sure() call");let a=[{range:s,newText:r.name}],l=t.textDocument.uri,o=e.documents.documents.m.get(l),c=o instanceof bt?o:null;null==c&&Lt(l)&&(c=new bt(l,"hx",1,Ei.readFileSync(vt(l),{encoding:"utf8"})));let u={};return null!=c&&(u[c.uri]=a),[{title:"Change to "+i,kind:"quickfix",edit:{changes:u},diagnostics:[n]}]}}Ln.__name__="haxeLanguageServer.features.haxe.codeAction.diagnostics.UnresolvedIdentifierActions";class An{static createUnusedImportActions(e,t,n){if(null!=t.context.only&&!t.context.only.includes("quickfix"))return[];let r=t.textDocument.uri,i=e.documents.documents.m.get(r),s=i instanceof bt?i:null;null==s&&Lt(r)&&(s=new bt(r,"hx",1,Ei.readFileSync(vt(r),{encoding:"utf8"})));let a=s;if(null==a||null==n.range)return[];let l=n.range;if(null==l)throw new $s("Null pointer in .sure() call");let o=[{range:lr.untrimRange(a,l),newText:""}],c=t.textDocument.uri,u=e.documents.documents.m.get(c),h=u instanceof bt?u:null;null==h&&Lt(c)&&(h=new bt(c,"hx",1,Ei.readFileSync(vt(c),{encoding:"utf8"})));let d={};return null!=h&&(d[h.uri]=o),[{title:"Remove unused import/using",kind:"quickfix",edit:{changes:d},diagnostics:[n],isPreferred:!0}]}}An.__name__="haxeLanguageServer.features.haxe.codeAction.diagnostics.UnusedImportActions";class Fn{static createUpdateSyntaxActions(e,t,n){if(!gr.isEqualOrGreaterThan(e.haxeServer.haxeVersion,{major:4,minor:3,patch:0,pre:null,build:null}))return[];let r=t.textDocument.uri,i=e.documents.documents.m.get(r),s=i instanceof bt?i:null;null==s&&Lt(r)&&(s=new bt(r,"hx",1,Ei.readFileSync(vt(r),{encoding:"utf8"})));let a=s;if(null==a)return[];let l=[],o=a.get_tokens(),c=null!=o?o.getTokenAtOffset(a.offsetAt(t.range.start)):null;if(null==c)return[];let u=Fn.getSingleLineIfExpr(c);if(null!=u){let n=Fn.getIfVarEqNullIdentRange(a,u);if(null!=n){let r=a.getText(n);Fn.addNullCoalPrevLineAction(e,t,l,a,u,r),Fn.addNullCoalAssignAction(e,t,l,a,u,r)}let r=Fn.getIfVarNotEqNullIdentRange(a,u);null!=r&&Fn.addSaveNavIfNotNullAction(e,t,l,a,u,a.getText(r)),Fn.addIfInvertAction(e,t,l,a,u)}let h=Fn.getNullCheckTernaryExpr(c);return null!=h&&Fn.addTernaryNullCheckAction(e,t,l,a,h),l}static addNullCoalPrevLineAction(e,t,n,r,i,s){let a=i.previousSibling;if(null==a)return;let l=Fn.getIdentAssignToken(r,a);if(null==l)return;let o=Fn.getIdentEnd(l),c=l.pos,u=c.max,h={start:r.positionAt(c.min,0),end:r.positionAt(u,0)},d=o.pos,p=d.max;if(r.getText(Rt(h,{start:r.positionAt(d.min,0),end:r.positionAt(p,0)}))!=s)return;let f,m=Fn.getIfBodyVarAssignRanges(r,i);if(null!=m&&s!=r.getText(m.varName))return;let _=null!=m?m.value:null,g=null!=_?_:Fn.getIfBodyDeadEndRange(r,i);if(null==g)return;f=g;let x,k=r.getText(f);k.endsWith(";")||(k+=";");let y=l.getFirstChild(),w=null!=y?y.getFirstChild():null;if(null==w)return;x=w;let b=x.getPos(),T=b.max,S={start:r.positionAt(b.min,0),end:r.positionAt(T,0)},C=r.getText(S),v=i.getPos(),P=v.max,L=Rt(S,{start:r.positionAt(v.min,0),end:r.positionAt(P,0)}),A=[{range:L,newText:C+" ?? "+Fn.multilineIndent(r,e,k,L.start)}],F=t.textDocument.uri,N=e.documents.documents.m.get(F),I=N instanceof bt?N:null;null==I&&Lt(F)&&(I=new bt(F,"hx",1,Ei.readFileSync(vt(F),{encoding:"utf8"})));let O={};null!=I&&(O[I.uri]=A),n.push({title:"Change to ?? operator",kind:"quickfix",edit:{changes:O}})}static multilineIndent(e,t,n,r,i){if(null==i&&(i=!0),!n.includes("\n")&&i)return n;n=or.formatText(e,t,n,la.ExpressionLevel);let s=e.lineAt(r.line),a=Fn.lineIndentationCount(s);if(0==a)return n;let l=se.rpad("",s.charAt(0),a),o=0,c=[],u=tl(n.split("\n"));for(;u.hasNext();){let e=u.next(),t=o++;c.push(i&&0==t?e:""+l+e)}return n=c.join("\n")}static lineIndentationCount(e){let t=0,n=0;for(;n<e.length;){let r=n;if(e.charCodeAt(n++),!se.isSpace(e,r))break;++t}return t}static addNullCoalAssignAction(e,t,n,r,i,s){let a=Fn.getIfBodyVarAssignRanges(r,i);if(null==a)return;if(s!=r.getText(a.varName))return;let l=r.getText(a.value);l.endsWith(";")||(l+=";");let o=i.getPos(),c=o.max,u={start:r.positionAt(o.min,0),end:r.positionAt(c,0)},h=[{range:u,newText:s+" ??= "+Fn.multilineIndent(r,e,l,u.start)}],d=t.textDocument.uri,p=e.documents.documents.m.get(d),f=p instanceof bt?p:null;null==f&&Lt(d)&&(f=new bt(d,"hx",1,Ei.readFileSync(vt(d),{encoding:"utf8"})));let m={};null!=f&&(m[f.uri]=h),n.push({title:"Change to ??= operator",kind:"quickfix",edit:{changes:m}})}static addSaveNavIfNotNullAction(e,t,n,r,i,s){if(null!=Fn.getElseBody(i))return;let l=Fn.getSingleLineIfBodyExpr(i);if(null==l)return;let o=l.getPos(),c=o.max,u=r.getText({start:r.positionAt(o.min,0),end:r.positionAt(c,0)});if(!u.startsWith(s))return;let h=se.replace(u,s,"");if(!h.startsWith("?.")){if(!h.startsWith("."))return;h="?"+h}h.endsWith(";")||(h+=";");let d=i.getPos(),p=d.max,f={start:r.positionAt(d.min,0),end:r.positionAt(p,0)},m=Fn.multilineIndent(r,e,h,f.start),_=m.length,g=0;for(;g<_&&se.isSpace(m,_-g-1);)++g;let x=g>0?a.substr(m,0,_-g):m,k=t.textDocument.uri,y=e.documents.documents.m.get(k),w=y instanceof bt?y:null;null==w&&Lt(k)&&(w=new bt(k,"hx",1,Ei.readFileSync(vt(k),{encoding:"utf8"})));let b={};null!=w&&(b[w.uri]=[{range:f,newText:""+s+x}]),n.push({title:"Change to ?. operator",kind:"quickfix",edit:{changes:b}})}static getElseBody(e){let t=e.getFirstChild();if(null==t)return null;let n=t.nextSibling;if(null==n)return null;let r=n.nextSibling;return null==r?null:r.matches(oa.Kwd(li.KwdElse))?r.getFirstChild():null}static addIfInvertAction(e,t,n,r,i){let s;if(xn.isInFunctionScope(i)){let e=i.parent;if(null==e)return;let t=Fn.getBlockReturn(e);if(null!=t){let e=t.getPos(),n=e.max,i=0;s=r.getText({start:r.positionAt(e.min,i),end:r.positionAt(n,i)})}else s="return;"}else{if(!xn.isInLoopScope(i))return;s="continue;"}if(null!=Fn.filterNextSibling(i,(function(e){if(e.isComment())return!1;let t,n=e.tok;if(1==n._hx_index)switch(n.k._hx_index){case 10:case 24:t=!0;break;default:t=!1}else t=!1;return!t&&19!=e.tok._hx_index})))return;let l=i.getFirstChild();if(null==l)return;let o=l.nextSibling;if(null==o)return;let c=i.getPos(),u=c.max,h={start:r.positionAt(c.min,0),end:r.positionAt(u,0)},d=Fn.getElseBody(i);if(null!=d){null!=Fn.getBlockReturn(d)&&(s="");let t=Fn.getBlockText(r,d)+"\n"+s;t="{\n"+t+"\n}",t=Fn.multilineIndent(r,e,se.trim(t),h.start);let n=t.length,i=0;for(;i<n&&se.isSpace(t,n-i-1);)++i;i>0&&(t=a.substr(t,0,n-i)),s=t}let p=Fn.invertCondition(l),f=Fn.getBlockText(r,o);f=Fn.multilineIndent(r,e,se.trim(f),h.start,!1);let m=f.length,_=0;for(;_<m&&se.isSpace(f,m-_-1);)++_;_>0&&(f=a.substr(f,0,m-_)),f.length>0&&(f="\n"+f);let g=t.textDocument.uri,x=e.documents.documents.m.get(g),k=x instanceof bt?x:null;null==k&&Lt(g)&&(k=new bt(g,"hx",1,Ei.readFileSync(vt(g),{encoding:"utf8"})));let y={};null!=k&&(y[k.uri]=[{range:h,newText:"if ("+p+") "+s+f}]),n.push({title:"Invert if expression",kind:"refactor.rewrite",edit:{changes:y}})}static getBlockReturn(e){let t,n=e.getLastChild(),r=null!=n?n.previousSibling:null;if(null==r)return null;t=r;let i,s=t.tok;if(1==s._hx_index)switch(s.k._hx_index){case 10:case 24:i=!0;break;default:i=!1}else i=!1;return i?t:null}static getBlockText(e,t){let n=t.getPos(),r=n.max,i=e.getText({start:e.positionAt(n.min,0),end:e.positionAt(r,0)});if(t.tok==oa.BrOpen&&!xn.isAnonStructure(t)){let e=new s("\\{((.|\n)*)\\}","g");e.match(i)&&(i=e.matched(1))}return se.trim(i)}static filterNextSibling(e,t){let n;if(null==e)return null;for(n=e;;){let e=n.nextSibling;if(null==e)return null;if(n=e,t(e))return e}}static invertCondition(e){let t,n="",r=e.getFirstChild();if(null==r)return"";t=r;let i=e.getLastChild();if(null==i)return"";let s=[],a="",l=!1;for(;t!=i;){if(s.length>0){let e;switch(t.matches(s[s.length-1])&&s.pop(),t.tok._hx_index){case 6:case 12:case 14:case 22:e=" "+t.toString()+" ";break;case 16:case 18:case 20:let n=Fn.getClosingBracketTok(t.tok);null!=n&&s.push(n),e=t.toString();break;default:e=t.toString()}a+=e;let r=Fn.flatNextToken(t);if(null==r)return n+a;t=r;continue}let e=t.tok;switch(e._hx_index){case 1:switch(e.k._hx_index){case 38:a+=l?"true":"false",l=!0;break;case 39:a+=l?"false":"true",l=!0;break;default:a+=t.toString()}break;case 5:2==e.op._hx_index?(a+=l?"!":"",l=!0):a+=t.toString();break;case 6:switch(e.op._hx_index){case 5:n+=a+" "+(l?"==":"!=")+" ",a="",l=!0;break;case 6:n+=a+" "+(l?"!=":"==")+" ",a="",l=!0;break;case 7:n+=a+" "+(l?">":"<=")+" ",a="",l=!0;break;case 8:n+=a+" "+(l?">=":"<")+" ",a="",l=!0;break;case 9:n+=a+" "+(l?"<":">=")+" ",a="",l=!0;break;case 10:n+=a+" "+(l?"<=":">")+" ",a="",l=!0;break;case 14:n+=(l?a:"!"+a)+" || ",a="",l=!1;break;case 15:n+=(l?a:"!"+a)+" && ",a="",l=!1;break;default:a+=" "+t.toString()+" "}break;case 16:case 18:case 20:let r=Fn.getClosingBracketTok(t.tok);null!=r&&s.push(r),a+=t.toString();break;default:a+=t.toString()}let r=Fn.flatNextToken(t);if(null==r)return n+a;t=r}return""+n+(l?a:"!"+a)}static getClosingBracketTok(e){switch(e._hx_index){case 16:return oa.BkClose;case 18:return oa.BrClose;case 20:return oa.PClose;default:return null}}static flatNextToken(e){let t=e.getFirstChild();if(null!=t)return t;for(;;){let t=e.nextSibling;if(null!=t)return t;let n=e.parent;if(null==n)return null;e=n}}static addTernaryNullCheckAction(e,t,n,r,i){let s,a=i.parent,l=null!=a?a.parent:null;if(null==l)return;s=l;let o=s.parent;if(null==o)return;let c=Fn.preDotToken(o),u=i.getFirstChild();if(null==u)return;let h=u.nextSibling;if(null==h)return;let d=h.getFirstChild();if(null==d)return;let p=Fn.getLastNonCommaToken(d);if(null==p)return;let f=c.pos,m=f.max,_={start:r.positionAt(f.min,0),end:r.positionAt(m,0)},g=o.pos,x=g.max,k=Rt(_,{start:r.positionAt(g.min,0),end:r.positionAt(x,0)}),y=u.getPos(),w=y.max,b={start:r.positionAt(y.min,0),end:r.positionAt(w,0)},T=d.pos,S=T.max,C={start:r.positionAt(T.min,0),end:r.positionAt(S,0)},v=p.pos,P=v.max,L=Rt(C,{start:r.positionAt(v.min,0),end:r.positionAt(P,0)}),A=s.matches(oa.Binop(ht.OpEq)),F=r.getText(k),N=r.getText(b),I=r.getText(L);if(A){if(F!=I)return}else if(F!=N)return;let O=c.getPos(),E=O.max,D={start:r.positionAt(O.min,0),end:r.positionAt(E,0)},B=A?N:I;B.endsWith(";")||(B+=";");let R=[{range:D,newText:F+" ?? "+Fn.multilineIndent(r,e,B,D.start)}],j=t.textDocument.uri,M=e.documents.documents.m.get(j),H=M instanceof bt?M:null;null==H&&Lt(j)&&(H=new bt(j,"hx",1,Ei.readFileSync(vt(j),{encoding:"utf8"})));let W={};null!=H&&(W[H.uri]=R),n.push({title:"Change to ?? operator",kind:"quickfix",edit:{changes:W}})}static getIdentAssignToken(e,t){let n,r=t.tok;if(1==r._hx_index)switch(r.k._hx_index){case 2:case 42:n=!0;break;default:n=!1}else n=!1;if(n){let e=t.getFirstChild();if(null==e)return null;t=e}let i=Fn.getIdentEnd(t).getFirstChild();if(null==i)return null;let s=i.tok;return 6==s._hx_index&&4==s.op._hx_index?t:null}static getIfBodyDeadEndRange(e,t){let n=Fn.getSingleLineIfBodyExpr(t);if(null==n)return null;let r=n.tok;if(1!=r._hx_index)return null;switch(r.k._hx_index){case 8:case 9:case 10:case 24:let t=n.getPos(),r=t.max,i=0;return{start:e.positionAt(t.min,i),end:e.positionAt(r,i)};default:return null}}static getSingleLineIfExpr(e){if(null==e)return null;let t=e.tok;if(1==t._hx_index&&3==t.k._hx_index)return e;if(null==(e=e.parent))return null;let n=e.tok;if(1==n._hx_index&&3==n.k._hx_index)return e;if(null==(e=e.parent))return null;let r=e.tok;if(1==r._hx_index&&3==r.k._hx_index)return e;if(null==(e=e.parent))return null;let i=e.tok;if(1==i._hx_index&&3==i.k._hx_index)return e;if(null==(e=e.parent))return null;let s=e.tok;if(1==s._hx_index&&3==s.k._hx_index)return e;if(null==(e=e.parent))return null;let a=e.tok;if(1==a._hx_index&&3==a.k._hx_index)return e;if(null==(e=e.parent))return null;let l=e.tok;if(1==l._hx_index&&3==l.k._hx_index)return e;if(null==(e=e.parent))return null;let o=e.tok;if(1==o._hx_index&&3==o.k._hx_index)return e;if(null==(e=e.parent))return null;let c=e.tok;if(1==c._hx_index&&3==c.k._hx_index)return e;if(null==(e=e.parent))return null;let u=e.tok;return 1==u._hx_index&&3==u.k._hx_index?e:(e=e.parent,null)}static getNullCheckTernaryExpr(e){let t=0;for(;t<10;){if(++t,null==e)return null;let n,r=e.tok;if(6==r._hx_index)switch(r.op._hx_index){case 5:case 6:n=!0;break;default:n=!1}else n=!1;if(n){let t=e.getFirstChild();if(null==t)return null;if(0==t.matches(oa.Kwd(li.KwdNull)))return null;let n=t.getFirstChild();return null==n||0==(null!=n?n.matches(oa.Question):null)?null:n}e=e.parent}return null}static getIfVarEqNullIdentRange(e,t){let n=t.getFirstChild();if(null==n)return null;let r=n.getFirstChild();if(null==r)return null;let i=Fn.getIdentEnd(r),s=i.getFirstChild();if(null==s)return null;let a=s.getFirstChild();if(null==a)return null;let l=s.tok,o=a.tok;if(6==l._hx_index){if(5==l.op._hx_index){if(1==o._hx_index){if(37==o.k._hx_index){let t=r.pos,n=t.max,s=0,a={start:e.positionAt(t.min,s),end:e.positionAt(n,s)},l=i.pos,o=l.max,c=0;return Rt(a,{start:e.positionAt(l.min,c),end:e.positionAt(o,c)})}return null}return null}return null}return null}static getIfVarNotEqNullIdentRange(e,t){let n=t.getFirstChild();if(null==n)return null;let r=n.getFirstChild();if(null==r)return null;let i=Fn.getIdentEnd(r),s=i.getFirstChild();if(null==s)return null;let a=s.getFirstChild();if(null==a)return null;let l=s.tok,o=a.tok;if(6==l._hx_index){if(6==l.op._hx_index){if(1==o._hx_index){if(37==o.k._hx_index){let t=r.pos,n=t.max,s=0,a={start:e.positionAt(t.min,s),end:e.positionAt(n,s)},l=i.pos,o=l.max,c=0;return Rt(a,{start:e.positionAt(l.min,c),end:e.positionAt(o,c)})}return null}return null}return null}return null}static getIfBodyVarAssignRanges(e,t){let n=Fn.getSingleLineIfBodyExpr(t);if(null==n)return null;let r=Fn.getIdentEnd(n),i=r.getFirstChild();if(null==i)return null;let s=i.getFirstChild();if(null==s)return null;let a=i.tok;if(6==a._hx_index){if(4==a.op._hx_index){let t=n.pos,i=t.max,a=0,l={start:e.positionAt(t.min,a),end:e.positionAt(i,a)},o=r.pos,c=o.max,u=0,h=Rt(l,{start:e.positionAt(o.min,u),end:e.positionAt(c,u)}),d=s.getPos(),p=d.max,f=0;return{varName:h,value:{start:e.positionAt(d.min,f),end:e.positionAt(p,f)}}}return null}return null}static getSingleLineIfBodyExpr(e){let t,n=sa.child(e,1),r=null!=n?n:null;if(null==r)return null;if(t=r,t.matches(oa.BrOpen)){let e=t.children;if(null==e)return null;if(e.length>2)return null;let n=t.getFirstChild();if(null==n)return null;t=n}return t}static getIdentEnd(e){for(;;){let t=e.getFirstChild();if(null==t)return e;let n,r=t.tok;switch(r._hx_index){case 2:n=3==r.c._hx_index;break;case 11:case 13:case 22:n=!0;break;default:n=!1}if(!n)return e;e=t}}static preDotToken(e){for(;;){let t=e.parent;if(null==t)return e;let n=t.tok;switch(n._hx_index){case 1:if(22==n.k._hx_index)return t;break;case 11:case 13:let r=t.parent;if(null==r)return e;if(!e.isCIdent())return e;e=r;continue}return e}}static getLastToken(e){return null==e?null:fa.getLastToken(e)}static getLastNonCommaToken(e){for(;;){let t=Fn.getLastToken(e);if(null==t)return t;if(t.tok!=oa.Comma&&t.tok!=oa.Semicolon)return t;{let n=t.previousSibling;if(null==n)return t.parent;e=n}}}}Fn.__name__="haxeLanguageServer.features.haxe.codeAction.diagnostics.UpdateSyntaxActions";class Nn{constructor(e){this.context=e;let t=this.context.capabilities.textDocument,n=null!=t?t.completion:null;this.contextSupport=1==(null!=n?n.contextSupport:null);let r,i=null!=n?n.completionItem:null;if(null!=i){let e=i.documentationFormat;r=null==e?null:e.includes("markdown")}else r=null;this.markdownSupport=1==r;let s=null!=n?n.completionItem:null;this.snippetSupport=1==(null!=s?s.snippetSupport:null);let a=null!=n?n.completionItem:null;this.commitCharactersSupport=1==(null!=a?a.commitCharactersSupport:null);let l,o=null!=n?n.completionItem:null,c=null!=o?o.tagSupport:null;if(null!=c){let e=c.valueSet;l=null==e?null:e.includes(1)}else l=null;this.deprecatedSupport=1==l,this.expectedTypeCompletion=new On(e),this.postfixCompletion=new En(e),this.snippetCompletion=new Dn(e),this.printer=new Sr(!1,Tr.Qualified,{argumentTypeHints:!0,returnTypeHint:"non-void",useArrowSyntax:!1,placeOpenBraceOnNewLine:!1,explicitPublic:!0,explicitPrivate:!0,explicitNull:!0}),this.legacy=new In(e,this.contextSupport,nl(this,this.formatDocumentation))}onCompletion(e,n,r,i){let s=e.textDocument.uri,l=this.context.documents.documents.m.get(s),o=l instanceof bt?l:null;null==o&&Lt(s)&&(o=new bt(s,"hx",1,Ei.readFileSync(vt(s),{encoding:"utf8"})));let c=o;if(null==c||!Pt(s))return void Wt(i,s);let u=c.offsetAt(e.position),h=c.content.substring(0,u),d=h.length,p=h.length,f=0;for(;f<p&&se.isSpace(h,p-f-1);)++f;let m=e.position,_=new ei(c).resolve({line:m.line,character:m.character+-(d-(f>0?a.substr(h,0,p-f):h).length)});!this.contextSupport||this.isValidCompletionPosition(_,c,e,h)?(this.context.haxeServer.supports("display/completion")?nl(this,this.handleJsonRpc):nl(t=this.legacy,t.handle))(e,n,r,i,c,u,h,_):r({items:[],isIncomplete:!1})}isValidCompletionPosition(e,t,n,r){if(null==e)return!0;let i,s;switch(e.tok._hx_index){case 7:case 8:i=!0;break;default:i=!1}if(i)return!1;let a=e.tok;if(3!=a._hx_index||"if"!=a.s){let t=e.tok;s=3==t._hx_index&&"end"==t.s}else s=!0;if(s)return!1;let l=e.parent,o=null!=l?l.tok:null;if(null!=o&&(3==o._hx_index&&"if"==o.s)&&null==e.previousSibling)return!1;if(null==n.context)return!0;let c=n.context.triggerCharacter;if(null==c)return!0;switch(c){case" ":return!!Nn.autoTriggerOnSpacePattern.match(r);case"$":return!!this.isInterpolationPosition(e,t,n.position,r);case">":return!!se.trim(r).endsWith("->");default:return!0}}isInterpolationPosition(e,t,n,r){let i=null!=sa.findParent(e,(function(e){return null!=sa.matches(e,oa.Kwd(li.KwdMacro))}));return ei.getStringKind(e,t,n)!=ti.SingleQuote?i:!!Nn.dollarPattern.match(r)&&Nn.dollarPattern.matched(1).length%2!=0}onCompletionResolve(e,t,n,r){let i=e.data;if(!this.context.haxeServer.supports("display/completionItem/resolve")||null==this.previousCompletionData||1==(null!=i?i.origin:null))return void n(e);let s,a=null!=i?i.index:null;if(null==a)throw new $s("Null pointer in .sure() call");s=a,this.previousCompletionData.isResolve=!0;let l=this;this.context.callHaxeMethod("display/completionItem/resolve",{index:s},t,(function(e){let t=l,i=s,a=e.item,o=l.previousCompletionData;if(null==o)throw new $s("Null pointer in .sure() call");let c=t.createCompletionItem(i,a,o);if(null!=c)n(c);else{let e=r,t=null,n={code:-32603,message:"Unable to resolve completion item."};null!=t&&(n.data=t),e(n)}return null}),jt(r))}handleJsonRpc(e,t,n,r,i,a,l,o){let c=!0;null!=e.context&&(c=2==e.context.triggerKind,"$"==e.context.triggerCharacter&&(c=!1));let u={file:vt(i.uri),contents:i.content,offset:this.context.displayOffsetConverter.characterOffsetToByteOffset(i.content,a),wasAutoTriggered:c,meta:[":deprecated"]},h=ei.getContext(o,i,e.position),d=e.position,p=i.getText({start:d,end:{line:d.line+1,character:d.character}}),f=new s("\\w*$","");f.match(l);let m=e.position,_=-f.matched(0).length,g={start:{line:m.line,character:m.character+_},end:e.position},x=this,k=function(){let t=i.get_tokens(),r=null!=t?t.getTokenAtOffset(i.offsetAt(g.start)):null;if(null!=r&&null!=r.parent){let e=r.parent.tok;if(1==e._hx_index&&15==e.k._hx_index&&r.tok==oa.DblDot)return void n({items:[],isIncomplete:!1})}let s=x.createFieldKeywordItems(h,g,p);x.snippetSupport?x.snippetCompletion.createItems({doc:i,params:e,replaceRange:g,tokenContext:h},[]).then((function(e){n({items:s.concat(e.items),isIncomplete:!1})})):n({items:s,isIncomplete:!1})};this.context.callHaxeMethod("display/completion",u,t,(function(t){if(null==t)return k(),null;let r=t.mode.kind;if(4!=r&&c&&se.trim(l).endsWith("->"))return n({items:[],isIncomplete:!1}),null;let a=fr(i),o=i.indentAt(e.position.line);switch(r){case 2:if(null!=t.replaceRange)g=t.replaceRange;else{let t=new s("\\w+(\\.\\w+)*$","");if(t.match(l)){let n=e.position,r=-t.matched(0).length;g.start={line:n.line,character:n.character+r}}}break;case 3:null!=t.replaceRange&&(g=t.replaceRange);break;case 4:case 5:case 6:case 10:case 13:let n=new s("\\w+(\\.\\w+)*$","");if(n.match(l)){let t=e.position,r=-n.matched(0).length;g.start={line:t.line,character:t.character+r}}}let u=t.items,d={replaceRange:g,mode:t.mode,doc:i,indent:o,lineAfter:p,params:e,importPosition:a,tokenContext:h,isResolve:!1},f=[];f=f.concat(x.postfixCompletion.createItems(d,u)),f=f.concat(x.expectedTypeCompletion.createItems(d)),f=f.concat(x.createFieldKeywordItems(h,g,p));let m=function(e){let r=0,i=u.length;for(;r<i;){let t=r++,n=u[t];if(1==e.m.get(n))continue;let i=x.createCompletionItem(null==n.index?t:n.index,n,d);null!=i&&f.push(i)}let s=[],a=0,l=f;for(;a<l.length;){let e=l[a];++a,null!=e&&s.push(e)}f=s,n({items:f,isIncomplete:1==t.isIncomplete})};return x.snippetSupport&&8!=r&&0!=r?x.snippetCompletion.createItems(d,u).then((function(e){f=f.concat(e.items),m(e.itemsToIgnore)})):m(new Ye),x.previousCompletionData=d,u.length+" items"}),(function(e){k()}))}createFieldKeywordItems(e,t,n){if(1!=e._hx_index||null!=e.type.field)return[];let r=[],i=this,s=["public","private","extern","final","static","dynamic","override","inline","macro"];gr.isEqualOrGreaterThan(this.context.haxeServer.haxeVersion,{major:4,minor:2,patch:0,pre:null,build:null})&&(s.push("abstract"),s.push("overload"));let a=0;for(;a<s.length;)r.push({label:l=s[a++],kind:14,textEdit:{newText:i.maybeInsert(l," ",n),range:t},command:xl,sortText:"~~~",data:{origin:1}});var l;return r}createCompletionItem(e,t,n){let r;switch(t.kind){case"AnonymousStructure":case"Define":case"Expression":r=null;break;case"ClassField":case"EnumAbstractField":r=this.createClassFieldCompletionItem(t,n);break;case"EnumField":r=this.createEnumFieldCompletionItem(t,n);break;case"Keyword":r=this.createKeywordCompletionItem(t.args,n);break;case"Literal":r=this.createLiteralCompletionItem(t,n);break;case"Local":r=this.createLocalCompletionItem(t,n);break;case"Metadata":r=t.args.internal?null:{label:t.args.name,kind:3};break;case"Module":r=this.createModuleCompletionItem(t.args,n);break;case"Package":r=this.createPackageCompletionItem(t.args,n);break;case"Type":r=this.createTypeCompletionItem(t.args,n);break;case"TypeParameter":r={label:t.args.name,kind:25}}if(null==r)return null;if(null==r.textEdit&&null!=n.replaceRange&&(r.textEdit={range:n.replaceRange,newText:r.label}),null==r.documentation&&(r.documentation=this.formatDocumentation(Pr(t))),null!=r.detail){let e=r.detail,t=e.length,n=0;for(;n<t&&se.isSpace(e,t-n-1);)++n;r.detail=n>0?a.substr(e,0,t-n):e}if(this.commitCharactersSupport){let e=n.mode.kind;(null!=t.type&&"TFun"==t.type.kind&&11!=e||10==e)&&(r.commitCharacters=["("])}return null==r.sortText&&(r.sortText=""),r.sortText+=se.lpad(re.string(e+1),"0",10),r.data={origin:0,index:e},r}createClassFieldCompletionItem(e,t){let n=e.args,r=e.type,i=n.field,s=n.resolution,a=this.printer.printClassFieldOrigin(n.origin,e.kind,"'");if(null==r||Ir(i.meta,":noCompletion"))return null;if(12==t.mode.kind)return this.createOverrideCompletionItem(e,t,a);let l=i.name,o=this.getKindForField(i,e.kind),c=null==n.field.overloads?0:n.field.overloads.length,u=this.printer.printClassFieldDefinition(n,r,"EnumAbstractField"==e.kind);c>0&&(u+=" (+"+c+" overloads)");let h,d=s.isQualified?"":" (shadowed)",p=null!=a?u+"\n "+a+d:u+"\n "+d,f=s.isQualified?"":s.qualifier+".";switch(t.mode.kind){case 1:h=this.maybeInsert(i.name,": ",t.lineAfter);break;case 11:h=this.maybeInsert(i.name,":",t.lineAfter);break;default:h=i.name}let m={label:l,kind:o,detail:p,textEdit:{newText:f+h,range:t.replaceRange}};return 1==t.mode.kind&&Ir(i.meta,":optional")&&(m.label="?"+i.name,m.filterText=i.name),this.handleDeprecated(m,i.meta),m}createOverrideCompletionItem(e,t,n){let r=e.type,i=e.args.field,s=this.context.config.user.codeGeneration.imports;if(null==r||"TFun"!=r.kind||Rr(i))return null;let a=i.kind.args;if("FMethod"==i.kind.kind&&("MethInline"==a||"MethMacro"==a))return null;let l=this.context.config.user.codeGeneration.functions.field,o=new Sr(!1,s.enableAutoImports?Tr.Shadowed:Tr.Qualified,l),c={label:i.name,kind:this.getKindForField(i,e.kind),textEdit:{newText:o.printOverrideDefinition(i,r,t.indent,!0),range:t.replaceRange},insertTextFormat:2,detail:"Auto-generate override"+(null==n?"":"\n"+n),documentation:{kind:"markdown",value:lr.printCodeBlock("override "+o.printOverrideDefinition(i,r,t.indent,!1),"haxe")},additionalTextEdits:pr(t.doc,t.importPosition,this.context,r,l)};return this.handleDeprecated(c,i.meta),c}getKindForField(e,t){if("EnumAbstractField"==t)return 20;let n=e.kind;switch(n.kind){case"FMethod":return function(e){return!(!Ir(e.meta,":op")&&!Ir(e.meta,":resolve"))||Ir(e.meta,":arrayAccess")}(e)?24:0==e.scope?3:2==e.scope?4:2;case"FVar":if(Rr(e))return 5;let t=n.args.write.kind;switch(n.args.read.kind){case"AccInline":return 21;case"AccNormal":return"AccNormal"==t?5:10;default:return 10}}}createEnumFieldCompletionItem(e,t){if(null==e.type)return null;let n=e.args,r=n.field,i=r.name,s={newText:i,range:t.replaceRange},a=this.printer.printEnumField(r,e.type,!1,!0),l=this.printer.printEnumFieldOrigin(n.origin,"'"),o={label:i,kind:20,detail:null!=l?a+"\n"+l:a,textEdit:s};if(11==t.mode.kind){let n=this.printer.printEnumField(r,e.type,!0,!1);n=this.maybeInsertPatternColon(n,t),s.newText=n,o.insertTextFormat=2,o.command=kl}return o}createTypeCompletionItem(e,t){let n=t.mode,r=8==n.kind||9==n.kind,i=this.context.config.user.codeGeneration.imports,s=i.enableAutoImports;(r||2==e.path.importStatus)&&(s=!1);let l=new Sr(null,Tr.Always).printPath(e.path);if(this.isExcluded(l))return null;let o=e.path.typeName,c=l.includes(".")?Ut(l):"",u=new Sr(null,r?Tr.Always:Tr.Qualified).printPath(e.path),h=this.context.latestActiveFilePackage,d=c==h?"00":0==c.length?"01":Ir(e.meta,":deprecated")?"09":se.lpad(""+((h.startsWith(c)?se.replace(c,h,""):c).split(".").length+2),"0",2),p={range:t.replaceRange,newText:s?o:u},f={label:o+(""==c?"":" - "+l),kind:this.getKindForModuleType(e),textEdit:p,sortText:o+d};if(r?p.newText=this.maybeInsert(p.newText,";",t.lineAfter):i.enableAutoImports&&1==e.path.importStatus&&(f.additionalTextEdits=[dr(t.doc,t.importPosition,[l],i.style)]),this.snippetSupport)switch(t.mode.kind){case 4:case 5:case 6:case 7:60!=a.cca(t.lineAfter,0)&&function(e){if("Dynamic"==vr(e.path))return!1;return null!=e.params&&e.params.length>0}(e)&&(p.newText+="<$1>",f.insertTextFormat=2,f.command=xl)}return 7==t.mode.kind&&null!=t.mode.args&&(t.mode.args.isIntersectionType||(p.newText=this.maybeInsert(p.newText,",",t.lineAfter))),null!=e.params&&(f.detail=this.printTypeDetail(e,c)),this.handleDeprecated(f,e.meta),f}getKindForModuleType(e){switch(e.kind){case 0:case 3:return 7;case 1:case 5:return 8;case 2:case 4:return 13;case 6:return 22}}formatDocumentation(e){return null==e?null:this.markdownSupport?{kind:"markdown",value:lr.markdownFormat(e)}:lr.extractText(e)}printTypeDetail(e,t){let n,r=this.printer.printEmptyTypeDefinition(e)+"\n",i=e.path.importStatus;if(null==i)n="";else switch(i){case 0:n="(imported)";break;case 1:n="Auto-import from '"+t+"'";break;case 2:n="(shadowed)"}return r+n}createPackageCompletionItem(e,t){let n=e.path,r=n.pack.join(".");if(this.isExcluded(r))return null;let i=0==t.mode.kind?n.pack[n.pack.length-1]:r;return{label:i,kind:9,detail:"package "+r,textEdit:{newText:this.maybeInsert(i,".",t.lineAfter),range:t.replaceRange},command:xl}}createKeywordCompletionItem(e,t){let n={newText:e.name,range:t.replaceRange},r={label:e.name,kind:14,textEdit:n};if(13!=t.mode.kind&&"new"!=e.name&&"inline"!=e.name||(r.command=xl),14==t.mode.kind)switch(e.name){case"extern":case"final":case"import":case"private":case"using":r.command=xl}switch(e.name){case"catch":case"for":case"if":case"while":this.snippetSupport?(r.insertTextFormat=2,n.newText=e.name+" ($1)"):n.newText=this.maybeInsert(n.newText," ",t.lineAfter);break;case"extends":case"implements":n.newText+=" ";break;case"break":case"cast":case"continue":case"default":case"package":case"return":break;default:n.newText=this.maybeInsert(n.newText," ",t.lineAfter)}return r}createLocalCompletionItem(e,t){let n=e.args;return null==e.type||"_"==n.name?null:{label:n.name,kind:5==n.origin?2:6,detail:this.printer.printLocalDefinition(n,e.type)+" \n("+this.printer.printLocalOrigin(n.origin)+")"}}createModuleCompletionItem(e,t){let n=e.path,r=n.pack.concat([n.moduleName]).join(".");return this.isExcluded(r)?null:{label:n.moduleName,kind:19,detail:"module "+r}}createLiteralCompletionItem(e,t){if(null==e.type)return null;let n=e.args,r={label:n.name,kind:14,detail:this.printer.printType(e.type)};switch(n.name){case"false":case"null":case"true":r.textEdit={range:t.replaceRange,newText:this.maybeInsertPatternColon(n.name,t)}}return r}maybeInsert(e,t,n){return n.charAt(0)==t.charAt(0)?e:e+t}maybeInsertPatternColon(e,t){let n=t.mode.args;return null==n||n.isOutermostPattern?this.maybeInsert(e,":",t.lineAfter):e}handleDeprecated(e,t){this.deprecatedSupport&&Ir(t,":deprecated")&&(null==e.tags&&(e.tags=[]),e.tags.push(1))}isExcluded(e){let t=this.context.config.user.exclude;if(null==t)return!1;let n=0;for(;n<t.length;)if(e.startsWith(t[n++]))return!0;return!1}}Nn.__name__="haxeLanguageServer.features.haxe.completion.CompletionFeature",Object.assign(Nn.prototype,{__class__:Nn});class In{constructor(e,t,n){this.context=e,this.contextSupport=t,this.formatDocumentation=n}handle(e,t,n,r,i,s,a,l){if(this.contextSupport&&In.isInvalidCompletionPosition(e.context,a))return void n({items:[],isIncomplete:!1});let o=In.calculateCompletionPosition(a,s),c=this.context.displayOffsetConverter.characterOffsetToByteOffset(i.content,o.pos),u=vt(i.uri),h=this;this.context.callDisplay(o.toplevel?"@toplevel":"field completion",[(null==u?"null":u)+"@"+c+(o.toplevel?"@toplevel":"")],i.content,t,(function(t){switch(t._hx_index){case 0:n(null);break;case 1:let s,l=t.msg;try{s=ue.parse(l).firstElement()}catch(e){We.lastError=e,s=null}if(null==s)return void Mt(r,l);let c=o.toplevel?h.parseToplevelCompletion(s,e.position,a,i):h.parseFieldCompletion(s,a,e.position);n({items:c,isIncomplete:!1})}}),jt(r))}parseToplevelCompletion(e,t,n,r){let i=[],s=[],a=e.elements();for(;a.hasNext();){let e=a.next(),n=e.get("k"),r=e.get("t");if(e.nodeType!=ue.Document&&e.nodeType!=ue.Element)throw Me.thrown("Bad node type, expected Element or Document but found "+(null==e.nodeType?"null":ce.toString(e.nodeType)));let l=e.children[0];if(l.nodeType==ue.Document||l.nodeType==ue.Element)throw Me.thrown("Bad node type, unexpected "+(null==l.nodeType?"null":ce.toString(l.nodeType)));let o=l.nodeValue;if("local"==n&&"_"==o)continue;let c={label:o,detail:""},u=In.toplevelKindToCompletionItemKind(n,r);if(null!=u&&(c.kind=u),o.startsWith("@TIME")||o.startsWith("@TOTAL")){let e=o.split(":");s.push(In.getTimerCompletionItem(e[0],e[1],t));continue}let h=o;if("global"==n?h=e.get("p")+"."+o:"type"==n&&(h=e.get("p")),null!=r||h!=o){let e=[];h!=o&&e.push(h),null!=r&&e.push(r),c.detail=e.join(" ")}let d=e.get("d");null!=d&&(c.documentation=this.formatDocumentation(d)),i.push(c)}return In.sortTimers(s),i.concat(s)}parseFieldCompletion(e,t,n){let r=[],i=[],s=new Map,l=e.elements();for(;l.hasNext();){let e=l.next(),o=e.get("k"),c=In.fieldKindToCompletionItemKind(o),u=e.get("n");if(2==c){let e=s.get(u);if(null!=e){e.overloads++;continue}}let h=null,d=null,p=e.elements();for(;p.hasNext();){let e=p.next();if(e.nodeType!=ue.Element)throw Me.thrown("Bad node type, expected Element but found "+(null==e.nodeType?"null":ce.toString(e.nodeType)));switch(e.nodeName){case"d":if(e.nodeType!=ue.Document&&e.nodeType!=ue.Element)throw Me.thrown("Bad node type, expected Element or Document but found "+(null==e.nodeType?"null":ce.toString(e.nodeType)));let t=e.children[0];if(t.nodeType==ue.Document||t.nodeType==ue.Element)throw Me.thrown("Bad node type, unexpected "+(null==t.nodeType?"null":ce.toString(t.nodeType)));let n=t.nodeValue;d=""==n?null:n;break;case"t":if(e.nodeType!=ue.Document&&e.nodeType!=ue.Element)throw Me.thrown("Bad node type, expected Element or Document but found "+(null==e.nodeType?"null":ce.toString(e.nodeType)));let r=e.children[0];if(r.nodeType==ue.Document||r.nodeType==ue.Element)throw Me.thrown("Bad node type, unexpected "+(null==r.nodeType?"null":ce.toString(r.nodeType)));let i=r.nodeValue;h=""==i?null:i}}let f=null;if("metadata"==o)u=a.substr(u,1,null),In.reFieldPart.match(t),":"==In.reFieldPart.matched(2)&&(f={newText:u,range:{start:{line:n.line,character:n.character+-1},end:n}});else if((u.startsWith("@TIME")||u.startsWith("@TOTAL"))&&null!=h){i.push(In.getTimerCompletionItem(u,h,n));continue}let m={label:u};null!=d&&(m.documentation=this.formatDocumentation(d)),null!=c&&(m.kind=c),null!=h&&(m.detail=In.formatType(h,u,c)),null!=f&&(m.textEdit=f),2==c&&s.set(u,{item:m,overloads:0}),r.push(m)}let o=s.values(),c=o.next();for(;!c.done;){let e=c.value;c=o.next();let t=e.overloads;t>0&&(e.item.detail+=" (+"+t+" overloads)")}return In.sortTimers(i),r.concat(i)}static isInvalidCompletionPosition(e,t){return":"==(null!=e?e.triggerCharacter:null)&&In.reCaseOrDefault.match(t)}static calculateCompletionPosition(e,t){if(In.reFieldPart.match(e))return{pos:t-In.reFieldPart.matched(3).length,toplevel:!1};let n=e.length,r=e.length,i=0;for(;i<r&&se.isSpace(e,r-i-1);)++i;return{pos:t-(n-(i>0?a.substr(e,0,r-i):e).length),toplevel:!0}}static toplevelKindToCompletionItemKind(e,t){let n=function(){return null!=t&&1==yr.parseDisplayType(t)._hx_index};switch(e){case"enum":case"enumabstract":return 13;case"global":return 6;case"literal":return 14;case"local":return n()?2:6;case"package":return 9;case"member":case"static":return n()?2:5;case"timer":return 12;case"type":return 7;default:return He.trace("unknown toplevel item kind: "+e,{fileName:"src/haxeLanguageServer/features/haxe/completion/CompletionFeatureLegacy.hx",lineNumber:136,className:"haxeLanguageServer.features.haxe.completion.CompletionFeatureLegacy",methodName:"toplevelKindToCompletionItemKind"}),null}}static sortTimers(e){e.sort((function(e,t){let n=e.data,r=t.data;return n<r?1:n>r?-1:0}));let t=0,n=e.length;for(;t<n;){let n=t++;e[n].sortText="_"+String.fromCodePoint(65+n)}}static getTimerCompletionItem(e,t,n){let r=new s("([0-9.]*)s(?: \\(([0-9]*)%\\))?",""),i=0,a="--";try{r.match(t),i=parseFloat(r.matched(1)),a=r.matched(2)}catch(e){}let l=null;return e.startsWith("@TIME @TOTAL")?e="@Total time: "+t:(e=se.replace(e,"@TIME ",a+"% "),l=i+"s"),{label:e,kind:12,documentation:{kind:"plaintext",value:l},textEdit:{range:{start:n,end:n},newText:""},data:i}}static formatType(e,t,n){return null==n?e:2==n?t+yr.prepareSignature(e):e}static fieldKindToCompletionItemKind(e){switch(e){case"metadata":return 3;case"method":return 2;case"package":return 9;case"timer":return 12;case"type":return 7;case"var":return 5;default:return He.trace("unknown field item kind: "+e,{fileName:"src/haxeLanguageServer/features/haxe/completion/CompletionFeatureLegacy.hx",lineNumber:279,className:"haxeLanguageServer.features.haxe.completion.CompletionFeatureLegacy",methodName:"fieldKindToCompletionItemKind"}),null}}}In.__name__="haxeLanguageServer.features.haxe.completion.CompletionFeatureLegacy",Object.assign(In.prototype,{__class__:In});class On{constructor(e){this.context=e}createItems(e){let t;switch(e.mode.kind){case 2:case 11:t=e.mode.args;break;default:return[]}if(null==t)return[];let n=[],r=t.expectedTypeFollowed;if(null!=r){let e=0,t=Nr(r);for(;e<t.length;)n.push(t[e++])}if(null!=t.compatibleTypes){let e=0,r=t.compatibleTypes;for(;e<r.length;){let t=0,i=Nr(r[e++]);for(;t<i.length;)n.push(i[t++])}}let i=[],s=0;for(;s<n.length;)i=i.concat(this.createItemsForType(n[s++],e));i=Ct(i,(function(e,t){return e.insertText==t.insertText}));let a=this,l=e.params.position,o=function(e){return a.createExpectedTypeCompletionItem(e,l)},c=new Array(i.length),u=0,h=i.length;for(;u<h;){let e=u++;c[e]=o(i[e])}return c}createItemsForType(e,t){let n=[],r=this.context.config.user.codeGeneration.functions.anonymous,i=new Sr(!1,Tr.Shadowed,r),s=this;switch(e.kind){case"TAbstract":case"TInst":let a=e.args,l=function(e){return s.createItemsForType(a.params[e],t)[0]},o=Cr(e);if(null!=o)switch(o){case"EReg":n.push({label:"~/regex/",detail:"Generate regex literal",insertText:"~/${1:regex}/",insertTextFormat:2});break;case"haxe.ds.Map":let e=l(1),t={label:"[key => value]",detail:"Generate map literal",insertText:"[${1:key} => "+(null==e?"${2:value}":xr.offset(e.insertText,1))+"]",insertTextFormat:2};t.code=xr.prettify(t.insertText),n.push(t);break;case"Array":case"haxe.ds.ReadOnlyArray":let r=l(0),i={label:"[]",detail:"Generate array literal",insertText:"["+(null==r?"$1":r.insertText)+"]",insertTextFormat:2};i.code=xr.prettify(i.insertText),n.push(i)}break;case"TAnonymous":let c=e.args,u=11==t.mode.kind,h=i.printObjectLiteral(c,u,!1,!0),d=i.printObjectLiteral(c,u,!0,!0);h==d?n.push({label:0==c.fields.length?"{}":"{fields...}",detail:"Generate object literal",insertText:h,insertTextFormat:2,code:i.printObjectLiteral(c,u,!1,!1)}):(n.push({label:"{required fields...}",detail:"Generate object literal\n(only required fields)",sortText:".",insertText:d,insertTextFormat:2,code:i.printObjectLiteral(c,u,!0,!1)}),n.push({label:"{all fields...}",detail:"Generate object literal\n(all fields)",sortText:"/",insertText:h,insertTextFormat:2,code:i.printObjectLiteral(c,u,!1,!1)}));break;case"TFun":let p=i.printAnonymousFunctionDefinition(e.args);n.push({label:p,detail:"Generate anonymous function",insertText:p,insertTextFormat:1,additionalTextEdits:pr(t.doc,t.importPosition,this.context,e,r)})}return n}createExpectedTypeCompletionItem(e,t){let n={label:e.label,detail:e.detail,sortText:null==e.sortText?"0":e.sortText,kind:15,textEdit:{newText:e.insertText,range:{start:t,end:t}},insertTextFormat:e.insertTextFormat,additionalTextEdits:e.additionalTextEdits,data:{origin:1}};return null!=e.code&&(n.documentation={kind:"markdown",value:lr.printCodeBlock(e.code,"haxe")}),n}}On.__name__="haxeLanguageServer.features.haxe.completion.ExpectedTypeCompletion",Object.assign(On.prototype,{__class__:On});class En{constructor(e){this.context=e}createItems(e,t){let n=this.context.config.user.postfixCompletion.level;if("off"==n)return[];let r,i=e.params.context;if(2==(null!=i?i.triggerKind:null)&&"."!=(null!=i?i.triggerCharacter:null))return[];let s=e.mode;if(null==s)return[];if(0!=s.kind)return[];if(null==s.args)return[];r=s.args;let l=r.item.type;if(null==l||null==r.range)return[];let o=Dr(l).type,c=e.doc.getText(r.range);c.startsWith("(")&&c.endsWith(")")&&(c=c.substring(1,c.length-1));let u=e.replaceRange;if(null==u){let t=e.params.position;u={start:t,end:t}}let h={start:r.range.start,end:u.start},d=[],p=this,f=function(t){d.push(p.createPostfixCompletionItem(t,e.doc,h,u))};if(null!=r.iterator){let e="for (${1:"+function(e){let t=Br(e);if(null==t)return"unknown";return hr.guessName(t.path.typeName)}((m=r,m instanceof Array?function(){return new ct(m)}:"function"==typeof m.iterator?nl(m,m.iterator):m.iterator).type)+"} in "+c+") {\n\t$0\n}";f({label:"for",detail:"for (item in expr)",insertText:e,insertTextFormat:2})}var m;if(null!=r.keyValueIterator){let e="StdTypes.Int"==Cr(function(e){return e instanceof Array?function(){return a.keyValueIter(e)}:"function"==typeof e.keyValueIterator?nl(e,e.keyValueIterator):e.keyValueIterator}(r).key)?"index":"key";f({label:"for k=>v",detail:"for ("+e+" => value in expr)",insertText:"for ("+e+" => value in "+c+") {\n\t$0\n}",insertTextFormat:2})}let _=Cr(o);if(null!=_)switch(_){case"StdTypes.Bool":f({label:"not",detail:"!expr",insertText:"!"+c,insertTextFormat:1}),f({label:"if",detail:"if (expr)",insertText:"if ("+c+") {\n\t$0\n}",insertTextFormat:2}),f({label:"else",detail:"if (!expr)",insertText:"if (!"+c+") {\n\t$0\n}",insertTextFormat:2});break;case"StdTypes.Float":f({label:"int",detail:"Std.int(expr)",insertText:"Std.int("+c+")",insertTextFormat:1});break;case"StdTypes.Int":let e=0,t=this.createIndexedLoops(c);for(;e<t.length;)f(t[e++])}"filtered"!=n&&this.createNonFilteredItems(_,c,f);let g=0,x=this.createLengthIterators(r,t,c);for(;g<x.length;)f(x[g++]);let k=this.createSwitchItem(r,c);return null!=k&&f(k),d}createNonFilteredItems(e,t,n){"String"!=e&&n({label:"string",detail:"Std.string(expr)",insertText:"Std.string("+t+")",insertTextFormat:1}),n({label:"trace",detail:"trace(expr);",insertText:"trace(${1:"+t+"});",insertTextFormat:2,eat:";"}),n({label:"print",detail:"Sys.println(expr);",insertText:"Sys.println(${1:"+t+"});",insertTextFormat:2}),n({label:"is",detail:"Std.is(expr, T)",insertText:"Std.is("+t+", $1)",insertTextFormat:2,command:xl}),n({label:"unsafe cast",detail:"cast expr",insertText:"cast "+t,insertTextFormat:1}),n({label:"safe cast",detail:"cast(expr, T)",insertText:"cast("+t+", $1)",insertTextFormat:2,command:xl}),n({label:"type check",detail:"(expr : T)",insertText:"("+t+" : $1)",insertTextFormat:2,command:xl}),n({label:"null",detail:"if (expr == null)",insertText:"if ("+t+" == null) {\n\t$0\n}",insertTextFormat:2}),n({label:"not null",detail:"if (expr != null)",insertText:"if ("+t+" != null) {\n\t$0\n}",insertTextFormat:2}),n({label:"return",detail:"return expr;",insertText:"return "+t+";",insertTextFormat:1});let r=function(e,n){return{label:e,detail:e+" name = "+t+";",insertText:e+" ${1:name} = "+t+";",insertTextFormat:2,eat:";"}};n(r("var")),n(r("final"))}createLengthIterators(e,t,n){let r=[],i=0;for(;i<t.length;){let e=t[i];if(++i,"ClassField"==e.kind){let t=e.args.field.name;if(!new s("^(get)?(length|count|size)$","i").match(t)||null==e.type)continue;let i=Dr(e.type).type;if("TFun"==i.kind){t+="()";let e=i.args;if(e.args.length>0)continue;i=e.ret}let a=Cr(i);if(null!=a)switch(a){case"StdTypes.Int":case"UInt":r=r.concat(this.createIndexedLoops(n+"."+t))}}}return r}createIndexedLoops(e){return[{label:"for 0..."+e,insertText:"for (i in 0..."+e+") {\n\t$0\n}",insertTextFormat:2,showCode:!0},{label:"while 0..."+e,insertText:"var i = 0;\nwhile (i < "+e+") {\n\t$0\n\ti++;\n}",insertTextFormat:2,showCode:!0},{label:"while "+e+"...0",insertText:"var i = "+e+";\nwhile (i-- > 0) {\n\t$0\n}",insertTextFormat:2,showCode:!0}]}createSwitchItem(e,t){let n=e.moduleTypeFollowed;if(null==n&&(n=e.moduleType),null==n)return null;let r=e.item.type;if(null==r)return null;let i=new Sr,s=this.context.config.user.codeGeneration.switch_.parentheses,a=function(e){return{label:"switch",detail:i.printSwitchSubject("expr",s)+" {cases...}",insertText:e,insertTextFormat:2,showCode:!0}},l=Dr(r).nullable;switch(n.kind){case"abstract":if(!Ir(n.meta,":enum")){if("StdTypes"==n.moduleName&&"Bool"==n.name)return a(i.printSwitch(t,["true","false"],l,!0,s));{let e=a(i.printSwitchSubject(t,s)+" {\n\tcase $0\n}");return e.command=xl,e}}{let e=n.args;if(null!=e.impl&&te.exists(e.impl.statics,(function(e){return Or(e)})))return a(i.printSwitchOnEnumAbstract(t,e,l,!0,s))}break;case"enum":let e=n.args;if(e.constructors.length>0)return a(i.printSwitchOnEnum(t,e,l,!0,s));break;default:let r=a(i.printSwitchSubject(t,s)+" {\n\tcase $0\n}");return r.command=xl,r}return null}createPostfixCompletionItem(e,t,n,r){if(null!=e.eat){let n=r.end,i=t.getText({start:n,end:{line:n.line,character:n.character+1}});if(i==e.label.charAt(0)&&i!=e.eat){let e={line:n.line,character:n.character+1};i=t.getText({start:e,end:{line:e.line,character:e.character+1}})}i==e.eat&&(r={start:r.start,end:{line:n.line,character:n.character+1}})}let i={label:e.label,sortText:"~",kind:15,insertTextFormat:e.insertTextFormat,textEdit:{newText:e.insertText,range:r},additionalTextEdits:[{range:n,newText:""}],data:{origin:1}};return 1==e.showCode&&(i.documentation={kind:"markdown",value:lr.printCodeBlock(xr.prettify(e.insertText),"haxe")}),null!=e.detail&&(i.detail=e.detail),null!=e.command&&(i.command=e.command),i}}En.__name__="haxeLanguageServer.features.haxe.completion.PostfixCompletion",Object.assign(En.prototype,{__class__:En});class Dn{constructor(e){this.context=e}createItems(e,t){let n=vt(e.doc.uri),r=e.params.position,i=0==se.trim(a.substr(e.doc.lineAt(r.line),r.character,null)).length,s=new Ye,l=0;for(;l<t.length;){let e=t[l];if(++l,"Keyword"==e.kind)switch(e.args.name){case"final":case"function":case"package":case"var":s.m.set(e,!0);break;case"abstract":case"class":case"enum":case"interface":case"typedef":i&&s.m.set(e,!0)}}let o=[],c=function(){return{items:o,itemsToIgnore:s}},u="{\n\t$0\n}",h=this,d=function(t,n,r,i){o.push(h.createItem(t,n,r,e.replaceRange,i))},p=function(e){d("var","var name:T;","var ${1:name}:${2:T};",e)},f=function(e){d("final","final name:T;","final ${1:name}:${2:T};",e)},m=function(e){d("function","function name()","function ${1:name}($2) {\n\t$0\n}",e)},_=function(e){let t=e?"public ":"";d("readonly",t+"var name(default, null):T;",t+"var ${1:name}(default, null):${2:T};")},g=function(e){let t=e?"public ":"",n=e?"":"private ";d("property",t+"var name(get, set):T;",t+"var ${1:name}(get, set):${2:T};\n\n"+n+"function get_${1:name}():${2:T} {\n\t$3\n}\n\n"+n+"function set_${1:name}(${1:name}:${2:T}):${2:T} "+u)},x=function(e){let t=(e?"static ":"")+"function main()";d("main",t,t+" "+u)},k=function(){d("final","final name","final ${1:name}"),d("var","var name","var ${1:name}"),m()},y=gr.isEqualOrGreaterThan(this.context.haxeServer.haxeVersion,{major:4,minor:2,patch:0,pre:null,build:null}),w=e.tokenContext;switch(w._hx_index){case 0:let t=w.pos,r=function(e){let t=e.indexOf(".");return-1==t?e:e.substring(0,t)}(ot.withoutDirectory(n)),s="${1:"+r+"}",a=s+"(${2:T})";return new Promise((function(l,k){if(i){let t=[{label:"class",code:"class "+s+" "+u},{label:"interface",code:"interface "+s+" "+u},{label:"enum",code:"enum "+s+" "+u},{label:"typedef",code:"typedef "+s+" = "},{label:"struct",code:"typedef "+s+" = "+u},{label:"abstract",code:"abstract "+a+" "+u},{label:"enum abstract",code:"enum abstract "+a+" "+u}],n=new Array(t.length),i=0,l=t.length;for(;i<l;){let s=i++,a=t[s];n[s]=h.createItem(a.label,a.label+" "+r,a.code,e.replaceRange)}o=n}y&&(p(),f(),_(!1),g(!1),m(),x(!1)),t==ri.BeforePackage?h.context.determinePackage.onDeterminePackage({fsPath:n},null,(function(e){let t=""==e.pack?"package;":"package "+e.pack+";";d("package",t,t),l(c())}),(function(e){l(c())})):l(c())}));case 1:let l=w.type,b=l.kind==ii.Class||l.kind==ii.MacroClass;null!=l.field||!b&&l.kind!=ii.Abstract&&l.kind!=ii.EnumAbstract||(l.kind==ii.EnumAbstract?(d("var","var Name;","var ${1:Name}$2;","~"),d("final","final Name;","final ${1:Name}$2;","~")):(p(),f(),_(!0)),m(),g(!0),d("new","public function new()","public function new($1) "+u),b&&x(!0)),null!=l.field&&k();break;case 2:k()}return Promise.resolve(c())}createItem(e,t,n,r,i){return{label:e,detail:t,kind:15,sortText:null==i?"~~":i,textEdit:{range:r,newText:n},insertTextFormat:2,documentation:{kind:"markdown",value:lr.printCodeBlock(xr.prettify(n),"haxe")},data:{origin:1}}}}Dn.__name__="haxeLanguageServer.features.haxe.completion.SnippetCompletion",Object.assign(Dn.prototype,{__class__:Dn});class Bn{constructor(e){this.context=e,e.languageServerProtocol.onRequest("textDocument/documentSymbol",nl(this,this.onDocumentSymbols))}onDocumentSymbols(e,t,n,r){let i=this.context.startTimer("textDocument/documentSymbol"),s=e.textDocument.uri,a=this.context.documents.documents.m.get(s),l=a instanceof bt?a:null;null==l&&Lt(s)&&(l=new bt(s,"hx",1,Ei.readFileSync(vt(s),{encoding:"utf8"})));let o=l;if(null==o)return void Wt(r,s);if(null==o.get_tokens())return void Ht(r);let c=new Rn(o).resolve();n(c),i(null,this.countSymbols(c)+" symbols")}countSymbols(e){if(null==e)return 0;{let t=e.length,n=new Array(e.length),r=0,i=e.length;for(;r<i;){let t=r++;n[t]=this.countSymbols(e[t].children)}return t+te.fold(n,(function(e,t){return e+t}),0)}}}Bn.__name__="haxeLanguageServer.features.haxe.documentSymbols.DocumentSymbolsFeature",Object.assign(Bn.prototype,{__class__:Bn});class Rn{constructor(e){this.document=e}resolve(){let e=Mn._new(),t=this.document.get_tokens();if(null==t)return[];let n=this;return t.tree.filterCallback((function(r,i){Mn.set_depth(e,i);let s=function(r,i,s,a,l){let o=fa.getNameToken(r);if(null==o&&null!=a&&(o=r),null==o||o.inserted)return;if(null==a&&null==(a=fa.getName(o)))return;if(s==jn.Expression&&"_"==a)return;null==l&&(l=!0);let c=t.getTreePos(r);if(s!=jn.Expression){let e=fa.getDocComment(r);if(null!=e){let n=t.getPos(e);c={file:c.file,min:n.min,max:c.max}}}let u=n.document,h=c.max,d={start:u.positionAt(c.min,1),end:u.positionAt(h,1)},p=t.getPos(o),f=n.document,m=p.max,_={name:a,kind:i,range:d,selectionRange:{start:f.positionAt(p.min,1),end:f.positionAt(m,1)}};fa.isDeprecated(r)&&(_.tags=[1]),Mn.addSymbol(e,s,_,l)},a=r.tok;switch(a._hx_index){case 1:switch(a.k._hx_index){case 1:let t=fa.getNameToken(r),n=null!=t?fa.getName(t):null;null==n&&fa.isTypeMacroClass(r)&&(n="<macro class>"),s(r,5,jn.Type(0),n);break;case 7:case 21:let i=sa.isCIdent(sa.firstChild(sa.matches(sa.firstChild(r),oa.POpen)));null!=i&&s(i,13,jn.Expression,null,!1);break;case 26:fa.isTypeEnum(r)&&s(r,10,jn.Type(2));break;case 28:s(r,11,jn.Type(1));break;case 32:fa.isTypeStructure(r)?s(r,23,jn.Type(6)):s(r,11,jn.Type(5));break;case 40:fa.isTypeEnumAbstract(r)?s(r,10,jn.Type(4)):s(r,5,jn.Type(3));break;case 0:case 2:case 42:let a;switch(e[e.length-1].level._hx_index){case 0:case 1:a=jn.Field;break;case 2:case 3:a=jn.Expression}let l=ua.getFieldType(r,da.Private);switch(l._hx_index){case 0:let t=l.name,n=t;null==t&&(n="<anonymous function>");let i=Mn.getParentTypeKind(e);s(r,"new"==n?9:!ua.isOperatorFunction(r)||3!=i&&4!=i?6:25,a,n);break;case 1:let o=l.name,c=l.isStatic,u=l.isInline;if(a==jn.Expression){let e=r.children;if(null!=e){let t=0,n=e.length;for(;t<n;){let n=t++;s(0==n?r:e[n],13,a,null,n==e.length-1)}}}else s(r,4!=Mn.getParentTypeKind(e)||c?u?14:8:22,a,o);break;case 2:s(r,7,a,l.name)}}break;case 2:if(3==a.c._hx_index){let t=Mn.getParentTypeKind(e);if(null!=t)switch(t){case 2:null!=sa.matches(sa.parent(r),oa.BrOpen)&&s(r,22,jn.Field);break;case 6:let e=sa.parent(r);null!=sa.matches(e,oa.Question)&&(e=sa.parent(e)),null!=sa.matches(e,oa.BrOpen)&&s(r,8,jn.Field)}}}return ia.GoDeeper})),e[0].symbol.children}}Rn.__name__="haxeLanguageServer.features.haxe.documentSymbols.DocumentSymbolsResolver",Object.assign(Rn.prototype,{__class__:Rn});var jn=r["haxeLanguageServer.features.haxe.documentSymbols.SymbolLevel"]={__ename__:!0,__constructs__:null,Root:{_hx_name:"Root",_hx_index:0,__enum__:"haxeLanguageServer.features.haxe.documentSymbols.SymbolLevel",toString:n},Type:(t=function(e){return{_hx_index:1,kind:e,__enum__:"haxeLanguageServer.features.haxe.documentSymbols.SymbolLevel",toString:n,__params__:function(){return[this.kind]}}},t._hx_name="Type",t),Field:{_hx_name:"Field",_hx_index:2,__enum__:"haxeLanguageServer.features.haxe.documentSymbols.SymbolLevel",toString:n},Expression:{_hx_name:"Expression",_hx_index:3,__enum__:"haxeLanguageServer.features.haxe.documentSymbols.SymbolLevel",toString:n}};jn.__constructs__=[jn.Root,jn.Type,jn.Field,jn.Expression];class Mn{static set_depth(e,t){if(t>e.length-1)null==e[t]&&(e[t]=e[t-1]);else if(t<e.length-1)for(;e.length-1>t;)e.pop();return e.length-1}static _new(){return[{level:jn.Root,symbol:{name:"root",kind:2,range:null,selectionRange:null,children:[]}}]}static addSymbol(e,t,n,r){let i=e[e.length-1].symbol;null==i.children&&(i.children=[]),i.children.push(n),r&&(e[e.length-1+1]={level:t,symbol:n})}static getParentTypeKind(e){let t=e.length-1;for(;t-- >0;){let n=e[t].level;if(1==n._hx_index)return n.kind}return null}}class Hn{constructor(e){this.context=e,e.languageServerProtocol.onRequest("textDocument/foldingRange",nl(this,this.onFoldingRange))}onFoldingRange(e,t,n,r){let i=this.context.startTimer("textDocument/foldingRange"),s=e.textDocument.uri,a=this.context.documents.documents.m.get(s),l=a instanceof bt?a:null;null==l&&Lt(s)&&(l=new bt(s,"hx",1,Ei.readFileSync(vt(s),{encoding:"utf8"})));let o=l;if(null==o)return void Wt(r,s);if(null==o.get_tokens())return void Ht(r);let c=new Wn(o,this.context.capabilities.textDocument).resolve();n(c),i(null,c.length+" ranges")}}Hn.__name__="haxeLanguageServer.features.haxe.foldingRange.FoldingRangeFeature",Object.assign(Hn.prototype,{__class__:Hn});class Wn{constructor(e,t){this.document=e;let n=null!=t?t.foldingRange:null;this.lineFoldingOnly=1==(null!=n?n.lineFoldingOnly:null)}resolve(){let e=[],t=this,n=function(n,r,i){let s={startLine:n.line,endLine:r.line};t.lineFoldingOnly||(s.startCharacter=n.character,s.endCharacter=r.character),null!=i&&(s.kind=i),e.push(s)},r=function(e,r){let i=t.document.positionAt(e.min),s=t.document.positionAt(e.max);n(i,s,r)},i=null,s=null,a=[],l=[],o=this.document.get_tokens();if(null==o)return[];if(o.tree.filterCallback((function(e,c){let u=e.tok;switch(u._hx_index){case 1:switch(u.k._hx_index){case 15:case 16:r(o.getTreePos(e));break;case 13:case 36:null==i&&(i=e),s=e}break;case 2:if(2==u.c._hx_index){let r=o.getTreePos(e),i=t.document.positionAt(r.min),s=t.getEndOfPreviousLine(r.max);s.line>i.line&&n(i,s)}break;case 3:let c=u.s;if("else"==c||"elseif"==c||"end"==c){let r=a.pop(),i=o.getPos(e),s=t.getEndOfPreviousLine(i.max);null!=r&&s.line>r.line&&n(r,s)}if("if"==c||"else"==c||"elseif"==c){let n=sa.matches(sa.lastChild(sa.matches(sa.firstChild(e),oa.POpen)),oa.PClose),r=null==n?o.getPos(e):o.getPos(n),i=t.document.positionAt(r.max);i.character++,a.push(i)}break;case 7:r(o.getTreePos(e),"comment");break;case 8:let h=u.s;if(Wn.regionStartPattern.match(h))l.push(o.getPos(e).max);else if(Wn.regionEndPattern.match(h)){let t=l.pop();if(null!=t){let n=o.getPos(e);r({file:n.file,min:t,max:n.max},"region")}}break;case 16:case 18:let d=o.getTreePos(e),p=t.document.positionAt(d.min),f=t.getEndOfPreviousLine(d.max);f.line>p.line&&n(p,f)}return ia.GoDeeper})),null!=s&&i!=s){let e=o.getPos(i),t=o.getTreePos(s);r({file:e.file,min:e.min,max:t.max},"imports")}return e}getEndOfPreviousLine(e){let t=this.document.positionAt(e).line-1;return{line:t,character:this.document.lineAt(t).length-1}}}Wn.__name__="haxeLanguageServer.features.haxe.foldingRange.FoldingRangeResolver",Object.assign(Wn.prototype,{__class__:Wn});class Un{}Un.__name__="refactor.edits.IEditableDocument",Un.__isInterface__=!0,Object.assign(Un.prototype,{__class__:Un});class Jn{constructor(e,t,n,r){this.filePath=e,this.list=t,this.context=n,this.converter=r,this.edits=[],this.creates=[],this.renames=[],this.deletes=[]}addChange(e){switch(e._hx_index){case 0:this.creates.push({kind:"create",uri:Ft(e.newFileName),options:{overwrite:!1,ignoreIfExists:!1}});break;case 1:this.deletes.push({kind:"Delete",uri:Ft(e.fileName),options:{recursive:!1,ignoreIfNotExists:!1}});break;case 2:this.renames.push({kind:"rename",oldUri:Ft(this.filePath),newUri:Ft(e.newFileName),options:{overwrite:!1,ignoreIfExists:!1}});break;case 3:let t=e.text,n=t,r=this.posToRange(e.pos);n=this.correctFirstLineIndent(e.format,t,r),this.edits.push({range:r,newText:n});break;case 4:let i=e.text,s=e.pos,a=i;a=this.correctFirstLineIndent(e.format,i,this.posToRange(s)),this.edits.push({range:this.posToRange(s),newText:a});break;case 5:this.edits.push({range:this.posToRange(e.pos),newText:""})}}correctFirstLineIndent(e,t,n){switch(e._hx_index){case 0:break;case 1:if(t=or.formatSnippet(this.filePath,t,la.FieldLevel,e.indentOffset),e.trimRight){let e=t.length,n=0;for(;n<e&&se.isSpace(t,e-n-1);)++n;n>0&&(t=a.substr(t,0,e-n))}if(0!=n.start.character){let e=this.context.documents,r=Ft(this.filePath),i=e.documents.m.get(r),s=i instanceof bt?i:null;null==s&&Lt(r)&&(s=new bt(r,"hx",1,Ei.readFileSync(vt(r),{encoding:"utf8"})));let l=s;if(null!=l)if(0==se.trim(l.getText({start:{line:n.start.line,character:0},end:{line:n.start.line,character:n.start.character}})).length)n.start.character=0;else{let e=t.length,n=0;for(;n<e&&se.isSpace(t,n);)++n;n>0&&(t=a.substr(t,n,e-n))}}}return t}posToRange(e){if(!zs.exists(this.filePath)){let e={line:0,character:0};return{start:e,end:e}}let t=this.context.documents,n=Ft(this.filePath),r=t.documents.m.get(n),i=r instanceof bt?r:null;null==i&&Lt(n)&&(i=new bt(n,"hx",1,Ei.readFileSync(vt(n),{encoding:"utf8"})));let s=i;if(null==s){let t=Ei.readFileSync(this.filePath,{encoding:"utf8"}),n=this.detectLineSeparator(t),r=n.length,i=t.split(n),s=null,a=null,l=0,o=0,c=this.converter.byteOffsetToCharacterOffset(t,e.start),u=this.converter.byteOffsetToCharacterOffset(t,e.end),h=0;for(;h<i.length;){let e=i[h++].length+r;if(c>l+e)l+=e,++o;else{if(c>=l&&c<l+e&&(s={line:o,character:c-l}),u>=l&&u<l+e){a={line:o,character:u-l};break}l+=e,++o}}if(null==s||null==a)throw Me.thrown((null==this.filePath?"null":this.filePath)+" not found");return{start:s,end:a}}let a=this.converter.byteOffsetToCharacterOffset(s.content,e.start),l=this.converter.byteOffsetToCharacterOffset(s.content,e.end);return{start:s.positionAt(a,1),end:s.positionAt(l,1)}}detectLineSeparator(e){let t,n=0,r=e.length;for(;n<r;){let r=n++,i=e.charAt(r);if("\r"==i||"\n"==i)return t=i,"\r"==i&&r+1<e.length&&(i=e.charAt(r+1),"\n"==i&&(t+=i)),t}return"\n"}endEdits(){let e=0,t=this.creates;for(;e<t.length;)this.list.addEdit(t[e++]);this.list.addEdit({textDocument:{uri:Ft(this.filePath),version:null},edits:this.edits});let n=0,r=this.renames;for(;n<r.length;)this.list.addEdit(r[n++]);let i=0,s=this.deletes;for(;i<s.length;)this.list.addEdit(s[i++])}}Jn.__name__="haxeLanguageServer.features.haxe.refactoring.EditDoc",Jn.__interfaces__=[Un],Object.assign(Jn.prototype,{__class__:Jn});class Vn{constructor(){this.documentChanges=[]}addEdit(e){this.documentChanges.push(e)}}Vn.__name__="haxeLanguageServer.features.haxe.refactoring.EditList",Object.assign(Vn.prototype,{__class__:Vn});class Kn{}Kn.__name__="refactor.typing.ITyper",Kn.__isInterface__=!0,Object.assign(Kn.prototype,{__class__:Kn});class Gn{constructor(e){this.context=e,this.printer=new Sr,this.fullPrinter=new Sr(null,Tr.Always)}resolveType(e,t){let n={file:e,offset:t,wasAutoTriggered:!0},r=this;return new Promise((function(i,s){r.context.callHaxeMethod("display/hover",n,null,(function(n){if(null==n)i(null);else{let s=r.buildTypeHint(n,e+"@"+t);i(s)}return null}),jt(s))}))}buildType(e){switch(e.kind){case"TAbstract":case"TEnum":case"TInst":case"TType":let t=e.args,n=this.printer.printPath(t.path),r=this.fullPrinter.printPath(t.path),i=t.path,s=null!=i?i.typeName:null;null!=s&&(s.startsWith("Abstract<")&&(r=s.substring(9,s.length-1)),s.startsWith("Class<")&&(r=s.substring(6,s.length-1)));let a=this.typeList,l=null!=a?a.getType(r):null,o=[];if(t.params.length>0){let e=0,n=t.params;for(;e<n.length;){let t=this.buildType(n[e++]);null!=t&&o.push(t)}}return null==l?Ks.LibType(n,r,o):Ks.ClasspathType(l,o);case"TAnonymous":let c=[],u=0,h=e.args.fields;for(;u<h.length;){let e=h[u];++u;let t=this.buildType(e.type);null!=t&&c.push(Ks.NamedType(e.name,t))}return Ks.StructType(c);case"TDynamic":let d=e.args;if(null==d)return Ks.LibType("Dynamic","Dynamic",[]);let p=this.buildType(d);return null==p?Ks.LibType("Dynamic","Dynamic",[]):Ks.LibType("Dynamic","Dynamic",[p]);case"TFun":let f=e.args,m=[],_=0,g=f.args;for(;_<g.length;){let e=this.buildType(g[_++].t);null!=e&&m.push(e)}return Ks.FunctionType(m,this.buildType(f.ret));case"TMono":return Ks.UnknownType("?")}}buildTypeHint(e,t){if(null==this.typeList)return null;let n=null!=e?e.item:null,r=null!=n?n.type:null;return null==r?null:this.buildType(r)}}Gn.__name__="haxeLanguageServer.features.haxe.refactoring.LanguageServerTyper",Gn.__interfaces__=[Kn],Object.assign(Gn.prototype,{__class__:Gn});class qn{constructor(e){this.context=e,this.cache=new Yi,this.converter=new sr,this.typer=new Gn(e),this.usageCollector=new fs,this.nameMap=new os,this.fileList=new rs,this.typeList=new ps,this.classPaths=[],this.initClassPaths()}clearCache(){this.cache.clear(),this.nameMap.clear(),this.fileList.clear(),this.typeList.clear()}initClassPaths(){if(this.context.config.user.disableRefactorCache)return;if(this.clearCache(),!this.context.haxeServer.supports("server/contexts"))return void this.initFromSetting();let e=ot.removeTrailingSlashes(ot.addTrailingSlash(process.cwd())),t=this;this.context.callHaxeMethod("server/contexts",null,null,(function(n){t.classPaths=[];let r=0;for(;r<n.length;){let i=n[r];if(++r,"after_init_macros"==(null!=i?i.desc:null)){let n=0,r=i.classPaths;for(;n<r.length;){let i=r[n];++n,""!=i&&(ot.isAbsolute(i)&&!i.startsWith(e)||t.classPaths.push(i))}break}}return t.classPaths.length<=0?(t.initFromSetting(),""):(He.trace("[RefactorCache] detected classpaths: "+re.string(t.classPaths),{fileName:"src/haxeLanguageServer/features/haxe/refactoring/RefactorCache.hx",lineNumber:90,className:"haxeLanguageServer.features.haxe.refactoring.RefactorCache",methodName:"initClassPaths"}),t.init(),"")}),(function(e){t.initFromSetting()}))}initFromSetting(){this.classPaths=["src","source","Source","test","tests"],null!=this.context.config.user.renameSourceFolders&&(this.classPaths=this.context.config.user.renameSourceFolders),this.init()}init(){if(this.context.config.user.disableRefactorCache)return;let e=this.context.startTimer("refactor/cache/init"),t=this.context.startProgress("Building Refactoring Cache…"),n=this.makeUsageContext();this.typer.typeList=n.typeList;let r=_r.normalize(this.context.workspacePath),i=this.classPaths,s=new Array(i.length),a=0,l=i.length;for(;a<l;){let e=a++;s[e]=ot.join([r,i[e]])}try{cs.traverseSources(s,n),n.usageCollector.updateImportHx(n)}catch(a){}t(),e()}updateSingleFileCache(e){if(this.context.config.user.disableRefactorCache)return;let t=this.context.startTimer("refactor/cache/updateFile"),n=this.makeUsageContext();n.fileName=e;try{cs.collectIdentifierData(n)}catch(e){}t()}invalidateFile(e){if(this.context.config.user.disableRefactorCache)return;let t=this.context.startTimer("refactor/cache/invalidateFile");this.cache.invalidateFile(e,this.nameMap,this.typeList),this.fileList.removeFile(e);let n=this;if(this.fileList.wasRecentlyRenamed(e))return Ue.delay((function(){zs.exists(e)&&n.updateSingleFileCache(e)}),250),void t();zs.exists(e)&&this.updateSingleFileCache(e),t()}makeUsageContext(){return{fileReader:nl(this,this.readFile),fileName:"",file:null,usageCollector:this.usageCollector,nameMap:this.nameMap,fileList:this.fileList,typeList:this.typeList,type:null,cache:this.cache}}makeCanRenameContext(e,n,r){return{nameMap:this.nameMap,fileList:this.fileList,typeList:this.typeList,what:{fileName:n,toName:"",pos:this.converter.characterOffsetToByteOffset(e.content,e.offsetAt(r))},verboseLog:function(e,t){},typer:this.typer,fileReader:nl(this,this.readFile),converter:(t=this.converter,nl(t,t.byteOffsetToCharacterOffset))}}makeRenameContext(e,n,r,i,s){let a=this;return{nameMap:this.nameMap,fileList:this.fileList,typeList:this.typeList,what:{fileName:n,toName:i,pos:this.converter.characterOffsetToByteOffset(e.content,e.offsetAt(r))},forRealExecute:!0,docFactory:function(e){return new Jn(e,s,a.context,a.converter)},verboseLog:function(e,t){},typer:this.typer,fileReader:nl(this,this.readFile),converter:(t=this.converter,nl(t,t.byteOffsetToCharacterOffset))}}makeCanRefactorContext(e,n){return null==e?null:{nameMap:this.nameMap,fileList:this.fileList,typeList:this.typeList,what:{fileName:vt(e.uri),posStart:this.converter.characterOffsetToByteOffset(e.content,e.offsetAt(n.start)),posEnd:this.converter.characterOffsetToByteOffset(e.content,e.offsetAt(n.end))},verboseLog:function(e,t){},typer:this.typer,fileReader:nl(this,this.readFile),converter:(t=this.converter,nl(t,t.byteOffsetToCharacterOffset))}}makeRefactorContext(e,n,r){if(null==e)return null;let i=this;return{nameMap:this.nameMap,fileList:this.fileList,typeList:this.typeList,what:{fileName:vt(e.uri),posStart:this.converter.characterOffsetToByteOffset(e.content,e.offsetAt(n.start)),posEnd:this.converter.characterOffsetToByteOffset(e.content,e.offsetAt(n.end))},verboseLog:function(e,t){},typer:this.typer,fileReader:nl(this,this.readFile),forRealExecute:!0,docFactory:function(e){return new Jn(e,r,i.context,i.converter)},converter:(t=this.converter,nl(t,t.byteOffsetToCharacterOffset))}}readFile(e){let t=this.context.documents,n=Ft(e),r=t.documents.m.get(n),i=r instanceof bt?r:null;null==i&&Lt(n)&&(i=new bt(n,"hx",1,Ei.readFileSync(vt(n),{encoding:"utf8"})));let s=i;if(null==s)return function(e){return ns.Text(Ei.readFileSync(e,{encoding:"utf8"}))}(e);let a=null!=s?s.get_tokens():null,l=null!=a?a.tree:null;return null!=l?ns.Token(l,s.content):ns.Text(s.content)}}qn.__name__="haxeLanguageServer.features.haxe.refactoring.RefactorCache",Object.assign(qn.prototype,{__class__:qn});class $n{constructor(e){this.IgnoredFiles=["haxe_libraries","node_modules","dump"],this.context=e}onCompletion(e,t,n,r){let i=e.textDocument.uri,s=this.context.documents.documents.m.get(i),l=s instanceof Tt?s:null;null==l&&At(i)&&(l=new Tt(i,"hxml",1,Ei.readFileSync(vt(i),{encoding:"utf8"})));let o=l;if(null==o)return void Wt(r,i);let c=e.position,u=o.lineAt(c.line),h=a.substr(u,c.character,null),d=Zn(a.substr(u,0,c.character),c),p=function(e){n({isIncomplete:!1,items:e})},f=d.range,m=d.element;switch(m._hx_index){case 0:p(this.createFlagCompletion(f,h));break;case 1:p(this.createEnumValueCompletion(f,m.values));break;case 2:p(this.createDefineCompletion(f));break;case 3:case 7:break;case 4:p(this.createFilePathCompletion(f,m.path,!0));break;case 5:p(this.createFilePathCompletion(f,m.path,!1));break;case 6:this.createLibraryNameCompletion(f,n,r)}}createFlagCompletion(e,t){let n=[],r=function(r,i){let s={range:e,newText:i},a={label:i,textEdit:s,filterText:i,kind:3,documentation:{kind:"markdown",value:r.description},insertTextFormat:2},l=r.argument;if(null!=l){if(a.label+=" "+l.name," "!=t.charAt(0)&&(s.newText+=" "),null!=l.insertion){let e=l.insertion;e.includes("$")||(e="${1:"+e+"}"),s.newText+=e}null!=l.kind&&(a.command=xl)}n.push(a)},i=0,s=[],a=gl.iterator();for(;a.hasNext();){let e=tl(a.next());for(;e.hasNext();)s.push(e.next())}for(;i<s.length;){let e=s[i];++i,r(e,e.name),null!=e.shortName&&r(e,e.shortName)}return n}createEnumValueCompletion(e,t){let n=[],r=0,i=t;for(;r<i.length;){let t=i[r];++r,n.push({label:t.name,kind:20,textEdit:{range:e,newText:t.name},documentation:t.description})}return n[0].preselect=!0,n}createDefineCompletion(e){let t=this.context.haxeServer.haxeVersion,n=tr(!1),r=new Array(n.length),i=0,s=n.length;for(;i<s;){let s=i++,a=n[s],l=Xn.getRealName(a),o={range:e,newText:l},c={label:l,kind:21,textEdit:o,documentation:{kind:"markdown",value:Xn.printDetails(a,t)}};Xn.hasParams(a)&&(o.newText+="=",c.command=xl),Xn.isAvailable(a,t)||(c.tags=[1]),r[s]=c}return r}createFilePathCompletion(e,t,n){null==t&&(t="");let r=function(e){return!!zs.exists(e)&&zs.isDirectory(e)},i=(t.endsWith("/")||t.endsWith("\\"))&&r(t)?t:ot.directory(t);if(""==se.trim(i)&&(i="."),!r(i))return[];let s=[],a=0,l=Ei.readdirSync(i);for(;a<l.length;){let e=l[a];if(++a,e.startsWith(".")||e.startsWith("$")||this.IgnoredFiles.includes(e))continue;let t=zs.isDirectory(ot.join([i,e]));if(!n&&!t)continue;let r={label:e,kind:t?19:17};t&&n&&(r.insertText=e+"/",r.command=xl),s.push(r)}return s.push({label:"..",insertText:"../",kind:19,command:xl}),s}createLibraryNameCompletion(e,t,n){this.context.languageServerProtocol.sendRequest("haxe/listLibraries",null,null,(function(n){let r=t,i=new Array(n.length),s=0,a=n.length;for(;s<a;){let t=s++,r=n[t];i[t]={label:r.name,kind:19,textEdit:{newText:r.name,range:e}}}r({isIncomplete:!1,items:i})}),(function(e){let t={code:-32603,message:"unable to retrieve library names"};n(t)}))}}$n.__name__="haxeLanguageServer.features.hxml.CompletionFeature",Object.assign($n.prototype,{__class__:$n});class zn{constructor(e){this.context=e,e.languageServerProtocol.onRequest("textDocument/hover",nl(this,this.onHover))}onHover(e,t,n,r){let i=e.textDocument.uri,s=this.context.documents.documents.m.get(i),a=s instanceof Tt?s:null;null==a&&At(i)&&(a=new Tt(i,"hxml",1,Ei.readFileSync(vt(i),{encoding:"utf8"})));let l=a;if(null==l)return void Wt(r,i);let o,c=e.position,u=Zn(l.lineAt(c.line),c),h=function(e){return{contents:{kind:"markdown",value:e.join("\n\n---\n")},range:u.range}},d=u.element;switch(d._hx_index){case 0:let e=d.flag;if(null!=e){let t=e.name;null!=e.argument&&(t+=" "+e.argument.name),o=h([lr.printCodeBlock(t,"hxml"),e.description])}else o=null;break;case 1:let t=d.value;if(null!=t){let e=[lr.printCodeBlock(t.name,"hxml")];null!=t.description&&e.push(t.description),o=h(e)}else o=null;break;case 2:let n=d.define;o=null!=n?h([lr.printCodeBlock(Xn.getRealName(n),"hxml"),Xn.printDetails(n,this.context.haxeServer.haxeVersion)]):null;break;default:o=null}n(o)}}zn.__name__="haxeLanguageServer.features.hxml.HoverFeature",Object.assign(zn.prototype,{__class__:zn});var Qn=r["haxeLanguageServer.features.hxml.HxmlElement"]={__ename__:!0,__constructs__:null,Flag:(t=function(e){return{_hx_index:0,flag:e,__enum__:"haxeLanguageServer.features.hxml.HxmlElement",toString:n,__params__:function(){return[this.flag]}}},t._hx_name="Flag",t),EnumValue:(t=function(e,t){return{_hx_index:1,value:e,values:t,__enum__:"haxeLanguageServer.features.hxml.HxmlElement",toString:n,__params__:function(){return[this.value,this.values]}}},t._hx_name="EnumValue",t),Define:(t=function(e){return{_hx_index:2,define:e,__enum__:"haxeLanguageServer.features.hxml.HxmlElement",toString:n,__params__:function(){return[this.define]}}},t._hx_name="Define",t),DefineValue:(t=function(e,t){return{_hx_index:3,define:e,value:t,__enum__:"haxeLanguageServer.features.hxml.HxmlElement",toString:n,__params__:function(){return[this.define,this.value]}}},t._hx_name="DefineValue",t),File:(t=function(e){return{_hx_index:4,path:e,__enum__:"haxeLanguageServer.features.hxml.HxmlElement",toString:n,__params__:function(){return[this.path]}}},t._hx_name="File",t),Directory:(t=function(e){return{_hx_index:5,path:e,__enum__:"haxeLanguageServer.features.hxml.HxmlElement",toString:n,__params__:function(){return[this.path]}}},t._hx_name="Directory",t),LibraryName:(t=function(e){return{_hx_index:6,name:e,__enum__:"haxeLanguageServer.features.hxml.HxmlElement",toString:n,__params__:function(){return[this.name]}}},t._hx_name="LibraryName",t),Unknown:{_hx_name:"Unknown",_hx_index:7,__enum__:"haxeLanguageServer.features.hxml.HxmlElement",toString:n}};function Zn(e,t){let n=function(e,t){let n=function(e){return!(!se.isSpace(e,0)&&"="!=e)||":"==e},r=0,i=!1,s=0,a=e.length;for(;s<a;){let a=s++;if(n(e.charAt(a))){if(i&&(i=!1,r<=t&&a>=t))return{start:r,end:a}}else i||(i=!0,r=a)}if(i)return{start:r,end:e.length};return{start:t,end:t}}(e,t.character);e=e.substring(0,n.end);let r=new RegExp("\\s+","".split("u").join("")),i=e.length,s=0;for(;s<i&&se.isSpace(e,s);)++s;let l,o=(s>0?a.substr(e,s,i-s):e).replace(r," ").split(" "),c=function(e){let t=[],n=gl.iterator();for(;n.hasNext();){let e=tl(n.next());for(;e.hasNext();)t.push(e.next())}return te.find(t,(function(t){if(t.name!=e&&t.shortName!=e){let n=t.deprecatedNames;return null!=n?n.includes(e):null}return!0}))};switch(o.length){case 0:l=Qn.Flag();break;case 1:l=Qn.Flag(c(o[0]));break;case 2:let e=o[1],t=c(o[0]),n=null!=t?t.argument:null,r=null!=n?n.kind:null;if(null==r)l=Qn.Unknown;else switch(r._hx_index){case 0:let t=r.values;l=Qn.EnumValue(te.find(t,(function(t){return t.name==e})),t);break;case 1:let n=function(e){return te.find(tr(!0),(function(t){return Xn.matches(t,e)}))},i=e.split("=");switch(i.length){case 0:l=Qn.Define();break;case 1:l=Qn.Define(n(i[0]));break;case 2:let t=i[1],r=n(i[0]),s=null!=r?Xn.getEnumValues(r):null;l=null!=s?Qn.EnumValue(te.find(s,(function(t){return t.name==e})),s):Qn.DefineValue(r,t);break;default:l=Qn.Unknown}break;case 2:l=Qn.File(e);break;case 3:l=Qn.Directory(e);break;case 4:l=Qn.LibraryName(e)}break;default:l=Qn.Unknown}return{element:l,range:{start:{line:t.line,character:n.start},end:{line:t.line,character:n.end}}}}Qn.__constructs__=[Qn.Flag,Qn.EnumValue,Qn.Define,Qn.DefineValue,Qn.File,Qn.Directory,Qn.LibraryName,Qn.Unknown];class Xn{static printDetails(e,t){let n=(new Sr).printMetadataDetails({name:Xn.getRealName(e),doc:e.doc,links:e.links,platforms:e.platforms,parameters:e.params,targets:[],internal:!1,origin:e.origin}),r=pl.m.get(e.name),i=null!=r?r.since:null,s=null!=r?r.until:null,a=function(){return Xn.isAvailable(e,t)?"":" (you are using "+(null==t?"null":gr.toString(t))+")"};return null!=i&&null!=s?n+="\n_Available from Haxe "+(null==i?"null":gr.toString(i))+" to "+(null==s?"null":gr.toString(s))+a()+"_":null!=i?n+="\n_Available since Haxe "+(null==i?"null":gr.toString(i))+a()+"_":null!=s&&(n+="\n_Available until Haxe "+(null==s?"null":gr.toString(s))+a()+"_"),n}static normalizeName(e){return se.replace(e,"_","-")}static getRealName(e){return Xn.normalizeName(e.define)}static matches(e,t){return Xn.normalizeName(t)==Xn.normalizeName(e.define)}static hasParams(e){return null!=e.params||null!=Xn.getEnumValues(e)}static isAvailable(e,t){let n=pl.m.get(e.name);return null==n||(null==n.since||!gr.isGreaterThan(n.since,t))&&(null==n.until||!gr.isGreaterThan(t,n.until))}static getEnumValues(e){return fl.m.get(e.name)}}class Yn{static getClass(e){if(null==e)return null;if(e instanceof Array)return Array;{let t=e.__class__;if(null!=t)return t;let n=Yn.__nativeClassName(e);return null!=n?Yn.__resolveNativeClass(n):null}}static __string_rec(e,t){if(null==e)return"null";if(t.length>=5)return"<...>";let n=typeof e;switch("function"==n&&(e.__name__||e.__ename__)&&(n="object"),n){case"function":return"<function>";case"object":if(e.__enum__){let n=r[e.__enum__].__constructs__[e._hx_index]._hx_name;if(e.__params__){t+="\t";let r=e.__params__(),i=0,s=r.length;for(;i<s;){let e=(i+=1,i-1);r[e]=Yn.__string_rec(r[e],t)}return(null==n?"null":""+n)+"("+r.join(",")+")"}return n}if(e instanceof Array){let n="[";t+="\t";let r=0,i=e.length;for(;r<i;){let i=r++;n+=(i>0?",":"")+Yn.__string_rec(e[i],t)}return n+="]",n}let n;try{n=e.toString}catch(e){return We.lastError=e,"???"}if(null!=n&&n!=Object.toString&&"function"==typeof n){let t=e.toString();if("[object Object]"!=t)return t}let i="{\n";t+="\t";let s=null!=e.hasOwnProperty,a=null;for(a in e)s&&!e.hasOwnProperty(a)||"prototype"!=a&&"__class__"!=a&&"__super__"!=a&&"__interfaces__"!=a&&"__properties__"!=a&&(2!=i.length&&(i+=", \n"),i+=t+a+" : "+Yn.__string_rec(e[a],t));return i+="\n"+(t=t.substring(1))+"}",i;case"string":return e;default:return String(e)}}static __interfLoop(e,t){for(;;){if(null==e)return!1;if(e==t)return!0;let n=e.__interfaces__;if(null!=n&&(null==e.__super__||e.__super__.__interfaces__!=n)){let e=0,r=n.length;for(;e<r;){let r=n[e++];if(r==t||Yn.__interfLoop(r,t))return!0}}e=e.__super__}}static __instanceof(e,t){if(null==t)return!1;switch(t){case Array:return e instanceof Array;case al:return"boolean"==typeof e;case il:return null!=e;case sl:return"number"==typeof e;case rl:return"number"==typeof e&&(0|e)===e;case String:return"string"==typeof e;default:if(null==e)return!1;if("function"==typeof t){if(Yn.__downcastCheck(e,t))return!0}else if("object"==typeof t&&Yn.__isNativeObj(t)&&e instanceof t)return!0;return t==ll&&null!=e.__name__||(t==ol&&null!=e.__ename__||null!=e.__enum__&&r[e.__enum__]==t)}}static __downcastCheck(e,t){return e instanceof t||!!t.__isInterface__&&Yn.__interfLoop(Yn.getClass(e),t)}static __nativeClassName(e){let t=Yn.__toStr.call(e).slice(8,-1);return"Object"==t||"Function"==t||"Math"==t||"JSON"==t?null:t}static __isNativeObj(e){return null!=Yn.__nativeClassName(e)}static __resolveNativeClass(t){return e[t]}}function er(e,t){let n=[],r=e,i=t+1;for(;r<i;){let e=r++;n.push({name:null==e?"null":""+e})}return n}function tr(e){let t=_l.concat(ml.slice());if(e)return t;{let e=[],n=0;for(;n<t.length;){let r=t[n];++n,1!=r.reserved&&e.push(r)}return e}}Yn.__name__="js.Boot";var nr=r["haxeLanguageServer.features.hxml.data.ArgumentKind"]={__ename__:!0,__constructs__:null,Enum:(t=function(e){return{_hx_index:0,values:e,__enum__:"haxeLanguageServer.features.hxml.data.ArgumentKind",toString:n,__params__:function(){return[this.values]}}},t._hx_name="Enum",t),Define:{_hx_name:"Define",_hx_index:1,__enum__:"haxeLanguageServer.features.hxml.data.ArgumentKind",toString:n},File:{_hx_name:"File",_hx_index:2,__enum__:"haxeLanguageServer.features.hxml.data.ArgumentKind",toString:n},Directory:{_hx_name:"Directory",_hx_index:3,__enum__:"haxeLanguageServer.features.hxml.data.ArgumentKind",toString:n},LibraryName:{_hx_name:"LibraryName",_hx_index:4,__enum__:"haxeLanguageServer.features.hxml.data.ArgumentKind",toString:n}};nr.__constructs__=[nr.Enum,nr.Define,nr.File,nr.Directory,nr.LibraryName];var rr=r["haxeLanguageServer.features.hxml.data.Category"]={__ename__:!0,__constructs__:null,Target:{_hx_name:"Target",_hx_index:0,__enum__:"haxeLanguageServer.features.hxml.data.Category",toString:n},Compilation:{_hx_name:"Compilation",_hx_index:1,__enum__:"haxeLanguageServer.features.hxml.data.Category",toString:n},Optimization:{_hx_name:"Optimization",_hx_index:2,__enum__:"haxeLanguageServer.features.hxml.data.Category",toString:n},Debug:{_hx_name:"Debug",_hx_index:3,__enum__:"haxeLanguageServer.features.hxml.data.Category",toString:n},Batch:{_hx_name:"Batch",_hx_index:4,__enum__:"haxeLanguageServer.features.hxml.data.Category",toString:n},Services:{_hx_name:"Services",_hx_index:5,__enum__:"haxeLanguageServer.features.hxml.data.Category",toString:n},CompilationServer:{_hx_name:"CompilationServer",_hx_index:6,__enum__:"haxeLanguageServer.features.hxml.data.Category",toString:n},TargetSpecific:{_hx_name:"TargetSpecific",_hx_index:7,__enum__:"haxeLanguageServer.features.hxml.data.Category",toString:n},Miscellaneous:{_hx_name:"Miscellaneous",_hx_index:8,__enum__:"haxeLanguageServer.features.hxml.data.Category",toString:n}};rr.__constructs__=[rr.Target,rr.Compilation,rr.Optimization,rr.Debug,rr.Batch,rr.Services,rr.CompilationServer,rr.TargetSpecific,rr.Miscellaneous];class ir{byteRangeToCharacterRange(e,t){return{start:{line:e.start.line,character:this.byteOffsetToCharacterOffset(t.lineAt(e.start.line),e.start.character)},end:{line:e.end.line,character:this.byteOffsetToCharacterOffset(t.lineAt(e.end.line),e.end.character)}}}static create(e){return gr.isEqualOrGreaterThan(e,{major:4,minor:0,patch:0,pre:null,build:null})?new ar:new sr}}ir.__name__="haxeLanguageServer.helper.DisplayOffsetConverter",Object.assign(ir.prototype,{__class__:ir});class sr extends ir{constructor(){super()}positionCharToZeroBasedColumn(e){return e}byteOffsetToCharacterOffset(e,t){return jr.from(e,"utf-8").toString("utf-8",0,t).length}characterOffsetToByteOffset(e,t){return 0==t?0:t==e.length?jr.byteLength(e,"utf-8"):jr.byteLength(a.substr(e,0,t),"utf-8")}}sr.__name__="haxeLanguageServer.helper.Haxe3DisplayOffsetConverter",sr.__super__=ir,Object.assign(sr.prototype,{__class__:sr});class ar extends ir{constructor(){super()}positionCharToZeroBasedColumn(e){return e-1}byteOffsetToCharacterOffset(e,t){let n=t,r=0,i=0;for(;i<e.length&&r<t;){let t=a.cca(e,i);if(null==t)throw new $s("Null pointer in .sure() call");t>=55296&&t<56320&&(++n,++i),++r,++i}return n}characterOffsetToByteOffset(e,t){let n=t,r=0,i=0;for(;i<e.length&&r<t;){let t=a.cca(e,i);if(null==t)throw new $s("Null pointer in .sure() call");t>=55296&&t<56320&&(n+=-1,++i),++r,++i}return n}}ar.__name__="haxeLanguageServer.helper.Haxe4DisplayOffsetConverter",ar.__super__=ir,Object.assign(ar.prototype,{__class__:ar});class lr{static trim(e){if(null==e)return"";for(;"*"==e.charAt(0);)e=a.substr(e,1,null);for(;"*"==e.charAt(e.length-1);)e=a.substr(e,0,e.length-1);e=se.trim(e);let t=new s("^([ \t]+(\\* )?)[^\\s\\*]","m");if(t.match(e)){let n=t.matched(1);n=n.split("* ").join("\\* ?");let r=new RegExp("^"+n,"gm".split("u").join(""));e=e.replace(r,"")}if("*"==e.charAt(0)){let t=a.substr(e,1,null),n=t.length,r=0;for(;r<n&&se.isSpace(t,r);)++r;e=r>0?a.substr(t,r,n-r):t}return e}static markdownFormat(e){let t=function(e,t){return"| "+(null==e?"null":""+e)+" | "+(null==t?"null":""+t)+" |\n"},n=function(e,n){return"\n"+t(e,n)+t("------","------")},r=function(e,t){return se.replace(se.replace(e,"\n",t),"\r",t)},i=function(e){let n=new Array(e.length),i=0,s=e.length;for(;i<s;){let s=i++,a=e[s],l=r(a.doc," ");n[s]=t("`"+a.value+"`",l)}return n.join("")};e=lr.trim(e);let s=mr.parse(e),a=s.doc,l=s.params.length>0,o=null!=s.returns;if(a+="\n",null!=s.deprecated&&(a+="\n**Deprecated:** "+s.deprecated.doc+"\n"),(l||o)&&(a+=n("Argument","Description")),l&&(a+=i(s.params)),o&&(a+=t("`return`",r(s.returns.doc," "))),s.throws.length>0&&(a+=n("Exception","Description")+i(s.throws)),s.events.length>0&&(a+=n("Event","Description")+i(s.events)),s.sees.length>0){let e=s.sees,t=new Array(e.length),n=0,r=e.length;for(;n<r;){let r=n++;t[r]="* "+e[r].doc}a+="\nSee also:\n"+t.join("\n")+"\n"}return null!=s.since&&(a+="\n_Available since "+s.since.doc+"_"),a}static extractText(e){if(null==e)return null;let t="",n=0,r=se.trim(e).split("\n");for(;n<r.length;){let e=r[n];++n,e=se.trim(e),e.startsWith("*")&&(e=a.substr(e,1,null)),t+=""==e?"\n\n":e+" "}return t}static printCodeBlock(e,t){return"```"+t+"\n"+e+"\n```"}static untrimRange(e,t){let n=e.lineAt(t.start.line);return lr.reStartsWhitespace.match(n.substring(0,t.start.character))&&(t={start:{line:t.start.line,character:0},end:t.end}),lr.reEndsWithWhitespace.match((t.start.line==t.end.line?n:e.lineAt(t.end.line)).substring(t.end.character))&&(t={start:t.start,end:{line:t.end.line+1,character:0}}),t}}lr.__name__="haxeLanguageServer.helper.DocHelper";class or{static formatText(e,t,n,r){let i,s;if(Pt(e.uri)){let t=vt(e.uri);i=t,s=me.SourceFile(t)}else i=t.workspacePath,s=me.Snippet;let a=pe.format(fe.Code(n,s),pe.loadConfig(i),null,r);return 0===a._hx_index?a.formattedCode:n}static formatSnippet(e,t,n,r){let i=pe.format(fe.Code(t,me.Snippet),pe.loadConfig(e),null,n,null,r);return 0===i._hx_index?i.formattedCode:t}}or.__name__="haxeLanguageServer.helper.FormatterHelper";class cr{static cp(e,t){let n=[],r=Ei.lstatSync(e);if(r.isDirectory()){zs.exists(t)||zs.createDirectory(t);let r=Ei.readdirSync(e),i=0;for(;i<r.length;){let s=r[i];++i;let a=ot.join([e,s]),l=ot.join([t,s]),o=Ei.statSync(a);n.push((o.isDirectory()?cr.cp:cr.copyFile)(a,l))}}else r.isFile()&&n.push(cr.copyFile(e,t));return Promise.all(n).then((function(e){return null}))}static rmdir(e){try{if(!Ei.existsSync(e))return Promise.resolve();if(!Ei.lstatSync(e).isDirectory())return cr.rmFile(e);let t=[],n=0,r=Ei.readdirSync(e);for(;n<r.length;)t.push(cr.rmdir(ot.join([e,r[n++]])));return Promise.all(t).then((function(t){Ei.rmdirSync(e)}))}catch(e){return Promise.reject(Me.caught(e))}}static rmFile(e){return Ei.unlinkSync(e),Promise.resolve()}static copyFile(e,t){let n=ot.directory(t);return zs.exists(n)||zs.createDirectory(n),Qs.copy(e,t),Promise.resolve()}}cr.__name__="haxeLanguageServer.helper.FsHelper";class ur{static parse(e,t,n,r){if(!ur.positionRe.match(e))return null;let i=ur.getProperFileNameCase(ur.positionRe.matched(1)),s=ur.positionRe.matched(3);if(null!=s){let e=re.parseInt(s);if(null==e)throw new $s("Null pointer in .sure() call");let n=re.parseInt(ur.positionRe.matched(4));return{uri:i==vt(t.uri)?t.uri:Ft(i),range:{start:{line:e-1,character:0},end:{line:n,character:0}}}}{let e,a,l,o=re.parseInt(ur.positionRe.matched(2));if(null==o)throw new $s("Null pointer in .sure() call");if(e=o,e=o-1,i==vt(t.uri))a=t.lineAt(e),l=t.uri;else{let t;if(null==n)t=Ei.readFileSync(i,{encoding:"utf8"}).split("\n");else if(t=n.m.get(i),null==t){let e=Ei.readFileSync(i,{encoding:"utf8"}).split("\n");n.m.set(i,e),t=e}a=t[e],l=Ft(i)}let c=re.parseInt(ur.positionRe.matched(6));if(null==c)throw new $s("Null pointer in .sure() call");let u,h=r.byteOffsetToCharacterOffset(a,r.positionCharToZeroBasedColumn(c));if(s=ur.positionRe.matched(5),null!=s){let e=re.parseInt(s);if(null==e)throw new $s("Null pointer in .sure() call");u=r.byteOffsetToCharacterOffset(a,r.positionCharToZeroBasedColumn(e))}else u=h;return{uri:l,range:{start:{line:e,character:u},end:{line:e,character:h}}}}}static getProperFileNameCase(e){if(!ur.isWindows)return e;if(null!=ur.properFileNameCaseCache){let t=ur.properFileNameCaseCache.m.get(e);if(null!=t)return t}let t=e,n=e.split("\\");if(n.length>1){let e=n[0],r=1,i=n.length;for(;r<i;){let t=n[r++],i=0,s=Ei.readdirSync(e+"\\");for(;i<s.length;){let e=s[i];if(++i,e.toLowerCase()==t){t=e;break}}e=e+"/"+t}t=e}return ur.properFileNameCaseCache.m.set(e,t),t}}ur.__name__="haxeLanguageServer.helper.HaxePosition";class hr{static guessNames(e){let t=[],n=0;for(;n<e.length;){let r=e[n];++n,null!=r.name?t.push(r.name):t.push(hr.guessName(r.type))}return hr.avoidDuplicates(t)}static guessName(e){if(null==e)return"unknown";if(e=yr.unwrapNullable(e),null==(e=yr.getTypeWithoutParams(e))){if(e.startsWith("{"))return"struct";{let t=new s("(?=[A-Z][^A-Z]*$)","").split(e),n=t[t.length-1];return n.substring(0,1).toLowerCase()+a.substr(n,1,null)}}switch(e){case"":return"unknown";case"Bool":return"b";case"Dynamic":return"d";case"False":case"Float":return"f";case"Int":return"i";case"Null":return"n";case"String":return"s";case"True":return"t";case"Void":return"_";default:if(e.startsWith("{"))return"struct";{let t=new s("(?=[A-Z][^A-Z]*$)","").split(e),n=t[t.length-1];return n.substring(0,1).toLowerCase()+a.substr(n,1,null)}}}static avoidDuplicates(e){let t=new Map,n=[],r=0;for(;r<e.length;){let i=e[r];++r;let s=t.get(i);null==s&&(s=0);let a=i;te.count(e,(function(e){return e==a}))>1&&++s,t.set(i,s),s>0&&(i+=s),n.push(i)}return n}static addNamesToSignatureType(e,t){null==t&&(t=0);let n=!1;if(e.startsWith("?")&&(n=!0,e=a.substr(e,1,null)),e.startsWith(":")){let r=n?"?":"",i=26,s=97,a=[],l=0,o=1+(t/i|0);for(;l<o;)l++,a.push(String.fromCodePoint(s+t%i));return r+a.join("")+e}if(e.startsWith("(")){let n=new s("\\((.*?)\\)\\s*:\\s*(.*)","");if(!n.match(e))return e;let r=n.matched(1),i=n.matched(2),a=[],l=0,o=new s("\\s*,\\s*","g").split(r);for(;l<o.length;)a.push(hr.addNamesToSignatureType(o[l++],t++));return"("+a.join(", ")+"):"+i}return e}}function dr(e,t,n,r){if("module"==r){let e=yr.getModule,t=new Array(n.length),r=0,i=n.length;for(;r<i;){let i=r++;t[i]=e(n[i])}n=t}let i=t.position,s={start:i,end:i},a=new Array(n.length),l=0,o=n.length;for(;l<o;){let e=l++;a[e]="import "+n[e]+";\n"}let c={range:s,newText:a.join("")},u=function(n){return 0==se.trim(e.lineAt(t.position.line+n)).length};return t.insertLineBefore&&!u(-1)&&(c.newText="\n"+c.newText),t.insertLineAfter&&!u(0)&&(c.newText+="\n"),c}function pr(e,n,r,i,s){let a=r.config.user.codeGeneration.imports;if(!a.enableAutoImports)return[];let l=[],o=Lr(i);if(s.argumentTypeHints&&(!s.useArrowSyntax||1!=o.args.length)){let e=o.args,t=new Array(e.length),n=0,r=e.length;for(;n<r;){let r=n++;t[r]=Fr(e[r].t)}let i=[],s=tl(t);for(;s.hasNext();){let e=tl(s.next());for(;e.hasNext();)i.push(e.next())}l=l.concat(te.array(i))}if(It(s,o)&&(l=l.concat(Fr(o.ret))),l=Ct(l,(function(e,t){return JSON.stringify(e)==JSON.stringify(t)})),0==l.length)return[];{let r=nl(t=new Sr(!1,Tr.Always),t.printPath),i=new Array(l.length),s=0,o=l.length;for(;s<o;){let e=s++;i[e]=r(l[e])}return[dr(e,n,i,a.style)]}}function fr(e){let t=e.get_tokens();if(null==t)return{position:{line:0,character:0},insertLineAfter:!0,insertLineBefore:!0};let n=null,r=null,i=3==t.list[0].tok._hx_index?t.list[0]:null;if(t.tree.filterCallback((function(e,t){let i=e.tok;switch(i._hx_index){case 1:switch(i.k._hx_index){case 34:r=e;break;case 13:case 36:null==n&&(n=e)}break;case 3:"if"==i.s&&null==n&&(n=e)}return ia.SkipSubtree})),null!=n)return{position:e.positionAt(t.getPos(n).min),insertLineBefore:!1,insertLineAfter:!1};if(null!=r){let n=r.getLastChild(),i=e.positionAt(t.getPos(null!=n?n:r).max);return i.line+=1,i.character=0,{position:i,insertLineAfter:!0,insertLineBefore:!0}}if(null!=i){let t=e.positionAt(i.pos.max);return t.line+=1,t.character=0,{position:t,insertLineAfter:!0,insertLineBefore:!0}}return{position:{line:0,character:0},insertLineAfter:!0,insertLineBefore:!0}}hr.__name__="haxeLanguageServer.helper.IdentifierHelper";class mr{static parse(e){let t=[],n={doc:e=new s("^@(param|default|exception|throws|deprecated|return|returns|since|see|event|author)\\s+([^@]+)","gm").map(e,(function(e){let n=e.matched(1),r=e.matched(2),i=null;switch(n){case"event":case"exception":case"param":case"throws":let e=new s("([^\\s]+)\\s+([\\s\\S]*)","g");e.match(r)?(i=e.matched(1),r=e.matched(2)):(i=r,r="")}return r=mr.trimDoc(r),t.push({name:n,doc:r,value:i}),""})),throws:[],params:[],sees:[],events:[],tags:t},r=0;for(;r<t.length;){let e=t[r];switch(++r,e.name){case"default":n.defaultValue=e;break;case"deprecated":n.deprecated=e;break;case"event":n.events.push(e);break;case"param":n.params.push(e);break;case"return":case"returns":n.returns=e;break;case"see":n.sees.push(e);break;case"since":n.since=e;break;case"exception":case"throws":n.throws.push(e)}}return n}static trimDoc(e){let t=new s("^\\s+","m");if(t.match(e)){let n=new RegExp("^"+t.matched(0),"mg".split("u").join(""));e=e.replace(n,"")}return e}}mr.__name__="haxeLanguageServer.helper.JavadocHelper";class _r{static matches(e,t){return new s(t,"").match(_r.normalize(e))}static preparePathFilter(e,t,n){let r=e;return r=se.replace(e,"${workspaceRoot}",n),null!=t&&(r=se.replace(r,"${haxelibPath}",t)),_r.normalize(r)}static normalize(e){let t=ot.normalize(e);return _r.reUpperCaseDriveLetter.match(t)&&(t=a.substr(t,0,1).toLowerCase()+t.substring(1)),t}}_r.__name__="haxeLanguageServer.helper.PathHelper";class gr{static parse(e){return gr.reVersion.match(e)?{major:re.parseInt(gr.reVersion.matched(1)),minor:re.parseInt(gr.reVersion.matched(2)),patch:re.parseInt(gr.reVersion.matched(3)),pre:gr.reVersion.matched(4),build:gr.reVersion.matched(5)}:null}static isEqualOrGreaterThan(e,t){return!!gr.isEqual(e,t)||gr.isGreaterThan(e,t)}static isGreaterThan(e,t){return e.major>t.major||e.major==t.major&&e.minor>t.minor||e.major==t.major&&e.minor==t.minor&&e.patch>t.patch}static isEqual(e,t){return e.major==t.major&&e.minor==t.minor&&e.patch==t.patch}static toString(e){return e.major+"."+e.minor+"."+e.patch}static toFullVersion(e){let t=e.major+"."+e.minor+"."+e.patch;return null!=e.pre&&(t+="-"+e.pre),null!=e.build&&(t+="+"+e.build),t}}class xr{static prettify(e){let t=new RegExp("\\$\\{\\d+:(.*?)\\}","g".split("u").join(""));e=e.replace(t,"$1");let n=new RegExp("\\$\\d+","g".split("u").join(""));return e.replace(n,"|")}static offset(e,t){return new s("\\$\\{(\\d+)(:.*?)?\\}","g").map(e,(function(e){let n=re.parseInt(e.matched(1));if(null==n)return e.matched(0);let r=e.matched(2);return null==r&&(r=""),"${"+(n+t)+r+"}"}))}}xr.__name__="haxeLanguageServer.helper.SnippetHelper";class kr{static clean(e){return e.replace(kr.stripAnsi.r,"")}}kr.__name__="haxeLanguageServer.helper.StringHelper";class yr{static getCloseChar(e){switch(e){case"(":return")";case"<":return">";case"{":return"}";default:throw Me.thrown("unknown opening char "+e)}}static prepareSignature(e){let t=yr.parseDisplayType(e);switch(t._hx_index){case 0:let e=t.type;return null==e?"":e;case 1:return yr.printFunctionSignature(t.args,t.ret,{argumentTypeHints:!0,returnTypeHint:"always",useArrowSyntax:!1,placeOpenBraceOnNewLine:!1,explicitNull:!1,explicitPrivate:!1,explicitPublic:!1})}}static printFunctionSignature(e,t,n){let r=!n.useArrowSyntax||n.argumentTypeHints||1!=e.length,i="";r&&(i+=String.fromCodePoint(40));let s=0,a=e.length;for(;s<a;){let t=s++;t>0&&(i+=", "),i+=re.string(yr.printSignatureArgument(t,e[t],n.argumentTypeHints))}return r&&(i+=String.fromCodePoint(41)),yr.shouldPrintReturnType(t,n.returnTypeHint)&&!n.useArrowSyntax&&(i+=String.fromCodePoint(58),i+=re.string(t.replace(yr.packagePathsRegex.r,""))),i}static shouldPrintReturnType(e,t){if(null==e)return!1;switch(t){case"always":return!0;case"never":return!1;case"non-void":return"Void"!=e}}static printSignatureArgument(e,t,n){let r=null!=t.name?t.name:String.fromCodePoint(97+e);return 1==t.opt&&(r="?"+r),null!=t.type&&n&&(r+=":",r+=t.type),r}static printFunctionType(e,t){let n="";n+=String.fromCodePoint(40);let r=0,i=e.length;for(;r<i;){let t=r++;t>0&&(n+=", "),n+=re.string(yr.printSignatureArgument(t,e[t],!0))}return n+=") -> ",n+=re.string(null==t?"Unknown":t),n}static unwrapNullable(e){for(;e.startsWith("Null<")&&e.endsWith(">");)e=e.substring("Null<".length,e.length-1);return e}static getTypeWithoutParams(e){let t=e.indexOf("<");return t>=0?e.substring(0,t):e}static getModule(e){return yr.subtypePackageRegex.match(e)?Ut(e):e}static parseDisplayType(e){e=se.replace(e," -> ","%");let t="",n=new Map,r=new ze,i=0,s=0,l=0,o=e.length;for(;l<o;){let a=e.charAt(l++);if("("==a||"<"==a||"{"==a){if(++i,r.head=new $e(yr.getCloseChar(a),r.head),1==i){++s,n.set(s,new ie),t+=null==a?"null":""+a,t+=re.string("$"+s);continue}}else if(a==(null==r.head?null:r.head.elt)){let e=r.head;null!=e&&(r.head=e.next),--i}0==i?t+=null==a?"null":""+a:n.get(s).b+=null==a?"null":""+a}let c=function(e){return e=yr.groupRegex.map(e,(function(e){let t=re.parseInt(e.matched(1));return null==t?"":se.replace(n.get(t).b,"%","->")})),yr.parenRegex.match(e)&&(e=yr.parenRegex.matched(1)),e},u=t.split("%"),h=c(u.pop());if(yr.monomorphRegex.match(h)&&(h=null),u.length>0){let e=[],t=0,n=u.length;for(;t<n;){let n,r,i=u[t++],s=!1;if(yr.argNameRegex.match(i)?(n=yr.argNameRegex.matched(1),63==a.cca(n,0)&&(n=n.substring(1),s=!0),r=yr.argNameRegex.matchedRight()):(n=null,r=i,63==a.cca(i,0)&&(r=i.substring(1),s=!0)),s&&yr.nullRegex.match(r)&&(r=yr.nullRegex.matched(1)),r=c(r),"Void"==r)continue;let l={name:n};yr.monomorphRegex.match(r)||(l.type=r),s&&(l.opt=!0),e.push(l)}return wr.DTFunction(e,h)}return wr.DTValue(h)}}yr.__name__="haxeLanguageServer.helper.TypeHelper";var wr=r["haxeLanguageServer.helper.DisplayType"]={__ename__:!0,__constructs__:null,DTValue:(t=function(e){return{_hx_index:0,type:e,__enum__:"haxeLanguageServer.helper.DisplayType",toString:n,__params__:function(){return[this.type]}}},t._hx_name="DTValue",t),DTFunction:(t=function(e,t){return{_hx_index:1,args:e,ret:t,__enum__:"haxeLanguageServer.helper.DisplayType",toString:n,__params__:function(){return[this.args,this.ret]}}},t._hx_name="DTFunction",t)};wr.__constructs__=[wr.DTValue,wr.DTFunction];class br{static textDocumentEdit(e,t){return{textDocument:{uri:e,version:null},edits:t}}static insertText(e,t){return{range:{start:e,end:e},newText:t}}static replaceText(e,t){return{range:e,newText:t}}static removeText(e){return{range:e,newText:""}}}br.__name__="haxeLanguageServer.helper.WorkspaceEditHelper";var Tr=r["haxeLanguageServer.protocol.PathPrinting"]={__ename__:!0,__constructs__:null,Always:{_hx_name:"Always",_hx_index:0,__enum__:"haxeLanguageServer.protocol.PathPrinting",toString:n},Never:{_hx_name:"Never",_hx_index:1,__enum__:"haxeLanguageServer.protocol.PathPrinting",toString:n},Qualified:{_hx_name:"Qualified",_hx_index:2,__enum__:"haxeLanguageServer.protocol.PathPrinting",toString:n},Shadowed:{_hx_name:"Shadowed",_hx_index:3,__enum__:"haxeLanguageServer.protocol.PathPrinting",toString:n}};Tr.__constructs__=[Tr.Always,Tr.Never,Tr.Qualified,Tr.Shadowed];class Sr{constructor(e,t,n){null==t&&(t=Tr.Qualified),null==e&&(e=!1),this.indent="",this.wrap=e,this.pathPrinting=t,this.functionFormatting=null==n?{useArrowSyntax:!0,returnTypeHint:"non-void",argumentTypeHints:!0,placeOpenBraceOnNewLine:!1,explicitPublic:!1,explicitPrivate:!1,explicitNull:!1}:n}collectQualifiedPaths(){let e=this.qualifiedPaths,t=this.qualifiedPaths=[],n=this;return function(){return n.qualifiedPaths=e,t}}printPath(e){let t;switch(this.pathPrinting._hx_index){case 0:t=!0;break;case 1:t=!1;break;case 2:t=0!=e.importStatus;break;case 3:t=2==e.importStatus}let n=e.moduleName!=e.typeName;0!=e.pack.length||n||2!=e.importStatus||e.pack.push("std");let r=function(){let t=e.moduleName+(n?"."+e.typeName:"");return e.pack.length>0&&(t=e.pack.join(".")+"."+t),t};return t?r():(1==e.importStatus&&null!=this.qualifiedPaths&&this.qualifiedPaths.push(r()),e.typeName)}printPathWithParams(e){let t=this.printPath(e.path);if(0==e.params.length)return t;{let n=e.params,r=nl(this,this.printType),i=new Array(n.length),s=0,a=n.length;for(;s<a;){let e=s++;i[e]=r(n[e])}return t+"<"+i.join(", ")+">"}}printType(e){let t=this;switch(e.kind){case"TAbstract":case"TEnum":case"TInst":case"TType":return this.printPathWithParams(e.args);case"TAnonymous":let n=e.args.fields,r=[],i=0;for(;i<n.length;){let e=n[i];++i,r.push((Ir(e.meta,":optional")?"?":"")+e.name+":"+re.string(this.printTypeRec(e.type)))}return"{"+r.join(", ")+"}";case"TDynamic":if(null==e.args)return"Dynamic";{let t=this.printTypeRec(e.args);return"Dynamic<"+(null==t?"null":""+t)+">"}case"TFun":let s=!1,a=function(e){return""!=e.name&&(s=!0),t.printFunctionArgument(e)},l=e.args.args,o=a,c=new Array(l.length),u=0,h=l.length;for(;u<h;){let e=u++;c[e]=o(l[e])}let d=this.printTypeRec(e.args.ret);switch(c.length){case 0:return"() -> "+(null==d?"null":""+d);case 1:return s?"("+c[0]+") -> "+(null==d?"null":""+d):c[0]+" -> "+(null==d?"null":""+d);default:return te.fold(c,(function(e,t){return t+e.length}),0)<50||!this.wrap?"("+c.join(", ")+") -> "+(null==d?"null":""+d):"("+c.join(",\n "+this.indent)+")\n"+this.indent+"-> "+(null==d?"null":""+d)}break;case"TMono":return"?"}}printTypeRec(e){let t=this.indent;this.indent+="  ";let n=this.printType(e);return this.indent=t,n}printFunctionArgument(e){let t=Dr(e.t),n=this.functionFormatting.explicitNull||!e.opt?e.t:t.type,r=(e.opt&&null==e.value?"?":"")+e.name;return!this.functionFormatting.argumentTypeHints||"TMono"==n.kind&&""!=e.name||(r+=(""==e.name?"":":")+re.string(this.printTypeRec(n))),null!=e.value&&(r+=" = "+e.value.string),r}printCallArguments(e,t){let n=e.args,r=new Array(n.length),i=0,s=n.length;for(;i<s;){let e=i++;r[e]=t(n[e])}return"("+r.join(", ")+")"}printTypeParameters(e){if(0==e.length)return"";{let t=new Array(e.length),n=0,r=e.length;for(;n<r;){let r=n++,i=e[r],s=i.name;if(i.constraints.length>0){let e=i.constraints,t=new Array(e.length),n=0,r=e.length;for(;n<r;){let r=n++;t[r]=this.printTypeRec(e[r])}s+=":"+t.join(" & ")}t[r]=s}return"<"+t.join(", ")+">"}}printReturn(e){return"TMono"==e.ret.kind?"":It(this.functionFormatting,e)?":"+this.printTypeRec(e.ret):""}printEmptyFunctionDefinition(e,t,n){return"function "+e+(null==n?"":this.printTypeParameters(n))+this.printCallArguments(t,nl(this,this.printFunctionArgument))+this.printReturn(t)}printOverrideDefinition(e,t,n,r){let i=e.isPublic?"public ":"private ";e.isPublic&&!this.functionFormatting.explicitPublic&&(i=""),e.isPublic||this.functionFormatting.explicitPrivate||(i="");let s=Lr(t),a="StdTypes.Void"==Cr(s.ret)?"":"return ",l=this.printCallArguments(s,(function(e){return e.name})),o=this.functionFormatting.placeOpenBraceOnNewLine?"\n":" ",c=i+this.printEmptyFunctionDefinition(e.name,s,e.params)+(o+"{\n")+n,u=a+"super."+e.name+l+";";return r?c+"${1:"+u+"}$0\n}":c+u+"\n}"}printCommonFieldModifiers(e,t,n){t.isPublic?n||(e.b+="public "):this.functionFormatting.explicitPrivate&&(e.b+="private "),0!=t.scope||n||(e.b+="static ")}printMethodImplementation(e,t,n,r,i,s){null==s&&(s="\t");let a=new ie,l=Lr(t),o=this.functionFormatting.placeOpenBraceOnNewLine?"\n":" ";Ir(e.meta,":overload")&&(a.b+="overload "),n&&(a.b+="override "),this.printCommonFieldModifiers(a,e,r);let c=this.printEmptyFunctionDefinition(e.name,l,e.params);if(a.b+=re.string(c),a.b=(a.b+=null==o?"null":""+o)+"{",i.length>0){let e=0;for(;e<i.length;){let t=i[e];++e,a.b+="\n",a.b=(a.b+=re.string(this.indent))+(null==s?"null":""+s),a.b=(a.b+=null==s?"null":""+s)+(null==t?"null":""+t),a.b+=";"}a.b+="\n",a.b=(a.b+=re.string(this.indent))+(null==s?"null":""+s)}return a.b+="}\n",a.b}printVarImplementation(e,t,n,r){let i=new ie;if(this.printCommonFieldModifiers(i,e,r),Rr(e))i.b+="final ",i.b+=re.string(e.name);else{i.b+="var ",i.b+=re.string(e.name);let n=this.printAccessors(t);i.b+=re.string(n)}i.b+=":";let s=this.printType(e.type);return i.b+=re.string(s),i.b+=";\n",i.b}printClassFieldImplementation(e,t,n,r,i,s){switch(null==s&&(s="\t"),e.kind.kind){case"FMethod":return this.printMethodImplementation(e,t,n,r,i,s);case"FVar":return this.printVarImplementation(e,e.kind.args,t,r)}}printAccessors(e){let t=this.printAccessor(e.read,!0),n=this.printAccessor(e.write,!1);return null==t||null==n||"default"==t&&"default"==n?"":"("+t+", "+n+")"}printClassFieldDefinition(e,t,n){let r=e.field;"TMono"==t.kind&&(t=r.type);let i=this.printType(t),s=r.name,a=r.kind,l=r.isPublic?"public ":"private ",o=0!=r.scope||Er(e.origin)?"":"static ";switch(a.kind){case"FMethod":let c;switch(a.args){case"MethDynamic":c="dynamic ";break;case"MethInline":c="inline ";break;case"MethMacro":c="macro ";break;case"MethNormal":c=""}return""+l+o+(Rr(r)?"final ":"")+(r.isAbstract?"abstract ":"")+c+this.printEmptyFunctionDefinition(s,Lr(t),r.params);case"FVar":let u="AccInline"==a.args.write.kind?"inline ":"",h="AccCtor"==a.args.write.kind||Rr(r),d=h?"":this.printAccessors(a.args);!function(e){if(null==e)return!1;switch(e.kind){case 0:case 1:case 2:case 3:let t=e.args;return null!=t&&("typedef"==t.kind&&"TAnonymous"==Dr(t.args.type).type.kind);case 4:return!0;default:return!1}}(e.origin)?n&&(l="",o=""):(l="",Ir(r.meta,":optional")&&(s="?"+s));let p=""+l+o+(h?"final":"var")+" "+u+s+d+":"+i;return null!=r.expr&&(p+=" = "+r.expr.string.replace(Sr.castRegex.r,"")),p}}printAccessor(e,t){switch(e.kind){case"AccCall":return t?"get":"set";case"AccCtor":case"AccInline":case"AccRequire":case"AccResolve":return null;case"AccNever":return"never";case"AccNo":return"null";case"AccNormal":return"default"}}printLocalDefinition(e,t){let n=e.origin;if(5==n)return(e.isInline?"inline ":"")+this.printEmptyFunctionDefinition(e.name,Lr(t),null==e.extra?null:e.extra.params);{let r=e.isFinal?"final ":"var ",i=e.name;return 1==n&&(r="",Dr(t).nullable&&(i="?"+i)),""+r+i+":"+this.printType(t)}}printEmptyTypeDefinition(e){let t,n=[];switch(e.isPrivate&&n.push("private"),function(e){return!!Ir(e.meta,":final")||e.isFinal}(e)&&n.push("final"),e.isExtern&&n.push("extern"),e.isAbstract&&n.push("abstract"),e.kind){case 0:t="class";break;case 1:t="interface";break;case 2:t="enum";break;case 3:t="abstract";break;case 4:t="enum abstract";break;case 5:case 6:t="typedef"}n.push(t);let r=e.path.typeName;if(e.params.length>0){let t=e.params,n=new Array(t.length),i=0,s=t.length;for(;i<s;){let e=i++;n[e]=t[e].name}r+="<"+n.join(", ")+">"}return n.push(r),n.join(" ")}printClassFieldOrigin(e,t,n){if(null==n&&(n=""),null==e)return null;if("EnumAbstractField"==t||6==e.kind)return null;if(null==e.args&&5!=e.kind)return null;let r,i=function(t){return(Er(e)?"module":function(e){switch(e.kind){case"abstract":return Ir(e.meta,":enum")?"enum abstract":"abstract";case"class":return e.args.isInterface?"interface":"class";case"enum":return"enum";case"typedef":return"typedef"}}(t))+" "+(n+(Er(e)?t.moduleName:t.name)+n)};switch(e.kind){case 0:r=i(e.args);break;case 1:r=i(e.args)+" (statically imported)";break;case 2:r="parent "+i(e.args);break;case 3:r=i(e.args)+" (static extension method)";break;case 4:r="anonymous structure";break;case 5:r="compiler (built-in)";break;case 6:r=""}return"from "+r}printEnumFieldOrigin(e,t){if(null==t&&(t=""),null==e||null==e.args)return null;let n;switch(e.kind){case 0:n=""+t+e.args.name+t;break;case 1:n=""+t+e.args.name+t+" (statically imported)"}return"from enum "+n}printLocalOrigin(e){switch(e){case 0:return"local variable";case 1:return"argument";case 2:return"for loop variable";case 3:return"pattern variable";case 4:return"catch variable";case 5:return"local function"}}printEnumField(e,t,n,r){switch(t.kind){case"TEnum":return e.name;case"TFun":let i=t.args,s=e.name+"(",a=0,l=i.args.length;for(;a<l;){let e=a++,t=i.args[e];s+=n?"${"+(e+1)+":"+t.name+"}":t.name,r&&(s+=":"+this.printTypeRec(t.t)),e<i.args.length-1&&(s+=", ")}return s+")";default:return""}}printAnonymousFunctionDefinition(e){let t=e.args,n=new Array(t.length),r=0,i=t.length;for(;r<i;){let e=r++,i=t[e];n[e]={name:""==i.name?null:i.name,opt:i.opt,type:new Sr(null,Tr.Never).printTypeRec(i.t)}}let s=hr.guessNames(n),a=[],l=1==n.length;if(l&&this.functionFormatting.useArrowSyntax)a=[s[0]];else{let t=0,r=n.length;for(;t<r;){let r=t++;a.push(this.printFunctionArgument({t:e.args[r].t,opt:n[r].opt,name:s[r]}))}}let o=a.join(", ");return this.functionFormatting.useArrowSyntax?(l||(o="("+o+")"),o+" -> "):"function("+o+")"+this.printReturn(e)+" "}printObjectLiteral(e,t,n,r){let i=[],s=0,a=e.fields.length;for(;s<a;){let a=s++,l=e.fields[a],o=l.name,c=o+": ";t||(c="\t"+c),c+=r?"${"+(a+1)+":"+o+"}":o,n&&Ir(l.meta,":optional")||i.push(c)}return 0==i.length?"{}":t?"{"+i.join(", ")+"}":"{\n"+i.join(",\n")+"\n}"}printSwitchSubject(e,t){return"switch "+(t?"("+e+")":e)}printSwitchOnEnum(e,t,n,r,i){let s=t.constructors,a=new Array(s.length),l=0,o=s.length;for(;l<o;){let e=l++,t=s[e];a[e]=this.printEnumField(t,t.type,!1,!1)}return this.printSwitch(e,a,n,r,i)}printSwitchOnEnumAbstract(e,t,n,r,i){let s;if(null==t.impl)s=[];else{let e=t.impl.statics,n=[],r=0;for(;r<e.length;){let t=e[r];++r,Or(t)&&n.push(t)}let i=new Array(n.length),a=0,l=n.length;for(;a<l;){let e=a++;i[e]=n[e].name}s=i}return this.printSwitch(e,s,n,r,i)}printSwitch(e,t,n,r,i){n&&t.unshift("null");let s=0,a=t.length;for(;s<a;){let e=s++,n=t[e];n="\tcase "+n+":",r&&(n+="$"+(e+1)),t[e]=n}return this.printSwitchSubject(e,i)+" {\n"+t.join("\n")+"\n}"}printMetadataTarget(e){switch(e){case"TAbstract":return"abstracts";case"TAbstractField":return"abstract fields";case"TAnyField":return"any field";case"TClass":return"classes";case"TClassField":return"class fields";case"TEnum":return"enums";case"TExpr":return"expressions";case"TTypeParameter":return"type parameters";case"TTypedef":return"typedefs"}}printPlatform(e){switch(e){case"cpp":return"C++";case"cross":return"cross";case"eval":return""+e=="cs"?"C#":"Eval";case"flash":return"Flash";case"hl":return""+e=="cs"?"C#":"HashLink";case"java":return""+e=="cs"?"C#":"Java";case"js":return"JavaScript";case"lua":return"Lua";case"neko":return"Neko";case"php":return"PHP";case"python":return""+e=="cs"?"C#":"Python"}}printMetadataDetails(e){let t=e.doc+"\n";if(null!=e.parameters){let n=e.parameters;t+=0==n.length?"":"- **Parameters:** "+n.join(", ")+"\n"}if(null!=e.platforms){let n=e.platforms,r=nl(this,this.printPlatform),i=new Array(n.length),s=0,a=n.length;for(;s<a;){let e=s++;i[e]=r(n[e])}t+=0==i.length?"":"- **Targets:** "+i.join(", ")+"\n"}if(null!=e.targets){let n=e.targets,r=nl(this,this.printMetadataTarget),i=new Array(n.length),s=0,a=n.length;for(;s<a;){let e=s++;i[e]=r(n[e])}t+=0==i.length?"":"- **Can be used on:** "+i.join(", ")+"\n"}if(null!=e.links&&e.links.length>0){let n=e.links,r=new Array(n.length),i=0,s=n.length;for(;i<s;){let e=i++;r[e]="- "+n[e]}t+=r.join("\n")}return e.internal&&(t+="\n_compiler-internal_"),t}printArrayAccess(e){let t=this.printFunctionArgument(e.args[0]);return e.args.length>1?"["+t+"] = "+this.printFunctionArgument(e.args[1]):"["+t+"] -> "+this.printType(e.ret)}}Sr.__name__="haxeLanguageServer.protocol.DisplayPrinter",Object.assign(Sr.prototype,{__class__:Sr});function Cr(e){let t=Br(e);return null==t?null:vr(t.path)}function vr(e){return class{static _new(e){return e}}._new(new Sr(null,Tr.Always).printPath(e))}function Pr(e){switch(e.kind){case"ClassField":case"EnumAbstractField":case"EnumField":return e.args.field.doc;case"Metadata":return(new Sr).printMetadataDetails(e.args);case"Type":return e.args.doc;default:return null}}function Lr(e){let t=Ar(e);if(null==t)throw new $s("Null pointer in .sure() call");return t}function Ar(e){let t=Dr(e).type;return"TFun"==t.kind?t.args:null}function Fr(e){let t=null;return t=function(e){for(;;)switch(e.kind){case"TAbstract":case"TEnum":case"TInst":case"TType":let n=[],r=e.args;if(null!=r.params){let e=r.params,i=t,s=new Array(e.length),a=0,l=e.length;for(;a<l;){let t=a++;s[t]=i(e[t])}let o=[],c=tl(s);for(;c.hasNext();){let e=tl(c.next());for(;e.hasNext();)o.push(e.next())}n=te.array(o)}return 1==r.path.importStatus&&n.push(r.path),n;case"TAnonymous":let i=e.args.fields,s=new Array(i.length),a=0,l=i.length;for(;a<l;){let e=a++;s[e]=t(i[e].type)}let o=[],c=tl(s);for(;c.hasNext();){let e=tl(c.next());for(;e.hasNext();)o.push(e.next())}return te.array(o);case"TDynamic":if(null!=e.args){e=e.args;continue}return[];case"TFun":let u=e.args,h=u.args,d=new Array(h.length),p=0,f=h.length;for(;p<f;){let e=p++;d[e]=t(h[e].t)}let m=[],_=tl(d);for(;_.hasNext();){let e=tl(_.next());for(;e.hasNext();)m.push(e.next())}return te.array(m).concat(t(u.ret));case"TMono":return[]}},t(e)}function Nr(e){if("TAbstract"==e.kind&&"haxe.extern.EitherType"==Cr(e)){let t=e.args.params,n=Nr,r=new Array(t.length),i=0,s=t.length;for(;i<s;){let e=i++;r[e]=n(t[e])}let a=[],l=tl(r);for(;l.hasNext();){let e=tl(l.next());for(;e.hasNext();)a.push(e.next())}return te.array(a)}return[e]}function Ir(e,t){return null!=e&&te.exists(e,(function(e){return e.name==t}))}function Or(e){if(!Ir(e.meta,":enum"))return!1;switch(e.kind.kind){case"FMethod":return!1;case"FVar":return"AccNever"==e.kind.args.write.kind}}function Er(e){if(null==e)return!1;switch(e.kind){case 0:case 1:case 2:case 3:let t=e.args;return null!=t&&("class"==t.kind&&"KModuleFields"==t.args.kind.kind);default:return!1}}function Dr(e,t){for(null==t&&(t=!1);;){if("TAbstract"==e.kind){let n=e.args;if("StdTypes.Null"==Cr(e)&&null!=n.params&&null!=n.params[0]){e=n.params[0],t=!0;continue}}return{type:e,nullable:t}}}function Br(e){let t=e.kind;if(null==t)return null;switch(t){case"TAbstract":case"TEnum":case"TInst":case"TType":return e.args;default:return null}}function Rr(e){return!!Ir(e.meta,":final")||e.isFinal}var jr=require("buffer").Buffer;class Mr{constructor(e,t,n,r,i,s){this.label=e,this.args=t,this.token=n,this.cancellable=r,this.stdin=i,this.handler=s,this.creationTime=(new Date).getTime()}prepareBody(){null!=this.stdin&&(this.args.push("-D"),this.args.push("display-stdin"));let e=jr.alloc(4),t=[e],n=0,r=0,i=this.args;for(;r<i.length;){let e=jr.from(i[r++]+"\n");t.push(e),n+=e.length}if(null!=this.stdin){t.push(Mr.stdinSepBuf);let e=jr.from(this.stdin);t.push(e),n+=e.length+Mr.stdinSepBuf.length}return e.writeInt32LE(n,0),jr.concat(t,n+4)}onData(e){if(null!=this.token&&this.token.canceled){let e=this.handler;switch(e._hx_index){case 0:case 1:e.callback(Hr.DCancelled)}return}let t=this.handler;switch(t._hx_index){case 0:t.callback(Hr.DResult(e));break;case 1:this.processResult(e,t.callback,t.errback)}}processResult(e,t,n){let r="",i=!1,s=0,a=e.split("\n");for(;s<a.length;){let e=a[s];switch(++s,e.charCodeAt(0)){case 1:He.trace("Haxe print:\n"+se.replace(e.substring(1),"","\n"),{fileName:"src/haxeLanguageServer/server/DisplayRequest.hx",lineNumber:83,className:"haxeLanguageServer.server.DisplayRequest",methodName:"processResult"});break;case 2:i=!0;break;default:r+=null==e?"null":""+e,r+=String.fromCodePoint(10)}}let l=se.trim(r);if(i)n(l);else try{t(Hr.DResult(l))}catch(s){n(Ui.errorToString(Me.caught(s),"Exception while handling Haxe completion response: "))}}}Mr.__name__="haxeLanguageServer.server.DisplayRequest",Object.assign(Mr.prototype,{__class__:Mr});var Hr=r["haxeLanguageServer.server.DisplayResult"]={__ename__:!0,__constructs__:null,DCancelled:{_hx_name:"DCancelled",_hx_index:0,__enum__:"haxeLanguageServer.server.DisplayResult",toString:n},DResult:(t=function(e){return{_hx_index:1,msg:e,__enum__:"haxeLanguageServer.server.DisplayResult",toString:n,__params__:function(){return[this.msg]}}},t._hx_name="DResult",t)};Hr.__constructs__=[Hr.DCancelled,Hr.DResult];class Wr{constructor(e,t,n,r){Wr._hx_skip_constructor||this._hx_constructor(e,t,n,r)}_hx_constructor(e,t,n,r){this.nextMessageLength=-1,this.buffer=new Kr,this.process=e,this.logger=t,this.onMessage=n;let i=this;e.on("exit",(function(e,t){r(i)}))}send(e){}kill(){this.process.removeAllListeners(),this.process.kill()}getLastErrorOutput(){return""}onStdout(e){this.logger(e.toString().replace(Wr.reTrailingNewline.r,""))}onData(e){for(this.buffer.append(e);;){if(-1==this.nextMessageLength){let e=this.buffer.tryReadLength();if(-1==e)return;this.nextMessageLength=e}let e=this.buffer.tryReadContent(this.nextMessageLength);if(null==e)return;this.nextMessageLength=-1,this.onMessage(e)}}}Wr.__name__="haxeLanguageServer.server.HaxeConnection",Object.assign(Wr.prototype,{__class__:Wr});class Ur extends Wr{constructor(e,t,n,r){super(e,t,n,r),e.stdout.on("data",nl(this,this.onStdout)),e.stderr.on("data",nl(this,this.onData))}send(e){this.process.stdin.write(e)}getLastErrorOutput(){return this.buffer.getContent()}static start(e,t,n,r,i,s,a){He.trace("Using --wait stdio",{fileName:"src/haxeLanguageServer/server/HaxeConnection.hx",lineNumber:78,className:"haxeLanguageServer.server.StdioConnection",methodName:"start"});let l=Oi.spawn(e,t.concat(["--wait","stdio"]),n);a(new Ur(l,r,i,s))}}Ur.__name__="haxeLanguageServer.server.StdioConnection",Ur.__super__=Wr,Object.assign(Ur.prototype,{__class__:Ur});class Jr extends Wr{constructor(e,t,n,r){Wr._hx_skip_constructor=!0,super(),Wr._hx_skip_constructor=!1,this._hx_constructor(e,t,n,r)}_hx_constructor(e,t,n,r){this.lastErrorOutput="",super._hx_constructor(e,t,n,r),e.stdout.on("data",nl(this,this.onStdout)),e.stderr.on("data",nl(this,this.onStderr))}setup(e){this.socket=e,e.on("data",nl(this,this.onData))}send(e){let t=this.socket;null!=t&&t.write(e)}kill(){null!=this.socket&&this.socket.on("error",(function(e){})),super.kill()}onStderr(e){this.lastErrorOutput=e.toString(),this.logger(this.lastErrorOutput.replace(Wr.reTrailingNewline.r,""))}getLastErrorOutput(){return this.lastErrorOutput}static start(e,t,n,r,i,s,a){He.trace("Using --server-connect",{fileName:"src/haxeLanguageServer/server/HaxeConnection.hx",lineNumber:122,className:"haxeLanguageServer.server.SocketConnection",methodName:"start"});let l=Di.createServer();l.listen(0,(function(){let o=l.address().port,c=Oi.spawn(e,t.concat(["--server-connect","127.0.0.1:"+o]),n),u=new Jr(c,r,i,s);l.on("connection",(function(e){He.trace("Haxe connected!",{fileName:"src/haxeLanguageServer/server/HaxeConnection.hx",lineNumber:129,className:"haxeLanguageServer.server.SocketConnection",methodName:"start"}),l.close(),u.setup(e),a(u)}))}))}}Jr.__name__="haxeLanguageServer.server.SocketConnection",Jr.__super__=Wr,Object.assign(Jr.prototype,{__class__:Jr});class Vr{constructor(e){this.protocolVersion={major:0,minor:0,patch:0,pre:null,build:null},this.haxeVersion={major:0,minor:0,patch:0,pre:null,build:null},this.supportedMethods=[],this.crashes=0,this.starting=!1,this.context=e}checkHaxeVersion(e,t){let n=Oi.spawnSync(e,["-version"],t);if(null!=n.error){if(n.error.message.includes("ENOENT")){if("haxe"==e){let e=this.context.languageServerProtocol,t={type:1,message:"Could not find Haxe in PATH. Is it installed?"},n={jsonrpc:"2.0",method:"window/showMessage"};return null!=t&&(n.params=t),e.writeMessage(n,null),null!=e.didSendNotification&&e.didSendNotification(n),!1}{let t=this.context.languageServerProtocol,n={type:1,message:"Path to Haxe executable is not valid: '"+e+"'. Please check your settings."},r={jsonrpc:"2.0",method:"window/showMessage"};return null!=n&&(r.params=n),t.writeMessage(r,null),null!=t.didSendNotification&&t.didSendNotification(r),!1}}let t="Error starting Haxe server: "+kr.clean(n.error.message),r=this.context.languageServerProtocol,i={type:1,message:t},s={jsonrpc:"2.0",method:"window/showMessage"};return null!=i&&(s.params=i),r.writeMessage(s,null),null!=r.didSendNotification&&r.didSendNotification(s),!1}let r=kr.clean(se.trim(n.stderr.toString()));if(""==r&&(r=kr.clean(se.trim(n.stdout.toString()))),0!=n.status){let e=this.context.languageServerProtocol,t={type:1,message:""==r?"`haxe -version` exited with error code "+n.status:'Haxe version check failed: "'+r+'"'},i={jsonrpc:"2.0",method:"window/showMessage"};return null!=t&&(i.params=t),e.writeMessage(i,null),null!=e.didSendNotification&&e.didSendNotification(i),!1}let i=gr.parse(r);if(null==i){let e="Error parsing Haxe version "+JSON.stringify(r),t=this.context.languageServerProtocol,n={type:1,message:e},i={jsonrpc:"2.0",method:"window/showMessage"};return null!=n&&(i.params=n),t.writeMessage(i,null),null!=t.didSendNotification&&t.didSendNotification(i),!1}if(this.haxeVersion=i,!gr.isEqualOrGreaterThan(i,{major:3,minor:4,patch:0,pre:null,build:null})){let e=this.context.languageServerProtocol,t={type:1,message:"Unsupported Haxe version! Minimum required: 3.4.0. Found: "+(null==i?"null":gr.toString(i))+"."},n={jsonrpc:"2.0",method:"window/showMessage"};return null!=t&&(n.params=t),e.writeMessage(n,null),null!=e.didSendNotification&&e.didSendNotification(n),!1}return!0}mergeEnvs(e,t){let n=ne.fields(e),r=0;for(;r<n.length;){let i=n[r++],s=e[i],a=i;if("Windows"==ae.systemName()){let e=0,n=ne.fields(t);for(;e<n.length;){let t=n[e];if(++e,i.toLowerCase()==t.toLowerCase()){a=t;break}}}t[a]=s}}start(e){if(this.hasNonCancellableRequests()||this.starting)return void(this.startRequest=e);this.supportedMethods=[],this.startRequest=null,this.stop();let t=this.context.config.displayServer,n={};this.mergeEnvs(process.env,n),this.mergeEnvs(t.env,n);let r=yt(t.path),i={env:n,cwd:this.context.workspacePath,shell:!0};if(!this.checkHaxeVersion(r,i))return;this.starting=!0;let s=this,a=t.useSocket;this.haxeVersion.major<4&&(a=!1),4==this.haxeVersion.major&&0==this.haxeVersion.minor&&null!=this.haxeVersion.pre&&(a=!1),zs.exists(ot.join([this.context.workspacePath,".haxerc"]))&&(a=!1),He.trace("Haxe Path: "+t.path,{fileName:"src/haxeLanguageServer/server/HaxeServer.hx",lineNumber:196,className:"haxeLanguageServer.server.HaxeServer",methodName:"start"}),i.env.HAXE_COMPLETION_SERVER="1",(a?Jr.start:Ur.start)(r,t.arguments,i,nl(this,this.log),nl(this,this.onMessage),nl(this,this.onExit),(function(t){s.haxeConnection=t;let n=function(){s.stopProgress(),s.buildCompletionCache(),null!=e&&e()};s.context.callHaxeMethod("initialize",{supportsResolve:!0,exclude:s.context.config.user.exclude,maxCompletionItems:s.context.config.user.maxCompletionItems},null,(function(e){if(4==e.haxeVersion.major&&0==e.haxeVersion.minor&&null!=e.haxeVersion.pre){let e=s.context.languageServerProtocol,t={haxe4Preview:!0,version:gr.toString(s.haxeVersion)},n={jsonrpc:"2.0",method:"haxe/didDetectOldHaxeVersion"};null!=t&&(n.params=t),e.writeMessage(n,null),null!=e.didSendNotification&&e.didSendNotification(n)}return s.protocolVersion=e.protocolVersion,s.supportedMethods=e.methods,s.configure(),n(),null}),(function(e){if(e.startsWith("Error: Invalid format")){He.trace("Haxe version does not support JSON-RPC, using legacy --display API.",{fileName:"src/haxeLanguageServer/server/HaxeServer.hx",lineNumber:159,className:"haxeLanguageServer.server.HaxeServer",methodName:"start"});let e=s.context.languageServerProtocol,t={haxe4Preview:4==s.haxeVersion.major,version:gr.toString(s.haxeVersion)},n={jsonrpc:"2.0",method:"haxe/didDetectOldHaxeVersion"};null!=t&&(n.params=t),e.writeMessage(n,null),null!=e.didSendNotification&&e.didSendNotification(n)}else He.trace(e,{fileName:"src/haxeLanguageServer/server/HaxeServer.hx",lineNumber:165,className:"haxeLanguageServer.server.HaxeServer",methodName:"start"});n()}));let r=s.context.config.user.displayPort,i=s.context.config.user.displayHost,a=null!=i?i:"127.0.0.1";null==s.socketListener&&null!=r?"auto"==r?s.getAvailablePort(a,6e3).then(nl(s,s.startSocketServer)):s.startSocketServer({host:a,port:r}):(s.starting=!1,s.checkRestart())}))}log(e){He.trace(e,{fileName:"src/haxeLanguageServer/server/HaxeServer.hx",lineNumber:202,className:"haxeLanguageServer.server.HaxeServer",methodName:"log"}),this.context.serverRecording.onServerLog(e)}configure(){this.context.callHaxeMethod("server/configure",{noModuleChecks:!0,print:this.context.config.displayServer.print,legacyCompletion:this.context.config.user.useLegacyCompletion},null,(function(e){return null}),(function(e){He.trace("Error during server/configure "+e,{fileName:"src/haxeLanguageServer/server/HaxeServer.hx",lineNumber:212,className:"haxeLanguageServer.server.HaxeServer",methodName:"configure"})}))}buildCompletionCache(){if(!this.context.config.user.buildCompletionCache||null==this.context.config.displayArguments)return;this.startProgress("Building Cache");let e=this,t=Gr.Processed((function(t){e.stopProgress(),e.supports("server/readClassPaths")?e.readClassPaths():He.trace("Done.",{fileName:"src/haxeLanguageServer/server/HaxeServer.hx",lineNumber:230,className:"haxeLanguageServer.server.HaxeServer",methodName:"buildCompletionCache"})}),(function(t){if(e.context.config.user.enableCompletionCacheWarning){let t=e.context.languageServerProtocol,n={jsonrpc:"2.0",method:"haxe/cacheBuildFailed"};t.writeMessage(n,null),null!=t.didSendNotification&&t.didSendNotification(n)}e.stopProgress(),He.trace("Failed - try fixing the error(s) and restarting the language server:\n\n"+kr.clean(t),{fileName:"src/haxeLanguageServer/server/HaxeServer.hx",lineNumber:237,className:"haxeLanguageServer.server.HaxeServer",methodName:"buildCompletionCache"})}));this.process("cache build",["--no-output","--each","--no-output","-D","message.no-color"].concat(this.context.config.displayArguments),null,!0,null,t)}readClassPaths(){this.startProgress("Parsing Classpaths");let e=this;this.context.callHaxeMethod("server/readClassPaths",null,null,(function(t){return e.stopProgress(),He.trace("Done.",{fileName:"src/haxeLanguageServer/server/HaxeServer.hx",lineNumber:245,className:"haxeLanguageServer.server.HaxeServer",methodName:"readClassPaths"}),null==t.files?null:t.files+" files"}),(function(t){e.stopProgress(),He.trace("Failed - "+kr.clean(t),{fileName:"src/haxeLanguageServer/server/HaxeServer.hx",lineNumber:252,className:"haxeLanguageServer.server.HaxeServer",methodName:"readClassPaths"})}))}hasNonCancellableRequests(){if(null!=this.currentRequest&&!this.currentRequest.cancellable)return!0;let e=this.requestsHead;for(;null!=e;){if(!e.cancellable)return!0;e=e.next}return!1}getAvailablePort(e,t){let n=null;return n=function(t,r){let i=Di.createServer();i.listen(t,e,(function(){let n=r,s={host:e,port:t};i.once("close",(function(){n(s)})),i.close()})),i.on("error",(function(e){n(t+1,r)}))},new Promise((function(e,r){n(t,e)}))}startSocketServer(e){null!=this.socketListener&&this.socketListener.close();let t=this;this.socketListener=Di.createServer((function(e){He.trace("Client connected",{fileName:"src/haxeLanguageServer/server/HaxeServer.hx",lineNumber:289,className:"haxeLanguageServer.server.HaxeServer",methodName:"startSocketServer"}),e.on("data",(function(n){let r=n.toString().split("\n");r.pop();t.context.resetInvalidatedFiles(),t.process("compilation",r,null,!1,null,Gr.Raw((function(t){switch(t._hx_index){case 0:break;case 1:e.write(t.msg)}e.end(),e.destroy(),He.trace("Client disconnected",{fileName:"src/haxeLanguageServer/server/HaxeServer.hx",lineNumber:302,className:"haxeLanguageServer.server.HaxeServer",methodName:"startSocketServer"})})))})),e.on("error",(function(e){He.trace("Socket error: "+re.string(e),{fileName:"src/haxeLanguageServer/server/HaxeServer.hx",lineNumber:308,className:"haxeLanguageServer.server.HaxeServer",methodName:"startSocketServer"})}))})),this.socketListener.listen(e.port,e.host),He.trace("Listening on port "+e.host+":"+e.port,{fileName:"src/haxeLanguageServer/server/HaxeServer.hx",lineNumber:312,className:"haxeLanguageServer.server.HaxeServer",methodName:"startSocketServer"});let n=this.context.languageServerProtocol,r={jsonrpc:"2.0",method:"haxe/didChangeDisplayPort"};null!=e&&(r.params=e),n.writeMessage(r,null),null!=n.didSendNotification&&n.didSendNotification(r),this.starting=!1,this.checkRestart()}stop(){null!=this.haxeConnection&&(this.haxeConnection.kill(),this.haxeConnection=null),this.stopProgress();let e=this.requestsHead;for(;null!=e;){let t=e.handler;switch(t._hx_index){case 0:case 1:t.callback(Hr.DCancelled)}e=e.next}this.requestsHead=this.requestsTail=this.currentRequest=null,this.updateRequestQueue()}startProgress(e){this.stopProgress(),this.stopProgressCallback=this.context.startProgress(e)}stopProgress(){null!=this.stopProgressCallback&&this.stopProgressCallback(),this.stopProgressCallback=null}restart(e,t){He.trace("Haxe server restart requested: "+e,{fileName:"src/haxeLanguageServer/server/HaxeServer.hx",lineNumber:351,className:"haxeLanguageServer.server.HaxeServer",methodName:"restart"}),this.start((function(){He.trace("Restarted Haxe server: "+e,{fileName:"src/haxeLanguageServer/server/HaxeServer.hx",lineNumber:353,className:"haxeLanguageServer.server.HaxeServer",methodName:"restart"}),null!=t&&t()}))}onExit(e){if(this.stopProgress(),this.crashes++,this.crashes<3)return void this.restart("Haxe process was killed");let t=e.getLastErrorOutput(),n=new s("unknown option [`'](.*?)'.","");if(n.match(t)){let e=n.matched(1),t=this.context.languageServerProtocol,r={type:1,message:"Invalid compiler argument '"+e+'\' detected. Please verify "haxe.configurations" and "haxe.displayServer.arguments".'},i={jsonrpc:"2.0",method:"window/showMessage"};return null!=r&&(i.params=r),t.writeMessage(i,null),void(null!=t.didSendNotification&&t.didSendNotification(i))}let r=this.context.languageServerProtocol,i={jsonrpc:"2.0",method:"haxe/haxeKeepsCrashing"};r.writeMessage(i,null),null!=r.didSendNotification&&r.didSendNotification(i),He.trace("\nError message from the compiler:\n",{fileName:"src/haxeLanguageServer/server/HaxeServer.hx",lineNumber:380,className:"haxeLanguageServer.server.HaxeServer",methodName:"onExit"}),He.trace(t,{fileName:"src/haxeLanguageServer/server/HaxeServer.hx",lineNumber:381,className:"haxeLanguageServer.server.HaxeServer",methodName:"onExit"})}onMessage(e){if(null!=this.currentRequest){let t=this.currentRequest;this.context.serverRecording.onServerMessage(t,e),this.currentRequest=null,t.onData(e),this.updateRequestQueue(),this.checkQueue()}}process(e,t,n,r,i,s){let a=new Mr(e,t,n,r,i,s),l=this;null!=n&&(n.callback=function(){if(a==l.currentRequest)return;l.context.serverRecording.onDisplayRequestCancelled(a),a==l.requestsHead&&(l.requestsHead=a.next),a==l.requestsTail&&(l.requestsTail=a.prev),null!=a.prev&&(a.prev.next=a.next),null!=a.next&&(a.next.prev=a.prev);let e=a.handler;switch(e._hx_index){case 0:case 1:e.callback(Hr.DCancelled)}l.updateRequestQueue()}),null==this.requestsHead||null==this.requestsTail?this.requestsHead=this.requestsTail=a:(this.requestsTail.next=a,a.prev=this.requestsTail,this.requestsTail=a),null!=this.currentRequest&&this.context.serverRecording.onDisplayRequestQueued(a),this.checkQueue(),this.updateRequestQueue()}checkRestart(){null==this.startRequest||this.start(this.startRequest)}checkQueue(){this.checkRestart(),null==this.currentRequest&&null!=this.requestsHead&&null!=this.haxeConnection&&(this.currentRequest=this.requestsHead,this.requestsHead=this.currentRequest.next,this.updateRequestQueue(),this.context.serverRecording.onDisplayRequest(this.currentRequest),this.haxeConnection.send(this.currentRequest.prepareBody()))}supports(e){return this.supportedMethods.includes(e)}updateRequestQueue(){if(!this.context.config.sendMethodResults)return;let e=[],t=this.currentRequest;for(;null!=t;)e.push(t.label),t=t.next;let n=this.context.languageServerProtocol,r={queue:e},i={jsonrpc:"2.0",method:"haxe/didChangeRequestQueue"};null!=r&&(i.params=r),n.writeMessage(i,null),null!=n.didSendNotification&&n.didSendNotification(i)}}Vr.__name__="haxeLanguageServer.server.HaxeServer",Object.assign(Vr.prototype,{__class__:Vr});class Kr{constructor(){this.index=0,this.buffer=jr.alloc(8192)}append(e){if(this.buffer.length-this.index>=e.length)e.copy(this.buffer,this.index,0,e.length);else{let t=8192*(Math.ceil((this.index+e.length)/8192)+1);0==this.index?(this.buffer=jr.alloc(t),e.copy(this.buffer,0,0,e.length)):this.buffer=jr.concat([this.buffer.slice(0,this.index),e],t)}this.index+=e.length}tryReadLength(){if(this.index<4)return-1;let e=this.buffer.readInt32LE(0);return this.buffer=this.buffer.slice(4),this.index-=4,e}tryReadContent(e){if(this.index<e)return null;let t=this.buffer.toString("utf-8",0,e);return this.buffer.copy(this.buffer,0,e),this.index-=e,t}getContent(){return this.buffer.toString("utf-8",0,this.index)}}Kr.__name__="haxeLanguageServer.server.MessageBuffer",Object.assign(Kr.prototype,{__class__:Kr});var Gr=r["haxeLanguageServer.server.ResultHandler"]={__ename__:!0,__constructs__:null,Raw:(t=function(e){return{_hx_index:0,callback:e,__enum__:"haxeLanguageServer.server.ResultHandler",toString:n,__params__:function(){return[this.callback]}}},t._hx_name="Raw",t),Processed:(t=function(e,t){return{_hx_index:1,callback:e,errback:t,__enum__:"haxeLanguageServer.server.ResultHandler",toString:n,__params__:function(){return[this.callback,this.errback]}}},t._hx_name="Processed",t)};Gr.__constructs__=[Gr.Raw,Gr.Processed];class qr{constructor(){this.config=xt.DefaultUserSettings.serverRecording,this.recordingPath="",this.fsEventIndex=1,this.startTime=-1,this.ready=!1}get_enabled(){return!!this.ready&&this.config.enabled}onInitialize(e){this.restart(e)}restartServer(e,t){this.restart(t,t.initialized?e:null)}export(e,t,n,r){if(!this.get_enabled()){let e=r,t=null,n={code:-32603,message:"Was not recording haxe server"};return null!=t&&(n.data=t),void e(n)}let s;if(this.appendLines(this.makeEntry("#","Export requested ...")),null==(null!=e?e.dest:null))s=this.config.path;else{if(null==e)throw new $s("Null pointer in .sure() call");s=e.dest}if(!zs.isDirectory(s)){this.appendLines(this.makeEntry("#","Failed to export to "+s));let e=r,t=null,n={code:-32602,message:"Server recording export path should be a directory"};return null!=t&&(n.data=t),void e(n)}let a=i.format(new Date,"%Y%m%d-%H%M%S"),l=this;try{let e=ot.join([s,a]);this.appendLines(this.makeEntry("#","Exporting to "+e+" ...")),zs.createDirectory(e);let t=Zr(ot.join([this.get_recordingPath(),"end.patch"]),ot.join([e,"endUntracked"]),this.config);1==t._hx_index&&t.untrackedCopy.then((function(e){l.appendLines(l.makeEntry("#","Untracked files copied successfully"))})).catch((function(e){l.appendLines(l.makeEntry("#","Warning: error while saving untracked file: "+re.string(e.message)))})),cr.cp(this.get_recordingPath(),e).then((function(t){n("Exported server recording to "+e)})).catch((function(e){let t=r,n={code:-32603,message:re.string(e)};null!=e&&(n.data=e),t(n)}))}catch(e){let t=Me.caught(e),n=r,i=null,s={code:-32603,message:t.get_message()};null!=i&&(s.data=i),n(s)}}onDisplayRequestQueued(e){null!=this.config&&this.config.enabled&&this.appendLines(this.makeEntry("-","serverRequestQueued",this.extractRequestId(e.args),e.label))}onDisplayRequestCancelled(e){null!=this.config&&this.config.enabled&&this.appendLines(this.makeEntry("-","serverRequestCancelled",this.extractRequestId(e.args),e.label),JSON.stringify(e.args))}onDisplayRequest(e){if(!this.get_enabled())return;let t=(new Date).getTime()-e.creationTime,n=this.extractRequestId(e.args);t>5&&this.appendLines(this.makeEntry("#","Request has been queued for "+t+" ms")),this.appendLines(this.makeEntry(">","serverRequest",n,e.label),JSON.stringify(e.args))}onServerLog(e){this.get_enabled()&&this.appendLines(this.makeEntry("<","serverLog"),"<<EOF",e,"EOF")}onServerMessage(e,t){if(!this.get_enabled())return;this.appendLines(this.makeEntry("#","Request total time: "+((new Date).getTime()-e.creationTime)+" ms"));let n=this,r=e,i=this,s=e;e.processResult(t,(function(e){n.onServerResponse(r,e)}),(function(e){i.onServerError(s,e)}))}onServerResponse(e,t){if(this.get_enabled())switch(t._hx_index){case 0:break;case 1:let n=t.msg;switch(e.label){case"cache build":case"compilation":this.appendLines(this.makeEntry("<","compilationResult"),"<<EOF",kr.clean(n),"EOF");break;default:this.appendLines(this.makeEntry("<","serverResponse",this.extractRequestId(e.args),e.label),n)}}}onServerError(e,t){if(this.get_enabled())switch(e.label){case"cache build":case"compilation":this.appendLines(this.makeEntry("<","compilationError"),"<<EOF",t,"EOF");break;default:this.appendLines(this.makeEntry("<","serverError",this.extractRequestId(e.args),e.label),"<<EOF",t,"EOF")}}onDidChangeTextDocument(e){this.get_enabled()&&this.appendLines(this.makeEntry("-","didChangeTextDocument"),JSON.stringify(e))}onFileEvent(e){if(!this.get_enabled())return;let t;switch(e.type){case 1:t="fileCreated";break;case 2:t="fileChanged";break;case 3:t="fileDeleted"}let n,r=vt(e.uri);switch(e.type){case 1:case 2:n=0==Ei.statSync(r).size?0:this.fsEventIndex++;break;case 3:n=0}this.appendLines(this.makeEntry("-",t,n),'"'+vt(e.uri)+'"'),n>0&&(this.ensureFileContentsDir(),cr.cp(r,ot.join([this.get_recordingPath(),"files",n+".contents"])))}restart(e,t){this.ready=!1,this.recordingPath="",this.startTime=-1,this.fsEventIndex=1;let n=e.config.user,r=null!=n?n.serverRecording:null;if(null==r)return;if(this.config=r,!r.enabled)return;let i=this;cr.rmdir(this.get_recordingPath()).then((function(n){i.start(e,t)})).catch((function(t){let n=e.languageServerProtocol,r={type:2,message:"Server recording disabled: could not remove previous files."},i={jsonrpc:"2.0",method:"window/showMessage"};null!=r&&(i.params=r),n.writeMessage(i,null),null!=n.didSendNotification&&n.didSendNotification(i)}))}start(e,t){let n=new Date,r=e.workspacePath;try{zs.createDirectory(this.get_recordingPath())}catch(t){let n=e.languageServerProtocol,r={type:2,message:"Server recording disabled: could not create recording directory."},i={jsonrpc:"2.0",method:"window/showMessage"};return null!=r&&(i.params=r),n.writeMessage(i,null),void(null!=n.didSendNotification&&n.didSendNotification(i))}try{this.writeLines(this.makeEntry("#","See https://github.com/kLabz/haxerepro for instructions"))}catch(t){let n=e.languageServerProtocol,r={type:2,message:"Server recording disabled: could not write server logs file."},i={jsonrpc:"2.0",method:"window/showMessage"};return null!=r&&(i.params=r),n.writeMessage(i,null),void(null!=n.didSendNotification&&n.didSendNotification(i))}null!=t&&this.appendLines(this.makeEntry("#","Restart reason: "+t)),this.appendLines(this.makeEntry("-","userConfig"),JSON.stringify(e.config.user),this.makeEntry("-","serverRecordingConfig"),JSON.stringify({watch:this.config.watch,exclude:this.config.exclude,excludeUntracked:this.config.excludeUntracked,version:1.2}),this.makeEntry("-","displayServer"),JSON.stringify(e.config.displayServer),this.makeEntry("-","displayArguments"),JSON.stringify(e.config.displayArguments),this.makeEntry("-","haxe"),gr.toFullVersion(e.haxeServer.haxeVersion),this.makeEntry("-","root",null,r));let s=Zr(ot.join([this.get_recordingPath(),"status.patch"]),ot.join([this.get_recordingPath(),"untracked"]),this.config),a=this;switch(s._hx_index){case 0:this.appendLines(this.makeEntry("#","Could not detect version control, initial state not guaranteed."));break;case 1:this.appendLines(this.makeEntry("-","checkoutGitRef"),s.ref),s.hasPatch&&this.appendLines(this.makeEntry("-","applyGitPatch")),s.hasUntracked&&(this.appendLines(this.makeEntry("-","addGitUntracked")),s.untrackedCopy.then((function(e){a.appendLines(a.makeEntry("#","Untracked files copied successfully"))})).catch((function(e){a.appendLines(a.makeEntry("#","Warning: error while saving untracked file: "+re.string(e.message)))})));break;case 2:this.appendLines(this.makeEntry("-","checkoutSvnRevision"),s.rev),s.hasPatch&&this.appendLines(this.makeEntry("-","applySvnPatch"))}this.appendLines(this.makeEntry("-","start"),this.makeEntry("#","Started "+i.format(n,"%Y-%m-%d %H:%M:%S"))),this.startTime=n.getTime(),this.ready=!0}writeLines(...e){this.print((function(e){return new Zs(Ei.openSync(e,"w"))}),...e)}appendLines(...e){this.print((function(e){return new Zs(Ei.openSync(e,"a"))}),...e)}makeEntry(e,t,n,r){return this.withTiming(e+" "+t+(null==n?"":" "+n)+(null==r?"":' "'+r+'"'))}withTiming(e){return-1==this.startTime?e:"+"+Math.round(((new Date).getTime()-this.startTime)/10)/10+"s "+e}ensureFileContentsDir(){let e=ot.join([this.get_recordingPath(),"files"]);zs.exists(e)||zs.createDirectory(e)}print(e,...t){if(0==t.length)return;let n=e(ot.join([this.get_recordingPath(),"repro.log"])),r=0;for(;r<t.length;)n.writeString(t[r++]+"\n");n.close()}get_recordingPath(){return""==this.recordingPath&&(this.recordingPath=ot.join([this.config.path,"current"])),this.recordingPath}extractRequestId(e){let t=e.length;if(t<2||"--display"!=e[t-2])return null;try{return JSON.parse(e[t-1]).id}catch(e){return null}}}qr.__name__="haxeLanguageServer.server.ServerRecording",Object.assign(qr.prototype,{__class__:qr});var $r=r["haxeLanguageServer.server.VcsState"]={__ename__:!0,__constructs__:null,None:{_hx_name:"None",_hx_index:0,__enum__:"haxeLanguageServer.server.VcsState",toString:n},Git:(t=function(e,t,r,i){return{_hx_index:1,ref:e,hasPatch:t,hasUntracked:r,untrackedCopy:i,__enum__:"haxeLanguageServer.server.VcsState",toString:n,__params__:function(){return[this.ref,this.hasPatch,this.hasUntracked,this.untrackedCopy]}}},t._hx_name="Git",t),Svn:(t=function(e,t){return{_hx_index:2,rev:e,hasPatch:t,__enum__:"haxeLanguageServer.server.VcsState",toString:n,__params__:function(){return[this.rev,this.hasPatch]}}},t._hx_name="Svn",t)};function zr(e){try{return Qr(e,[]),!0}catch(e){return!1}}function Qr(e,t){let n=Oi.spawnSync(e,t);return{code:n.status,out:se.trim((0==n.status?n.stdout:n.stderr).toString())}}function Zr(e,t,n){let r=$r.None;return r=function(e,t,n){if(!zr("git"))return $r.None;let r=Qr("git",["rev-parse","HEAD"]);if(0!=r.code)return $r.None;Qr("git",Xr(["diff","--output",e,"--patch"],n));let i=!1,s=Promise.resolve();if(!n.excludeUntracked){let e=Qr("git",Xr(["status","--porcelain"],n)).out.split("\n"),r=[],l=0;for(;l<e.length;){let t=e[l];++l,t.startsWith("?? ")&&r.push(t)}let o=new Array(r.length),c=0,u=r.length;for(;c<u;){let e=c++;o[e]=a.substr(r[e],3,null)}let h=[],d=0;for(;d<o.length;){let e=o[d];++d,e!=Yr(n)&&".haxelib"!=e&&"dump"!=e&&h.push(e)}if(h.length>0){i=!0,zs.createDirectory(t);let e=[],n=0;for(;n<h.length;){let r=h[n];++n,r.startsWith('"')&&(r=a.substr(r,1,null)),r.endsWith('"')&&(r=a.substr(r,0,r.length-1)),e.push(cr.cp(r,ot.join([t,r])))}s=Promise.all(e).then((function(e){}))}}return $r.Git(r.out,!0,i,s)}(e,t,n),0==r._hx_index&&(r=function(e,t){if(!zr("svn"))return $r.None;let n=Qr("svn",["info","--show-item","revision"]);if(0!=n.code)return $r.None;let r=t.exclude.length>0,i=Qr("svn",["status"]),s=[];if(!t.excludeUntracked){let e=[],n=0,l=i.out.split("\n");for(;n<l.length;){let i=l[n];if(++n,63!=a.cca(i,0))continue;let s=se.trim(a.substr(i,1,null));if(r){let e=!1,n=0,r=t.exclude;for(;n<r.length;)if(s.startsWith(r[n++])){e=!0;break}if(e)continue}e.push(s)}s=e}let l=0;for(;l<s.length;)Qr("svn",["add",s[l++]]);let o=Qr("svn",["diff","--depth=infinity","--patch-compatible"]),c=se.trim(o.out).length>0;c&&Ei.writeFileSync(e,o.out);let u=0;for(;u<s.length;)Qr("svn",["rm","--keep-local",s[u++]]);return $r.Svn(n.out,c)}(e,n)),r}function Xr(e,t){if(0==t.exclude.length)return e;e.push("--"),e.push(".");let n=0,r=t.exclude;for(;n<r.length;)e.push(":^"+r[n++]);return e}function Yr(e){let t=ot.isAbsolute(e.path)?"":e.path;return(t.startsWith("./")||t.startsWith("../"))&&(t=""),t.split("/")[0]+"/"}$r.__constructs__=[$r.None,$r.Git,$r.Svn];class ei{constructor(e){this.document=e}resolve(e){let t=this.document.get_tokens();if(null==t)return null;let n=!1,r=null,i=this;return t.tree.filterCallback((function(s,a){if(n)return ia.SkipSubtree;let l=i.document,o=t.getPos(s),c=o.max;if(Bt({start:l.positionAt(o.min,1),end:l.positionAt(c,1)},e))return r=s,n=!0,ia.SkipSubtree;let u=i.document,h=t.getTreePos(s),d=h.max;return Bt({start:u.positionAt(h.min,1),end:u.positionAt(d,1)},e)?(r=s,ia.GoDeeper):ia.SkipSubtree})),r}static getStringKind(e,t,n){let r=t.get_tokens();if(null==e||null==r)return ti.None;let i=e.tok;if(2!=i._hx_index)return ti.None;if(2!=i.c._hx_index)return ti.None;{let n=t.positionAt(r.getPos(e).min);switch(t.getText({start:n,end:{line:n.line,character:n.character+1}})){case'"':return ti.DoubleQuote;case"'":return ti.SingleQuote;default:return ti.None}}}static getContext(e,t,n){let r=t.get_tokens();if(null==e||null==r)return ni.Root(ri.BeforePackage);let i=null,s=null,a=!1,l=e;e:for(;null!=l&&null!=l&&null!=l.tok;){let t=l.tok;switch(t._hx_index){case 1:let n,r=t.k;if(1==t._hx_index)switch(t.k._hx_index){case 1:case 26:case 28:case 32:case 40:n=!0;break;default:n=!1}else n=!1;if(n&&a){i=l;break e}switch(r._hx_index){case 0:case 2:case 42:fa.isModifier(e)||(s=l)}break;case 18:if(fa.getBrOpenType(l)==ma.Block)a=!0;else{let e;if(1==t._hx_index)switch(t.k._hx_index){case 1:case 26:case 28:case 32:case 40:e=!0;break;default:e=!1}else e=!1;if(e&&a){i=l;break e}}break;default:let o;if(1==t._hx_index)switch(t.k._hx_index){case 1:case 26:case 28:case 32:case 40:o=!0;break;default:o=!1}else o=!1;if(o&&a){i=l;break e}}l=sa.parent(l)}let o=function(){let e=null!=s?s.tok:null;if(null==e)throw Me.thrown("assert false");if(1!=e._hx_index)throw Me.thrown("assert false");switch(e.k._hx_index){case 0:return si.Function;case 2:return si.Var;case 42:return si.Final;default:throw Me.thrown("assert false")}};if(null!=i){let e;if(null!=i){let t=i.tok;if(1==t._hx_index)switch(t.k._hx_index){case 1:e=fa.isTypeMacroClass(i)?ii.MacroClass:ii.Class;break;case 26:e=fa.isTypeEnumAbstract(i)?ii.EnumAbstract:ii.Enum;break;case 28:e=ii.Interface;break;case 32:e=ii.Typedef;break;case 40:e=fa.isTypeEnumAbstract(i)?ii.EnumAbstract:ii.Abstract;break;default:e=null}else e=null}else e=null;return ni.Type({kind:e,field:null!=s?{isStatic:null!=sa.firstOf(sa.child(s,0),oa.Kwd(li.KwdStatic)),kind:o()}:null})}if(null==i&&null!=s)return ni.ModuleLevelStatic(o());let c=ri.BeforePackage,u=r.tree;if(null==u.children)return ni.Root(c);let h=0,d=u.children;for(;h<d.length;){let e=d[h];++h;let i=r.getPos(e),s=i.max,a=1,l=t.positionAt(i.min,a);if(t.positionAt(s,a),Dt(l,n))break;let o=e.tok;if(1==o._hx_index)switch(o.k._hx_index){case 34:c=ri.BeforeFirstImport;break;case 13:case 36:c=ri.BeforeFirstType;break;default:let e;if(1==o._hx_index)switch(o.k._hx_index){case 1:case 26:case 28:case 32:case 40:e=!0;break;default:e=!1}else e=!1;e&&(c=ri.AfterFirstType)}else{let e;if(1==o._hx_index)switch(o.k._hx_index){case 1:case 26:case 28:case 32:case 40:e=!0;break;default:e=!1}else e=!1;e&&(c=ri.AfterFirstType)}}return ni.Root(c)}}ei.__name__="haxeLanguageServer.tokentree.PositionAnalyzer",Object.assign(ei.prototype,{__class__:ei});var ti=r["haxeLanguageServer.tokentree.StringKind"]={__ename__:!0,__constructs__:null,None:{_hx_name:"None",_hx_index:0,__enum__:"haxeLanguageServer.tokentree.StringKind",toString:n},SingleQuote:{_hx_name:"SingleQuote",_hx_index:1,__enum__:"haxeLanguageServer.tokentree.StringKind",toString:n},DoubleQuote:{_hx_name:"DoubleQuote",_hx_index:2,__enum__:"haxeLanguageServer.tokentree.StringKind",toString:n}};ti.__constructs__=[ti.None,ti.SingleQuote,ti.DoubleQuote];var ni=r["haxeLanguageServer.tokentree.TokenContext"]={__ename__:!0,__constructs__:null,Root:(t=function(e){return{_hx_index:0,pos:e,__enum__:"haxeLanguageServer.tokentree.TokenContext",toString:n,__params__:function(){return[this.pos]}}},t._hx_name="Root",t),Type:(t=function(e){return{_hx_index:1,type:e,__enum__:"haxeLanguageServer.tokentree.TokenContext",toString:n,__params__:function(){return[this.type]}}},t._hx_name="Type",t),ModuleLevelStatic:(t=function(e){return{_hx_index:2,kind:e,__enum__:"haxeLanguageServer.tokentree.TokenContext",toString:n,__params__:function(){return[this.kind]}}},t._hx_name="ModuleLevelStatic",t)};ni.__constructs__=[ni.Root,ni.Type,ni.ModuleLevelStatic];var ri=r["haxeLanguageServer.tokentree.RootPosition"]={__ename__:!0,__constructs__:null,BeforePackage:{_hx_name:"BeforePackage",_hx_index:0,__enum__:"haxeLanguageServer.tokentree.RootPosition",toString:n},BeforeFirstImport:{_hx_name:"BeforeFirstImport",_hx_index:1,__enum__:"haxeLanguageServer.tokentree.RootPosition",toString:n},BeforeFirstType:{_hx_name:"BeforeFirstType",_hx_index:2,__enum__:"haxeLanguageServer.tokentree.RootPosition",toString:n},AfterFirstType:{_hx_name:"AfterFirstType",_hx_index:3,__enum__:"haxeLanguageServer.tokentree.RootPosition",toString:n}};ri.__constructs__=[ri.BeforePackage,ri.BeforeFirstImport,ri.BeforeFirstType,ri.AfterFirstType];var ii=r["haxeLanguageServer.tokentree.TypeKind"]={__ename__:!0,__constructs__:null,Class:{_hx_name:"Class",_hx_index:0,__enum__:"haxeLanguageServer.tokentree.TypeKind",toString:n},Interface:{_hx_name:"Interface",_hx_index:1,__enum__:"haxeLanguageServer.tokentree.TypeKind",toString:n},Enum:{_hx_name:"Enum",_hx_index:2,__enum__:"haxeLanguageServer.tokentree.TypeKind",toString:n},EnumAbstract:{_hx_name:"EnumAbstract",_hx_index:3,__enum__:"haxeLanguageServer.tokentree.TypeKind",toString:n},Abstract:{_hx_name:"Abstract",_hx_index:4,__enum__:"haxeLanguageServer.tokentree.TypeKind",toString:n},Typedef:{_hx_name:"Typedef",_hx_index:5,__enum__:"haxeLanguageServer.tokentree.TypeKind",toString:n},MacroClass:{_hx_name:"MacroClass",_hx_index:6,__enum__:"haxeLanguageServer.tokentree.TypeKind",toString:n}};ii.__constructs__=[ii.Class,ii.Interface,ii.Enum,ii.EnumAbstract,ii.Abstract,ii.Typedef,ii.MacroClass];var si=r["haxeLanguageServer.tokentree.FieldKind"]={__ename__:!0,__constructs__:null,Var:{_hx_name:"Var",_hx_index:0,__enum__:"haxeLanguageServer.tokentree.FieldKind",toString:n},Final:{_hx_name:"Final",_hx_index:1,__enum__:"haxeLanguageServer.tokentree.FieldKind",toString:n},Function:{_hx_name:"Function",_hx_index:2,__enum__:"haxeLanguageServer.tokentree.FieldKind",toString:n}};si.__constructs__=[si.Var,si.Final,si.Function];class ai{constructor(e,t,n){this.bytes=e,this.list=t,this.tree=n}getPos(e){if(null==this.tokenCharacterRanges){this.tokenCharacterRanges=new Qe;let e=0,t=0,n=this.list.length;for(;t<n;){let n,r=t++,i=this.list[r],s=i.tok;switch(s._hx_index){case 1:let e=s.c;switch(e._hx_index){case 2:let t=e.s;n=t.length-jr.byteLength(t);break;case 4:let r=e.r;n=r.length-jr.byteLength(r);break;default:n=0}break;case 3:let t=s.s;n=t.length-jr.byteLength(t);break;case 4:let r=s.s;n=r.length-jr.byteLength(r);break;default:n=0}e+=n,0!=e&&this.tokenCharacterRanges.m.set(r,{file:i.pos.file,min:i.pos.min+e,max:i.pos.max+e})}}let t=this.tokenCharacterRanges.m.get(e.index);return null==t?e.pos:t}getTreePos(e){let t=this.getPos(e),n=e.children;if(null==t||null==n)return t;if(n.length<=0)return t;let r={file:t.file,min:t.min,max:t.max},i=0;for(;i<n.length;){let e=this.getTreePos(n[i++]);null!=e&&(e.min<r.min&&(r.min=e.min),e.max>r.max&&(r.max=e.max))}return r}getTokenAtOffset(e){if(this.list.length<=0)return null;if(e<0)return null;if(e>this.list[this.list.length-1].pos.max)return null;if(null==this.tokenCharacterRanges){this.tokenCharacterRanges=new Qe;let e=0,t=0,n=this.list.length;for(;t<n;){let n,r=t++,i=this.list[r],s=i.tok;switch(s._hx_index){case 1:let e=s.c;switch(e._hx_index){case 2:let t=e.s;n=t.length-jr.byteLength(t);break;case 4:let r=e.r;n=r.length-jr.byteLength(r);break;default:n=0}break;case 3:let t=s.s;n=t.length-jr.byteLength(t);break;case 4:let r=s.s;n=r.length-jr.byteLength(r);break;default:n=0}e+=n,0!=e&&this.tokenCharacterRanges.m.set(r,{file:i.pos.file,min:i.pos.min+e,max:i.pos.max+e})}}let t=0,n=this.list.length;for(;t<n;){let n=t++,r=this.tokenCharacterRanges.m.get(n);if(null==r&&(r=this.list[n].pos),!(r.max<e))return e<r.min?null:this.findTokenAtIndex(this.tree,n)}return null}findTokenAtIndex(e,t){if(null==e.children)return null;let n=0,r=e.children;for(;n<r.length;){let e=r[n];if(++n,e.index==t)return e;let i=this.findTokenAtIndex(e,t);if(null!=i)return i}return null}static create(e){let t=it.ofString(e),n=ai.createTokens(t);return new ai(t,n,ai.createTokenTree(t,n))}static createTokens(e){try{let t=[],n=new bi(e),r=n.token(bi.tok);for(;r.tok!=oi.Eof;)t.push(r),r=n.token(bi.tok);return t}catch(e){throw Me.thrown("failed to create tokens: "+re.string(Me.caught(e)))}}static createTokenTree(e,t){try{return ea.MODE=Ys.Relaxed,aa.buildTokenTree(t,e)}catch(e){throw Me.thrown("failed to create token tree: "+re.string(Me.caught(e)))}}}ai.__name__="haxeLanguageServer.tokentree.TokenTreeManager",Object.assign(ai.prototype,{__class__:ai});var li=r["haxeparser.Keyword"]={__ename__:!0,__constructs__:null,KwdFunction:{_hx_name:"KwdFunction",_hx_index:0,__enum__:"haxeparser.Keyword",toString:n},KwdClass:{_hx_name:"KwdClass",_hx_index:1,__enum__:"haxeparser.Keyword",toString:n},KwdVar:{_hx_name:"KwdVar",_hx_index:2,__enum__:"haxeparser.Keyword",toString:n},KwdIf:{_hx_name:"KwdIf",_hx_index:3,__enum__:"haxeparser.Keyword",toString:n},KwdElse:{_hx_name:"KwdElse",_hx_index:4,__enum__:"haxeparser.Keyword",toString:n},KwdWhile:{_hx_name:"KwdWhile",_hx_index:5,__enum__:"haxeparser.Keyword",toString:n},KwdDo:{_hx_name:"KwdDo",_hx_index:6,__enum__:"haxeparser.Keyword",toString:n},KwdFor:{_hx_name:"KwdFor",_hx_index:7,__enum__:"haxeparser.Keyword",toString:n},KwdBreak:{_hx_name:"KwdBreak",_hx_index:8,__enum__:"haxeparser.Keyword",toString:n},KwdContinue:{_hx_name:"KwdContinue",_hx_index:9,__enum__:"haxeparser.Keyword",toString:n},KwdReturn:{_hx_name:"KwdReturn",_hx_index:10,__enum__:"haxeparser.Keyword",toString:n},KwdExtends:{_hx_name:"KwdExtends",_hx_index:11,__enum__:"haxeparser.Keyword",toString:n},KwdImplements:{_hx_name:"KwdImplements",_hx_index:12,__enum__:"haxeparser.Keyword",toString:n},KwdImport:{_hx_name:"KwdImport",_hx_index:13,__enum__:"haxeparser.Keyword",toString:n},KwdSwitch:{_hx_name:"KwdSwitch",_hx_index:14,__enum__:"haxeparser.Keyword",toString:n},KwdCase:{_hx_name:"KwdCase",_hx_index:15,__enum__:"haxeparser.Keyword",toString:n},KwdDefault:{_hx_name:"KwdDefault",_hx_index:16,__enum__:"haxeparser.Keyword",toString:n},KwdStatic:{_hx_name:"KwdStatic",_hx_index:17,__enum__:"haxeparser.Keyword",toString:n},KwdPublic:{_hx_name:"KwdPublic",_hx_index:18,__enum__:"haxeparser.Keyword",toString:n},KwdPrivate:{_hx_name:"KwdPrivate",_hx_index:19,__enum__:"haxeparser.Keyword",toString:n},KwdTry:{_hx_name:"KwdTry",_hx_index:20,__enum__:"haxeparser.Keyword",toString:n},KwdCatch:{_hx_name:"KwdCatch",_hx_index:21,__enum__:"haxeparser.Keyword",toString:n},KwdNew:{_hx_name:"KwdNew",_hx_index:22,__enum__:"haxeparser.Keyword",toString:n},KwdThis:{_hx_name:"KwdThis",_hx_index:23,__enum__:"haxeparser.Keyword",toString:n},KwdThrow:{_hx_name:"KwdThrow",_hx_index:24,__enum__:"haxeparser.Keyword",toString:n},KwdExtern:{_hx_name:"KwdExtern",_hx_index:25,__enum__:"haxeparser.Keyword",toString:n},KwdEnum:{_hx_name:"KwdEnum",_hx_index:26,__enum__:"haxeparser.Keyword",toString:n},KwdIn:{_hx_name:"KwdIn",_hx_index:27,__enum__:"haxeparser.Keyword",toString:n},KwdInterface:{_hx_name:"KwdInterface",_hx_index:28,__enum__:"haxeparser.Keyword",toString:n},KwdUntyped:{_hx_name:"KwdUntyped",_hx_index:29,__enum__:"haxeparser.Keyword",toString:n},KwdCast:{_hx_name:"KwdCast",_hx_index:30,__enum__:"haxeparser.Keyword",toString:n},KwdOverride:{_hx_name:"KwdOverride",_hx_index:31,__enum__:"haxeparser.Keyword",toString:n},KwdTypedef:{_hx_name:"KwdTypedef",_hx_index:32,__enum__:"haxeparser.Keyword",toString:n},KwdDynamic:{_hx_name:"KwdDynamic",_hx_index:33,__enum__:"haxeparser.Keyword",toString:n},KwdPackage:{_hx_name:"KwdPackage",_hx_index:34,__enum__:"haxeparser.Keyword",toString:n},KwdInline:{_hx_name:"KwdInline",_hx_index:35,__enum__:"haxeparser.Keyword",toString:n},KwdUsing:{_hx_name:"KwdUsing",_hx_index:36,__enum__:"haxeparser.Keyword",toString:n},KwdNull:{_hx_name:"KwdNull",_hx_index:37,__enum__:"haxeparser.Keyword",toString:n},KwdTrue:{_hx_name:"KwdTrue",_hx_index:38,__enum__:"haxeparser.Keyword",toString:n},KwdFalse:{_hx_name:"KwdFalse",_hx_index:39,__enum__:"haxeparser.Keyword",toString:n},KwdAbstract:{_hx_name:"KwdAbstract",_hx_index:40,__enum__:"haxeparser.Keyword",toString:n},KwdMacro:{_hx_name:"KwdMacro",_hx_index:41,__enum__:"haxeparser.Keyword",toString:n},KwdFinal:{_hx_name:"KwdFinal",_hx_index:42,__enum__:"haxeparser.Keyword",toString:n},KwdOperator:{_hx_name:"KwdOperator",_hx_index:43,__enum__:"haxeparser.Keyword",toString:n},KwdOverload:{_hx_name:"KwdOverload",_hx_index:44,__enum__:"haxeparser.Keyword",toString:n}};li.__constructs__=[li.KwdFunction,li.KwdClass,li.KwdVar,li.KwdIf,li.KwdElse,li.KwdWhile,li.KwdDo,li.KwdFor,li.KwdBreak,li.KwdContinue,li.KwdReturn,li.KwdExtends,li.KwdImplements,li.KwdImport,li.KwdSwitch,li.KwdCase,li.KwdDefault,li.KwdStatic,li.KwdPublic,li.KwdPrivate,li.KwdTry,li.KwdCatch,li.KwdNew,li.KwdThis,li.KwdThrow,li.KwdExtern,li.KwdEnum,li.KwdIn,li.KwdInterface,li.KwdUntyped,li.KwdCast,li.KwdOverride,li.KwdTypedef,li.KwdDynamic,li.KwdPackage,li.KwdInline,li.KwdUsing,li.KwdNull,li.KwdTrue,li.KwdFalse,li.KwdAbstract,li.KwdMacro,li.KwdFinal,li.KwdOperator,li.KwdOverload];var oi=r["haxeparser.TokenDef"]={__ename__:!0,__constructs__:null,Eof:{_hx_name:"Eof",_hx_index:0,__enum__:"haxeparser.TokenDef",toString:n},Const:(t=function(e){return{_hx_index:1,c:e,__enum__:"haxeparser.TokenDef",toString:n,__params__:function(){return[this.c]}}},t._hx_name="Const",t),Kwd:(t=function(e){return{_hx_index:2,k:e,__enum__:"haxeparser.TokenDef",toString:n,__params__:function(){return[this.k]}}},t._hx_name="Kwd",t),Comment:(t=function(e){return{_hx_index:3,s:e,__enum__:"haxeparser.TokenDef",toString:n,__params__:function(){return[this.s]}}},t._hx_name="Comment",t),CommentLine:(t=function(e){return{_hx_index:4,s:e,__enum__:"haxeparser.TokenDef",toString:n,__params__:function(){return[this.s]}}},t._hx_name="CommentLine",t),Binop:(t=function(e){return{_hx_index:5,op:e,__enum__:"haxeparser.TokenDef",toString:n,__params__:function(){return[this.op]}}},t._hx_name="Binop",t),Unop:(t=function(e){return{_hx_index:6,op:e,__enum__:"haxeparser.TokenDef",toString:n,__params__:function(){return[this.op]}}},t._hx_name="Unop",t),Semicolon:{_hx_name:"Semicolon",_hx_index:7,__enum__:"haxeparser.TokenDef",toString:n},Comma:{_hx_name:"Comma",_hx_index:8,__enum__:"haxeparser.TokenDef",toString:n},BrOpen:{_hx_name:"BrOpen",_hx_index:9,__enum__:"haxeparser.TokenDef",toString:n},BrClose:{_hx_name:"BrClose",_hx_index:10,__enum__:"haxeparser.TokenDef",toString:n},BkOpen:{_hx_name:"BkOpen",_hx_index:11,__enum__:"haxeparser.TokenDef",toString:n},BkClose:{_hx_name:"BkClose",_hx_index:12,__enum__:"haxeparser.TokenDef",toString:n},POpen:{_hx_name:"POpen",_hx_index:13,__enum__:"haxeparser.TokenDef",toString:n},PClose:{_hx_name:"PClose",_hx_index:14,__enum__:"haxeparser.TokenDef",toString:n},Dot:{_hx_name:"Dot",_hx_index:15,__enum__:"haxeparser.TokenDef",toString:n},DblDot:{_hx_name:"DblDot",_hx_index:16,__enum__:"haxeparser.TokenDef",toString:n},QuestionDot:{_hx_name:"QuestionDot",_hx_index:17,__enum__:"haxeparser.TokenDef",toString:n},Arrow:{_hx_name:"Arrow",_hx_index:18,__enum__:"haxeparser.TokenDef",toString:n},IntInterval:(t=function(e){return{_hx_index:19,s:e,__enum__:"haxeparser.TokenDef",toString:n,__params__:function(){return[this.s]}}},t._hx_name="IntInterval",t),Sharp:(t=function(e){return{_hx_index:20,s:e,__enum__:"haxeparser.TokenDef",toString:n,__params__:function(){return[this.s]}}},t._hx_name="Sharp",t),Question:{_hx_name:"Question",_hx_index:21,__enum__:"haxeparser.TokenDef",toString:n},At:{_hx_name:"At",_hx_index:22,__enum__:"haxeparser.TokenDef",toString:n},Dollar:(t=function(e){return{_hx_index:23,s:e,__enum__:"haxeparser.TokenDef",toString:n,__params__:function(){return[this.s]}}},t._hx_name="Dollar",t),Spread:{_hx_name:"Spread",_hx_index:24,__enum__:"haxeparser.TokenDef",toString:n}};oi.__constructs__=[oi.Eof,oi.Const,oi.Kwd,oi.Comment,oi.CommentLine,oi.Binop,oi.Unop,oi.Semicolon,oi.Comma,oi.BrOpen,oi.BrClose,oi.BkOpen,oi.BkClose,oi.POpen,oi.PClose,oi.Dot,oi.DblDot,oi.QuestionDot,oi.Arrow,oi.IntInterval,oi.Sharp,oi.Question,oi.At,oi.Dollar,oi.Spread];var ci=r["haxeparser.Constant"]={__ename__:!0,__constructs__:null,CInt:(t=function(e,t){return{_hx_index:0,v:e,s:t,__enum__:"haxeparser.Constant",toString:n,__params__:function(){return[this.v,this.s]}}},t._hx_name="CInt",t),CFloat:(t=function(e,t){return{_hx_index:1,f:e,s:t,__enum__:"haxeparser.Constant",toString:n,__params__:function(){return[this.f,this.s]}}},t._hx_name="CFloat",t),CString:(t=function(e,t){return{_hx_index:2,s:e,kind:t,__enum__:"haxeparser.Constant",toString:n,__params__:function(){return[this.s,this.kind]}}},t._hx_name="CString",t),CIdent:(t=function(e){return{_hx_index:3,s:e,__enum__:"haxeparser.Constant",toString:n,__params__:function(){return[this.s]}}},t._hx_name="CIdent",t),CRegexp:(t=function(e,t){return{_hx_index:4,r:e,opt:t,__enum__:"haxeparser.Constant",toString:n,__params__:function(){return[this.r,this.opt]}}},t._hx_name="CRegexp",t),CMarkup:(t=function(e){return{_hx_index:5,s:e,__enum__:"haxeparser.Constant",toString:n,__params__:function(){return[this.s]}}},t._hx_name="CMarkup",t)};ci.__constructs__=[ci.CInt,ci.CFloat,ci.CString,ci.CIdent,ci.CRegexp,ci.CMarkup];class ui{static toString(e){switch(e._hx_index){case 0:return"<eof>";case 1:return ui.constToString(e.c);case 2:let t=e.k;return a.substr(r[t.__enum__].__constructs__[t._hx_index]._hx_name,3,null).toLowerCase();case 3:return"/*"+e.s+"*/";case 4:return"//"+e.s;case 5:return new pt("").printBinop(e.op);case 6:return new pt("").printUnop(e.op);case 7:return";";case 8:return",";case 9:return"{";case 10:return"}";case 11:return"[";case 12:return"]";case 13:return"(";case 14:return")";case 15:return".";case 16:return":";case 17:return"?.";case 18:return"->";case 19:return e.s+"...";case 20:return"#"+e.s;case 21:return"?";case 22:return"@";case 23:return"$"+e.s;case 24:return"..."}}static constToString(e){switch(e._hx_index){case 0:let t=e.v,n=e.s;return null==n?t:""+t+n;case 1:let r=e.f,i=e.s;return null==i?r:""+r+i;case 2:let s=e.s,a=e.kind;if(null==a)return'"'+s+'"';switch(a._hx_index){case 0:return'"'+s+'"';case 1:return"'"+s+"'"}break;case 3:case 5:return e.s;case 4:return"~/"+e.r+"/"+e.opt}}}ui.__name__="haxeparser.TokenDefPrinter";class hi{constructor(e,t){this.tok=e,this.pos=t}toString(){return ui.toString(this.tok)}}hi.__name__="haxeparser.Token",Object.assign(hi.prototype,{__class__:hi});var di=r["haxeparser.LexerErrorMsg"]={__ename__:!0,__constructs__:null,UnterminatedString:{_hx_name:"UnterminatedString",_hx_index:0,__enum__:"haxeparser.LexerErrorMsg",toString:n},UnterminatedRegExp:{_hx_name:"UnterminatedRegExp",_hx_index:1,__enum__:"haxeparser.LexerErrorMsg",toString:n},UnclosedComment:{_hx_name:"UnclosedComment",_hx_index:2,__enum__:"haxeparser.LexerErrorMsg",toString:n},UnterminatedEscapeSequence:{_hx_name:"UnterminatedEscapeSequence",_hx_index:3,__enum__:"haxeparser.LexerErrorMsg",toString:n},InvalidEscapeSequence:(t=function(e){return{_hx_index:4,c:e,__enum__:"haxeparser.LexerErrorMsg",toString:n,__params__:function(){return[this.c]}}},t._hx_name="InvalidEscapeSequence",t),UnknownEscapeSequence:(t=function(e){return{_hx_index:5,c:e,__enum__:"haxeparser.LexerErrorMsg",toString:n,__params__:function(){return[this.c]}}},t._hx_name="UnknownEscapeSequence",t),UnclosedCode:{_hx_name:"UnclosedCode",_hx_index:6,__enum__:"haxeparser.LexerErrorMsg",toString:n}};di.__constructs__=[di.UnterminatedString,di.UnterminatedRegExp,di.UnclosedComment,di.UnterminatedEscapeSequence,di.InvalidEscapeSequence,di.UnknownEscapeSequence,di.UnclosedCode];class pi{constructor(e,t){this.msg=e,this.pos=t}}pi.__name__="haxeparser.LexerError",Object.assign(pi.prototype,{__class__:pi});class fi{constructor(e,t){null==t&&(t="<null>"),this.current="",this.input=e,this.source=t,this.pos=0}token(e){if(this.pos==this.input.length){if(null!=e.eofFunction)return e.eofFunction(this);throw Me.thrown(new at)}let t=e.state,n=null,r=this.pos,i=this.pos;do{if(t.finalId>-1&&(n=t,r=this.pos),this.pos==this.input.length)break;let e=this.input.b[this.pos];++this.pos,t=t.trans[e]}while(null!=t);if(this.pos=r,this.current=this.input.getString(i,this.pos-i),null==n||-1==n.finalId){let e=this.input.b[this.pos];throw Me.thrown(new Ni(String.fromCodePoint(e),new wi(this.source,this.pos-this.current.length,this.pos)))}return e.functions[n.finalId](this)}static buildRuleset(e,t){null==t&&(t="");let n=[],r=[],i=null,s=0;for(;s<e.length;){let t=e[s];++s,""==t.rule?i=t.func:(n.push(gi.parse(t.rule)),r.push(t.func))}return new yi(new gi(n).firstState(),r,i,t)}}fi.__name__="hxparse.Lexer",Object.assign(fi.prototype,{__class__:fi});class mi{}mi.__name__="hxparse.RuleBuilder",mi.__isInterface__=!0;class _i{constructor(e,t){this.min=e,this.max=t}}_i.__name__="hxparse._LexEngine.CharRange",Object.assign(_i.prototype,{__class__:_i});class gi{constructor(e){this.nodes=[],this.finals=[],this.states=[],this.hstates=new tt,this.uid=0;let t=0,n=0;for(;n<e.length;){let r=e[n++],i=t++,s=new ki(this.uid++,i),a=this.initNode(r,s,i);this.nodes.push(a),this.finals.push(s)}this.makeState(this.addNodes([],this.nodes))}firstState(){return this.states[0]}makeState(e){let t="",n=0;for(;n<e.length;)t+=re.string(e[n++].id),t+=String.fromCodePoint(45);let r=t,i=this.hstates.m.get(r);if(null!=i)return i;i=new Fi,this.states.push(i),this.hstates.m.set(r,i);let s=this.getTransitions(e),a=0;for(;a<s.length;){let e=s[a];++a;let t=this.makeState(e.n),n=0,r=e.chars;for(;n<r.length;){let e=r[n];++n;let s=e.min,a=e.max+1;for(;s<a;)i.trans[s++]=t}}let l=this;return-1==i.finalId&&function(){let t=0,n=l.finals;for(;t<n.length;){let r=n[t++],s=0;for(;s<e.length;){let t=e[s];if(++s,t==r)return void(i.finalId=t.pid)}}}(),i}getTransitions(e){let t=[],n=0;for(;n<e.length;){let r=0,i=e[n++].trans;for(;r<i.length;)t.push(i[r++])}t.sort((function(e,t){return e.n.id-t.n.id}));let r=t[0],i=1,s=t.length;for(;i<s;){let e=i++,n=t[e];r.n==n.n&&(t[e-1]=null,n={chars:gi.cunion(r.chars,n.chars),n:n.n},t[e]=n),r=n}for(;a.remove(t,null););let l=gi.EMPTY,o=new Ze,c=0;for(;c<t.length;){let e=t[c];++c;let n=new Ze;n.push({chars:gi.cdiff(e.chars,l),n:[e.n]});let r=o.h;for(;null!=r;){let t=r.item;r=r.next;let i=t.n.slice();i.push(e.n),n.push({chars:gi.cinter(t.chars,e.chars),n:i}),n.push({chars:gi.cdiff(t.chars,e.chars),n:t.n})}let i=n.h;for(;null!=i;){let e=i.item;i=i.next,0==e.chars.length&&n.remove(e)}l=gi.cunion(l,e.chars),o=n}let u=[],h=o.h;for(;null!=h;){let e=h.item;h=h.next,u.push({chars:e.chars,n:this.addNodes([],e.n)})}return u.sort((function(e,t){let n=e.chars.length,r=t.chars.length,i=0,s=n<r?n:r;for(;i<s;){let n=i++,r=e.chars[n],s=t.chars[n];if(r.min!=s.min)return s.min-r.min;if(r.max!=s.max)return s.max-r.max}return n<r?r-n:0})),u}addNode(e,t){let n=0;for(;n<e.length;)if(t==e[n++])return;e.push(t),this.addNodes(e,t.epsilon)}addNodes(e,t){let n=0;for(;n<t.length;)this.addNode(e,t[n++]);return e}initNode(e,t,n){switch(e._hx_index){case 0:return t;case 1:let r=new ki(this.uid++,n);return r.trans.push({chars:e.c,n:t}),r;case 2:let i=new ki(this.uid++,n),s=this.initNode(e.p,i,n);return i.epsilon.push(s),i.epsilon.push(t),i;case 3:let a=new ki(this.uid++,n),l=this.initNode(e.p,a,n);return a.epsilon.push(l),a.epsilon.push(t),l;case 4:return this.initNode(e.p1,this.initNode(e.p2,t,n),n);case 5:let o=new ki(this.uid++,n);return o.epsilon.push(this.initNode(e.p1,t,n)),o.epsilon.push(this.initNode(e.p2,t,n)),o;case 6:return this.initNode(e.p,t,n)}}static parse(e){let t=gi.parseInner(it.ofString(e));if(null==t)throw Me.thrown("Invalid pattern '"+e+"'");return t.pattern}static next(e,t){return e==xi.Empty?t:xi.Next(e,t)}static plus(e){return 4==e._hx_index?xi.Next(e.p1,gi.plus(e.p2)):xi.Plus(e)}static star(e){return 4==e._hx_index?xi.Next(e.p1,gi.star(e.p2)):xi.Star(e)}static opt(e){return 4==e._hx_index?xi.Next(e.p1,gi.opt(e.p2)):xi.Choice(e,xi.Empty)}static cinter(e,t){return gi.ccomplement(gi.cunion(gi.ccomplement(e),gi.ccomplement(t)))}static cdiff(e,t){return gi.ccomplement(gi.cunion(gi.ccomplement(e),t))}static ccomplement(e){let t=e[0],n=null!=t&&-1==t.min?e.shift().max+1:-1,r=[],i=0;for(;i<e.length;){let t=e[i];++i,r.push(new _i(n,t.min-1)),n=t.max+1}return n<=255&&r.push(new _i(n,255)),r}static cunion(e,t){let n=0,r=0,i=[];n=1;let s=e[0];r=1;let a=t[0];for(;;){if(null==s){for(i.push(a);r<t.length;)i.push(t[r++]);break}if(null==a){for(i.push(s);n<e.length;)i.push(e[n++]);break}if(s.min<=a.min)s.max+1<a.min?(i.push(s),s=e[n++]):s.max<a.max?(a=new _i(s.min,a.max),s=e[n++]):a=t[r++];else{let i=e;e=t,t=i;let l=r;r=n,n=l;let o=s;s=a,a=o}}return i}static parseInner(e,t,n){null==n&&(n=0),null==t&&(t=0);let r=function(){t+=1;let n=e.b[t-1];if(n!=n)n=92;else if(120==n)n=re.parseInt("0x"+e.getString(t,2)),t+=2;else if(n>=48&&n<=57){let r=n-48;for(;;){let n=e.b[t];if(!(n>=48&&n<=57))break;r=10*r+(n-48),t+=1}n=r}return n},i=xi.Empty,s=e.length;for(;t<s;){t+=1;let s=e.b[t-1];if(s>255)throw Me.thrown(s);switch(s){case 40:let a=gi.parseInner(e,t,n+1);t=a.pos,i=gi.next(i,a.pattern);break;case 41:if(i==xi.Empty)throw Me.thrown("Empty group");return{pattern:xi.Group(i),pos:t};case 42:i=i!=xi.Empty?gi.star(i):gi.next(i,xi.Match([new _i(s,s)]));break;case 43:i=i!=xi.Empty?gi.plus(i):gi.next(i,xi.Match([new _i(s,s)]));break;case 46:i=gi.next(i,xi.Match(gi.ALL_CHARS));break;case 63:i=i!=xi.Empty?gi.opt(i):gi.next(i,xi.Match([new _i(s,s)]));break;case 91:if(e.length>1){let n=0,s=[],a=94==e.b[t];for(a&&(t+=1);;){t+=1;let i=e.b[t-1];if(93==i){if(0!=n)return null;break}if(45==i){if(0!=n)return null;let e=s.pop();if(null==e)s.push(new _i(i,i));else{if(e.min!=e.max)return null;n=e.min}}else 92==i&&(i=r()),0==n?s.push(new _i(i,i)):(s.push(new _i(n,i)),n=0)}let l=[],o=0;for(;o<s.length;)l=gi.cunion(l,[s[o++]]);a&&(l=gi.cdiff(gi.ALL_CHARS,l)),i=gi.next(i,xi.Match(l))}else i=gi.next(i,xi.Match([new _i(s,s)]));break;case 92:s=r(),i=gi.next(i,xi.Match([new _i(s,s)]));break;case 124:if(i!=xi.Empty){let n=gi.parseInner(e,t);return{pattern:xi.Choice(i,n.pattern),pos:n.pos}}i=gi.next(i,xi.Match([new _i(s,s)]));break;default:i=gi.next(i,xi.Match([new _i(s,s)]))}}if(0!=n)throw Me.thrown('Found unclosed parenthesis while parsing "'+re.string(e)+'"');return{pattern:i,pos:t}}}gi.__name__="hxparse.LexEngine",Object.assign(gi.prototype,{__class__:gi});var xi=r["hxparse._LexEngine.Pattern"]={__ename__:!0,__constructs__:null,Empty:{_hx_name:"Empty",_hx_index:0,__enum__:"hxparse._LexEngine.Pattern",toString:n},Match:(t=function(e){return{_hx_index:1,c:e,__enum__:"hxparse._LexEngine.Pattern",toString:n,__params__:function(){return[this.c]}}},t._hx_name="Match",t),Star:(t=function(e){return{_hx_index:2,p:e,__enum__:"hxparse._LexEngine.Pattern",toString:n,__params__:function(){return[this.p]}}},t._hx_name="Star",t),Plus:(t=function(e){return{_hx_index:3,p:e,__enum__:"hxparse._LexEngine.Pattern",toString:n,__params__:function(){return[this.p]}}},t._hx_name="Plus",t),Next:(t=function(e,t){return{_hx_index:4,p1:e,p2:t,__enum__:"hxparse._LexEngine.Pattern",toString:n,__params__:function(){return[this.p1,this.p2]}}},t._hx_name="Next",t),Choice:(t=function(e,t){return{_hx_index:5,p1:e,p2:t,__enum__:"hxparse._LexEngine.Pattern",toString:n,__params__:function(){return[this.p1,this.p2]}}},t._hx_name="Choice",t),Group:(t=function(e){return{_hx_index:6,p:e,__enum__:"hxparse._LexEngine.Pattern",toString:n,__params__:function(){return[this.p]}}},t._hx_name="Group",t)};xi.__constructs__=[xi.Empty,xi.Match,xi.Star,xi.Plus,xi.Next,xi.Choice,xi.Group];class ki{constructor(e,t){this.id=e,this.pid=t,this.trans=[],this.epsilon=[]}}ki.__name__="hxparse._LexEngine.Node",Object.assign(ki.prototype,{__class__:ki});class yi{constructor(e,t,n,r){null==r&&(r=""),this.state=e,this.functions=t,this.eofFunction=n,this.name=r}}yi.__name__="hxparse.Ruleset",Object.assign(yi.prototype,{__class__:yi});class wi{constructor(e,t,n){this.psource=e,this.pmin=t,this.pmax=n}toString(){return this.psource+":characters "+this.pmin+"-"+this.pmax}getLinePosition(e){let t=1,n=1,r=0,i=0,s=0;for(;s<this.pmin;)10==e.b[s]&&(++t,r=s+1),++s;for(n=t,i=r,r=s-r;s<this.pmax;)10==e.b[s]&&(++n,i=s+1),++s;return i=s-i,{lineMin:t,lineMax:n,posMin:r,posMax:i}}format(e){let t=this.getLinePosition(e);return t.lineMin!=t.lineMax?this.psource+":lines "+t.lineMin+"-"+t.lineMax:this.psource+":"+t.lineMin+": characters "+t.posMin+"-"+t.posMax}}wi.__name__="hxparse.Position",Object.assign(wi.prototype,{__class__:wi});class bi extends fi{constructor(e,t){super(e,t)}static mkPos(e){return{file:e.psource,min:e.pmin,max:e.pmax}}static mk(e,t){return new hi(t,bi.mkPos(new wi(e.source,e.pos-e.current.length,e.pos)))}static inlineMarkup(e){let t=a.substr(e.current,1,null),n=e.pos-e.current.length,r=e.input.getString(n,e.input.length-n),i="<"+t,s="</"+t+">",l=function(){return e.pos=n+1,e.current="<",bi.mk(e,oi.Binop(ht.OpLt))},o=0,c=0;for(;;){let e=r.indexOf(i,c),t=r.indexOf(s,c);if(-1==e&&-1==t)return l();if(-1==e&&(e=t+1),-1==t&&(t=e+1),e<t){switch(c=e+i.length,r.charAt(c)){case" ":case"/":case">":break;default:continue}++o;let t=r.indexOf("/>",c),n=r.indexOf(">",c),s=r.indexOf("<",c);if(-1==t&&-1==n&&-1==s)return l();-1==t&&(t=1+(0|Math.max(n,s))),-1==n&&(n=1+(0|Math.max(t,s))),-1==s&&(s=1+(0|Math.max(t,n))),t<n&&t<s&&(c=t+2,--o),n<t&&n<s&&(c=n+1),s<t&&s<n&&(c=s)}if(t<e&&(c=t+s.length,--o),o<=0)break}r=a.substr(r,0,c);let u=it.ofString(r),h=n+u.length;return e.current=r,e.pos=h,bi.mk(e,oi.Const(ci.CMarkup(r)))}static splitSuffix(e,t,n){let r=a.substr(e,0,t),i=a.substr(e,t,null);return r.endsWith("_")&&(r=a.substr(r,0,r.length-1)),n?oi.Const(ci.CInt(r,i)):oi.Const(ci.CFloat(r,i))}static splitIntSuffix(e){let t=e.indexOf("i");return t<=0&&(t=e.indexOf("u")),t<=0?oi.Const(ci.CInt(e)):bi.splitSuffix(e,t,!0)}static splitFloatSuffix(e){let t=e.indexOf("f");return t<=0?oi.Const(ci.CFloat(e)):bi.splitSuffix(e,t,!1)}static unescape(e,t){let n="",r=0,i=!1;for(;e.length!=r;){let l=a.cca(e,r);if(i){let o,c=r+1;if(null==l){if(o=l>=48&&l<=51,1!=o){let e=l;throw Me.thrown(new pi(di.UnknownEscapeSequence("\\"+String.fromCodePoint(e)),{file:t.file,min:t.min+r,max:t.min+r+1}))}c+=2}else switch(l){case 34:case 39:case 92:n+=String.fromCodePoint(l);break;case 110:n+="\n";break;case 114:n+="\r";break;case 116:n+="\t";break;case 117:if(o=l>=48&&l<=51,1==o)c+=2;else{let i;if("{"==e.charAt(r+1)){let n=e.indexOf("}",r+3);if(-1==n)throw Me.thrown(new pi(di.UnterminatedEscapeSequence,{file:t.file,min:t.min+r,max:t.min+r+2}));let l=n-(r+2),o=a.substr(e,r+2,l);if(!new s("^[0-9a-fA-F]+$","").match(o))throw Me.thrown(new pi(di.InvalidEscapeSequence("\\u{"+o+"}"),{file:t.file,min:t.min+r,max:t.min+r+(3+l)}));if(i=re.parseInt("0x"+o),i>1114111)throw Me.thrown(new pi(di.InvalidEscapeSequence("\\u{"+o+"}"),{file:t.file,min:t.min+r,max:t.min+r+(3+l)}));c+=2+l}else{let n=a.substr(e,r+1,4);if(!new s("^[0-9a-fA-F]{4}$","").match(n))throw Me.thrown(new pi(di.InvalidEscapeSequence("\\u"+n),{file:t.file,min:t.min+r,max:t.min+r+5}));i=re.parseInt("0x"+n),c+=4}n+=String.fromCodePoint(i)}break;case 120:if(o=l>=48&&l<=51,1==o)c+=2;else{let i=a.substr(e,r+1,2);if(!new s("^[0-9a-fA-F]{2}$","").match(i))throw Me.thrown(new pi(di.InvalidEscapeSequence("\\x"+i),{file:t.file,min:t.min+r,max:t.min+r+3}));let l=re.parseInt("0x"+i);n+=String.fromCodePoint(l),c+=2}break;default:if(o=l>=48&&l<=51,1!=o){let e=l;throw Me.thrown(new pi(di.UnknownEscapeSequence("\\"+String.fromCodePoint(e)),{file:t.file,min:t.min+r,max:t.min+r+1}))}c+=2}i=!1,r=c}else null==l?(n+=String.fromCodePoint(l),++r):92==l?(++r,i=!0):(n+=String.fromCodePoint(l),++r)}return n}}bi.__name__="haxeparser.HaxeLexer",bi.__interfaces__=[mi],bi.__super__=fi,Object.assign(bi.prototype,{__class__:bi});class Ti{constructor(e,t){this.message=e,this.pos=t}}Ti.__name__="hxjsonast.Error",Object.assign(Ti.prototype,{__class__:Ti});class Si{constructor(e,t){this.value=e,this.pos=t}}Si.__name__="hxjsonast.Json",Object.assign(Si.prototype,{__class__:Si});var Ci=r["hxjsonast.JsonValue"]={__ename__:!0,__constructs__:null,JString:(t=function(e){return{_hx_index:0,s:e,__enum__:"hxjsonast.JsonValue",toString:n,__params__:function(){return[this.s]}}},t._hx_name="JString",t),JNumber:(t=function(e){return{_hx_index:1,s:e,__enum__:"hxjsonast.JsonValue",toString:n,__params__:function(){return[this.s]}}},t._hx_name="JNumber",t),JObject:(t=function(e){return{_hx_index:2,fields:e,__enum__:"hxjsonast.JsonValue",toString:n,__params__:function(){return[this.fields]}}},t._hx_name="JObject",t),JArray:(t=function(e){return{_hx_index:3,values:e,__enum__:"hxjsonast.JsonValue",toString:n,__params__:function(){return[this.values]}}},t._hx_name="JArray",t),JBool:(t=function(e){return{_hx_index:4,b:e,__enum__:"hxjsonast.JsonValue",toString:n,__params__:function(){return[this.b]}}},t._hx_name="JBool",t),JNull:{_hx_name:"JNull",_hx_index:5,__enum__:"hxjsonast.JsonValue",toString:n}};Ci.__constructs__=[Ci.JString,Ci.JNumber,Ci.JObject,Ci.JArray,Ci.JBool,Ci.JNull];class vi{constructor(e,t,n){this.name=e,this.namePos=t,this.value=n}}vi.__name__="hxjsonast.JObjectField",Object.assign(vi.prototype,{__class__:vi});class Pi{constructor(e,t){this.source=e,this.filename=t,this.pos=0}doParse(){let e,t=this.parseRec();for(;e=this.source.charCodeAt(this.pos++),e==e;)switch(e){case 9:case 10:case 13:case 32:break;default:this.invalidChar()}return t}parseRec(){for(;;){let e=this.source.charCodeAt(this.pos++);switch(e){case 9:case 10:case 13:case 32:break;case 34:let t=this.pos;return new Si(Ci.JString(this.parseString()),new Li(this.filename,t-1,this.pos));case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:let n=this.pos-1,r=45==e,i=!r,s=48==e,l=!1,o=!1,c=!1,u=!1;do{switch(this.source.charCodeAt(this.pos++)){case 43:case 45:o&&!c||this.invalidNumber(n),i=!1,c=!0;break;case 46:(r||l||o)&&this.invalidNumber(n),i=!1,l=!0;break;case 48:s&&!l&&this.invalidNumber(n),r&&(r=!1,s=!0),i=!0;break;case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:s&&!l&&this.invalidNumber(n),r&&(r=!1),i=!0,s=!1;break;case 69:case 101:(r||s||o)&&this.invalidNumber(n),i=!1,o=!0;break;default:i||this.invalidNumber(n),this.pos--,u=!0}}while(!u);return new Si(Ci.JNumber(a.substr(this.source,n,this.pos-n)),new Li(this.filename,n,this.pos));case 91:let h=[],d=null,p=this.pos-1;for(;;)switch(this.source.charCodeAt(this.pos++)){case 9:case 10:case 13:case 32:break;case 44:d?d=!1:this.invalidChar();break;case 93:return 0==d&&this.invalidChar(),new Si(Ci.JArray(h),new Li(this.filename,p,this.pos));default:d&&this.invalidChar(),this.pos--,h.push(this.parseRec()),d=!0}break;case 102:let f=this.pos;return 97==this.source.charCodeAt(this.pos++)&&108==this.source.charCodeAt(this.pos++)&&115==this.source.charCodeAt(this.pos++)&&101==this.source.charCodeAt(this.pos++)||(this.pos=f,this.invalidChar()),new Si(Ci.JBool(!1),new Li(this.filename,f-1,this.pos));case 110:let m=this.pos;return 117==this.source.charCodeAt(this.pos++)&&108==this.source.charCodeAt(this.pos++)&&108==this.source.charCodeAt(this.pos++)||(this.pos=m,this.invalidChar()),new Si(Ci.JNull,new Li(this.filename,m-1,this.pos));case 116:let _=this.pos;return 114==this.source.charCodeAt(this.pos++)&&117==this.source.charCodeAt(this.pos++)&&101==this.source.charCodeAt(this.pos++)||(this.pos=_,this.invalidChar()),new Si(Ci.JBool(!0),new Li(this.filename,_-1,this.pos));case 123:let g=[],x=new Map,k=null,y=null,w=null,b=this.pos-1;for(;;)switch(this.source.charCodeAt(this.pos++)){case 9:case 10:case 13:case 32:break;case 34:(null!=k||w)&&this.invalidChar();let e=this.pos-1;if(k=this.parseString(),y=new Li(this.filename,e,this.pos),x.has(k))throw Me.thrown(new Ti('Duplicate field name "'+k+'"',y));x.set(k,!0);break;case 44:w?w=!1:this.invalidChar();break;case 58:null==k&&this.invalidChar(),g.push(new vi(k,y,this.parseRec())),k=null,y=null,w=!0;break;case 125:return null==k&&0!=w||this.invalidChar(),new Si(Ci.JObject(g),new Li(this.filename,b,this.pos));default:this.invalidChar()}break;default:this.invalidChar()}}}parseString(){let e=this.pos,t=null;for(;;){let n=this.source.charCodeAt(this.pos++);if(34==n)break;if(92==n){null==t&&(t=new ie);let r=this.source,i=this.pos-e-1;switch(t.b+=null==i?a.substr(r,e,null):a.substr(r,e,i),n=this.source.charCodeAt(this.pos++),n){case 34:case 47:case 92:t.b+=String.fromCodePoint(n);break;case 98:t.b+=String.fromCodePoint(8);break;case 102:t.b+=String.fromCodePoint(12);break;case 110:t.b+=String.fromCodePoint(10);break;case 114:t.b+=String.fromCodePoint(13);break;case 116:t.b+=String.fromCodePoint(9);break;case 117:let e=re.parseInt("0x"+a.substr(this.source,this.pos,4));this.pos+=4,t.b+=String.fromCodePoint(e);break;default:throw Me.thrown(new Ti("Invalid escape sequence \\"+String.fromCodePoint(n),new Li(this.filename,this.pos-2,this.pos)))}e=this.pos}else if(n!=n)throw this.pos--,Me.thrown(new Ti("Unclosed string",new Li(this.filename,e-1,this.pos)))}if(null==t)return a.substr(this.source,e,this.pos-e-1);{let n=this.source,r=this.pos-e-1;return t.b+=null==r?a.substr(n,e,null):a.substr(n,e,r),t.b}}invalidChar(){throw this.pos--,Me.thrown(new Ti("Invalid character: "+this.source.charAt(this.pos),new Li(this.filename,this.pos,this.pos+1)))}invalidNumber(e){throw Me.thrown(new Ti("Invalid number: "+this.source.substring(e,this.pos),new Li(this.filename,e,this.pos)))}}Pi.__name__="hxjsonast.Parser",Object.assign(Pi.prototype,{__class__:Pi});class Li{constructor(e,t,n){this.file=e,this.min=t,this.max=n}}Li.__name__="hxjsonast.Position",Object.assign(Li.prototype,{__class__:Li});class Ai{constructor(e){this.pos=e}toString(){return"Parser error"}}Ai.__name__="hxparse.ParserError",Object.assign(Ai.prototype,{__class__:Ai});class Fi{constructor(){this.finalId=-1,this.trans=new Array(256)}}Fi.__name__="hxparse.State",Object.assign(Fi.prototype,{__class__:Fi});class Ni extends Ai{constructor(e,t){super(t),this.char=e}toString(){return"Unexpected "+this.char}}Ni.__name__="hxparse.UnexpectedChar",Ni.__super__=Ai,Object.assign(Ni.prototype,{__class__:Ni});class Ii{constructor(e){this.jsIterator=e,this.lastStep=e.next()}hasNext(){return!this.lastStep.done}next(){let e=this.lastStep.value;return this.lastStep=this.jsIterator.next(),e}}Ii.__name__="js.lib.HaxeIterator",Object.assign(Ii.prototype,{__class__:Ii});var Oi=require("child_process"),Ei=require("fs"),Di=require("net"),Bi=require("path");class Ri{static bytesOfBuffer(e){let t=Object.create(it.prototype);return t.length=e.byteLength,t.b=e,e.bufferValue=e,e.hxBytes=t,e.bytes=e,t}}Ri.__name__="js.node.buffer._Buffer.Helper";var ji=r["json2object.Error"]={__ename__:!0,__constructs__:null,IncorrectType:(t=function(e,t,r){return{_hx_index:0,variable:e,expected:t,pos:r,__enum__:"json2object.Error",toString:n,__params__:function(){return[this.variable,this.expected,this.pos]}}},t._hx_name="IncorrectType",t),IncorrectEnumValue:(t=function(e,t,r){return{_hx_index:1,value:e,expected:t,pos:r,__enum__:"json2object.Error",toString:n,__params__:function(){return[this.value,this.expected,this.pos]}}},t._hx_name="IncorrectEnumValue",t),InvalidEnumConstructor:(t=function(e,t,r){return{_hx_index:2,value:e,expected:t,pos:r,__enum__:"json2object.Error",toString:n,__params__:function(){return[this.value,this.expected,this.pos]}}},t._hx_name="InvalidEnumConstructor",t),UninitializedVariable:(t=function(e,t){return{_hx_index:3,variable:e,pos:t,__enum__:"json2object.Error",toString:n,__params__:function(){return[this.variable,this.pos]}}},t._hx_name="UninitializedVariable",t),UnknownVariable:(t=function(e,t){return{_hx_index:4,variable:e,pos:t,__enum__:"json2object.Error",toString:n,__params__:function(){return[this.variable,this.pos]}}},t._hx_name="UnknownVariable",t),ParserError:(t=function(e,t){return{_hx_index:5,message:e,pos:t,__enum__:"json2object.Error",toString:n,__params__:function(){return[this.message,this.pos]}}},t._hx_name="ParserError",t),CustomFunctionException:(t=function(e,t){return{_hx_index:6,e:e,pos:t,__enum__:"json2object.Error",toString:n,__params__:function(){return[this.e,this.pos]}}},t._hx_name="CustomFunctionException",t)};ji.__constructs__=[ji.IncorrectType,ji.IncorrectEnumValue,ji.InvalidEnumConstructor,ji.UninitializedVariable,ji.UnknownVariable,ji.ParserError,ji.CustomFunctionException];var Mi=r["json2object.InternalError"]={__ename__:!0,__constructs__:null,AbstractNoJsonRepresentation:(t=function(e){return{_hx_index:0,name:e,__enum__:"json2object.InternalError",toString:n,__params__:function(){return[this.name]}}},t._hx_name="AbstractNoJsonRepresentation",t),CannotGenerateSchema:(t=function(e){return{_hx_index:1,name:e,__enum__:"json2object.InternalError",toString:n,__params__:function(){return[this.name]}}},t._hx_name="CannotGenerateSchema",t),HandleExpr:{_hx_name:"HandleExpr",_hx_index:2,__enum__:"json2object.InternalError",toString:n},ParsingThrow:{_hx_name:"ParsingThrow",_hx_index:3,__enum__:"json2object.InternalError",toString:n},UnsupportedAbstractEnumType:(t=function(e){return{_hx_index:4,name:e,__enum__:"json2object.InternalError",toString:n,__params__:function(){return[this.name]}}},t._hx_name="UnsupportedAbstractEnumType",t),UnsupportedEnumAbstractValue:(t=function(e){return{_hx_index:5,name:e,__enum__:"json2object.InternalError",toString:n,__params__:function(){return[this.name]}}},t._hx_name="UnsupportedEnumAbstractValue",t),UnsupportedMapKeyType:(t=function(e){return{_hx_index:6,name:e,__enum__:"json2object.InternalError",toString:n,__params__:function(){return[this.name]}}},t._hx_name="UnsupportedMapKeyType",t),UnsupportedSchemaObjectType:(t=function(e){return{_hx_index:7,name:e,__enum__:"json2object.InternalError",toString:n,__params__:function(){return[this.name]}}},t._hx_name="UnsupportedSchemaObjectType",t),UnsupportedSchemaType:(t=function(e){return{_hx_index:8,type:e,__enum__:"json2object.InternalError",toString:n,__params__:function(){return[this.type]}}},t._hx_name="UnsupportedSchemaType",t)};Mi.__constructs__=[Mi.AbstractNoJsonRepresentation,Mi.CannotGenerateSchema,Mi.HandleExpr,Mi.ParsingThrow,Mi.UnsupportedAbstractEnumType,Mi.UnsupportedEnumAbstractValue,Mi.UnsupportedMapKeyType,Mi.UnsupportedSchemaObjectType,Mi.UnsupportedSchemaType];class Hi{constructor(e){this.linesInfo=[];let t=0,n=0,r=0,i=0;for(;r<e.length;)switch(e.charAt(r)){case"\n":n=r,this.linesInfo.push({number:i,start:t,end:n}),++i,++r,t=r;break;case"\r":n=r,"\n"==e.charAt(r+1)&&++n,this.linesInfo.push({number:i,start:t,end:n}),++i,r=n+1,t=r;break;default:++r}this.linesInfo.push({number:i,start:t,end:r})}convertPosition(e){let t=e.min,n=e.max,r={file:e.file,min:t+1,max:n+1,lines:[]},i=0,s=this.linesInfo.length-1;if(t>this.linesInfo[0].end)for(;s>i;){let e=(i+s)/2|0,n=this.linesInfo[e];n.start==t&&(i=e,s=e),n.end<t&&(i=e+1),(n.start>t||n.end>=t&&n.start<t)&&(s=e)}let a=i,l=this.linesInfo.length;for(;a<l;){let e=this.linesInfo[a++];if(e.start<=t&&e.end>=n){r.lines.push({number:e.number+1,start:t-e.start+1,end:n-e.start+1});break}if(e.start<=t&&t<=e.end&&r.lines.push({number:e.number+1,start:t-e.start+1,end:e.end+1}),e.start<=n&&n<=e.end&&r.lines.push({number:e.number+1,start:e.start+1,end:n-e.start+1}),e.start>=n||e.end>=n)break}return r}}Hi.__name__="json2object.PositionUtils",Object.assign(Hi.prototype,{__class__:Hi});class Wi{constructor(){this.canceled=!1}}Wi.__name__="jsonrpc._CancellationToken.CancellationTokenImpl",Object.assign(Wi.prototype,{__class__:Wi});class Ui{static errorToString(e,t){let n=t+re.string(e),r=Re.exceptionStack();return null!=r&&r.length>0&&(n+="\n"+Re.toString(r)),n}}Ui.__name__="jsonrpc.ErrorUtils";class Ji{constructor(e){this.writeMessage=e,this.requestTokens=new tt,this.nextRequestId=0,this.requestHandlers=new tt,this.notificationHandlers=new tt,this.progressHandlers=new Ye,this.responseCallbacks=new Qe;let t=this;this.onNotification("$/progress",(function(e){let n=t.progressHandlers.m.get(e.token);null!=n&&n(e.value)}))}handleMessage(e){(Object.prototype.hasOwnProperty.call(e,"result")||Object.prototype.hasOwnProperty.call(e,"error"))&&Object.prototype.hasOwnProperty.call(e,"id")?this.handleResponse(e):Object.prototype.hasOwnProperty.call(e,"method")&&(Object.prototype.hasOwnProperty.call(e,"id")?this.handleRequest(e):this.handleNotification(e))}onRequest(e,t){this.requestHandlers.m.set(e,t)}onNotification(e,t){this.notificationHandlers.m.set(e,t)}handleRequest(e){let t=re.string(e.id),n=this,r=function(r){n.requestTokens.m.delete(t);let i={jsonrpc:"2.0",id:e.id,result:r};n.writeMessage(i,null),null!=n.didRespondToRequest&&n.didRespondToRequest(e,i)},i=function(r){n.requestTokens.m.delete(t),n.writeMessage({jsonrpc:"2.0",id:e.id,error:r},null)},s=this.requestHandlers.m.get(e.method);if(null==s){let t=i,n=null,r={code:-32601,message:"Unhandled method "+e.method};return null!=n&&(r.data=n),void t(r)}let a=new Wi;this.requestTokens.m.set(t,a);try{s(e.params,a,r,i)}catch(n){We.lastError=n;let r=Me.caught(n).unwrap();this.requestTokens.m.delete(t);let s=Ui.errorToString(r,"Exception while handling request "+e.method+": "),a=i,l=null,o={code:-32603,message:s};null!=l&&(o.data=l),a(o),this.logError(s)}}handleNotification(e){if("$/cancelRequest"==e.method){let t=re.string(e.params.id),n=this.requestTokens.m.get(t);null!=n&&(this.requestTokens.m.delete(t),n.canceled||(n.canceled=!0,null!=n.callback&&n.callback()))}else{let t=this.notificationHandlers.m.get(e.method);if(null==t)return;try{t(e.params)}catch(t){We.lastError=t;let n=Me.caught(t).unwrap();this.logError(Ui.errorToString(n,"Exception while processing notification "+e.method+": "))}}}handleResponse(e){let t=e.id;if("number"!=typeof t||(0|t)!==t)return void this.logError("Got response with non-integer id:\n"+JSON.stringify(e,null,"    "));let n=this.responseCallbacks.m.get(e.id);if(null!=n){this.responseCallbacks.m.delete(e.id);try{Object.prototype.hasOwnProperty.call(e,"error")?null!=n.reject&&n.reject(e.error):null!=n.resolve&&n.resolve(e.result)}catch(e){We.lastError=e;let t=Me.caught(e).unwrap();this.logError(Ui.errorToString(t,"Exception while handing response "+n.method+": "))}}}sendRequest(e,t,n,r,i){let s=this.nextRequestId++,a={jsonrpc:"2.0",id:s,method:e};null!=t&&(a.params=t),this.responseCallbacks.m.set(s,new Vi(e,r,i));let l=this;null!=n&&(n.callback=function(){let e={id:s},t={jsonrpc:"2.0",method:"$/cancelRequest"};null!=e&&(t.params=e),l.writeMessage(t,null),null!=l.didSendNotification&&l.didSendNotification(t)}),this.writeMessage(a,n)}logError(e){}}Ji.__name__="jsonrpc.Protocol",Object.assign(Ji.prototype,{__class__:Ji});class Vi{constructor(e,t,n){this.method=e,this.resolve=t,this.reject=n}}Vi.__name__="jsonrpc._Protocol.ResponseCallbackEntry",Object.assign(Vi.prototype,{__class__:Vi}),(r["jsonrpc.NoData"]={__ename__:!0,__constructs__:null}).__constructs__=[];class Ki{constructor(e,t){null==t&&(t="utf-8"),this.readable=e,this.buffer=new Gi(t)}listen(e){this.nextMessageLength=-1,this.callback=e,this.readable.on("data",nl(this,this.onData))}onData(e){for(this.buffer.append(e);;){if(-1==this.nextMessageLength){let e=this.buffer.tryReadHeaders();if(null==e)return;let t=e.m.get("Content-Length");if(null==t)throw Me.thrown("Header must provide a Content-Length property.");let n=re.parseInt(t);if(null==n)throw Me.thrown("Content-Length value must be a number.");this.nextMessageLength=n}let e=this.buffer.tryReadContent(this.nextMessageLength);if(null==e)return;this.nextMessageLength=-1;let t=JSON.parse(e);this.callback(t)}}}Ki.__name__="jsonrpc.node.MessageReader",Object.assign(Ki.prototype,{__class__:Ki});class Gi{constructor(e){null==e&&(e="utf-8"),this.encoding=e,this.index=0,this.buffer=jr.alloc(8192)}append(e){let t;if("string"==typeof e){let n=e;t=jr.alloc(n.length),t.write(n,0,n.length,this.encoding)}else t=e;if(this.buffer.length-this.index>=t.length)t.copy(this.buffer,this.index,0,t.length);else{let e=8192*(Math.ceil((this.index+t.length)/8192)+1);0==this.index?(this.buffer=jr.alloc(e),t.copy(this.buffer,0,0,t.length)):this.buffer=jr.concat([this.buffer.slice(0,this.index),t],e)}this.index+=t.length}tryReadHeaders(){let e=0;for(;e+3<this.index&&(this.buffer[e]!=Gi.CR||this.buffer[e+1]!=Gi.LF||this.buffer[e+2]!=Gi.CR||this.buffer[e+3]!=Gi.LF);)++e;if(e+3>=this.index)return null;let t=new tt,n=this.buffer.toString("ascii",0,e).split("\r\n"),r=0;for(;r<n.length;){let e=n[r];++r;let i=e.indexOf(":");if(-1==i)throw Me.thrown("Message header must separate key and value using :");t.m.set(a.substr(e,0,i),se.trim(a.substr(e,i+1,null)))}let i=e+4;return this.buffer=this.buffer.slice(i),this.index-=i,t}tryReadContent(e){if(this.index<e)return null;let t=this.buffer.toString(this.encoding,0,e);return this.buffer.copy(this.buffer,0,e),this.index-=e,t}}Gi.__name__="jsonrpc.node._MessageReader.MessageBuffer",Object.assign(Gi.prototype,{__class__:Gi});class qi{constructor(e,t){null==t&&(t="utf8"),this.writable=e,this.encoding=t}write(e,t){let n=JSON.stringify(e),r=jr.byteLength(n,this.encoding);this.writable.write("Content-Length: ","ascii"),this.writable.write(""+r,"ascii"),this.writable.write("\r\n"),this.writable.write("\r\n"),this.writable.write(n,this.encoding)}}qi.__name__="jsonrpc.node.MessageWriter",Object.assign(qi.prototype,{__class__:qi}),(r["languageServerProtocol.protocol.Never"]={__ename__:!0,__constructs__:null}).__constructs__=[];class $i{static typeToString(e){switch(e._hx_index){case 17:let t=e.isStatic;return"FieldVar("+(null==t?"null":""+t)+")";case 18:let n=e.isStatic;return"Method("+(null==n?"null":""+n)+")";case 21:let r=e.fields,i=[];for(;0<r.length;){let e=r[0];switch(e._hx_index){case 0:case 1:return e.identifier.name}}return"TypedefField("+i.join(", ")+")";case 22:return"StructureField("+re.string(e.fieldNames)+")";case 27:let s=e.params,a=new Array(s.length),l=0,o=s.length;for(;l<o;){let e=l++;a[e]='"'+s[e].name+'"'}return"EnumField("+re.string(a)+")";case 28:return"CaseLabel("+e.switchIdentifier.name+")";case 33:return"ScopedLocal("+e.scopeStart+" - "+e.scopeEnd+", "+$i.scopeTypeToString(e.scopeType)+")";default:return""+re.string(e)}}static scopeTypeToString(e){switch(e._hx_index){case 0:let t=e.params,n=new Array(t.length),r=0,i=t.length;for(;r<i;){let e=r++;n[e]='"'+t[e].name+'"'}return"Parameter("+re.string(n)+")";case 3:let s=e.loopIdentifiers,a=new Array(s.length),l=0,o=s.length;for(;l<o;){let e=l++;a[e]='"'+s[e].name+'"'}return"ForLoop("+re.string(a)+")";default:return""+re.string(e)}}static printTypeHint(e){switch(e._hx_index){case 0:let t=e.type,n=e.typeParams;if(n.length>0){let e=new Array(n.length),r=0,i=n.length;for(;r<i;){let t=r++;e[t]=$i.printTypeHint(n[t])}return t.name.name+"<"+e.join(", ")+">"}return""+t.name.name;case 1:let r=e.name,i=e.typeParams;if(i.length>0){let e=new Array(i.length),t=0,n=i.length;for(;t<n;){let n=t++;e[n]=$i.printTypeHint(i[n])}return r+"<"+e.join(", ")+">"}return""+r;case 2:let s=e.args,a=e.retVal,l=new Array(s.length),o=0,c=s.length;for(;o<c;){let e=o++;l[e]=$i.printTypeHint(s[e])}return null==s?"("+l.join(", ")+") -> Void":1==s.length?l.join(", ")+" -> "+$i.printTypeHint(a):"("+l.join(", ")+") -> "+$i.printTypeHint(a);case 3:let u=e.fields,h=new Array(u.length),d=0,p=u.length;for(;d<p;){let e=d++;h[e]=$i.printTypeHint(u[e])}return"{"+h.join(", ")+"}";case 4:return e.name+":"+$i.printTypeHint(e.typeHint);case 5:return""+e.name}}static printRenameResult(e){switch(e._hx_index){case 0:return"nothing to do";case 1:return"could not find identifier to rename";case 2:return"renaming not supported for "+e.name;case 3:return"dry run - no changes were made";case 4:return"rename successful"}}}$i.__name__="refactor.PrintHelper";var zi=r["refactor.RefactorResult"]={__ename__:!0,__constructs__:null,NoChange:{_hx_name:"NoChange",_hx_index:0,__enum__:"refactor.RefactorResult",toString:n},NotFound:{_hx_name:"NotFound",_hx_index:1,__enum__:"refactor.RefactorResult",toString:n},Unsupported:(t=function(e){return{_hx_index:2,name:e,__enum__:"refactor.RefactorResult",toString:n,__params__:function(){return[this.name]}}},t._hx_name="Unsupported",t),DryRun:{_hx_name:"DryRun",_hx_index:3,__enum__:"refactor.RefactorResult",toString:n},Done:{_hx_name:"Done",_hx_index:4,__enum__:"refactor.RefactorResult",toString:n}};zi.__constructs__=[zi.NoChange,zi.NotFound,zi.Unsupported,zi.DryRun,zi.Done];class Qi{static canRefactor(e,t,n){switch(e._hx_index){case 0:return ys.canRefactor(t,n);case 1:return ws.canRefactor(t,n);case 2:return bs.canRefactor(t,n);case 3:return ks.canRefactor(t,n,e.asFinal);case 4:return Cs.canRefactor(t,n,e.toFinals);case 5:return vs.canRefactor(t,n)}}static doRefactor(e,t){switch(e._hx_index){case 0:return ys.doRefactor(t);case 1:return ws.doRefactor(t);case 2:return bs.doRefactor(t);case 3:return ks.doRefactor(t,e.asFinal);case 4:return Cs.doRefactor(t,e.toFinals);case 5:return vs.doRefactor(t)}}}Qi.__name__="refactor.Refactoring";class Zi{static canRename(e){let t=e.fileList.getFile(e.what.fileName);if(null==t)return Promise.reject($i.printRenameResult(zi.NotFound));let n=t.getIdentifier(e.what.pos);if(null==n)return Promise.reject($i.printRenameResult(zi.NotFound));let r=n.type;switch(r._hx_index){case 17:case 18:case 21:case 22:case 0:case 2:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 16:case 23:case 24:case 25:case 27:case 33:return Promise.resolve({name:n.name,pos:n.pos});case 28:case 1:case 3:case 11:case 12:case 13:case 14:case 15:case 19:case 20:case 26:case 34:case 35:return Promise.reject($i.printRenameResult(zi.Unsupported(n.toString())));case 29:if(r.isNew)return Promise.reject($i.printRenameResult(zi.Unsupported(n.toString())));{let r=Zi.findActualWhat(e,t,n);return null==r?Promise.reject($i.printRenameResult(zi.Unsupported(n.toString()))):n.name.startsWith(r.name)?Promise.resolve({name:r.name,pos:{fileName:n.pos.fileName,start:n.pos.start,end:n.pos.start+e.what.toName.length}}):n.name.endsWith(r.name)?Promise.resolve({name:r.name,pos:{fileName:n.pos.fileName,start:n.pos.end-e.what.toName.length,end:n.pos.end}}):Promise.reject($i.printRenameResult(zi.Unsupported(n.toString())))}case 30:let i=Zi.findActualWhat(e,t,n);return null==i?Promise.reject($i.printRenameResult(zi.Unsupported(n.toString()))):n.name.startsWith(i.name)?Promise.resolve({name:i.name,pos:{fileName:n.pos.fileName,start:n.pos.start,end:n.pos.start+e.what.toName.length}}):n.name.endsWith(i.name)?Promise.resolve({name:i.name,pos:{fileName:n.pos.fileName,start:n.pos.end-e.what.toName.length,end:n.pos.end}}):Promise.reject($i.printRenameResult(zi.Unsupported(n.toString())));case 31:case 32:let s=Zi.findActualWhat(e,t,n);return null==s?Promise.reject($i.printRenameResult(zi.Unsupported(n.toString()))):n.name.startsWith(s.name)?Promise.resolve({name:s.name,pos:{fileName:n.pos.fileName,start:n.pos.start,end:n.pos.start+e.what.toName.length}}):n.name.endsWith(s.name)?Promise.resolve({name:s.name,pos:{fileName:n.pos.fileName,start:n.pos.end-e.what.toName.length,end:n.pos.end}}):Promise.reject($i.printRenameResult(zi.Unsupported(n.toString())))}}static rename(e){for(;;){let t=e.fileList.getFile(e.what.fileName);if(null==t)return Promise.reject($i.printRenameResult(zi.NotFound));let n=t.getIdentifier(e.what.pos);if(null==n)return Promise.reject($i.printRenameResult(zi.NotFound));if(n.name==e.what.toName)return Promise.reject($i.printRenameResult(zi.NotFound));let r=n.type;switch(r._hx_index){case 0:return e.verboseLog('rename package name "'+n.name+'" to "'+e.what.toName+'"',{fileName:"refactor/Rename.hx",lineNumber:75,className:"refactor.Rename",methodName:"rename"}),Us.refactorPackageName(e,t,n);case 2:return e.verboseLog('rename import alias "'+n.name+'" to "'+e.what.toName+'"',{fileName:"refactor/Rename.hx",lineNumber:80,className:"refactor.Rename",methodName:"rename"}),Hs.refactorImportAlias(e,t,n);case 1:case 3:case 19:case 20:case 28:case 11:case 12:case 13:case 14:case 15:case 26:case 34:case 35:return Promise.reject($i.printRenameResult(zi.Unsupported(n.toString())));case 4:case 5:case 6:case 7:case 8:return e.verboseLog('rename type name "'+n.name+'" to "'+e.what.toName+'"',{fileName:"refactor/Rename.hx",lineNumber:83,className:"refactor.Rename",methodName:"rename"}),Vs.refactorTypeName(e,t,n);case 9:case 10:return e.verboseLog('rename module level static "'+n.name+'" to "'+e.what.toName+'"',{fileName:"refactor/Rename.hx",lineNumber:86,className:"refactor.Rename",methodName:"rename"}),Ws.refactorModuleLevelStatic(e,t,n);case 16:return e.verboseLog('rename property "'+n.name+'" to "'+e.what.toName+'"',{fileName:"refactor/Rename.hx",lineNumber:91,className:"refactor.Rename",methodName:"rename"}),js.refactorField(e,t,n,!1);case 17:let i=r.isStatic;return e.verboseLog("rename "+(i?"static ":"")+'field "'+n.name+'" to "'+e.what.toName+'"',{fileName:"refactor/Rename.hx",lineNumber:94,className:"refactor.Rename",methodName:"rename"}),js.refactorField(e,t,n,i);case 18:let s=r.isStatic;return e.verboseLog("rename "+(s?"static ":"")+'class method "'+n.name+'" to "'+e.what.toName+'"',{fileName:"refactor/Rename.hx",lineNumber:97,className:"refactor.Rename",methodName:"rename"}),js.refactorField(e,t,n,s);case 21:return Bs.refactorAnonStructField(e,t,n,r.fields);case 22:return Bs.refactorStructureField(e,t,n,r.fieldNames);case 23:case 24:case 25:return e.verboseLog('rename interface field "'+n.name+'" to "'+e.what.toName+'"',{fileName:"refactor/Rename.hx",lineNumber:108,className:"refactor.Rename",methodName:"rename"}),js.refactorField(e,t,n,!1);case 27:return e.verboseLog('rename enum field "'+n.name+'" to "'+e.what.toName+'"',{fileName:"refactor/Rename.hx",lineNumber:111,className:"refactor.Rename",methodName:"rename"}),Rs.refactorEnumField(e,t,n);case 29:if(r.isNew)return Promise.reject($i.printRenameResult(zi.Unsupported(n.toString())));{e.verboseLog('rename "'+n.name+'" at call/access location - trying to find definition',{fileName:"refactor/Rename.hx",lineNumber:116,className:"refactor.Rename",methodName:"rename"});let r=Zi.findActualWhat(e,t,n);if(null==r)return Promise.reject($i.printRenameResult(zi.Unsupported(n.toString())));e.what.pos=r.pos.start;continue}case 30:e.verboseLog('rename "'+n.name+'" at call/access location - trying to find definition',{fileName:"refactor/Rename.hx",lineNumber:116,className:"refactor.Rename",methodName:"rename"});let a=Zi.findActualWhat(e,t,n);if(null==a)return Promise.reject($i.printRenameResult(zi.Unsupported(n.toString())));e.what.pos=a.pos.start;continue;case 31:case 32:e.verboseLog('rename "'+n.name+'" at call/access location - trying to find definition',{fileName:"refactor/Rename.hx",lineNumber:116,className:"refactor.Rename",methodName:"rename"});let l=Zi.findActualWhat(e,t,n);if(null==l)return Promise.reject($i.printRenameResult(zi.Unsupported(n.toString())));e.what.pos=l.pos.start;continue;case 33:let o='rename scoped local "'+n.name+'" ('+$i.scopeTypeToString(r.scopeType)+') to "'+e.what.toName+'"';return e.verboseLog(o,{fileName:"refactor/Rename.hx",lineNumber:126,className:"refactor.Rename",methodName:"rename"}),Js.refactorScopedLocal(e,t,n,r.scopeStart,r.scopeEnd)}}}static findActualWhat(e,t,n){let r=n.name.split(".");if(r.length<=0)return null;let i=r.shift(),s=!1,a=0;if("this"==i&&(i=r.shift(),s=!0,a=5),e.what.pos>n.pos.start+i.length+a)return null;let l=t.findAllIdentifiers((function(e){return e.name==i})),o=null,c=0;for(;c<l.length;){let e=l[c];++c;let t=e.type;switch(t._hx_index){case 16:case 17:case 18:if(n.defineType.name!=e.defineType.name)continue;null==o&&(o=e);break;case 33:let r=t.scopeStart,i=t.scopeEnd;3==t.scopeType._hx_index?s&&s||r<n.pos.start&&n.pos.start<i&&(o=e):s||r<n.pos.start&&n.pos.start<i&&(o=e)}}return o}}Zi.__name__="refactor.Rename";class Xi{}Xi.__name__="refactor.cache.IFileCache",Xi.__isInterface__=!0,Object.assign(Xi.prototype,{__class__:Xi});class Yi{constructor(){this.files=new tt}clear(){this.files.m.clear()}storeFile(e){this.files.m.set(e.name,e)}invalidateFile(e,t,n){let r=this.files.m.get(e);null!=r&&(r.clear(),this.files.m.delete(e)),t.removeFile(e),n.removeFile(e)}getFile(e,t){let n=this.files.m.get(e);if(null==n)return null;let r=Ei.statSync(e);if(n.fileDate!=r.mtime.getTime()||n.fileSize!=r.size)return this.files.m.delete(e),null;null!=n.packageIdentifier&&t.addIdentifier(n.packageIdentifier);let i=0,s=n.importList;for(;i<s.length;){let e=s[i];++i,t.addIdentifier(e.moduleName),null!=e.alias&&t.addIdentifier(e.alias)}let a=0,l=n.typeList;for(;a<l.length;){let e=l[a];++a,t.addIdentifier(e.name);let n=0,r=e.uses;for(;n<r.length;)t.addIdentifier(r[n++])}return n}}Yi.__name__="refactor.cache.MemCache",Yi.__interfaces__=[Xi],Object.assign(Yi.prototype,{__class__:Yi});class es{constructor(e){this.name=e;let t=Ei.statSync(e);this.fileDate=t.mtime.getTime(),this.fileSize=t.size,this.importList=[],this.typeList=[]}initHeader(e,t,n){this.packageIdentifier=e,this.importList=t,this.importInsertPos=n}setTypes(e){this.typeList=e}getPackage(){return null!=this.packageIdentifier?this.packageIdentifier.name:""}importsModule(e,t,n){if(e.length<=0)return ts.Global;let r=e+"."+t,i=null,s=!0;t!=n&&(i=r+"."+n,s=!1);let a=0,l=this.importList;for(;a<l.length;){let t=l[a];if(++a,t.moduleName.name==r)return null!=t.alias?ts.ImportedWithAlias(t.alias.name):ts.Imported;if(t.moduleName.name==i)return null!=t.alias?ts.ImportedWithAlias(t.alias.name):ts.Imported;if(s&&t.starImport&&t.moduleName.name==e)return ts.StarImported}if(this.getPackage().startsWith(e+"."))return ts.ParentPackage;if(null==this.importHxFile)return e==this.getPackage()||e==this.getPackage()?ts.SamePackage:ts.None;let o=this.importHxFile.importsModule(e,t,n);return o==ts.None&&e==this.getPackage()?ts.SamePackage:o}getMainModulName(){return new ot(this.name).file}getType(e){let t=0,n=this.typeList;for(;t<n.length;){let r=n[t];if(++t,r.name.name==e)return r}return null}getIdentifier(e){if(null!=this.packageIdentifier&&this.packageIdentifier.containsPos(e))return this.packageIdentifier;let t=0,n=this.importList;for(;t<n.length;){let r=n[t];if(++t,null!=r.alias&&r.alias.containsPos(e))return r.alias;if(r.moduleName.containsPos(e))return r.moduleName}let r=0,i=this.typeList;for(;r<i.length;){let t=i[r++].findIdentifier(e);if(null!=t)return t}return null}findAllIdentifiers(e){let t=[];null!=this.packageIdentifier&&e(this.packageIdentifier)&&t.push(this.packageIdentifier);let n=0,r=this.importList;for(;n<r.length;){let i=r[n];++n,null!=i.alias&&e(i.alias)&&t.push(i.alias),e(i.moduleName)&&t.push(i.moduleName)}let i=0,s=this.typeList;for(;i<s.length;)t=t.concat(s[i++].findAllIdentifiers(e));return t.sort(is.sortIdentifier),t}clear(){this.packageIdentifier=null,this.importHxFile=null,this.importList=[],this.typeList=[]}}es.__name__="refactor.discover.File",Object.assign(es.prototype,{__class__:es});var ts=r["refactor.discover.ImportStatus"]={__ename__:!0,__constructs__:null,None:{_hx_name:"None",_hx_index:0,__enum__:"refactor.discover.ImportStatus",toString:n},Global:{_hx_name:"Global",_hx_index:1,__enum__:"refactor.discover.ImportStatus",toString:n},SamePackage:{_hx_name:"SamePackage",_hx_index:2,__enum__:"refactor.discover.ImportStatus",toString:n},ParentPackage:{_hx_name:"ParentPackage",_hx_index:3,__enum__:"refactor.discover.ImportStatus",toString:n},Imported:{_hx_name:"Imported",_hx_index:4,__enum__:"refactor.discover.ImportStatus",toString:n},ImportedWithAlias:(t=function(e){return{_hx_index:5,alias:e,__enum__:"refactor.discover.ImportStatus",toString:n,__params__:function(){return[this.alias]}}},t._hx_name="ImportedWithAlias",t),StarImported:{_hx_name:"StarImported",_hx_index:6,__enum__:"refactor.discover.ImportStatus",toString:n}};ts.__constructs__=[ts.None,ts.Global,ts.SamePackage,ts.ParentPackage,ts.Imported,ts.ImportedWithAlias,ts.StarImported];var ns=r["refactor.discover.FileContentType"]={__ename__:!0,__constructs__:null,Text:(t=function(e){return{_hx_index:0,text:e,__enum__:"refactor.discover.FileContentType",toString:n,__params__:function(){return[this.text]}}},t._hx_name="Text",t),Token:(t=function(e,t){return{_hx_index:1,root:e,text:t,__enum__:"refactor.discover.FileContentType",toString:n,__params__:function(){return[this.root,this.text]}}},t._hx_name="Token",t)};ns.__constructs__=[ns.Text,ns.Token];class rs{constructor(){this.recentlyRenamed=[],this.files=new tt}addFile(e){this.files.m.set(e.name,e),a.remove(this.recentlyRenamed,e.name)}addRecentlyRenamed(e){this.recentlyRenamed.push(e.name)}wasRecentlyRenamed(e){return!!this.recentlyRenamed.includes(e)&&(a.remove(this.recentlyRenamed,e),!0)}getFile(e){return this.files.m.get(e)}removeFile(e){this.files.m.delete(e)}clear(){this.files.m.clear(),this.recentlyRenamed=[]}}rs.__name__="refactor.discover.FileList",Object.assign(rs.prototype,{__class__:rs});class is{constructor(e,t,n,r,i,s){this.type=e,this.name=t,this.pos=n,this.file=i,this.defineType=s,this.parent=null,this.typeHint=null,this.typeHintResolved=!1,null!=s&&s.addIdentifier(this),r.addIdentifier(this)}addUse(e){null!=e&&(null==this.uses&&(this.uses=[]),this.uses.includes(e)||this.uses.push(e),null==e.parent&&(e.parent=this))}containsPos(e){return this.pos.start<=e&&this.pos.end>=e}findIdentifier(e){if(this.containsPos(e))return this;if(null==this.uses)return null;let t=0,n=this.uses;for(;t<n.length;){let r=n[t++].findIdentifier(e);if(null!=r)return r}return null}findAllIdentifiers(e){let t=[];if(e(this)&&t.push(this),null==this.uses)return t;let n=0,r=this.uses;for(;n<r.length;)t=t.concat(r[n++].findAllIdentifiers(e));return t.sort(is.sortIdentifier),t}setTypeHint(e){this.typeHint=e,this.typeHintResolved=!1}getTypeHint(){if(null==this.uses)return null;let e=0,t=this.uses;for(;e<t.length;){let n=t[e];if(++e,26==n.type._hx_index)return n}return null}getTypeHintNew(e){return null==this.typeHint?null:(this.typeHintResolved||(this.typeHint=hs.resolveTypeHint(this.typeHint,e,this.file),this.typeHintResolved=!0),this.typeHint)}toString(){return this.name+" "+this.pos.fileName+"@"+this.pos.start+"-"+this.pos.end+" ("+$i.typeToString(this.type)+")"}static sortIdentifier(e,t){return e.pos.fileName<t.pos.fileName?-1:e.pos.fileName>t.pos.fileName?1:e.pos.start<t.pos.start?-1:e.pos.start>t.pos.start?1:0}}is.__name__="refactor.discover.Identifier",Object.assign(is.prototype,{__class__:is});var ss=r["refactor.discover.IdentifierType"]={__ename__:!0,__constructs__:null,PackageName:{_hx_name:"PackageName",_hx_index:0,__enum__:"refactor.discover.IdentifierType",toString:n},ImportModul:{_hx_name:"ImportModul",_hx_index:1,__enum__:"refactor.discover.IdentifierType",toString:n},ImportAlias:{_hx_name:"ImportAlias",_hx_index:2,__enum__:"refactor.discover.IdentifierType",toString:n},UsingModul:{_hx_name:"UsingModul",_hx_index:3,__enum__:"refactor.discover.IdentifierType",toString:n},Abstract:{_hx_name:"Abstract",_hx_index:4,__enum__:"refactor.discover.IdentifierType",toString:n},Class:{_hx_name:"Class",_hx_index:5,__enum__:"refactor.discover.IdentifierType",toString:n},Enum:{_hx_name:"Enum",_hx_index:6,__enum__:"refactor.discover.IdentifierType",toString:n},Interface:{_hx_name:"Interface",_hx_index:7,__enum__:"refactor.discover.IdentifierType",toString:n},Typedef:{_hx_name:"Typedef",_hx_index:8,__enum__:"refactor.discover.IdentifierType",toString:n},ModuleLevelStaticVar:{_hx_name:"ModuleLevelStaticVar",_hx_index:9,__enum__:"refactor.discover.IdentifierType",toString:n},ModuleLevelStaticMethod:{_hx_name:"ModuleLevelStaticMethod",_hx_index:10,__enum__:"refactor.discover.IdentifierType",toString:n},Extends:{_hx_name:"Extends",_hx_index:11,__enum__:"refactor.discover.IdentifierType",toString:n},Implements:{_hx_name:"Implements",_hx_index:12,__enum__:"refactor.discover.IdentifierType",toString:n},AbstractOver:{_hx_name:"AbstractOver",_hx_index:13,__enum__:"refactor.discover.IdentifierType",toString:n},AbstractFrom:{_hx_name:"AbstractFrom",_hx_index:14,__enum__:"refactor.discover.IdentifierType",toString:n},AbstractTo:{_hx_name:"AbstractTo",_hx_index:15,__enum__:"refactor.discover.IdentifierType",toString:n},Property:{_hx_name:"Property",_hx_index:16,__enum__:"refactor.discover.IdentifierType",toString:n},FieldVar:(t=function(e){return{_hx_index:17,isStatic:e,__enum__:"refactor.discover.IdentifierType",toString:n,__params__:function(){return[this.isStatic]}}},t._hx_name="FieldVar",t),Method:(t=function(e){return{_hx_index:18,isStatic:e,__enum__:"refactor.discover.IdentifierType",toString:n,__params__:function(){return[this.isStatic]}}},t._hx_name="Method",t),TypedParameter:{_hx_name:"TypedParameter",_hx_index:19,__enum__:"refactor.discover.IdentifierType",toString:n},TypedefBase:{_hx_name:"TypedefBase",_hx_index:20,__enum__:"refactor.discover.IdentifierType",toString:n},TypedefField:(t=function(e){return{_hx_index:21,fields:e,__enum__:"refactor.discover.IdentifierType",toString:n,__params__:function(){return[this.fields]}}},t._hx_name="TypedefField",t),StructureField:(t=function(e){return{_hx_index:22,fieldNames:e,__enum__:"refactor.discover.IdentifierType",toString:n,__params__:function(){return[this.fieldNames]}}},t._hx_name="StructureField",t),InterfaceProperty:{_hx_name:"InterfaceProperty",_hx_index:23,__enum__:"refactor.discover.IdentifierType",toString:n},InterfaceVar:{_hx_name:"InterfaceVar",_hx_index:24,__enum__:"refactor.discover.IdentifierType",toString:n},InterfaceMethod:{_hx_name:"InterfaceMethod",_hx_index:25,__enum__:"refactor.discover.IdentifierType",toString:n},TypeHint:{_hx_name:"TypeHint",_hx_index:26,__enum__:"refactor.discover.IdentifierType",toString:n},EnumField:(t=function(e){return{_hx_index:27,params:e,__enum__:"refactor.discover.IdentifierType",toString:n,__params__:function(){return[this.params]}}},t._hx_name="EnumField",t),CaseLabel:(t=function(e){return{_hx_index:28,switchIdentifier:e,__enum__:"refactor.discover.IdentifierType",toString:n,__params__:function(){return[this.switchIdentifier]}}},t._hx_name="CaseLabel",t),Call:(t=function(e){return{_hx_index:29,isNew:e,__enum__:"refactor.discover.IdentifierType",toString:n,__params__:function(){return[this.isNew]}}},t._hx_name="Call",t),ArrayAccess:(t=function(e){return{_hx_index:30,arrayIdentifier:e,__enum__:"refactor.discover.IdentifierType",toString:n,__params__:function(){return[this.arrayIdentifier]}}},t._hx_name="ArrayAccess",t),Access:{_hx_name:"Access",_hx_index:31,__enum__:"refactor.discover.IdentifierType",toString:n},ForIterator:{_hx_name:"ForIterator",_hx_index:32,__enum__:"refactor.discover.IdentifierType",toString:n},ScopedLocal:(t=function(e,t,r){return{_hx_index:33,scopeStart:e,scopeEnd:t,scopeType:r,__enum__:"refactor.discover.IdentifierType",toString:n,__params__:function(){return[this.scopeStart,this.scopeEnd,this.scopeType]}}},t._hx_name="ScopedLocal",t),StringConst:{_hx_name:"StringConst",_hx_index:34,__enum__:"refactor.discover.IdentifierType",toString:n},Meta:{_hx_name:"Meta",_hx_index:35,__enum__:"refactor.discover.IdentifierType",toString:n}};ss.__constructs__=[ss.PackageName,ss.ImportModul,ss.ImportAlias,ss.UsingModul,ss.Abstract,ss.Class,ss.Enum,ss.Interface,ss.Typedef,ss.ModuleLevelStaticVar,ss.ModuleLevelStaticMethod,ss.Extends,ss.Implements,ss.AbstractOver,ss.AbstractFrom,ss.AbstractTo,ss.Property,ss.FieldVar,ss.Method,ss.TypedParameter,ss.TypedefBase,ss.TypedefField,ss.StructureField,ss.InterfaceProperty,ss.InterfaceVar,ss.InterfaceMethod,ss.TypeHint,ss.EnumField,ss.CaseLabel,ss.Call,ss.ArrayAccess,ss.Access,ss.ForIterator,ss.ScopedLocal,ss.StringConst,ss.Meta];var as=r["refactor.discover.ScopedLocalType"]={__ename__:!0,__constructs__:null,Parameter:(t=function(e){return{_hx_index:0,params:e,__enum__:"refactor.discover.ScopedLocalType",toString:n,__params__:function(){return[this.params]}}},t._hx_name="Parameter",t),Var:{_hx_name:"Var",_hx_index:1,__enum__:"refactor.discover.ScopedLocalType",toString:n},CaseCapture:(t=function(e,t){return{_hx_index:2,origin:e,index:t,__enum__:"refactor.discover.ScopedLocalType",toString:n,__params__:function(){return[this.origin,this.index]}}},t._hx_name="CaseCapture",t),ForLoop:(t=function(e){return{_hx_index:3,loopIdentifiers:e,__enum__:"refactor.discover.ScopedLocalType",toString:n,__params__:function(){return[this.loopIdentifiers]}}},t._hx_name="ForLoop",t)};as.__constructs__=[as.Parameter,as.Var,as.CaseCapture,as.ForLoop];var ls=r["refactor.discover.TypedefFieldType"]={__ename__:!0,__constructs__:null,Required:(t=function(e){return{_hx_index:0,identifier:e,__enum__:"refactor.discover.TypedefFieldType",toString:n,__params__:function(){return[this.identifier]}}},t._hx_name="Required",t),Optional:(t=function(e){return{_hx_index:1,identifier:e,__enum__:"refactor.discover.TypedefFieldType",toString:n,__params__:function(){return[this.identifier]}}},t._hx_name="Optional",t)};ls.__constructs__=[ls.Required,ls.Optional];class os{constructor(){this.names=new tt,this.parts=new tt}getIdentifiers(e){let t=this.names.m.get(e);return null==t?[]:(t.sort(is.sortIdentifier),t)}getIdentifier(e,t,n){let r=this.names.m.get(e);if(null==r)return null;let i=0;for(;i<r.length;){let e=r[i];if(++i,e.file.name==t&&e.pos.start==n)return e}return null}addIdentifier(e){let t=function(t,n){let r=t.m.get(n);if(null==r)t.m.set(n,[e]);else{let t=0;for(;t<r.length;){let n=r[t];if(++t,n.pos.fileName==e.pos.fileName&&n.pos.start==e.pos.start)return}r.push(e)}};t(this.names,e.name);let n=e.name.split("."),r=0;for(;r<n.length;)t(this.parts,n[r++])}getStartsWith(e){let t=[],n=this.names.m.entries(),r=n.next();for(;!r.done;){let i=r.value;r=n.next();let s=i[1];i[0].startsWith(e)&&(t=t.concat(s))}return t.sort(is.sortIdentifier),t}matchIdentifierPart(e,t){let n=this.parts.m.get(e);return null==n?[]:(t&&n.sort(is.sortIdentifier),n)}removeFile(e){let t=new tt,n=this.names.m.entries(),r=n.next();for(;!r.done;){let i=r.value;r=n.next();let s=i[0],a=i[1],l=[],o=0;for(;o<a.length;){let t=a[o];++o,t.pos.fileName!=e&&l.push(t)}t.m.set(s,l)}this.names=t;let i=new tt,s=this.parts.m.entries(),a=s.next();for(;!a.done;){let t=a.value;a=s.next();let n=t[0],r=t[1],l=[],o=0;for(;o<r.length;){let t=r[o];++o,t.pos.fileName!=e&&l.push(t)}i.m.set(n,l)}this.parts=i}clear(){this.names.m.clear(),this.parts.m.clear()}}os.__name__="refactor.discover.NameMap",Object.assign(os.prototype,{__class__:os});class cs{static traverseSources(e,t){let n=0;for(;n<e.length;){let r=se.trim(e[n++]);if(zs.exists(r))if(zs.isDirectory(r)){let e=[],n=0,i=Ei.readdirSync(r);for(;n<i.length;)e.push(ot.join([r,i[n++]]));cs.traverseSources(e,t)}else r.endsWith(".hx")&&(t.fileName=r,cs.collectIdentifierData(t))}}static collectIdentifierData(e){let t=e.fileReader(e.fileName);switch(t._hx_index){case 0:e.usageCollector.parseFile(it.ofString(t.text),e);break;case 1:e.usageCollector.parseFileWithTokens(t.root,e)}}}cs.__name__="refactor.discover.TraverseSources";class us{constructor(e){this.file=e,this.nameMap=new os,this.uses=[]}get_fullModuleName(){return null==this.fullModuleName&&(this.fullModuleName=this.makeFullModuleName()),this.fullModuleName}makeFullModuleName(){let e=this.file.getMainModulName()+".";this.file.getMainModulName()==this.name.name&&(e="");let t=this.file.getPackage();return t.length<=0?e+this.name.name:t+"."+e+this.name.name}addIdentifier(e){this.nameMap.addIdentifier(e),this.uses.push(e)}getIdentifiers(e){return this.nameMap.getIdentifiers(e)}findIdentifier(e){let t=this.name.findIdentifier(e);if(null!=t)return t;let n=0,r=this.uses;for(;n<r.length;)if(t=r[n++].findIdentifier(e),null!=t)return t;return null}findAllIdentifiers(e){let t=[];e(this.name)&&(t=[this.name]);let n=0,r=this.uses;for(;n<r.length;){let i=r[n];++n,e(i)&&t.push(i)}return t.sort(is.sortIdentifier),t}getStartsWith(e){return this.nameMap.getStartsWith(e)}}us.__name__="refactor.discover.Type",Object.assign(us.prototype,{__class__:us});class hs{static makeTypeHint(e){if(null==e)return null;let t=e.tok;switch(t._hx_index){case 1:if(37==t.k._hx_index){let t=hs.findArrow(e);if(null!=t)switch(fa.getArrowType(t)._hx_index){case 0:return null;case 1:return hs.makeOldFunctionTypeHint(e);case 2:return hs.makeFunctionTypeHint(e)}return hs.makeLibTypeHint(e)}return null;case 2:if(3==t.c._hx_index){let t=hs.findArrow(e);if(null!=t)switch(fa.getArrowType(t)._hx_index){case 0:return null;case 1:return hs.makeOldFunctionTypeHint(e);case 2:return hs.makeFunctionTypeHint(e)}return hs.makeLibTypeHint(e)}return null;case 4:let n=hs.findArrow(e);if(null!=n)switch(fa.getArrowType(n)._hx_index){case 0:return null;case 1:return hs.makeOldFunctionTypeHint(e);case 2:return hs.makeFunctionTypeHint(e)}return hs.makeLibTypeHint(e);case 18:return hs.makeStructTypeHint(e);case 20:return hs.makeFunctionTypeHint(e);default:return null}}static findArrow(e){for(;null!=e;){let t=e.tok;switch(t._hx_index){case 1:switch(t.k._hx_index){case 37:case 41:e=e.getFirstChild();break;default:return null}break;case 2:if(3!=t.c._hx_index)return null;e=e.getFirstChild();break;case 4:case 11:case 12:e=e.getFirstChild();break;case 6:switch(t.op._hx_index){case 4:case 20:default:return null;case 9:e=e.nextSibling}break;case 7:case 8:case 10:case 15:default:return null;case 14:return e}}return null}static makeLibTypeHint(e){if(null==e)return null;let t=[];e:for(;null!=e;){let n=e.tok;switch(n._hx_index){case 1:switch(n.k._hx_index){case 37:t.push("Null");break;case 41:t.push("macro")}break;case 2:let e=n.c;3==e._hx_index&&t.push(e.s);break;case 4:t.push(n.s);break;case 10:case 15:break e}if(null==(e=e.getFirstChild()))break;let r=e.tok;switch(r._hx_index){case 6:switch(r.op._hx_index){case 4:case 9:case 20:break e}break;case 10:case 15:case 12:case 14:break e;case 11:e=e.getFirstChild();continue}}if(t.length<=0)return null;let n=t.join(".");if(null==e)return Ks.LibType(n,n,[]);let r=e.tok;switch(r._hx_index){case 6:return 9==r.op._hx_index?Ks.LibType(n,n,hs.makeTypeHintParams(e)):Ks.LibType(n,n,[]);case 12:return Ks.NamedType(n,hs.makeTypeHint(e.getFirstChild()));default:return Ks.LibType(n,n,[])}}static makeTypeHintParams(e){let t=[],n=0,r=e.children;for(;n<r.length;){let e=r[n];++n;let i=e.tok;switch(i._hx_index){case 2:let n=i.c;if(3==n._hx_index){let r=n.s,i=e.getFirstChild();if(null==i){t.push(Ks.LibType(r,r,[]));continue}let s=i.tok;switch(s._hx_index){case 6:9==s.op._hx_index&&t.push(Ks.LibType(r,r,hs.makeTypeHintParams(i)));break;case 11:t.push(hs.makeTypeHint(e));continue}}break;case 4:let r=i.s,s=e.getFirstChild();if(null==s){t.push(Ks.LibType(r,r,[]));continue}let a=s.tok;switch(a._hx_index){case 6:9==a.op._hx_index&&t.push(Ks.LibType(r,r,hs.makeTypeHintParams(s)));break;case 11:t.push(hs.makeTypeHint(e));continue}}}return t}static makeStructTypeHint(e){if(null==e)return null;if(!e.hasChildren())return null;let t=[],n=0,r=e.children;e:for(;n<r.length;){let e=r[n];++n;let i=e.tok;switch(i._hx_index){case 1:if(2==i.k._hx_index){let n,r=e.getFirstChild();if(null==r)continue;let i=r.tok;switch(i._hx_index){case 1:n=37==i.k._hx_index?"NUll":""+re.string(r);break;case 2:let e=i.c;n=3==e._hx_index?e.s:""+re.string(r);break;default:n=""+re.string(r)}t.push(Ks.NamedType(n,hs.makeTypeHint(sa.firstChild(sa.firstOf(r,oa.DblDot)))))}break;case 2:let n=i.c;3==n._hx_index&&t.push(Ks.NamedType(n.s,hs.makeTypeHint(sa.firstChild(sa.firstOf(e,oa.DblDot)))));break;case 4:t.push(Ks.NamedType(i.s,hs.makeTypeHint(sa.firstChild(sa.firstOf(e,oa.DblDot)))));break;case 19:break e}}return Ks.StructType(t)}static makeOldFunctionTypeHint(e){if(null==e)return null;if(!e.hasChildren())return null;let t=[];for(;null!=e;){if(e.matches(oa.Arrow)){e=e.getFirstChild();continue}let n=hs.makeLibTypeHint(e);for(null!=n&&t.push(n);null!=e;){if(!e.hasChildren()){e=null;break}let t=null,n=0,r=e.children;e:for(;n<r.length;){let e=r[n];++n;let i=e.tok;switch(i._hx_index){case 2:if(3==i.c._hx_index){t=e;break e}break;case 6:break;case 10:break e;case 11:case 14:t=e;break e}}if(null==(e=t))break;if(e.matches(oa.Arrow))break}}return t.length<2?null:Ks.FunctionType(t,t.pop())}static makeFunctionTypeHint(e){if(null==e)return null;if(!e.hasChildren())return null;let t=[],n=0,r=e.children;e:for(;n<r.length;){let e=r[n];++n;let i=e.tok;switch(i._hx_index){case 2:3==i.c._hx_index&&t.push(hs.makeTypeHint(e));break;case 21:break e}}return Ks.FunctionType(t,hs.makeTypeHint(sa.firstChild(sa.firstOf(e,oa.Arrow))))}static resolveTypeHint(e,t,n){switch(e._hx_index){case 0:let r=e.type,i=e.typeParams,s=[],a=0;for(;a<i.length;)s.push(hs.resolveTypeHint(i[a++],t,n));return Ks.ClasspathType(r,s);case 1:let l=e.name,o=e.fullName,c=e.typeParams,u=[],h=0;for(;h<c.length;)u.push(hs.resolveTypeHint(c[h++],t,n));let d=hs.findTypeFromImports(o,t,n);return null==d?Ks.LibType(l,o,u):Ks.ClasspathType(d,u);case 2:let p=e.args,f=e.retVal,m=[],_=0;for(;_<p.length;)m.push(hs.resolveTypeHint(p[_++],t,n));return Ks.FunctionType(m,hs.resolveTypeHint(f,t,n));case 3:let g=e.fields,x=[],k=0;for(;k<g.length;)x.push(hs.resolveTypeHint(g[k++],t,n));return Ks.StructType(x);case 4:return Ks.NamedType(e.name,hs.resolveTypeHint(e.typeHint,t,n));case 5:return e}}static findTypeFromImports(e,t,n){let r=t.getType(e);if(null!=r)return r;let i=t.findTypeName(e),s=0,a=n.importList;for(;s<a.length;){let n=a[s];if(++s,null!=n.alias&&n.alias.name==e){let e=t.getType(n.moduleName.name);null!=e&&i.push(e)}}let l=0;for(;l<i.length;){let e=i[l];switch(++l,n.importsModule(e.file.getPackage(),e.file.getMainModulName(),e.name.name)._hx_index){case 0:break;case 5:case 1:case 2:case 3:case 4:case 6:return e}}return null}}hs.__name__="refactor.discover.TypeHintFromTree";class ds{}ds.__name__="refactor.typing.ITypeList",ds.__isInterface__=!0,Object.assign(ds.prototype,{__class__:ds});class ps{constructor(){this.types=new tt}addType(e){let t=this.types,n=e.get_fullModuleName();t.m.set(n,e)}findTypeName(e){let t=this.types;return te.filter({iterator:function(){return new Ii(t.m.values())}},(function(t){return t.name.name==e}))}getType(e){return this.types.m.has(e)?this.types.m.get(e):null}removeFile(e){let t=[],n=this.types.m.entries(),r=n.next();for(;!r.done;){let i=r.value;r=n.next();let s=i[1];s.file.name==e&&t.push(s.get_fullModuleName())}let i=0;for(;i<t.length;)this.types.m.delete(t[i++])}clear(){this.types.m.clear()}}ps.__name__="refactor.discover.TypeList",ps.__interfaces__=[ds],Object.assign(ps.prototype,{__class__:ps});class fs{constructor(){}parseFile(e,t){if(this.isCached(t))return;let n=null;try{let r=new bi(e,t.fileName),i=r.token(bi.tok),s=[];for(;i.tok!=oi.Eof;)s.push(i),i=r.token(bi.tok);n=aa.buildTokenTree(s,e,la.TypeLevel),this.parseFileWithTokens(n,t)}catch(e){We.lastError=e;let n=Me.caught(e),r=n.unwrap();if(r instanceof Ai){let e=r;throw Me.thrown("failed to parse "+t.fileName+" - ParserError: "+re.string(e)+" ("+re.string(e.pos)+")")}if(r instanceof pi){let e=r;throw Me.thrown("failed to parse "+t.fileName+" - LexerError: "+re.string(e.msg)+" ("+re.string(e.pos)+")")}throw Me.thrown("failed to parse "+t.fileName+" - "+n.details())}}parseFileWithTokens(e,t){if(!this.isCached(t))try{let n=new es(t.fileName);t.file=n,t.type=null,n.initHeader(this.readPackageName(e,t),this.readImports(e,t),this.findImportInsertPos(e)),n.setTypes(this.readTypes(e,t)),t.fileList.addFile(n),null!=t.cache&&t.cache.storeFile(n)}catch(e){let n=Me.caught(e);throw Me.thrown("failed to parse "+t.fileName+" - "+n.details())}}isCached(e){return null!=e.cache&&null!=e.cache.getFile(e.fileName,e.nameMap)}updateImportHx(e){let t=e.fileList.files.m.values(),n=t.next();for(;!n.done;){let r=n.value;n=t.next();let i=new ot(r.name);if("import"!=i.file)continue;let s=i.dir,a=e.fileList.files.m.values(),l=a.next();for(;!l.done;){let e=l.value;l=a.next(),e.name!=r.name&&(new ot(e.name).dir.startsWith(s)&&(e.importHxFile=r))}}}findImportInsertPos(e){if(!e.hasChildren())return 0;let t=0,n=0,r=e.children;for(;n<r.length;){let e=r[n];++n;let i=e.tok;switch(i._hx_index){case 1:if(34!==i.k._hx_index)return e.pos.min;t=e.getPos().max+1;break;case 7:case 8:t=e.pos.max+1;break;default:return e.pos.min}}return t}readPackageName(e,t){let n=e.filterCallback((function(e,t){let n=e.tok;return 1==n._hx_index&&34==n.k._hx_index?ia.FoundSkipSubtree:ia.SkipSubtree}));return 1!=n.length?null:this.makeIdentifier(t,n[0].getFirstChild(),ss.PackageName,null)}readImports(e,t){let n=[],r=e.filterCallback((function(e,t){let n=e.tok;switch(n._hx_index){case 1:switch(n.k._hx_index){case 13:case 36:return ia.FoundSkipSubtree;default:return ia.SkipSubtree}break;case 3:return ia.GoDeeper;default:return ia.SkipSubtree}})),i=0;for(;i<r.length;)n.push(this.readImport(r[i++],t));return n}readImport(e,t){let n,r=[],i=null,s=e.tok;if(1==s._hx_index)switch(s.k._hx_index){case 13:n=ss.ImportModul;break;case 36:n=ss.UsingModul;break;default:n=null}else n=null;if(null==n)return null;let a=!1;e=e.getFirstChild();let l=this.makePosition(t.fileName,e);e:for(;null!=e;){let n=e.tok;switch(n._hx_index){case 1:r.push(e.toString()),l.end=e.pos.max;break;case 2:let s=n.c;if(3!=s._hx_index)return null;if("as"==s.s){i=this.makeIdentifier(t,e.getFirstChild(),ss.ImportAlias,null);break e}r.push(e.toString()),l.end=e.pos.max;break;case 6:switch(n.op._hx_index){case 1:a=!0;break;case 23:i=this.makeIdentifier(t,e.getFirstChild(),ss.ImportAlias,null);break e;default:return null}break;case 10:break e;case 11:break;default:return null}e=e.getFirstChild()}let o=new is(n,r.join("."),l,t.nameMap,t.file,null);return null!=i&&o.addUse(i.parent),{moduleName:o,alias:i,starImport:a}}readTypes(e,t){let n=e.filterCallback((function(e,t){let n=e.tok;switch(n._hx_index){case 1:switch(n.k._hx_index){case 0:case 1:case 2:case 26:case 28:case 32:case 40:case 42:return ia.FoundSkipSubtree;default:return ia.SkipSubtree}break;case 3:return ia.GoDeeper;default:return ia.SkipSubtree}})),r=[],i=0;for(;i<n.length;)r.push(this.readType(n[i++],t));return r}readType(e,t){let n,r=e.tok;if(1==r._hx_index)switch(r.k._hx_index){case 0:n=ss.ModuleLevelStaticMethod;break;case 1:n=ss.Class;break;case 26:n=ss.Enum;break;case 28:n=ss.Interface;break;case 32:n=ss.Typedef;break;case 40:n=ss.Abstract;break;case 2:case 42:n=ss.ModuleLevelStaticVar;break;default:n=null}else n=null;if(null==n)return null;let i=e.getFirstChild(),s=new us(t.file);t.type=s;let a=this.makeIdentifier(t,i,n,null);if(null==a)return null;switch(s.name=a,t.typeList.addType(s),n._hx_index){case 4:this.addAbstractFields(t,a,i);break;case 5:this.addClassInterface(t,a,i);break;case 6:this.readEnum(t,a,i.getFirstChild());break;case 7:if(this.addClassInterface(t,a,i),null!=a.uses){let e=0,t=a.uses;for(;e<t.length;){let n=t[e];switch(++e,n.type._hx_index){case 16:n.type=ss.InterfaceProperty;break;case 17:n.type=ss.InterfaceVar;break;case 18:n.type=ss.InterfaceMethod}}}break;case 8:this.readTypedef(t,a,i);break;case 9:this.readVarInit(t,a,i);break;case 10:this.readMethod(t,a,i)}return this.readStrings(t,a,i),s}readStrings(e,t,n){let r=this;n.filterCallback((function(n,i){let a=n.tok;if(2!=a._hx_index)return ia.GoDeeper;{let i=a.c;if(2!=i._hx_index)return ia.GoDeeper;{let a=i.s,l=i.kind;if(null==l)return ia.GoDeeper;switch(l._hx_index){case 0:if(new s("^[a-z][a-zA-Z0-9]+(\\.[a-z][a-zA-Z0-9]+)*(|\\.[A-Z][a-zA-Z0-9]+)$","").match(a)){let i=new is(ss.StringConst,a,{fileName:e.fileName,start:n.pos.min+1,end:n.pos.max-1},e.nameMap,e.file,e.type),s=r.findParentIdentifier(e,n);null!=s&&s.addUse(i),t.addUse(i)}return ia.SkipSubtree;case 1:let i=r.findParentIdentifier(e,n);return null==i&&(i=t),r.readStringInterpolation(e,i,n,a),ia.SkipSubtree}}}}))}readStringInterpolation(e,t,n,r){let i,l=0;for(;i=r.indexOf("${",l),i>=0;){if(this.isDollarEscaped(r,i)){l=i+1;continue}l=i+1;let s=r.indexOf("}",i+2),a=r.substring(i+2,s);a.indexOf("{")>=0||(this.readInterpolatedFragment(e,t,a,n.pos.min+1+l+1),l=s)}l=0;let o=new s("^[a-z][a-zA-Z0-9]*","");for(;i=r.indexOf("$",l),i>=0&&!(i+1>=r.length);)if(l=i+1,o.match(a.substr(r,l,null))){let r=o.matched(0);t.addUse(new is(ss.Access,r,{fileName:n.pos.file,start:n.pos.min+l+1,end:n.pos.min+l+r.length+1},e.nameMap,e.file,e.type))}}findParentIdentifier(e,t){let n=t.parent;e:for(;null!=n;){let t=n.tok;if(null==t)break;switch(t._hx_index){case 0:break e;case 1:switch(t.k._hx_index){case 0:case 1:case 2:case 26:case 28:case 32:case 40:case 42:let t=n.getFirstChild();if(null!=t)return e.type.findIdentifier(t.pos.min)}}n=n.parent}return null}isDollarEscaped(e,t){let n=!1;for(;--t>=0;){if(36!=e.charCodeAt(t))return n;n=!n}return n}readInterpolatedFragment(e,t,n,r){let i=null;try{let s=it.ofString(n),a=new bi(s,e.fileName),l=a.token(bi.tok),o=[];for(;l.tok!=oi.Eof;)l.pos.min+=r,l.pos.max+=r,o.push(l),l=a.token(bi.tok);ea.MODE=Ys.Relaxed,i=aa.buildTokenTree(o,s,la.ExpressionLevel),this.readExpression(e,t,i,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:398,className:"refactor.discover.UsageCollector",methodName:"readInterpolatedFragment"})}catch(t){We.lastError=t;let n=Me.caught(t),r=n.unwrap();if(r instanceof Ai){let t=r;throw Me.thrown("failed to parse "+e.fileName+" - ParserError: "+re.string(t)+" ("+re.string(t.pos)+")")}if(r instanceof pi){let t=r;throw Me.thrown("failed to parse "+e.fileName+" - LexerError: "+re.string(t.msg)+" ("+re.string(t.pos)+")")}throw Me.thrown("failed to parse "+e.fileName+" - "+n.details())}}readEnum(e,t,n){if(!n.hasChildren())return;let r=0,i=n.children;for(;r<i.length;){let n=i[r];++r;let s=n.tok;switch(s._hx_index){case 2:if(3!=s.c._hx_index)continue;{let r=this.makeIdentifier(e,n,ss.EnumField([]),t);if(null==r)continue;if(!n.hasChildren())continue;let i=n.getFirstChild();if(!i.matches(oa.POpen))continue;r.type=ss.EnumField(this.readParameter(e,r,i,i.pos.max)),this.copyUsesToParent(t,r)}break;case 3:switch(s.s){case"else":this.readEnum(e,t,n);break;case"elseif":case"if":this.readExpression(e,t,n.getFirstChild(),{fileName:"refactor/discover/UsageCollector.hx",lineNumber:431,className:"refactor.discover.UsageCollector",methodName:"readEnum"});let r=1,i=n.children.length-1;for(;r<i;){let i=r++;3!=n.children[i].tok._hx_index&&this.readEnum(e,t,n.children[i])}break;default:continue}break;case 7:case 8:break;default:continue}}}readTypedef(e,t,n){if(!n.hasChildren())return;let r,i=n.getFirstChild();if(null!=i){let e=i.tok;r=!(6==e._hx_index&&4==e.op._hx_index)}else r=!0;if(r||!i.hasChildren())return;let s=0,a=i.children;for(;s<a.length;){let n=a[s];++s;let r=n.tok;switch(r._hx_index){case 2:if(3==r.c._hx_index){let r=this.makeIdentifier(e,n,ss.TypedefBase,t),i=0,s=this.findIdentifierChilds(n);for(;i<s.length;){let n=s[i];++i;let a=n.tok;switch(a._hx_index){case 6:switch(a.op._hx_index){case 9:this.addTypeParameter(e,r,n);break;case 11:this.readExpression(e,t,n,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:468,className:"refactor.discover.UsageCollector",methodName:"readTypedef"})}break;case 10:break;case 14:this.readTypeHint(e,r,n,ss.TypeHint)}}}break;case 7:case 8:break;case 18:this.readAnonStructure(e,t,n)}}}addClassInterface(e,t,n){if(null==n||!n.hasChildren())return;let r=0,i=n.children;for(;r<i.length;){let n=i[r];++r;let s=n.tok;switch(s._hx_index){case 1:switch(s.k._hx_index){case 11:this.makeIdentifier(e,n.getFirstChild(),ss.Extends,t);break;case 12:this.makeIdentifier(e,n.getFirstChild(),ss.Implements,t)}break;case 3:this.readExpression(e,t,n,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:498,className:"refactor.discover.UsageCollector",methodName:"addClassInterface"});break;case 6:9==s.op._hx_index&&this.addTypeParameter(e,t,n);break;case 7:case 8:break;case 18:this.addFields(e,t,n);break;case 23:this.readMetadata(e,t,n)}}}addFields(e,t,n){if(null==n||!n.hasChildren())return;let r=!0,i=0,s=n.children;for(;i<s.length;){let n=s[i];if(++i,r){r=!1;let e=n.parent;if(null!=e){let t=e.tok;if(3==t._hx_index)switch(t.s){case"elseif":case"if":continue}}}let a=n.tok;switch(a._hx_index){case 1:switch(a.k._hx_index){case 0:let r=n.getFirstChild(),i=this.makeIdentifier(e,r,ss.Method(null!=sa.firstOf(r,oa.Kwd(li.KwdStatic))),t);this.readMethod(e,i,r),this.copyUsesToParent(t,i);break;case 17:case 18:case 19:case 25:case 31:case 35:case 40:case 41:break;case 2:case 42:this.readVar(e,t,n,ss.FieldVar(null!=sa.firstOf(sa.firstChild(n),oa.Kwd(li.KwdStatic))))}break;case 3:this.addFields(e,t,n);break;case 6:this.readExpression(e,t,n,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:536,className:"refactor.discover.UsageCollector",methodName:"addFields"});break;case 7:case 8:case 10:case 19:break;case 23:this.readMetadata(e,t,n)}}}addAbstractFields(e,t,n){if(null==n||!n.hasChildren())return;let r=null,i=0,s=n.children;e:for(;i<s.length;){let n=s[i];++i;let a=n.tok;switch(a._hx_index){case 1:case 7:case 8:break;case 2:let i=a.c;if(3==i._hx_index)switch(i.s){case"from":this.makeIdentifier(e,n.getFirstChild(),ss.AbstractFrom,t);break;case"to":this.makeIdentifier(e,n.getFirstChild(),ss.AbstractTo,t)}break;case 18:r=n;break e;case 20:this.readTypeHint(e,t,n,ss.AbstractOver)}}if(null==r)return;let a=0,l=r.children;for(;a<l.length;){let n=l[a];++a;let r=n.tok;if(1==r._hx_index)switch(r.k._hx_index){case 0:let r=n.getFirstChild(),i=this.makeIdentifier(e,r,ss.Method(null!=sa.firstOf(r,oa.Kwd(li.KwdStatic))),t);this.readMethod(e,i,r),this.copyUsesToParent(t,i);break;case 2:case 42:this.readVar(e,t,n,ss.FieldVar(null!=sa.firstOf(sa.firstChild(n),oa.Kwd(li.KwdStatic))))}}}readVar(e,t,n,r){let i=n.getFirstChild();for(;null!=i;){let n=this.makeIdentifier(e,i,r,t);if(null==n)return;if(!i.hasChildren())return void this.copyUsesToParent(t,n);let s=0,a=i.children;for(;s<a.length;){let t=a[s];++s;let r=t.tok;switch(r._hx_index){case 1:case 7:case 8:case 10:case 15:break;case 6:switch(r.op._hx_index){case 4:case 20:this.readExpression(e,n,t,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:602,className:"refactor.discover.UsageCollector",methodName:"readVar"})}break;case 12:this.readTypeHint(e,n,t,ss.TypeHint);break;case 20:n.type=ss.Property;break;case 23:this.readMetadata(e,n,t)}}this.copyUsesToParent(t,n),i=i.nextSibling}}readMetadata(e,t,n){if(null!=n&&null!=(n=n.getFirstChild()))switch(n.tok._hx_index){case 1:break;case 2:let r=this.makeIdentifier(e,n,ss.Meta,t);this.readExpression(e,r,this.findIdentifierChild(n),{fileName:"refactor/discover/UsageCollector.hx",lineNumber:629,className:"refactor.discover.UsageCollector",methodName:"readMetadata"}),this.copyUsesToParent(t,r);break;case 12:this.readMetadata(e,t,n)}}readVarInit(e,t,n){let r=0,i=n.children;for(;r<i.length;){let n=i[r];++r;let s=n.tok;switch(s._hx_index){case 6:4==s.op._hx_index&&this.readExpression(e,t,n.getFirstChild(),{fileName:"refactor/discover/UsageCollector.hx",lineNumber:642,className:"refactor.discover.UsageCollector",methodName:"readVarInit"});break;case 12:if(1===fa.getColonType(n)._hx_index)this.readTypeHint(e,t,n,ss.TypeHint)}}}readMethod(e,t,n){let r=!0,i=n.getPos(),s=0,a=n.children;for(;s<a.length;){let n=a[s];++s;let l=n.tok;switch(l._hx_index){case 1:switch(l.k._hx_index){case 17:case 18:case 19:case 25:case 31:case 35:case 40:case 41:break;default:if(r)continue;this.readExpression(e,t,n,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:679,className:"refactor.discover.UsageCollector",methodName:"readMethod"})}break;case 6:if(9==l.op._hx_index)this.addTypeParameter(e,t,n);else{if(r)continue;this.readExpression(e,t,n,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:679,className:"refactor.discover.UsageCollector",methodName:"readMethod"})}break;case 7:case 8:break;case 12:this.readTypeHint(e,t,n,ss.TypeHint);break;case 18:if(r)continue;this.readBlock(e,t,n);break;case 20:this.readParameter(e,t,n,i.max),r=!1;break;case 23:this.readMetadata(e,t,n);break;default:if(r)continue;this.readExpression(e,t,n,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:679,className:"refactor.discover.UsageCollector",methodName:"readMethod"})}}}readObjectLiteral(e,t,n){if(!n.hasChildren())return;let r=[],i=0,s=n.children;e:for(;i<s.length;){let n=s[i];++i;let a=n.tok;switch(a._hx_index){case 2:let i=a.c;if(3!=i._hx_index)break e;{r.push(i.s);let s=this.makeIdentifier(e,n,ss.StructureField(r),t);this.readExpression(e,s,this.findIdentifierChild(n),{fileName:"refactor/discover/UsageCollector.hx",lineNumber:695,className:"refactor.discover.UsageCollector",methodName:"readObjectLiteral"}),this.copyUsesToParent(t,s)}break;case 7:case 8:break;default:break e}}}readBlock(e,t,n){if(!n.hasChildren())return;let r=n.getPos().max,i=0,s=n.children;for(;i<s.length;){let n=s[i];++i;let a=n.tok;switch(a._hx_index){case 1:switch(a.k._hx_index){case 0:n=n.getFirstChild();let i=this.makeIdentifier(e,n,ss.ScopedLocal(n.pos.min,r,as.Var),t);null==i?this.readMethod(e,t,n):(this.readMethod(e,i,n),this.copyUsesToParent(t,i));break;case 2:case 42:this.readVar(e,t,n,ss.ScopedLocal(n.getPos().max,r,as.Var));break;default:this.readExpression(e,t,n,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:729,className:"refactor.discover.UsageCollector",methodName:"readBlock"})}break;case 7:case 8:case 10:case 11:case 13:break;default:this.readExpression(e,t,n,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:729,className:"refactor.discover.UsageCollector",methodName:"readBlock"})}}}readIdentifier(e,t,n,r){if(null==n)return;let i=n.parent;switch(i.tok._hx_index){case 11:case 13:let r=i.previousSibling;if(null!=r)switch(r.tok._hx_index){case 16:case 17:case 20:case 21:let r=null,s=null!=i?i.parent:null,a=null!=s?s.parent:null;null!=a&&(r=e.type.findIdentifier(a.pos.min));let l=ss.Access;null!=r&&(l=ss.ArrayAccess(r)),this.makeIdentifier(e,n,l,t);let o=0,c=this.findIdentifierChilds(n);for(;o<c.length;){let n=c[o];switch(++o,n.tok._hx_index){case 5:case 7:case 8:break;case 6:this.readExpression(e,t,n,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:762,className:"refactor.discover.UsageCollector",methodName:"readIdentifier"});break;case 11:case 13:this.readExpression(e,t,n,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:764,className:"refactor.discover.UsageCollector",methodName:"readIdentifier"});break;case 16:case 20:this.readCallParams(e,t,n);break;case 22:fa.isTernary(n)&&this.readExpression(e,t,n,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:767,className:"refactor.discover.UsageCollector",methodName:"readIdentifier"})}}}break;case 20:switch(fa.getPOpenType(i)._hx_index){case 1:let r=i.getPos(),s=this.makeIdentifier(e,n,ss.ScopedLocal(r.min,r.max,as.Parameter([])),t),a=0,l=this.findIdentifierChilds(n);for(;a<l.length;){let n=l[a];++a;let r=n.tok;switch(r._hx_index){case 6:9==r.op._hx_index&&(this.addTypeParameter(e,s,n),this.copyUsesToParent(t,s));break;case 12:switch(fa.getColonType(n)._hx_index){case 1:case 6:this.readTypeHint(e,s,n,ss.TypeHint),this.copyUsesToParent(t,s);break;case 2:this.readExpression(e,t,n,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:791,className:"refactor.discover.UsageCollector",methodName:"readIdentifier"})}}}return;case 0:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:let o=this.makeIdentifier(e,n,ss.Access,t),c=0,u=this.findIdentifierChilds(n);for(;c<u.length;){let n=u[c];++c;let r=n.tok;switch(r._hx_index){case 2:let i=r.c;if(3==i._hx_index&&"is"==i.s){let r=n.getFirstChild();null!=r&&this.readExpression(e,t,r,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:834,className:"refactor.discover.UsageCollector",methodName:"readIdentifier"})}break;case 5:case 7:case 8:case 11:case 13:case 15:break;case 6:this.readExpression(e,t,n,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:812,className:"refactor.discover.UsageCollector",methodName:"readIdentifier"});break;case 12:switch(fa.getColonType(n)._hx_index){case 1:case 6:this.readTypeHint(e,o,n,ss.TypeHint),this.copyUsesToParent(t,o);break;case 2:this.readExpression(e,t,n,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:825,className:"refactor.discover.UsageCollector",methodName:"readIdentifier"})}break;case 14:this.readExpression(e,t,n,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:814,className:"refactor.discover.UsageCollector",methodName:"readIdentifier"});break;case 16:case 20:this.readCallParams(e,t,n);break;case 22:fa.isTernary(n)&&this.readExpression(e,t,n,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:838,className:"refactor.discover.UsageCollector",methodName:"readIdentifier"})}}return}break;default:let s=this.makeIdentifier(e,n,ss.Access,t);null==s&&(s=t);let a=!1,l=0,o=this.findIdentifierChilds(n);for(;l<o.length;){let r=o[l];switch(++l,r==n.getFirstChild()&&(a=!0),r.tok._hx_index){case 5:case 7:case 8:case 10:case 15:break;case 6:this.readExpression(e,s,r,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:862,className:"refactor.discover.UsageCollector",methodName:"readIdentifier"}),this.copyUsesToParent(t,s);break;case 12:switch(fa.getColonType(r)._hx_index){case 1:case 6:this.readTypeHint(e,s,r,ss.TypeHint),this.copyUsesToParent(t,s);break;case 2:this.readExpression(e,t,r,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:871,className:"refactor.discover.UsageCollector",methodName:"readIdentifier"})}break;case 11:case 13:case 16:case 20:this.readCallParams(e,s,r),this.copyUsesToParent(t,s);break;case 14:this.readExpression(e,t,r,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:883,className:"refactor.discover.UsageCollector",methodName:"readIdentifier"});break;case 22:fa.isTernary(r)&&this.readExpression(e,t,r,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:878,className:"refactor.discover.UsageCollector",methodName:"readIdentifier"});break;case 25:this.readExpression(e,t,r,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:881,className:"refactor.discover.UsageCollector",methodName:"readIdentifier"})}}if(a)return}if(n.hasChildren()){let r=0,i=n.children;for(;r<i.length;){let n=i[r];++r;let s=n.tok;switch(s._hx_index){case 6:4!=s.op._hx_index&&this.readExpression(e,t,n,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:900,className:"refactor.discover.UsageCollector",methodName:"readIdentifier"});break;case 7:case 8:case 11:case 13:case 15:break;case 20:this.readCallParams(e,t,n);break;default:this.readExpression(e,t,n,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:900,className:"refactor.discover.UsageCollector",methodName:"readIdentifier"})}}}}readCallParams(e,t,n){if(null==n)return;if(!n.hasChildren())return;let r=0,i=n.children;for(;r<i.length;)this.readExpression(e,t,i[r++],{fileName:"refactor/discover/UsageCollector.hx",lineNumber:914,className:"refactor.discover.UsageCollector",methodName:"readCallParams"})}readExpression(e,t,n,r){if(null==n)return;let i=n.tok;switch(i._hx_index){case 1:switch(i.k._hx_index){case 0:let r=n.parent.getPos().max,i=n.getFirstChild();if(2==i.tok._hx_index){let n=this.makeIdentifier(e,i,ss.ScopedLocal(i.pos.min,r,as.Var),t);this.readMethod(e,n,i),this.copyUsesToParent(t,n)}else this.readMethod(e,t,n);return;case 2:let s=n.parent.getPos();return void this.readVar(e,t,n,ss.ScopedLocal(n.getPos().max,s.max,as.Var));case 7:return void this.readFor(e,t,n);case 14:return void this.readSwitch(e,t,n);case 23:let a=this.makeIdentifier(e,n,ss.Access,t),l=0,o=this.findIdentifierChilds(n);for(;l<o.length;){let n=o[l];switch(++l,n.tok._hx_index){case 5:case 7:case 8:case 10:case 15:break;case 6:this.readExpression(e,t,n,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:951,className:"refactor.discover.UsageCollector",methodName:"readExpression"});break;case 12:this.readTypeHint(e,a,n,ss.TypeHint),this.copyUsesToParent(t,a);break;case 11:case 13:this.readIdentifier(e,a,n,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:960,className:"refactor.discover.UsageCollector",methodName:"readExpression"}),this.copyUsesToParent(t,a);break;case 16:case 20:this.readCallParams(e,a,n),this.copyUsesToParent(t,a);break;case 22:fa.isTernary(n)&&this.readExpression(e,t,n,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:970,className:"refactor.discover.UsageCollector",methodName:"readExpression"})}}return}break;case 2:if(3==i.c._hx_index)return void this.readIdentifier(e,t,n,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:926,className:"refactor.discover.UsageCollector",methodName:"readExpression"});break;case 6:case 7:case 8:break;case 10:return;case 18:switch(fa.getBrOpenType(n)._hx_index){case 0:case 1:case 3:case 4:this.readBlock(e,t,n);break;case 2:this.readObjectLiteral(e,t,n)}return}if(n.hasChildren()){let r=0,i=n.children;for(;r<i.length;)this.readExpression(e,t,i[r++],{fileName:"refactor/discover/UsageCollector.hx",lineNumber:1002,className:"refactor.discover.UsageCollector",methodName:"readExpression"})}}readSwitch(e,t,n){if(!n.hasChildren())return;let r=0;null!=t&&null!=t.uses&&(r=t.uses.length),this.readExpression(e,t,n.getFirstChild(),{fileName:"refactor/discover/UsageCollector.hx",lineNumber:1015,className:"refactor.discover.UsageCollector",methodName:"readSwitch"});let i=t;null!=t&&null!=t.uses&&t.uses.length>r&&(i=t.uses[r]);let s=sa.firstOf(n,oa.BrOpen);if(null==s||!s.hasChildren())return;let a=0,l=s.children;e:for(;a<l.length;){let n=l[a];++a;let r=n.tok;switch(r._hx_index){case 1:switch(r.k._hx_index){case 15:this.readCase(e,i,n);break;case 16:n.hasChildren()&&this.readBlock(e,i,n.getFirstChild());break;default:break e}break;case 3:this.readExpression(e,t,n.getFirstChild(),{fileName:"refactor/discover/UsageCollector.hx",lineNumber:1034,className:"refactor.discover.UsageCollector",methodName:"readSwitch"});let s=1,a=n.children.length-1;for(;s<a;){let t=s++,r=n.children[t].tok;if(1===r._hx_index)switch(r.k._hx_index){case 15:this.readCase(e,i,n.children[t]);break;case 16:n.hasChildren()&&this.readBlock(e,i,n.children[t].getFirstChild())}}break;case 7:case 8:break;default:break e}}this.copyUsesToParent(t,i)}readFor(e,t,n){if(!n.hasChildren())return;let r=!0,i=0,s=n.children;for(;i<s.length;){let a=s[i];switch(++i,a.tok._hx_index){case 7:case 8:break;case 20:let i=n.getPos().max;this.readForIteration(e,t,a.getFirstChild(),i),r=!1;break;default:if(r)continue;this.readExpression(e,t,a,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:1071,className:"refactor.discover.UsageCollector",methodName:"readFor"})}}}readForIteration(e,t,n,r){let i=[],s=sa.firstOf(sa.parent(n),oa.PClose),a=n.pos.min;null!=s&&(a=s.pos.max);let l=this.makeIdentifier(e,n,ss.ScopedLocal(a,r,as.ForLoop(i)),t);if(i.push(l),!n.hasChildren())return;let o=0,c=n.children;for(;o<c.length;){let n=c[o];++o;let s=n.tok;if(6==s._hx_index){if(22==s.op._hx_index)l=this.makeIdentifier(e,n.getFirstChild(),ss.ScopedLocal(a,r,as.ForLoop(i)),t),i.push(l);else if(this.readExpression(e,l,n,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:1095,className:"refactor.discover.UsageCollector",methodName:"readForIteration"}),this.copyUsesToParent(t,l),null!=(null!=l?l.uses:null)){let e=0,t=l.uses;for(;e<t.length;){let n=t[e];++e,31==n.type._hx_index&&(n.type=ss.ForIterator),i.push(n)}}}else if(this.readExpression(e,l,n,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:1095,className:"refactor.discover.UsageCollector",methodName:"readForIteration"}),this.copyUsesToParent(t,l),null!=(null!=l?l.uses:null)){let e=0,t=l.uses;for(;e<t.length;){let n=t[e];++e,31==n.type._hx_index&&(n.type=ss.ForIterator),i.push(n)}}}}readCase(e,t,n){if(!n.hasChildren())return;let r=n.getPos().max,i=0,s=n.children;e:for(;i<s.length;){let n=s[i];++i;let a=n.tok;switch(a._hx_index){case 1:2==a.k._hx_index&&(n=n.getFirstChild(),this.makeIdentifier(e,n,ss.ScopedLocal(n.pos.min,r,as.CaseCapture(null,0)),t));break;case 2:3==a.c._hx_index&&this.readCaseConst(e,t,n,r);break;case 7:case 8:break;case 12:this.readBlock(e,t,n);break e;case 16:this.readCaseArray(e,t,n,r);break;case 18:this.readCaseStructure(e,t,n,r)}}}readCaseConst(e,t,n,r){let i=this.makeIdentifier(e,n,ss.CaseLabel(t),t);if(!n.hasChildren())return;let s=this.findIdentifierChild(n);null!=s?(this.readCasePOpen(e,i,s,r),null!=i&&this.copyUsesToParent(t,i)):this.copyUsesToParent(t,i)}readCasePOpen(e,t,n,r){switch(n.tok._hx_index){case 16:this.readCaseArray(e,t,n,r);break;case 20:this.readCaseParameter(e,t,n,r)}}readCaseParameter(e,t,n,r){let i=[],s=0,a=0,l=n.children;e:for(;a<l.length;){let n=l[a];++a;let o=n.tok;switch(o._hx_index){case 2:if(3==o.c._hx_index){let a=this.makeIdentifier(e,n,ss.ScopedLocal(n.pos.min,r,as.CaseCapture(t,s)),t);i.push(a),++s;let l=this.findIdentifierChild(n);if(null==l)continue;if(l.parent==n)continue;this.readCasePOpen(e,a,l,r)}else++s;break;case 16:this.readCaseArray(e,t,n,r);break;case 21:break e;case 22:n=n.getFirstChild(),i.push(this.makeIdentifier(e,n,ss.ScopedLocal(n.pos.min,r,as.Parameter(i)),t))}}return i}readCaseArray(e,t,n,r){if(!n.hasChildren())return;let i=0,s=n.children;for(;i<s.length;)this.readCaseConst(e,t,s[i++],r)}readCaseStructure(e,t,n,r){if(!n.hasChildren())return;let i=0,s=n.children;for(;i<s.length;){let n=s[i];if(++i,2!=n.tok._hx_index)break;{let i=this.makeIdentifier(e,n,ss.StructureField([]),t);if(null==i)continue;if(!n.hasChildren())continue;let s=n.getFirstChild();switch(s.tok._hx_index){case 1:case 2:case 4:case 5:case 6:this.readExpression(e,i,s,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:1226,className:"refactor.discover.UsageCollector",methodName:"readCaseStructure"}),this.copyUsesToParent(t,i);break;case 16:case 18:this.readCaseStructure(e,i,s,r),this.copyUsesToParent(t,i);continue}if(null!=i.uses){let e=0,n=i.uses;for(;e<n.length;){let i=n[e];++e,i.type=ss.ScopedLocal(i.pos.start,r,as.CaseCapture(t,0))}}}}}readParameter(e,t,n,r){let i=[],s=0,a=n.children;for(;s<a.length;){let n=a[s];++s;let l=n.tok;switch(l._hx_index){case 2:if(3==l.c._hx_index){let s=this.makeIdentifier(e,n,ss.ScopedLocal(n.pos.min,r,as.Parameter(i)),t);i.push(s);let a=0,l=this.findIdentifierChilds(n);e:for(;a<l.length;){let t=l[a];++a;let r=t.tok;switch(r._hx_index){case 6:4==r.op._hx_index&&this.readExpression(e,s,t,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:1285,className:"refactor.discover.UsageCollector",methodName:"readParameter"});break;case 12:this.readTypeHint(e,s,t,ss.TypeHint);break;case 15:if(t.parent==n)break e}}this.copyUsesToParent(t,s)}break;case 22:n=n.getFirstChild();let s=this.makeIdentifier(e,n,ss.ScopedLocal(n.pos.min,r,as.Parameter(i)),t),a=0,o=this.findIdentifierChilds(n);for(;a<o.length;){let n=o[a];++a;let r=n.tok;switch(r._hx_index){case 6:4==r.op._hx_index&&this.readExpression(e,t,n,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:1266,className:"refactor.discover.UsageCollector",methodName:"readParameter"});break;case 12:switch(fa.getColonType(n)._hx_index){case 1:this.readTypeHint(e,s,n,ss.TypeHint),this.copyUsesToParent(t,s);break;case 2:this.readExpression(e,t,n,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:1260,className:"refactor.discover.UsageCollector",methodName:"readParameter"});break;case 3:this.readExpression(e,t,n,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:1262,className:"refactor.discover.UsageCollector",methodName:"readParameter"})}}}this.copyUsesToParent(t,s),i.push(s)}}return i}makePosition(e,t){return{fileName:e,start:t.pos.min,end:t.pos.max}}makeIdentifier(e,t,n,r){if(null==t)return null;let i=t.tok;switch(i._hx_index){case 1:switch(i.k._hx_index){case 22:case 23:case 37:break;default:return null}break;case 2:let e=i.c;if(3!=e._hx_index)return null;if("is"==e.s)return null;break;case 4:break;case 22:if(null==(t=t.getFirstChild()))return null;break;default:return null}let s=this.makePosition(e.fileName,t),a=[],l=t.parent,o=t,c=[],u=!0,h=null;if(h=function(e){if(!e.hasChildren())return;let t=0,r=e.children;for(;t<r.length;){let e=r[t];++t;let i=e.tok;switch(i._hx_index){case 1:switch(i.k._hx_index){case 22:case 23:case 37:case 41:if(u)return;a.push(e.toString()),u=!0;break;default:continue}break;case 2:let t=i.c;if(3==t._hx_index){if("is"==t.s)return;if(u)return;a.push(e.toString()),u=!0}else{if(u)return;a.push(e.toString()),u=!0}break;case 4:if(u)return;a.push(e.toString()),u=!0;break;case 5:case 6:return;case 11:a.push("."),u=!1;break;case 13:a.push("?."),u=!1;break;case 20:let r=l.tok;if(1==r._hx_index)switch(r.k._hx_index){case 0:break;case 2:case 42:n=ss.Property}return;default:continue}o=e,h(e)}},a.push(t.toString()),h(t),s.end=o.pos.max,o.hasChildren()){let e=0,r=o.children;for(;e<r.length;){let i=r[e];switch(++e,i.tok._hx_index){case 14:let e=i.getPos();n=ss.ScopedLocal(t.pos.min,e.max,as.Parameter(c));break;case 20:31==n._hx_index&&(n=l.matches(oa.Kwd(li.KwdNew))?ss.Call(!0):ss.Call(!1))}}}if(a.length<=0)return null;let d=a.join(""),p=e.nameMap.getIdentifier(d,e.file.name,s.start);return null==p&&(p=new is(n,d,s,e.nameMap,e.file,e.type)),c.push(p),null!=r&&r.addUse(p),p}addTypeParameter(e,t,n){if(!n.hasChildren())return;let r=0,i=n.children;e:for(;r<i.length;){let s=i[r];++r;let a=s.tok;switch(a._hx_index){case 2:if(3==a.c._hx_index){this.makeIdentifier(e,s,ss.TypedParameter,t);let n=0,r=this.findIdentifierChilds(s);for(;n<r.length;){let i=r[n];++n;let s=i.tok;switch(s._hx_index){case 6:9==s.op._hx_index&&this.addTypeParameter(e,t,i);break;case 14:this.addTypeParameter(e,t,i)}}}break;case 3:this.readExpression(e,t,s,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:1435,className:"refactor.discover.UsageCollector",methodName:"addTypeParameter"});break;case 4:this.makeIdentifier(e,s,ss.TypedParameter,t);let r=0,i=this.findIdentifierChilds(s);for(;r<i.length;){let n=i[r];++r;let s=n.tok;switch(s._hx_index){case 6:9==s.op._hx_index&&this.addTypeParameter(e,t,n);break;case 14:this.addTypeParameter(e,t,n)}}break;case 6:switch(a.op._hx_index){case 7:break e;case 11:this.addTypeParameter(e,t,s)}break;case 10:case 15:break;case 12:this.readTypeHint(e,t,s,ss.TypeHint);break;case 18:this.readBlock(e,t,s);break;case 20:this.readParameter(e,t,s,n.getPos().max)}}}readTypeHint(e,t,n,r){if(null==n)return;if(!n.hasChildren())return;let i=0,s=n.children;e:for(;i<s.length;){let a=s[i];++i;let l=a.tok;switch(l._hx_index){case 2:if(3==l.c._hx_index){this.makeIdentifier(e,a,r,t),n.matches(oa.DblDot)&&null!=t&&t.setTypeHint(hs.makeTypeHint(a));let i=0,s=this.findIdentifierChilds(a);for(;i<s.length;){let n=s[i];++i;let r=n.tok;switch(r._hx_index){case 3:this.readExpression(e,t,n,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:1468,className:"refactor.discover.UsageCollector",methodName:"readTypeHint"});break;case 6:9==r.op._hx_index&&this.addTypeParameter(e,t,n);break;case 7:case 8:case 10:case 21:break;case 14:this.readTypeHint(e,t,n,ss.TypeHint)}}}break;case 3:this.readExpression(e,t,a,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:1485,className:"refactor.discover.UsageCollector",methodName:"readTypeHint"});break;case 4:this.makeIdentifier(e,a,r,t),n.matches(oa.DblDot)&&null!=t&&t.setTypeHint(hs.makeTypeHint(a));let i=0,s=this.findIdentifierChilds(a);for(;i<s.length;){let n=s[i];++i;let r=n.tok;switch(r._hx_index){case 3:this.readExpression(e,t,n,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:1468,className:"refactor.discover.UsageCollector",methodName:"readTypeHint"});break;case 6:9==r.op._hx_index&&this.addTypeParameter(e,t,n);break;case 7:case 8:case 10:case 21:break;case 14:this.readTypeHint(e,t,n,ss.TypeHint)}}break;case 10:case 21:break;case 18:this.readAnonStructure(e,t,a),null!=t&&t.setTypeHint(hs.makeTypeHint(a));break e;case 20:this.readExpression(e,t,a,{fileName:"refactor/discover/UsageCollector.hx",lineNumber:1479,className:"refactor.discover.UsageCollector",methodName:"readTypeHint"}),null!=t&&t.setTypeHint(hs.makeTypeHint(a));break e}}}readAnonStructure(e,t,n){if(!n.hasChildren())return;let r=[],i=0,s=n.children;for(;i<s.length;){let n=s[i];++i;let a=n.tok;switch(a._hx_index){case 1:switch(a.k._hx_index){case 2:case 42:let i=n.getFirstChild();if(null==i)continue;let s=this.makeIdentifier(e,i,ss.TypedefField(r),t);null!=sa.firstOf(sa.firstOf(sa.firstOf(i,oa.At),oa.DblDot),oa.Const(ci.CIdent("optional")))?r.push(ls.Optional(s)):r.push(ls.Required(s)),this.readTypeHint(e,s,this.findIdentifierChild(i),ss.TypeHint)}break;case 2:if(3==a.c._hx_index){let i=this.makeIdentifier(e,n,ss.TypedefField(r),t);null!=sa.firstOf(sa.firstOf(sa.firstOf(n,oa.At),oa.DblDot),oa.Const(ci.CIdent("optional")))?r.push(ls.Optional(i)):r.push(ls.Required(i)),this.readTypeHint(e,i,this.findIdentifierChild(n),ss.TypeHint)}break;case 6:11==a.op._hx_index&&this.readAnonStructure(e,t,n);break;case 7:case 8:case 10:case 19:break;case 22:let i=n.getFirstChild();if(null==i)continue;let s=this.makeIdentifier(e,i,ss.TypedefField(r),t);r.push(ls.Optional(s)),this.readTypeHint(e,s,this.findIdentifierChild(i),ss.TypeHint)}}}findIdentifierChild(e){for(;null!=e;){if(null==(e=e.getFirstChild()))return null;if(e.matches(oa.At)&&(e=e.nextSibling),null==e)return null;let t=e.tok;switch(t._hx_index){case 1:switch(t.k._hx_index){case 22:case 41:break;default:return e}break;case 2:if(3!=t.c._hx_index)return e;break;case 4:case 11:case 13:break;default:return e}}return null}findIdentifierChilds(e){let t=[];for(;null!=e;){if(!e.hasChildren())return t;let n=null,r=!0,i=0,s=e.children;for(;i<s.length;){let e=s[i];++i;let a=e.tok;switch(a._hx_index){case 1:switch(a.k._hx_index){case 22:case 41:if(r){null==n&&(n=e);continue}t.push(e);break;default:t.push(e)}break;case 2:let i=a.c;if(3==i._hx_index)if("is"==i.s)t.push(e);else{if(r){null==n&&(n=e);continue}t.push(e)}else t.push(e);break;case 4:case 11:case 13:if(r){null==n&&(n=e);continue}t.push(e);break;case 10:case 23:break;default:t.push(e)}r=!1}e=n}return t}copyUsesToParent(e,t){if(null==e)return;if(null==t)return;if(null==t.uses)return;if(e==t)return;let n=0,r=t.uses;for(;n<r.length;)e.addUse(r[n++])}}fs.__name__="refactor.discover.UsageCollector",Object.assign(fs.prototype,{__class__:fs});class ms{constructor(e){this.changes=new tt,this.context=e,this.editedIdentifiers=[]}addChange(e,t,n){if(null!=n){if(this.editedIdentifiers.includes(n))return;this.editedIdentifiers.push(n)}let r=this.changes.m.get(e);null==r?this.changes.m.set(e,[t]):r.push(t)}execute(){if(!this.context.forRealExecute)return this.dryRun();let e=!1,t=this.changes.m.entries(),n=t.next();for(;!n.done;){let r=n.value;n=t.next();let i=r[0],s=r[1];s.sort(nl(this,this.sortFileEdits)),e=!0;let a=this.context.docFactory(i),l=0;for(;l<s.length;)a.addChange(s[l++]);a.endEdits()}return e?zi.Done:zi.NoChange}dryRun(){let e=!1,t=this.changes.m.entries(),n=t.next();for(;!n.done;){let r=n.value;n=t.next();let i=r[0],s=r[1];s.sort(nl(this,this.sortFileEdits)),e=!0,process.stdout.write(re.string(""+i)),process.stdout.write("\n");let a=0;for(;a<s.length;){let e=s[a];switch(++a,e._hx_index){case 0:process.stdout.write(re.string('* create file "'+e.newFileName+'"')),process.stdout.write("\n");break;case 1:process.stdout.write(re.string('* delete file "'+e.fileName+'"')),process.stdout.write("\n");break;case 2:process.stdout.write(re.string('* rename to file "'+e.newFileName+'"')),process.stdout.write("\n");break;case 3:let t=e.text,n=e.pos,r='* replace text with "'+t+'" @'+n.start+"-"+n.end+this.formatTypeToString(e.format);process.stdout.write(re.string(r)),process.stdout.write("\n"),this.printDiffLines(n,t);break;case 4:let i=e.text,s=e.pos,a='* insert text "'+i+'" @'+s.start+"-"+s.end+this.formatTypeToString(e.format);process.stdout.write(re.string(a)),process.stdout.write("\n"),process.stdout.write(re.string("+++ "+i)),process.stdout.write("\n");break;case 5:let l=e.pos,o="* remove text @"+l.start+"-"+l.end;process.stdout.write(re.string(o)),process.stdout.write("\n"),this.printDiffLines(l,null)}}}return e?zi.DryRun:zi.NoChange}formatTypeToString(e){switch(e._hx_index){case 0:return"";case 1:let t=e.indentOffset,n=e.trimRight;return 0==t?1==n?" with format and rtrim":" with format":1==n?" with format +indent="+t+" and rtrim":" with format +indent="+t}}sortFileEdits(e,t){let n=function(e){switch(e._hx_index){case 0:case 2:return 0;case 1:return 9999;case 3:case 4:case 5:return e.pos.start}},r=n(e),i=n(t);return r<i?-1:r>i?1:0}printDiffLines(e,t){let n=Ri.bytesOfBuffer(Ei.readFileSync(e.fileName)),r=e.start,i=e.end;for(;r>0;){let e=n.b[r];if(10==e||13==e){++r;break}--r}for(;i<n.length;){let e=n.b[i];if(10==e||13==e)break;++i}let s=n.getString(r,i-r);if(process.stdout.write(re.string("--- "+s)),process.stdout.write("\n"),null!=t){let s=it.ofString(n.getString(0,e.start)+t+n.getString(e.end,n.length-e.end)).getString(r,i+(t.length-(e.end-e.start)-r));process.stdout.write(re.string("+++ "+s)),process.stdout.write("\n")}}}ms.__name__="refactor.edits.Changelist",Object.assign(ms.prototype,{__class__:ms});var _s=r["refactor.edits.FileEdit"]={__ename__:!0,__constructs__:null,CreateFile:(t=function(e){return{_hx_index:0,newFileName:e,__enum__:"refactor.edits.FileEdit",toString:n,__params__:function(){return[this.newFileName]}}},t._hx_name="CreateFile",t),DeleteFile:(t=function(e){return{_hx_index:1,fileName:e,__enum__:"refactor.edits.FileEdit",toString:n,__params__:function(){return[this.fileName]}}},t._hx_name="DeleteFile",t),Move:(t=function(e){return{_hx_index:2,newFileName:e,__enum__:"refactor.edits.FileEdit",toString:n,__params__:function(){return[this.newFileName]}}},t._hx_name="Move",t),ReplaceText:(t=function(e,t,r){return{_hx_index:3,text:e,pos:t,format:r,__enum__:"refactor.edits.FileEdit",toString:n,__params__:function(){return[this.text,this.pos,this.format]}}},t._hx_name="ReplaceText",t),InsertText:(t=function(e,t,r){return{_hx_index:4,text:e,pos:t,format:r,__enum__:"refactor.edits.FileEdit",toString:n,__params__:function(){return[this.text,this.pos,this.format]}}},t._hx_name="InsertText",t),RemoveText:(t=function(e){return{_hx_index:5,pos:e,__enum__:"refactor.edits.FileEdit",toString:n,__params__:function(){return[this.pos]}}},t._hx_name="RemoveText",t)};_s.__constructs__=[_s.CreateFile,_s.DeleteFile,_s.Move,_s.ReplaceText,_s.InsertText,_s.RemoveText];var gs=r["refactor.edits.FormatType"]={__ename__:!0,__constructs__:null,NoFormat:{_hx_name:"NoFormat",_hx_index:0,__enum__:"refactor.edits.FormatType",toString:n},Format:(t=function(e,t){return{_hx_index:1,indentOffset:e,trimRight:t,__enum__:"refactor.edits.FormatType",toString:n,__params__:function(){return[this.indentOffset,this.trimRight]}}},t._hx_name="Format",t)};gs.__constructs__=[gs.NoFormat,gs.Format];var xs=r["refactor.refactor.CanRefactorResult"]={__ename__:!0,__constructs__:null,Unsupported:{_hx_name:"Unsupported",_hx_index:0,__enum__:"refactor.refactor.CanRefactorResult",toString:n},Supported:(t=function(e){return{_hx_index:1,title:e,__enum__:"refactor.refactor.CanRefactorResult",toString:n,__params__:function(){return[this.title]}}},t._hx_name="Supported",t)};xs.__constructs__=[xs.Unsupported,xs.Supported];class ks{static canRefactor(e,t,n){return null==ks.makeExtractConstructorParamsData(e)?xs.Unsupported:n?xs.Supported("Extract Constructor Params as final"):xs.Supported("Extract Constructor Params as var")}static doRefactor(e,t){let n=ks.makeExtractConstructorParamsData(e);if(null==n)return Promise.reject("failed to collect data for extract constructor params");let r=new ms(e),i="",s="",a=0,l=n.parameters;for(;a<l.length;){let r=l[a];++a,i+=re.string(ks.makeField(e,n,r,t)),s+=re.string(ks.makeAssignment(n,r))}let o=ks.findFieldInsertPos(e,n),c=ks.findAssignmentInsertPos(e,n);return o<=0||c<=0?Promise.reject("Extract Constructor Parameter cannot find positions for new fields"):(r.addChange(e.what.fileName,_s.InsertText(i,{fileName:e.what.fileName,start:o,end:o},gs.Format(1,!1)),null),r.addChange(e.what.fileName,_s.InsertText(s,{fileName:e.what.fileName,start:c,end:c},gs.Format(2,!1)),null),Promise.resolve(r.execute()))}static makeExtractConstructorParamsData(e){let t,n,r=e.fileReader(e.what.fileName);switch(r._hx_index){case 0:return null;case 1:t=r.text,n=r.root}if(null==n)return null;if(null==t)return null;let i=e.fileList.getFile(e.what.fileName);if(null==i)return null;let s=Ts.findTokensAtPos(n,e.what.posStart);if(null==s.after)return null;let a=s.after;if(null==a)return null;if(!a.matches(oa.Kwd(li.KwdNew)))return null;let l=i.getIdentifier(a.pos.min),o=ks.findParametersWithNoFields(e,l);if(o.length<=0)return null;let c=a.filterCallback((function(e,t){let n=e.tok;if(2==n._hx_index){let e=n.c;return 3==e._hx_index&&"super"==e.s?ia.FoundSkipSubtree:ia.GoDeeper}return ia.GoDeeper})),u=[],h=null,d=0;for(;d<c.length;){let e=c[d];++d,h=e,e.filterCallback((function(e,t){let n=e.tok;if(2==n._hx_index){let e=n.c;if(3==e._hx_index){let t=e.s,n=0;for(;n<o.length;)if(o[n++].name==t)return u.push(t),ia.GoDeeper}}return ia.GoDeeper}))}let p=[],f=0,m=o;for(;f<m.length;){let e=m[f];++f,u.includes(e.name)||p.push(e)}return o=p,o.length<=0?null:{content:t,root:n,tokenNew:a,identifierNew:l,parameters:o,superToken:h,file:i}}static findParametersWithNoFields(e,t){let n=[],r=[];if(null==(null!=t?t.uses:null))return[];let i=0,s=t.uses;for(;i<s.length;){let e=s[i++].type;if(33==e._hx_index){let t=e.scopeType;if(0==t._hx_index){r=t.params;break}}}let a=t.defineType,l=0;for(;l<r.length;){let e=r[l];++l;let t=a.getIdentifiers(e.name),i=!1,s=0;for(;s<t.length;)if(17==t[s++].type._hx_index){i=!0;break}i||n.push(e)}return n}static makeField(e,t,n,r){let i=Ts.findTokensAtPos(t.root,n.pos.start);if(null==i.after)return"";let s=fa.getLastToken(i.after),a=i.after.getPos();s.matches(oa.Comma)&&(a.max=s.pos.min);let l=Ts.extractText(e.converter,t.content,a.min,a.max);return r?"final "+l+";\n":"var "+l+";\n"}static makeAssignment(e,t){return"this."+t.name+" = "+t.name+";\n"}static findFieldInsertPos(e,t){let n=t.tokenNew.parent;return null==n?ks.findFieldInsertPosFromType(t):null!=n.previousSibling?n.previousSibling.getPos().max+1:(n=n.parent,null==n?ks.findFieldInsertPosFromType(t):n.pos.max+1)}static findFieldInsertPosFromType(e){let t=Ts.findTokensAtPos(e.root,e.identifierNew.defineType.name.pos.start).after;if(null==t)return-1;let n=sa.firstOf(t,oa.BrOpen);return null==n?-1:n.pos.max+1}static findAssignmentInsertPos(e,t){if(null!=t.superToken)return t.superToken.getPos().max+1;let n=sa.firstOf(t.tokenNew,oa.BrOpen);return null==n?-1:n.pos.max}}ks.__name__="refactor.refactor.ExtractConstructorParams";class ys{static canRefactor(e,t){let n=ys.makeExtractInterfaceData(e);return null==n?xs.Unsupported:xs.Supported('Extract Interface from "'+n.srcType.name.name+'" to '+ot.withoutDirectory(n.newFileName))}static doRefactor(e){let t=ys.makeExtractInterfaceData(e);if(null==t)return Promise.reject("failed to collect data for extract interface");let n=new ms(e);n.addChange(t.newFileName,_s.CreateFile(t.newFileName),null);let r=ys.findPublicFields(t,e),i=ys.makeHeader(t,e,ys.findImportCandidates(t,e,r));return ys.makeFields(t,e,r).then((function(e){n.addChange(t.newFileName,_s.InsertText(i+"interface "+t.newTypeName+" {\n"+e+"}",{fileName:t.newFileName,start:0,end:0},gs.Format(0,!1)),null);let r=" implements "+t.newTypeName,s=ys.findImplementsPos(t);return n.addChange(t.srcFile.name,_s.InsertText(r,{fileName:t.srcFile.name,start:s.max,end:s.max},gs.NoFormat),null),Promise.resolve(n.execute())}))}static makeExtractInterfaceData(e){let t,n,r=e.fileReader(e.what.fileName);switch(r._hx_index){case 0:return null;case 1:t=r.text,n=r.root}if(null==n)return null;if(null==t)return null;let i=Ts.findTokensAtPos(n,e.what.posStart);if(null==i.before||null==i.after||i.before.index!=i.after.index)return null;let s=Ts.findFirstImport(n),a=sa.matches(sa.parent(i.before),oa.Kwd(li.KwdClass));if(null==a)return null;let l=new ot(e.what.fileName),o=a.getFirstChild();if(null==o)return null;let c=o.toString(),u="I"+c,h=e.fileList.getFile(e.what.fileName);if(null==h)return null;let d=h.getType(c);if(null==d)return null;let p=ot.join([l.dir,u+".hx"]);return zs.exists(p)?null:{content:t,root:n,firstImport:s,classToken:a,newTypeName:u,newFileName:p,srcFile:h,srcType:d}}static findImplementsPos(e){let t=sa.firstChild(e.classToken),n={file:t.pos.file,min:t.pos.max,max:t.pos.max};if(!t.hasChildren())return n;let r=0,i=t.children;for(;r<i.length;){let e=i[r];if(++r,18==e.tok._hx_index)break;ys.expandPos(n,e.getPos())}return n.min=n.max,n}static findPublicFields(e,t){let n=[];return ys.findAllFields(sa.firstOf(sa.firstChild(e.classToken),oa.BrOpen),n),n}static expandPos(e,t){t.min<e.min&&(e.min=t.min),t.max>e.max&&(e.max=t.max)}static addField(e,t){if(!e.hasChildren())return;let n=e.getFirstChild();if(null==n||!n.hasChildren())return;if(n.matches(oa.Kwd(li.KwdNew)))return;let r={file:e.pos.file,min:e.pos.min,max:e.pos.max};ys.expandPos(r,n.pos);let i=!1,s=!1;if(null!=e.previousSibling){let t=e.previousSibling.tok;7==t._hx_index&&t.s.startsWith("*")&&ys.expandPos(r,e.previousSibling.pos)}let a=0,l=n.children;e:for(;a<l.length;){let e=l[a];++a;let t=e.tok;switch(t._hx_index){case 1:switch(t.k._hx_index){case 18:i=!0;break;case 25:case 31:case 33:case 35:ys.expandPos(r,e.pos);break;default:return}break;case 6:if(4==t.op._hx_index)break e;return;case 12:s=!0,ys.expandPos(r,e.getPos());break;case 18:break e;case 20:ys.expandPos(r,e.getPos());break;default:return}}i&&t.push({nameToken:n,pos:r,hasHint:s,isSharp:!1})}static findAllFields(e,t){if(null==e)return;if(!e.hasChildren())return;let n=0,r=e.children;for(;n<r.length;){let e=r[n];++n;let i=e.tok;switch(i._hx_index){case 1:switch(i.k._hx_index){case 0:case 2:case 42:ys.addField(e,t)}break;case 3:switch(i.s){case"else":t.push({nameToken:e,pos:{file:e.pos.file,min:e.pos.min,max:e.pos.max},hasHint:!0,isSharp:!0}),ys.findAllFields(e,t);break;case"elseif":case"if":if(!e.hasChildren())continue;let n={file:e.pos.file,min:e.pos.min,max:e.pos.max};ys.expandPos(n,e.getFirstChild().getPos()),t.push({nameToken:e,pos:n,hasHint:!0,isSharp:!0}),ys.findAllFields(e,t);break;case"end":t.push({nameToken:e,pos:{file:e.pos.file,min:e.pos.min,max:e.pos.max},hasHint:!0,isSharp:!0})}}}}static makeHeader(e,t,n){let r=Ts.makeNewFileImports(t,e.srcFile,n);if(null==e.firstImport){let n=Ts.getLastHeaderToken(e.root);if(null==e.firstImport)return"";let r=n.getPos();return Ts.extractText(t.converter,e.content,0,r.min-1)+"\n"}let i=e.firstImport.getPos();return Ts.extractText(t.converter,e.content,0,i.min-1)+"\n"+r}static findImportCandidates(e,t,n){let r=[],i=0;for(;i<n.length;){let t=n[i];++i;let s=e.srcType.findAllIdentifiers((function(e){return!(e.pos.start>t.pos.max)&&!(e.pos.end<t.pos.min)})),a=new Array(s.length),l=0,o=s.length;for(;l<o;){let e=l++;a[e]=s[e].name.split(".").shift()}r=r.concat(a)}return r}static makeFields(e,t,n){let r=[],i=0;for(;i<n.length;)r.push(ys.makeField(t,e,n[i++]));return Promise.all(r).then((function(e){return Promise.resolve(e.join(""))}))}static makeField(e,t,n){let r="",i=Ts.extractText(e.converter,t.content,n.pos.min,n.pos.max),s=i.lastIndexOf("function ");if(s<0&&(s=i.lastIndexOf("var ")),s<0&&(s=i.lastIndexOf("final ")),s>0){let e=i.lastIndexOf("*/",s),t="";e<0&&(e=0),e>0&&(t=a.substr(i,0,e));let n=i.substring(e,s),r=a.substr(i,s,null);n=se.replace(n,"public",""),n=se.replace(n,"inline",""),n=se.replace(n,"override",""),n=se.replace(n,"abstract",""),i=t+n+r}return r+=null==i?"null":""+i,n.isSharp?(r+="\n",Promise.resolve(r)):n.hasHint?(i.endsWith(";")||(r+=";"),r+="\n",Promise.resolve(r)):ys.typeHint(e,n.nameToken.pos).then((function(e){return null==e?Promise.resolve(""):(r+=":",r+=re.string($i.printTypeHint(e)),i.endsWith(";")||(r+=";"),r+="\n",Promise.resolve(r))}))}static typeHint(e,t){return null==t?Promise.reject("failed to find return type of selected code"):Gs.findTypeWithTyper(e,e.what.fileName,t.max-1).then((function(e){if(null==e)return Promise.resolve(e);switch(e._hx_index){case 0:case 1:case 3:case 5:return Promise.resolve(e);case 2:return Promise.resolve(e.retVal);case 4:return Promise.resolve(e.typeHint)}}))}}ys.__name__="refactor.refactor.ExtractInterface";class ws{static canRefactor(e,t){if(!t)return xs.Unsupported;let n=ws.makeExtractMethodData(e);return null==n?xs.Unsupported:xs.Supported("Extract Method as "+n.newMethodName)}static doRefactor(e){let t=ws.makeExtractMethodData(e);if(null==t)return Promise.reject("failed to collect data for extract method");let n=new ms(e),r=ws.getFunctionIdentifier(t,e);if(null==r)return Promise.reject("failed to find identifier of containing function");let i=ws.findParameters(t,e,r),s=ws.findLocalParameters(t,e,r),a=ws.findCodeGen(t,e,r,i,s);if(null==a)return Promise.reject("could not extract method from selected code - no codegen");let l="",o="",c=Promise.all(ws.makeParameterList(t,e,s.concat(i))).then((function(e){return l=e.join(", "),Promise.resolve(!0)})),u=a.makeReturnTypeHint().then((function(e){return o=e,Promise.resolve(!0)}));return Promise.all([c,u]).then((function(r){let i=a.makeCallSite();n.addChange(e.what.fileName,_s.ReplaceText(i,{fileName:e.what.fileName,start:t.startToken.pos.min,end:t.endToken.pos.max},gs.Format(t.snippetIndent,!0)),null);let s=(t.isStatic?"static ":"")+"function "+ws.makeFunctionName(t,e)+"("+l+")"+o,c=a.makeBody();return n.addChange(e.what.fileName,_s.InsertText(s+c,{fileName:e.what.fileName,start:t.newMethodOffset,end:t.newMethodOffset},gs.Format(t.functionIndent,!1)),null),n.execute()}))}static makeFunctionName(e,t){let n=sa.firstChild(e.functionToken);if(null==n)return e.newMethodName;let r=sa.firstOf(n,oa.Binop(ht.OpLt));if(null==r)return e.newMethodName;let i=r.getPos();return e.newMethodName+Ts.extractText(t.converter,e.content,i.min,i.max)}static makeExtractMethodData(e){if(e.what.posStart>=e.what.posEnd)return null;let t,n,r=e.fileReader(e.what.fileName);switch(r._hx_index){case 0:return null;case 1:t=r.text,n=r.root}if(null==n)return null;if(null==t)return null;if(null==e.fileList.getFile(e.what.fileName))return null;let i=Ts.findTokensAtPos(n,e.what.posStart),s=Ts.findTokensAtPos(n,e.what.posEnd);if(null==i.after||null==s.before)return null;let a=i.after,l=s.before;if(null==a||null==l)return null;if(a.index>=l.index)return null;let o=Ds.NoFunction,c=a.tok;switch(c._hx_index){case 1:if(0==c.k._hx_index){let e=a.getFirstChild();if(null==e)return null;let t=e.tok;switch(t._hx_index){case 2:let e=t.c;if(3!=e._hx_index)return null;o=Ds.Named(e.s);break;case 20:o=Ds.Unnamed;break;default:return null}}break;case 2:a.hasChildren()&&a.getFirstChild().matches(oa.Arrow)&&(o=Ds.Unnamed);break;case 20:1==fa.getPOpenType(a)._hx_index&&(o=Ds.Unnamed)}let u=fa.getLastToken(l);if(null==u)return null;if(l.index!=u.index)return null;if(!Ts.shareSameParent(a,l))return null;let h,d=ws.findParentFunction(a);if(null==d)return null;for(;h=ws.findParentFunction(d),null!=h;)d=h;let p=null!=sa.firstOf(sa.firstChild(d),oa.Kwd(li.KwdStatic)),f=ws.isSingleExpression(a,l),m=fa.getLastToken(d);if(null==m)return null;let _=m.pos.max+1,g=d.getFirstChild();if(null==g)return null;let x=g.toString()+"Extract";switch(o._hx_index){case 0:case 2:break;case 1:x=o.name}return{content:t,root:n,startToken:a,endToken:l,newMethodOffset:_,newMethodName:x,functionToken:d,isStatic:p,isSingleExpr:f,functionType:o,functionIndent:Ts.calcIndentation(e,t,e.what.fileName,d.pos.min),snippetIndent:Ts.calcIndentation(e,t,e.what.fileName,a.pos.min)}}static getFunctionIdentifier(e,t){let n=t.fileList.getFile(t.what.fileName);return null==n?null:n.getIdentifier(e.functionToken.getFirstChild().pos.min)}static findLocalParameters(e,t,n){if(e.functionType==Ds.NoFunction)return[];let r=[],i=e.startToken.tok;switch(i._hx_index){case 1:if(0==i.k._hx_index){let t=e.startToken.getFirstChild();if(null==t)return[];let i=t.tok;switch(i._hx_index){case 2:if(3!=i.c._hx_index)return[];t=t.getFirstChild();break;case 20:break;default:return[]}let s=0,a=t.children;e:for(;s<a.length;){let e=a[s];++s;let t=e.tok;switch(t._hx_index){case 2:if(3==t.c._hx_index){let t=n.findIdentifier(e.pos.min);null!=t&&r.push(t)}break;case 21:break e}}}break;case 2:let t=n.findIdentifier(e.startToken.pos.min);if(null==t)return[];r.push(t);break;case 20:let s=0,a=e.startToken.children;e:for(;s<a.length;){let e=a[s];++s;let t=e.tok;switch(t._hx_index){case 2:if(3==t.c._hx_index){let t=n.findIdentifier(e.pos.min);null!=t&&r.push(t)}break;case 21:break e}}}return r}static findParameters(e,t,n){let r=ws.getScopedBeforeSelected(e,t,n),i=[],s=n.findAllIdentifiers((function(t){return!(t.pos.start<e.startToken.pos.min||t.pos.start>e.endToken.pos.min)&&(33!=t.type._hx_index||(i.push(t),!1))})),a=new Map,l=0;for(;l<r.length;){let e=r[l];++l,a.set(e.name,e)}let o=[],c=0;for(;c<s.length;){let e=s[c];++c;let t=e.name.split(".").shift(),n=!1,r=0;for(;r<i.length;){let s=i[r];if(++r,s.name!=t)continue;let a=s.type;if(33==a._hx_index&&a.scopeStart<=e.pos.start&&a.scopeEnd>=e.pos.end){n=!0;break}}if(n)continue;if(!a.has(t))continue;let l=a.get(t);o.includes(l)||o.push(l)}return o}static getScopedBeforeSelected(e,t,n){return n.findAllIdentifiers((function(t){if(t.pos.start<e.functionToken.pos.min||t.pos.start>=e.startToken.pos.min)return!1;if(t.name.includes("."))return!1;let n=t.type;return 33==n._hx_index&&(!(n.scopeEnd<=e.startToken.pos.min)&&!(n.scopeStart>e.endToken.pos.max))}))}static getScopedInsideSelected(e,t,n){return n.findAllIdentifiers((function(t){return!(t.pos.start<e.startToken.pos.min||t.pos.start>e.endToken.pos.min)&&33==t.type._hx_index}))}static isSingleExpression(e,t){let n=e.getPos();return t.pos.min>=n.min&&t.pos.max<=n.max||!!t.matches(oa.Semicolon)&&t.pos.min==n.max}static findParentFunction(e){let t=e.parent;for(;null!=t&&null!=t.tok;){let e=t.tok;if(1==e._hx_index&&0==e.k._hx_index)return t;t=t.parent}return null}static findCodeGen(e,t,n,r,i){let s=[],a=e.startToken.parent;if(e.functionType==Ds.NoFunction&&ws.usedAsExpression(a))return e.isSingleExpr?new As(e,t,r):null;let l=ws.findAdditionalScopedVars(e,t,n,r),o=[],c=a.filterCallback((function(t,n){if(t.pos.max<e.startToken.pos.min)return ia.GoDeeper;if(t.pos.min>e.endToken.pos.max)return ia.SkipSubtree;let r=t.tok;switch(r._hx_index){case 1:switch(r.k._hx_index){case 0:return ia.SkipSubtree;case 10:return ia.FoundSkipSubtree;case 24:o.push(t)}break;case 2:let e=r.c;if(3==e._hx_index){let n=e.s,r=t.getFirstChild();if(null!=r){let e=r.tok;switch(e._hx_index){case 5:switch(e.op._hx_index){case 0:case 1:s.push(n)}break;case 6:switch(e.op._hx_index){case 4:case 20:s.push(n)}}}}break;case 14:return ia.SkipSubtree}return ia.GoDeeper})),u=0==c.length;if(c.length>0){let n=c[c.length-1];if(u=ws.isReturnEmpty(n),ws.isSingleExpression(n,e.endToken))return new Es(e,t,r,u)}if(o.length>0&&ws.isSingleExpression(o[o.length-1],e.endToken))return new Es(e,t,r,u);let h=new tt,d=0;for(;d<r.length;){let e=r[d];++d,s.includes(e.name)&&h.m.set(e.name,e)}let p=ws.findIdentifiersUsedAfterSelection(e,n,h);return e.functionType!=Ds.NoFunction?p.length>0?null:new Ns(e,t,r,i,u):0==c.length?new Is(e,t,r,p,l):u?new Fs(e,t,r,c,p,l):new Os(e,t,r,c,p,l)}static isReturnEmpty(e){if(!e.matches(oa.Kwd(li.KwdReturn)))return!1;let t=e.getFirstChild();return null!=t&&10==t.tok._hx_index}static findAdditionalScopedVars(e,t,n,r){let i=ws.getScopedInsideSelected(e,t,n),s=new tt,a=0;for(;a<i.length;){let e=i[a];++a;let n=e.type;33==n._hx_index&&n.scopeEnd>t.what.posEnd&&s.m.set(e.name,e)}return ws.findIdentifiersUsedAfterSelection(e,n,s)}static findIdentifiersUsedAfterSelection(e,t,n){let r=new Map,i=t.findAllIdentifiers((function(t){if(t.pos.start<e.endToken.pos.max)return!1;let i=t.name.split(".").shift();if(!n.m.has(i))return!1;let s=n.m.get(i).type;return 33==s._hx_index&&(!(t.pos.start>s.scopeEnd)&&(33!=t.type._hx_index||(r.set(t.name,t),!1)))})),s=[],a=0;for(;a<i.length;){let e=i[a];++a;let t=e.name.split(".").shift();if(r.has(t)){let n=r.get(t);if(e.pos.start>=n.pos.start&&e.pos.end<=n.pos.end)continue}let l=n.m.get(t);s.includes(l)||s.push(l)}return s}static makeParameterList(e,t,n){let r=[],i=0;for(;i<n.length;){let e=n[i];++i;let s=ws.findTypeOfIdentifier(t,e).then((function(t){return Promise.resolve(ws.buildParameter(e,t))}));r.push(s)}return r}static findTypeOfIdentifier(e,t){let n=t.getTypeHintNew(e.typeList);if(null!=n)return Promise.resolve(n);let r=t.getTypeHintNew(e.typeList);if(null!=r)return Promise.resolve(r);let i=t.getTypeHint();return null!=i?Gs.typeFromTypeHint(e,i):Gs.findTypeOfIdentifier(e,{name:t.name,pos:t.pos.end-1,defineType:t.defineType})}static buildParameter(e,t){return null==t?e.name+":Any":e.name+":"+$i.printTypeHint(t)}static usedAsExpression(e){if(null==e)return!1;let t=e.tok;switch(t._hx_index){case 1:return 10==t.k._hx_index;case 6:case 20:return!0;default:return!1}}}ws.__name__="refactor.refactor.ExtractMethod";class bs{static canRefactor(e,t){let n=bs.makeExtractTypeData(e);return null==n?xs.Unsupported:xs.Supported('Extract Type "'+n.name+'" to '+ot.withoutDirectory(n.newFileName))}static doRefactor(e){let t=bs.makeExtractTypeData(e);if(null==t)return Promise.reject("failed to collect data for extract type");let n=bs.makeHeader(t,e),r=t.typeToken.getPos(),i=fa.getDocComment(t.typeToken);null!=i&&i.pos.min<r.min&&(r.min=i.pos.min);let s=new ms(e),a=Ts.extractText(e.converter,t.content,r.min,r.max);return s.addChange(e.what.fileName,_s.RemoveText({fileName:r.file,start:r.min,end:r.max}),null),s.addChange(t.newFileName,_s.CreateFile(t.newFileName),null),s.addChange(t.newFileName,_s.InsertText(n+a,{fileName:t.newFileName,start:0,end:0},gs.Format(0,!1)),null),bs.findImportLocations(e,t,s),Promise.resolve(s.execute())}static makeExtractTypeData(e){let t,n,r=e.fileReader(e.what.fileName);switch(r._hx_index){case 0:return null;case 1:t=r.text,n=r.root}if(null==n)return null;if(null==t)return null;let i=Ts.findTokensAtPos(n,e.what.posStart);if(null==i.before||null==i.after||i.before.index!=i.after.index)return null;let s=Ts.findFirstImport(n),a=bs.findTypeToken(i.before);if(null==a)return null;if(bs.insideConditional(a))return null;let l=new ot(e.what.fileName),o=a.getFirstChild();if(null==o)return null;let c=o.toString();if(c==l.file||null==l.dir)return null;let u=e.fileList.getFile(e.what.fileName);if(null==u)return null;let h=u.getType(c);if(null==h)return null;let d=ot.join([l.dir,c+".hx"]);return zs.exists(d)?null:{content:t,root:n,firstImport:s,typeToken:a,name:c,newFileName:d,oldFile:u,oldType:h}}static findTypeToken(e){if(null==e)return null;let t=e.tok;switch(t._hx_index){case 0:return null;case 1:switch(t.k._hx_index){case 1:case 26:case 28:case 32:case 40:return e}}let n=e.parent;if(null==n)return null;let r=n.tok;if(1!=r._hx_index)return null;switch(r.k._hx_index){case 1:case 26:case 28:case 32:case 40:return n;default:return null}}static insideConditional(e){for(;;){let t=e.parent;if(null==t)return!1;switch(t.tok._hx_index){case 0:return!1;case 3:return!0;default:e=t;continue}}}static makeHeader(e,t){let n=e.oldType.uses,r=new Array(n.length),i=0,s=n.length;for(;i<s;){let e=i++;r[e]=n[e].name.split(".").shift()}let a=Ts.makeNewFileImports(t,e.oldFile,r);if(null==e.firstImport){let n=Ts.getLastHeaderToken(e.root);if(null==e.firstImport)return"";let r=n.getPos();return Ts.extractText(t.converter,e.content,0,r.min-1)+"\n"}let l=e.firstImport.getPos();return Ts.extractText(t.converter,e.content,0,l.min-1)+"\n"+a}static findImportLocations(e,t,n){let r=t.oldType.get_fullModuleName(),i=t.oldFile.packageIdentifier,s=(null!=i?i.name:null)+".",a=null!=s?s:"",l=a+t.oldFile.getMainModulName(),o=a+t.name,c=e.nameMap.getIdentifiers(r),u=0;for(;u<c.length;){let e=c[u];++u,n.addChange(e.file.name,_s.ReplaceText(o,e.pos,gs.NoFormat),e)}c=e.nameMap.getIdentifiers(t.name);let h=[],d=0;for(;d<c.length;){let e=c[d++].file,t=0,n=e.importList;for(;t<n.length;)if(n[t++].moduleName.name==l){h.includes(e)||h.push(e);break}}let p="import "+o+";\n",f=0;for(;f<h.length;){let e=h[f];++f,n.addChange(e.name,_s.InsertText(p,{fileName:e.name,start:e.importInsertPos,end:e.importInsertPos},gs.NoFormat),null)}}}bs.__name__="refactor.refactor.ExtractType";class Ts{static findTokensAtPos(e,t){let n={before:null,after:null},r=1e4,i=1e4;return e.filterCallback((function(e,s){if(e.pos.min<t){let i=t-e.pos.max;r>i&&(n.before=e,r=i)}if(e.pos.max>t){let r=e.pos.min-t;i>r&&(n.after=e,i=r)}return ia.GoDeeper})),n}static extractText(e,t,n,r){return t.substring(e(t,n),e(t,r))}static findFirstImport(e){if(!e.hasChildren())return null;let t=0,n=e.children;for(;t<n.length;){let e=n[t];++t;let r=e.tok;switch(r._hx_index){case 1:switch(r.k._hx_index){case 0:case 1:case 2:case 26:case 28:case 32:case 40:case 42:case 13:case 36:return e}break;case 3:return null}}return null}static makeNewFileImports(e,t,n){let r=[],i=[],s=[],a=0,l=t.importList;for(;a<l.length;){let e=l[a];++a,e.moduleName.type==ss.UsingModul&&r.push(e),e.starImport?r.push(e):null==e.alias?(i.push(e.moduleName.name.split(".").pop()),s.push(e)):(i.push(e.alias.name),s.push(e))}let o=0;for(;o<n.length;){let e=i.indexOf(n[o++]);if(e>=0){let t=s[e];if(r.includes(t))continue;r.push(t)}}let c="",u=0;for(;u<r.length;){let e=r[u];switch(++u,e.moduleName.type._hx_index){case 1:c+="import ",c+=re.string(e.moduleName.name),e.starImport&&(c+=".*"),c+=";\n";break;case 2:c+="import ",c+=re.string(e.moduleName.name),c+=" as ",c+=re.string(e.alias.name),c+=";\n";break;case 3:c+="using ",c+=re.string(e.moduleName.name),c+=";\n"}}let h=c;return h.length<=0?"":h+"\n"}static getLastHeaderToken(e){return e.filterCallback((function(e,t){let n=e.tok;switch(n._hx_index){case 1:switch(n.k._hx_index){case 0:case 1:case 2:case 26:case 28:case 32:case 40:case 42:return ia.FoundSkipSubtree;case 13:case 34:case 36:return ia.SkipSubtree}break;case 7:case 8:return ia.SkipSubtree}return ia.GoDeeper})).shift()}static calcIndentation(e,t,n,r){let i=pe.loadConfig(n),l=r-200;l<0&&(l=0);let o=Ts.extractText(e.converter,t,l,r),c=o.lastIndexOf("\n"),u=o.lastIndexOf("\r");if(u<0&&(u=c),c<0&&(c=u),c<0)return 0;let h=a.substr(o,c>u?c:u,null),d=new s("([\t ]+).*","");if(!d.match(h))return 0;let p=d.matched(1),f=null!=i?i.indentation:null,m=null!=f?f.character:null,_=null!=m?m:"tab";"tab"==_.toLowerCase()&&(_="\t");let g=p.split(_);return g.length<=0?0:g.length-1}static rangeInSameScope(e){if(e.what.posStart==e.what.posEnd)return!0;let t,n,r=e.fileReader(e.what.fileName);switch(r._hx_index){case 0:return null;case 1:t=r.text,n=r.root}if(null==n)return!1;if(null==t)return!1;if(null==e.fileList.getFile(e.what.fileName))return!1;let i=Ts.findTokensAtPos(n,e.what.posStart),s=Ts.findTokensAtPos(n,e.what.posEnd);if(null==i.after||null==s.before)return!1;let a=i.after,l=s.before;if(null==a||null==l)return!1;if(a.index>=l.index)return!1;let o=fa.getLastToken(l);return null!=o&&(l.index==o.index&&Ts.shareSameParent(a,l))}static shareSameParent(e,t){let n=e.parent;if(null==n)return!1;switch(n.tok._hx_index){case 16:let e=sa.firstOf(n,oa.BkClose);if(null==e)return!1;if(e.index<t.index)return!1;break;case 18:let r=sa.firstOf(n,oa.BrClose);if(null==r)return!1;if(r.index<t.index)return!1;break;case 20:let i=sa.firstOf(n,oa.PClose);if(null==i)return!1;if(i.index<t.index)return!1}let r=t.parent,i=t;for(;;){if(null==r)return!1;if(n.index==r.index){let e=fa.getLastToken(i);return null!=e&&e.index<=t.index}i=r,r=r.parent}}}Ts.__name__="refactor.refactor.RefactorHelper";var Ss=r["refactor.refactor.RefactorType"]={__ename__:!0,__constructs__:null,RefactorExtractInterface:{_hx_name:"RefactorExtractInterface",_hx_index:0,__enum__:"refactor.refactor.RefactorType",toString:n},RefactorExtractMethod:{_hx_name:"RefactorExtractMethod",_hx_index:1,__enum__:"refactor.refactor.RefactorType",toString:n},RefactorExtractType:{_hx_name:"RefactorExtractType",_hx_index:2,__enum__:"refactor.refactor.RefactorType",toString:n},RefactorExtractConstructorParams:(t=function(e){return{_hx_index:3,asFinal:e,__enum__:"refactor.refactor.RefactorType",toString:n,__params__:function(){return[this.asFinal]}}},t._hx_name="RefactorExtractConstructorParams",t),RefactorRewriteVarsToFinals:(t=function(e){return{_hx_index:4,toFinals:e,__enum__:"refactor.refactor.RefactorType",toString:n,__params__:function(){return[this.toFinals]}}},t._hx_name="RefactorRewriteVarsToFinals",t),RefactorRewriteWrapWithTryCatch:{_hx_name:"RefactorRewriteWrapWithTryCatch",_hx_index:5,__enum__:"refactor.refactor.RefactorType",toString:n}};Ss.__constructs__=[Ss.RefactorExtractInterface,Ss.RefactorExtractMethod,Ss.RefactorExtractType,Ss.RefactorExtractConstructorParams,Ss.RefactorRewriteVarsToFinals,Ss.RefactorRewriteWrapWithTryCatch];class Cs{static canRefactor(e,t,n){return null==Cs.makeRewriteVarsToFinalsData(e,n)?xs.Unsupported:n?xs.Supported("Rewrite Vars to Finals"):xs.Supported("Rewrite Finals to Vars")}static doRefactor(e,t){let n=Cs.makeRewriteVarsToFinalsData(e,t);if(null==n)return Promise.reject("failed to collect data for rewrite vars/finals");let r=new ms(e),i=0,s=n.allVarTokens;for(;i<s.length;){let n=s[i];++i,t?r.addChange(e.what.fileName,_s.ReplaceText("final",{fileName:e.what.fileName,start:n.pos.min,end:n.pos.max},gs.NoFormat),null):r.addChange(e.what.fileName,_s.ReplaceText("var",{fileName:e.what.fileName,start:n.pos.min,end:n.pos.max},gs.NoFormat),null)}return Promise.resolve(r.execute())}static makeRewriteVarsToFinalsData(e,t){let n,r,i=e.fileReader(e.what.fileName);switch(i._hx_index){case 0:return null;case 1:n=i.text,r=i.root}if(null==r)return null;if(null==n)return null;let s=Ts.findTokensAtPos(r,e.what.posStart);if(null==s.after)return null;let a=s.after;if(null==a)return null;let l=a.parent;e:for(;null!=l;)switch(l.tok._hx_index){case 0:case 18:break e;default:l=l.parent}if(null==l)return null;let o=l.filterCallback((function(n,r){if(n.pos.max<e.what.posStart)return ia.GoDeeper;if(n.pos.min>e.what.posEnd)return ia.SkipSubtree;let i=n.tok;if(1!=i._hx_index)return ia.GoDeeper;switch(i.k._hx_index){case 2:return t?null!=sa.firstOf(sa.firstChild(n),oa.POpen)?ia.SkipSubtree:ia.FoundSkipSubtree:ia.SkipSubtree;case 42:let e=n.parent;return null==e?ia.SkipSubtree:2==e.tok._hx_index?ia.GoDeeper:t?ia.SkipSubtree:ia.FoundSkipSubtree;default:return ia.GoDeeper}}));return o.length<=0?null:{content:n,root:r,allVarTokens:o}}}Cs.__name__="refactor.refactor.RewriteVarsToFinals";class vs{static canRefactor(e,t){return t?null==vs.makeRewriteWrapWithTryCatch(e)?xs.Unsupported:xs.Supported("Wrap With Try…Catch"):xs.Unsupported}static doRefactor(e){let t=vs.makeRewriteWrapWithTryCatch(e);if(null==t)return Promise.reject("failed to collect data for rewrite wrap with try catch");let n=new ms(e),r="try {\n"+Ts.extractText(e.converter,t.content,t.startToken.pos.min,t.endToken.pos.max)+"\n}\ncatch (e:haxe.Exception) {\n// TODO: handle exception\ntrace (e.details());\n}";return n.addChange(e.what.fileName,_s.ReplaceText(r,{fileName:e.what.fileName,start:t.startToken.pos.min,end:t.endToken.pos.max},gs.Format(t.snippetIndent,!0)),null),Promise.resolve(n.execute())}static makeRewriteWrapWithTryCatch(e){if(e.what.posStart>=e.what.posEnd)return null;let t,n,r=e.fileReader(e.what.fileName);switch(r._hx_index){case 0:return null;case 1:t=r.text,n=r.root}if(null==n)return null;if(null==t)return null;if(null==e.fileList.getFile(e.what.fileName))return null;let i=Ts.findTokensAtPos(n,e.what.posStart),s=Ts.findTokensAtPos(n,e.what.posEnd);if(null==i.after||null==s.before)return null;let a=i.after,l=s.before;if(null==a||null==l)return null;if(a.index>=l.index)return null;let o=fa.getLastToken(l);return null==o||l.index!=o.index?null:Ts.shareSameParent(a,l)?{content:t,root:n,startToken:a,endToken:l,snippetIndent:Ts.calcIndentation(e,t,e.what.fileName,a.pos.min)}:null}}vs.__name__="refactor.refactor.RewriteWrapWithTryCatch";class Ps{}Ps.__name__="refactor.refactor.extractmethod.ICodeGen",Ps.__isInterface__=!0,Object.assign(Ps.prototype,{__class__:Ps});class Ls{constructor(e,t,n){this.extractData=e,this.context=t,this.neededIdentifiers=n}findTypeOfIdentifier(e){return ws.findTypeOfIdentifier(this.context,e)}replaceReturnValues(e,t){let n=Ts.extractText(this.context.converter,this.extractData.content,this.extractData.startToken.pos.min,this.extractData.endToken.pos.max),r=this.context.converter(this.extractData.content,this.extractData.startToken.pos.min),i=n;e.reverse();let s=0;for(;s<e.length;){let n=e[s++].getPos(),a=this.context.converter(this.extractData.content,n.min),l=this.context.converter(this.extractData.content,n.max);a-=r,l-=r;let o=i.substring(l);i=i.substring(0,a)+"return "+t(i.substring(a+7,l-1))+";"+o}return i}parentTypeHint(){let e=this.findParentFunction();return null==e?Promise.reject("failed to find return type of selected code"):Gs.findTypeWithTyper(this.context,this.context.what.fileName,e.pos.max-1).then((function(e){if(null==e)return Promise.resolve(e);switch(e._hx_index){case 0:case 1:case 3:case 4:case 5:return Promise.resolve(e);case 2:return Promise.resolve(e.retVal)}}))}findParentFunction(){let e=this.extractData.startToken.parent;for(;;){if(null==e)return null;let t=e.tok;switch(t._hx_index){case 0:return null;case 1:if(0==t.k._hx_index){let t=e.getFirstChild();return null==t?null:2==t.tok._hx_index?t:e}e=e.parent;break;case 14:return e;default:e=e.parent}}}}Ls.__name__="refactor.refactor.extractmethod.CodeGenBase",Ls.__interfaces__=[Ps],Object.assign(Ls.prototype,{__class__:Ls});class As extends Ls{constructor(e,t,n){super(e,t,n)}makeCallSite(){let e=this.neededIdentifiers,t=new Array(e.length),n=0,r=e.length;for(;n<r;){let r=n++;t[r]=e[r].name}let i=t.join(", "),s=this.extractData.newMethodName+"("+i+")";switch(this.extractData.endToken.tok._hx_index){case 10:case 19:return s+";";default:return""+s}}makeReturnTypeHint(){let e=this.extractData.startToken.parent,t=e.tok;switch(t._hx_index){case 1:if(10==t.k._hx_index)return this.parentTypeHint().then((function(e){return null==e?Promise.resolve(""):Promise.resolve(":"+$i.printTypeHint(e))}));break;case 6:switch(t.op._hx_index){case 4:case 20:return e=e.parent,Gs.findTypeWithTyper(this.context,this.context.what.fileName,e.pos.max-1).then((function(e){return null==e?Promise.resolve(""):Promise.resolve(":"+$i.printTypeHint(e))}))}}return Gs.findTypeWithTyper(this.context,this.context.what.fileName,this.extractData.endToken.pos.max-1).then((function(e){return null==e?Promise.resolve(""):Promise.resolve(":"+$i.printTypeHint(e))}))}makeBody(){return" {\nreturn "+Ts.extractText(this.context.converter,this.extractData.content,this.extractData.startToken.pos.min,this.extractData.endToken.pos.max)+"\n}\n"}}As.__name__="refactor.refactor.extractmethod.CodeGenAsExpression",As.__super__=Ls,Object.assign(As.prototype,{__class__:As});class Fs extends Ls{constructor(e,t,n,r,i,s){super(e,t,n),this.returnTokens=r,this.assignments=i,this.vars=s}makeCallSite(){let e=this.neededIdentifiers,t=new Array(e.length),n=0,r=e.length;for(;n<r;){let r=n++;t[r]=e[r].name}let i=t.join(", "),s=this.extractData.newMethodName+"("+i+")",a=this.vars.length;switch(this.assignments.length){case 0:switch(a){case 0:return"if (!"+s+") {\nreturn;\n}";case 1:return"var "+this.vars[0].name+";\nswitch ("+s+") {\ncase None:\nreturn;\ncase Some(data):\n"+this.vars[0].name+" = data;\n}";default:let e=this.vars,t=new Array(e.length),n=0,r=e.length;for(;n<r;){let r=n++;t[r]="var "+e[r].name+";"}let i=t.join("\n"),a=this.assignments.concat(this.vars),l=new Array(a.length),o=0,c=a.length;for(;o<c;){let e=o++,t=a[e];l[e]=t.name+" = data."+t.name+";"}return i+"switch ("+s+") {\ncase None:\nreturn;\ncase Some(data):\n"+l.join("\n")+"\n}"}break;case 1:if(0==a)return"switch ("+s+") {\ncase None:\nreturn;\ncase Some(data):\n"+this.assignments[0].name+" = data;\n}";{let e=this.vars,t=new Array(e.length),n=0,r=e.length;for(;n<r;){let r=n++;t[r]="var "+e[r].name+";"}let i=t.join("\n"),a=this.assignments.concat(this.vars),l=new Array(a.length),o=0,c=a.length;for(;o<c;){let e=o++,t=a[e];l[e]=t.name+" = data."+t.name+";"}return i+"switch ("+s+") {\ncase None:\nreturn;\ncase Some(data):\n"+l.join("\n")+"\n}"}default:let e=this.vars,t=new Array(e.length),n=0,r=e.length;for(;n<r;){let r=n++;t[r]="var "+e[r].name+";"}let i=t.join("\n"),l=this.assignments.concat(this.vars),o=new Array(l.length),c=0,u=l.length;for(;c<u;){let e=c++,t=l[e];o[e]=t.name+" = data."+t.name+";"}return i+"switch ("+s+") {\ncase None:\nreturn;\ncase Some(data):\n"+o.join("\n")+"\n}"}}makeReturnTypeHint(){let e=this.vars.length;switch(this.assignments.length){case 0:switch(e){case 0:return Promise.resolve(":Bool");case 1:return this.findTypeOfIdentifier(this.vars[0]).then((function(e){return null==e?Promise.resolve(""):Promise.resolve(":haxe.ds.Option<"+$i.printTypeHint(e)+">")}));default:let e=[],t=0,n=this.assignments;for(;t<n.length;){let r=n[t];++t,e.push(this.findTypeOfIdentifier(r).then((function(e){return null==e?Promise.resolve(r.name+":Any"):Promise.resolve(r.name+":"+$i.printTypeHint(e))})))}let r=0,i=this.vars;for(;r<i.length;){let t=i[r];++r,e.push(this.findTypeOfIdentifier(t).then((function(e){return null==e?Promise.resolve(t.name+":Any"):Promise.resolve(t.name+":"+$i.printTypeHint(e))})))}return Promise.all(e).then((function(e){return Promise.resolve(":haxe.ds.Option<{"+e.join(", ")+"}>")}))}break;case 1:if(0==e)return this.findTypeOfIdentifier(this.assignments[0]).then((function(e){return null==e?Promise.resolve(""):Promise.resolve(":haxe.ds.Option<"+$i.printTypeHint(e)+">")}));{let e=[],t=0,n=this.assignments;for(;t<n.length;){let r=n[t];++t,e.push(this.findTypeOfIdentifier(r).then((function(e){return null==e?Promise.resolve(r.name+":Any"):Promise.resolve(r.name+":"+$i.printTypeHint(e))})))}let r=0,i=this.vars;for(;r<i.length;){let t=i[r];++r,e.push(this.findTypeOfIdentifier(t).then((function(e){return null==e?Promise.resolve(t.name+":Any"):Promise.resolve(t.name+":"+$i.printTypeHint(e))})))}return Promise.all(e).then((function(e){return Promise.resolve(":haxe.ds.Option<{"+e.join(", ")+"}>")}))}default:let t=[],n=0,r=this.assignments;for(;n<r.length;){let e=r[n];++n,t.push(this.findTypeOfIdentifier(e).then((function(t){return null==t?Promise.resolve(e.name+":Any"):Promise.resolve(e.name+":"+$i.printTypeHint(t))})))}let i=0,s=this.vars;for(;i<s.length;){let e=s[i];++i,t.push(this.findTypeOfIdentifier(e).then((function(t){return null==t?Promise.resolve(e.name+":Any"):Promise.resolve(e.name+":"+$i.printTypeHint(t))})))}return Promise.all(t).then((function(e){return Promise.resolve(":haxe.ds.Option<{"+e.join(", ")+"}>")}))}}makeBody(){let e=this.vars.length;switch(this.assignments.length){case 0:switch(e){case 0:return" {\n"+this.replaceReturnValues(this.returnTokens,(function(e){return"false"}))+"\nreturn true;\n}\n";case 1:return" {\n"+this.replaceReturnValues(this.returnTokens,(function(e){return"None"}))+"\nreturn Some("+this.vars[0].name+");\n}\n";default:let e=this.replaceReturnValues(this.returnTokens,(function(e){return"None"})),t=this.assignments.concat(this.vars),n=new Array(t.length),r=0,i=t.length;for(;r<i;){let e=r++,i=t[e];n[e]=i.name+": "+i.name+",\n"}return" {\n"+e+"\nreturn Some({\n"+re.string(n)+"\n});\n}\n"}break;case 1:if(0==e)return" {\n"+this.replaceReturnValues(this.returnTokens,(function(e){return"None"}))+"\nreturn Some("+this.assignments[0].name+");\n}\n";{let e=this.replaceReturnValues(this.returnTokens,(function(e){return"None"})),t=this.assignments.concat(this.vars),n=new Array(t.length),r=0,i=t.length;for(;r<i;){let e=r++,i=t[e];n[e]=i.name+": "+i.name+",\n"}return" {\n"+e+"\nreturn Some({\n"+re.string(n)+"\n});\n}\n"}default:let t=this.replaceReturnValues(this.returnTokens,(function(e){return"None"})),n=this.assignments.concat(this.vars),r=new Array(n.length),i=0,s=n.length;for(;i<s;){let e=i++,t=n[e];r[e]=t.name+": "+t.name+",\n"}return" {\n"+t+"\nreturn Some({\n"+re.string(r)+"\n});\n}\n"}}}Fs.__name__="refactor.refactor.extractmethod.CodeGenEmptyReturn",Fs.__super__=Ls,Object.assign(Fs.prototype,{__class__:Fs});class Ns extends Ls{constructor(e,t,n,r,i){super(e,t,n),this.localParams=r,this.returnIsEmpty=i}makeCallSite(){switch(this.extractData.functionType._hx_index){case 0:case 1:return"";case 2:if(0==this.neededIdentifiers.length)return this.extractData.newMethodName;if(this.returnIsEmpty){let e=this.localParams,t=new Array(e.length),n=0,r=e.length;for(;n<r;){let r=n++;t[r]=e[r].name}let i=t.join(", "),s=this.localParams.concat(this.neededIdentifiers),a=new Array(s.length),l=0,o=s.length;for(;l<o;){let e=l++;a[e]=s[e].name}let c=a.join(", ");return"function("+i+") { "+this.extractData.newMethodName+"("+c+"); }"}{let e=this.localParams,t=new Array(e.length),n=0,r=e.length;for(;n<r;){let r=n++;t[r]=e[r].name}let i=t.join(", "),s=this.localParams.concat(this.neededIdentifiers),a=new Array(s.length),l=0,o=s.length;for(;l<o;){let e=l++;a[e]=s[e].name}let c=a.join(", ");return"function("+i+") { return "+this.extractData.newMethodName+"("+c+"); }"}}}makeReturnTypeHint(){return this.functionHint().then((function(e){return null==e?Promise.resolve(""):Promise.resolve(":"+$i.printTypeHint(e))}))}functionHint(){let e;switch(this.extractData.functionType._hx_index){case 0:e=null;break;case 1:e=sa.firstChild(this.extractData.startToken);break;case 2:let t=this.extractData.startToken.tok;switch(t._hx_index){case 1:e=0==t.k._hx_index?this.extractData.startToken:null;break;case 2:case 20:e=sa.firstOf(this.extractData.startToken,oa.Arrow);break;default:e=null}}return null==e?Promise.reject("failed to find return type of selected code"):Gs.findTypeWithTyper(this.context,this.context.what.fileName,e.pos.max-1).then((function(e){if(null==e)return Promise.resolve(e);switch(e._hx_index){case 0:case 1:case 3:case 4:case 5:return Promise.resolve(e);case 2:return Promise.resolve(e.retVal)}}))}makeBody(){let e,t;switch(this.extractData.functionType._hx_index){case 0:e=null;break;case 1:e=sa.firstOf(sa.firstChild(this.extractData.startToken),oa.BrOpen);break;case 2:let t=this.extractData.startToken.tok;switch(t._hx_index){case 1:e=0==t.k._hx_index?sa.firstOf(this.extractData.startToken,oa.BrOpen):null;break;case 2:case 20:e=sa.firstChild(sa.firstOf(this.extractData.startToken,oa.Arrow));break;default:e=null}}if(null==e)return"";if(18==e.tok._hx_index){let n=e.getFirstChild();if(null==n)return"";let r=sa.firstOf(e,oa.BrClose);if(null==r)return"";let i=r.previousSibling,s=r.pos.min-1;if(null!=i){let e=fa.getLastToken(i);null!=e&&(s=e.pos.max)}t={file:e.pos.file,min:n.pos.min,max:s}}else t=e.getPos();return" {\n"+Ts.extractText(this.context.converter,this.extractData.content,t.min,t.max)+"\n}\n"}}Ns.__name__="refactor.refactor.extractmethod.CodeGenLocalFunction",Ns.__super__=Ls,Object.assign(Ns.prototype,{__class__:Ns});class Is extends Ls{constructor(e,t,n,r,i){super(e,t,n),this.assignments=r,this.vars=i}makeCallSite(){let e=this.neededIdentifiers,t=new Array(e.length),n=0,r=e.length;for(;n<r;){let r=n++;t[r]=e[r].name}let i=t.join(", "),s=this.extractData.newMethodName+"("+i+")",a=this.vars.length;switch(this.assignments.length){case 0:switch(a){case 0:return s+";";case 1:return"var "+this.vars[0].name+" = "+s+";";default:let e=this.vars,t=new Array(e.length),n=0,r=e.length;for(;n<r;){let r=n++;t[r]="var "+e[r].name+";"}let i=t.join("\n"),a=this.assignments.concat(this.vars),l=new Array(a.length),o=0,c=a.length;for(;o<c;){let e=o++,t=a[e];l[e]=t.name+" = data."+t.name+";"}return i+"\n{\nfinal data = "+s+";\n"+l.join("\n")+"\n}"}break;case 1:if(0==a)return this.assignments[0].name+" = "+s+";";{let e=this.vars,t=new Array(e.length),n=0,r=e.length;for(;n<r;){let r=n++;t[r]="var "+e[r].name+";"}let i=t.join("\n"),a=this.assignments.concat(this.vars),l=new Array(a.length),o=0,c=a.length;for(;o<c;){let e=o++,t=a[e];l[e]=t.name+" = data."+t.name+";"}return i+"\n{\nfinal data = "+s+";\n"+l.join("\n")+"\n}"}default:let e=this.vars,t=new Array(e.length),n=0,r=e.length;for(;n<r;){let r=n++;t[r]="var "+e[r].name+";"}let i=t.join("\n"),l=this.assignments.concat(this.vars),o=new Array(l.length),c=0,u=l.length;for(;c<u;){let e=c++,t=l[e];o[e]=t.name+" = data."+t.name+";"}return i+"\n{\nfinal data = "+s+";\n"+o.join("\n")+"\n}"}}makeReturnTypeHint(){let e=this.vars.length;switch(this.assignments.length){case 0:switch(e){case 0:return Promise.resolve(":Void");case 1:return this.findTypeOfIdentifier(this.vars[0]).then((function(e){return null==e?Promise.resolve(""):Promise.resolve(":"+$i.printTypeHint(e))}));default:let e=[],t=0,n=this.assignments;for(;t<n.length;){let r=n[t];++t,e.push(this.findTypeOfIdentifier(r).then((function(e){return null==e?Promise.resolve(r.name+":Any"):Promise.resolve(r.name+":"+$i.printTypeHint(e))})))}let r=0,i=this.vars;for(;r<i.length;){let t=i[r];++r,e.push(this.findTypeOfIdentifier(t).then((function(e){return null==e?Promise.resolve(t.name+":Any"):Promise.resolve(t.name+":"+$i.printTypeHint(e))})))}return Promise.all(e).then((function(e){return Promise.resolve(":{"+e.join(", ")+"}")}))}break;case 1:if(0==e)return this.findTypeOfIdentifier(this.assignments[0]).then((function(e){return null==e?Promise.resolve(""):Promise.resolve(":"+$i.printTypeHint(e))}));{let e=[],t=0,n=this.assignments;for(;t<n.length;){let r=n[t];++t,e.push(this.findTypeOfIdentifier(r).then((function(e){return null==e?Promise.resolve(r.name+":Any"):Promise.resolve(r.name+":"+$i.printTypeHint(e))})))}let r=0,i=this.vars;for(;r<i.length;){let t=i[r];++r,e.push(this.findTypeOfIdentifier(t).then((function(e){return null==e?Promise.resolve(t.name+":Any"):Promise.resolve(t.name+":"+$i.printTypeHint(e))})))}return Promise.all(e).then((function(e){return Promise.resolve(":{"+e.join(", ")+"}")}))}default:let t=[],n=0,r=this.assignments;for(;n<r.length;){let e=r[n];++n,t.push(this.findTypeOfIdentifier(e).then((function(t){return null==t?Promise.resolve(e.name+":Any"):Promise.resolve(e.name+":"+$i.printTypeHint(t))})))}let i=0,s=this.vars;for(;i<s.length;){let e=s[i];++i,t.push(this.findTypeOfIdentifier(e).then((function(t){return null==t?Promise.resolve(e.name+":Any"):Promise.resolve(e.name+":"+$i.printTypeHint(t))})))}return Promise.all(t).then((function(e){return Promise.resolve(":{"+e.join(", ")+"}")}))}}makeBody(){let e=Ts.extractText(this.context.converter,this.extractData.content,this.extractData.startToken.pos.min,this.extractData.endToken.pos.max),t=this.vars.length;switch(this.assignments.length){case 0:switch(t){case 0:return" {\n"+e+"\n}\n";case 1:return" {\n"+e+"\nreturn "+this.vars[0].name+";\n}\n";default:let t=this.assignments.concat(this.vars),n=new Array(t.length),r=0,i=t.length;for(;r<i;){let e=r++,i=t[e];n[e]=i.name+": "+i.name+","}return" {\n"+e+"\nreturn {\n"+n.join("\n")+"\n};\n}\n"}break;case 1:if(0==t)return" {\n"+e+"\nreturn "+this.assignments[0].name+";\n}\n";{let t=this.assignments.concat(this.vars),n=new Array(t.length),r=0,i=t.length;for(;r<i;){let e=r++,i=t[e];n[e]=i.name+": "+i.name+","}return" {\n"+e+"\nreturn {\n"+n.join("\n")+"\n};\n}\n"}default:let n=this.assignments.concat(this.vars),r=new Array(n.length),i=0,s=n.length;for(;i<s;){let e=i++,t=n[e];r[e]=t.name+": "+t.name+","}return" {\n"+e+"\nreturn {\n"+r.join("\n")+"\n};\n}\n"}}}Is.__name__="refactor.refactor.extractmethod.CodeGenNoReturn",Is.__super__=Ls,Object.assign(Is.prototype,{__class__:Is});class Os extends Ls{constructor(e,t,n,r,i,s){super(e,t,n),this.returnTokens=r,this.assignments=i,this.vars=s}makeCallSite(){let e=this.neededIdentifiers,t=new Array(e.length),n=0,r=e.length;for(;n<r;){let r=n++;t[r]=e[r].name}let i=t.join(", "),s=this.extractData.newMethodName+"("+i+")",a=this.vars.length;switch(this.assignments.length){case 0:switch(a){case 0:return"switch ("+s+") {\ncase Some(data):\nreturn data;\ncase None:\n}";case 1:return"var "+this.vars[0].name+";\n{\nfinal result = "+s+";\nswitch (result.ret) {\ncase Some(data):\nreturn data;\ncase None:\n"+this.vars[0].name+" = result.data;\n}\n}";default:let e=this.vars,t=new Array(e.length),n=0,r=e.length;for(;n<r;){let r=n++;t[r]="var "+e[r].name+";"}let i=t.join("\n"),a=this.assignments.concat(this.vars),l=new Array(a.length),o=0,c=a.length;for(;o<c;){let e=o++,t=a[e];l[e]=t.name+" = result.data."+t.name+";"}return i+"{\nfinal result = "+s+";\nswitch (result.ret) {\ncase Some(data):\nreturn data;\ncase None:\n"+l.join("\n")+"\n}\n}"}break;case 1:if(0==a)return"{\nfinal result = "+s+";\nswitch (result.ret) {\ncase Some(data):\nreturn data;\ncase None:\n"+this.assignments[0].name+" = result.data;\n}\n}";{let e=this.vars,t=new Array(e.length),n=0,r=e.length;for(;n<r;){let r=n++;t[r]="var "+e[r].name+";"}let i=t.join("\n"),a=this.assignments.concat(this.vars),l=new Array(a.length),o=0,c=a.length;for(;o<c;){let e=o++,t=a[e];l[e]=t.name+" = result.data."+t.name+";"}return i+"{\nfinal result = "+s+";\nswitch (result.ret) {\ncase Some(data):\nreturn data;\ncase None:\n"+l.join("\n")+"\n}\n}"}default:let e=this.vars,t=new Array(e.length),n=0,r=e.length;for(;n<r;){let r=n++;t[r]="var "+e[r].name+";"}let i=t.join("\n"),l=this.assignments.concat(this.vars),o=new Array(l.length),c=0,u=l.length;for(;c<u;){let e=c++,t=l[e];o[e]=t.name+" = result.data."+t.name+";"}return i+"{\nfinal result = "+s+";\nswitch (result.ret) {\ncase Some(data):\nreturn data;\ncase None:\n"+o.join("\n")+"\n}\n}"}}makeReturnTypeHint(){let e=this.vars.length;switch(this.assignments.length){case 0:switch(e){case 0:return this.parentTypeHint().then((function(e){return null==e?Promise.resolve(""):Promise.resolve(":haxe.ds.Option<"+$i.printTypeHint(e)+">")}));case 1:let e=[];return e.push(this.parentTypeHint().then((function(e){return null==e?Promise.resolve(""):Promise.resolve("ret:haxe.ds.Option<"+$i.printTypeHint(e)+">")}))),e.push(this.findTypeOfIdentifier(this.vars[0]).then((function(e){return null==e?Promise.resolve(""):Promise.resolve("?data:"+$i.printTypeHint(e))}))),Promise.all(e).then((function(e){return Promise.resolve(":{"+e.join(", ")+"}")}));default:let t=this.parentTypeHint().then((function(e){return null==e?Promise.resolve(""):Promise.resolve("ret:haxe.ds.Option<"+$i.printTypeHint(e)+">")})),n=[],r=0,i=this.assignments;for(;r<i.length;){let e=i[r];++r,n.push(this.findTypeOfIdentifier(e).then((function(t){return null==t?Promise.resolve(e.name+":Any"):Promise.resolve(e.name+":"+$i.printTypeHint(t))})))}let s=0,a=this.vars;for(;s<a.length;){let e=a[s];++s,n.push(this.findTypeOfIdentifier(e).then((function(t){return null==t?Promise.resolve(e.name+":Any"):Promise.resolve(e.name+":"+$i.printTypeHint(t))})))}let l=Promise.all(n).then((function(e){return Promise.resolve("?data:{"+e.join(", ")+"}")}));return Promise.all([t,l]).then((function(e){return Promise.resolve(":{"+e.join(", ")+"}")}))}break;case 1:if(0==e){let e=[];return e.push(this.parentTypeHint().then((function(e){return null==e?Promise.resolve(""):Promise.resolve("ret:haxe.ds.Option<"+$i.printTypeHint(e)+">")}))),e.push(this.findTypeOfIdentifier(this.assignments[0]).then((function(e){return null==e?Promise.resolve(""):Promise.resolve("?data:"+$i.printTypeHint(e))}))),Promise.all(e).then((function(e){return Promise.resolve(":{"+e.join(", ")+"}")}))}{let e=this.parentTypeHint().then((function(e){return null==e?Promise.resolve(""):Promise.resolve("ret:haxe.ds.Option<"+$i.printTypeHint(e)+">")})),t=[],n=0,r=this.assignments;for(;n<r.length;){let e=r[n];++n,t.push(this.findTypeOfIdentifier(e).then((function(t){return null==t?Promise.resolve(e.name+":Any"):Promise.resolve(e.name+":"+$i.printTypeHint(t))})))}let i=0,s=this.vars;for(;i<s.length;){let e=s[i];++i,t.push(this.findTypeOfIdentifier(e).then((function(t){return null==t?Promise.resolve(e.name+":Any"):Promise.resolve(e.name+":"+$i.printTypeHint(t))})))}let a=Promise.all(t).then((function(e){return Promise.resolve("?data:{"+e.join(", ")+"}")}));return Promise.all([e,a]).then((function(e){return Promise.resolve(":{"+e.join(", ")+"}")}))}default:let t=this.parentTypeHint().then((function(e){return null==e?Promise.resolve(""):Promise.resolve("ret:haxe.ds.Option<"+$i.printTypeHint(e)+">")})),n=[],r=0,i=this.assignments;for(;r<i.length;){let e=i[r];++r,n.push(this.findTypeOfIdentifier(e).then((function(t){return null==t?Promise.resolve(e.name+":Any"):Promise.resolve(e.name+":"+$i.printTypeHint(t))})))}let s=0,a=this.vars;for(;s<a.length;){let e=a[s];++s,n.push(this.findTypeOfIdentifier(e).then((function(t){return null==t?Promise.resolve(e.name+":Any"):Promise.resolve(e.name+":"+$i.printTypeHint(t))})))}let l=Promise.all(n).then((function(e){return Promise.resolve("?data:{"+e.join(", ")+"}")}));return Promise.all([t,l]).then((function(e){return Promise.resolve(":{"+e.join(", ")+"}")}))}}makeBody(){let e=this.vars.length;switch(this.assignments.length){case 0:switch(e){case 0:return" {\n"+this.replaceReturnValues(this.returnTokens,(function(e){return"Some("+e+")"}))+"\nreturn None;\n}\n";case 1:return" {\n"+this.replaceReturnValues(this.returnTokens,(function(e){return"{ret: Some("+e+")}"}))+"\nreturn {ret: None, data: "+this.vars[0].name+"};\n}\n";default:let e=this.replaceReturnValues(this.returnTokens,(function(e){return"{ret: Some("+e+")}"})),t=this.assignments.concat(this.vars),n=new Array(t.length),r=0,i=t.length;for(;r<i;){let e=r++,i=t[e];n[e]=i.name+": "+i.name+",\n"}return" {\n"+e+"\nreturn {ret: None, data: {\n"+re.string(n)+"\n}};\n}\n"}break;case 1:if(0==e)return" {\n"+this.replaceReturnValues(this.returnTokens,(function(e){return"{ret: Some("+e+")}"}))+"\nreturn {ret: None, data: "+this.assignments[0].name+"};\n}\n";{let e=this.replaceReturnValues(this.returnTokens,(function(e){return"{ret: Some("+e+")}"})),t=this.assignments.concat(this.vars),n=new Array(t.length),r=0,i=t.length;for(;r<i;){let e=r++,i=t[e];n[e]=i.name+": "+i.name+",\n"}return" {\n"+e+"\nreturn {ret: None, data: {\n"+re.string(n)+"\n}};\n}\n"}default:let t=this.replaceReturnValues(this.returnTokens,(function(e){return"{ret: Some("+e+")}"})),n=this.assignments.concat(this.vars),r=new Array(n.length),i=0,s=n.length;for(;i<s;){let e=i++,t=n[e];r[e]=t.name+": "+t.name+",\n"}return" {\n"+t+"\nreturn {ret: None, data: {\n"+re.string(r)+"\n}};\n}\n"}}}Os.__name__="refactor.refactor.extractmethod.CodeGenOpenEnded",Os.__super__=Ls,Object.assign(Os.prototype,{__class__:Os});class Es extends Ls{constructor(e,t,n,r){super(e,t,n),this.returnEmpty=r}makeCallSite(){let e=this.neededIdentifiers,t=new Array(e.length),n=0,r=e.length;for(;n<r;){let r=n++;t[r]=e[r].name}let i=t.join(", "),s=this.extractData.newMethodName+"("+i+")";return this.returnEmpty?s+";":"return "+s+";"}makeReturnTypeHint(){return this.returnEmpty?Promise.resolve(":Void"):this.parentTypeHint().then((function(e){return null==e?Promise.resolve(""):Promise.resolve(":"+$i.printTypeHint(e))}))}makeBody(){return" {\n"+Ts.extractText(this.context.converter,this.extractData.content,this.extractData.startToken.pos.min,this.extractData.endToken.pos.max)+"\n}\n"}}Es.__name__="refactor.refactor.extractmethod.CodeGenReturnIsLast",Es.__super__=Ls,Object.assign(Es.prototype,{__class__:Es});var Ds=r["refactor.refactor.extractmethod.LocalFunctionType"]={__ename__:!0,__constructs__:null,NoFunction:{_hx_name:"NoFunction",_hx_index:0,__enum__:"refactor.refactor.extractmethod.LocalFunctionType",toString:n},Named:(t=function(e){return{_hx_index:1,name:e,__enum__:"refactor.refactor.extractmethod.LocalFunctionType",toString:n,__params__:function(){return[this.name]}}},t._hx_name="Named",t),Unnamed:{_hx_name:"Unnamed",_hx_index:2,__enum__:"refactor.refactor.extractmethod.LocalFunctionType",toString:n}};Ds.__constructs__=[Ds.NoFunction,Ds.Named,Ds.Unnamed];class Bs{static refactorAnonStructField(e,t,n,r){let i=new ms(e);return i.addChange(n.pos.fileName,_s.ReplaceText(e.what.toName,n.pos,gs.NoFormat),n),Bs.renameFieldsOfType(e,i,n.defineType,r,n.name).then((function(e){return i.execute()}))}static refactorStructureField(e,t,n,r){let i=e.nameMap.getIdentifiers(n.name),s=0;for(;s<i.length;){let t=i[s];++s;let n=t.type;if(21==n._hx_index){let i=n.fields,s=i;if(s=i.concat(Bs.findBaseTypes(e,t.defineType)),Bs.matchesFields(s,r))return Bs.refactorAnonStructField(e,t.file,t,s)}}return Promise.resolve(zi.Unsupported(n.toString()))}static renameFieldsOfType(e,t,n,r,i){let s=n.file.getPackage(),a=n.file.getMainModulName();r=r.concat(Bs.findBaseTypes(e,n));let l=e.nameMap.matchIdentifierPart(i,!0),o=[],c=0;for(;c<l.length;){let u=l[c];++c;let h=u.type;switch(h._hx_index){case 22:if(!Bs.matchesFields(r,h.fieldNames))continue;break;case 29:if(0==h.isNew){o.push(Ms.replaceSingleAccessOrCall(e,t,u,i,[n]));continue}continue;case 31:o.push(Ms.replaceSingleAccessOrCall(e,t,u,i,[n]));continue;default:continue}0!==u.file.importsModule(s,a,n.name.name)._hx_index&&t.addChange(u.pos.fileName,_s.ReplaceText(e.what.toName,u.pos,gs.NoFormat),u)}return o.push(Bs.findAllExtending(e,t,n,r,i)),Promise.all(o).then(null)}static findAllExtending(e,t,n,r,i){let s=e.nameMap.getIdentifiers(n.name.name),a=[],l=0;for(;l<s.length;){let n=s[l];++l,20==n.type._hx_index&&a.push(Bs.renameFieldsOfType(e,t,n.defineType,Bs.getFieldsOfTypedef(n.defineType),i))}return Promise.all(a).then(null)}static matchesFields(e,t){let n=[],r=0;for(;r<e.length;){let i=e[r];switch(++r,i._hx_index){case 0:let e=i.identifier;if(n.push(e.name),!t.includes(e.name))return!1;break;case 1:n.push(i.identifier.name)}}let i=0;for(;i<t.length;)if(!n.includes(t[i++]))return!1;return!0}static findBaseTypes(e,t){let n=[],r=t.findAllIdentifiers((function(e){return 20==e.type._hx_index})),i=0;for(;i<r.length;){let t=Bs.findBase(e,r[i++]);null!=t&&(n=n.concat(Bs.getFieldsOfTypedef(t)))}return n}static getFieldsOfTypedef(e){let t=e.findAllIdentifiers((function(e){return!0})),n=0;for(;n<t.length;){let e=t[n++].type;if(21==e._hx_index)return e.fields}return[]}static findBase(e,t){let n=e.nameMap.getIdentifiers(t.name),r=0;for(;r<n.length;){let e=n[r];if(++r,8==e.type._hx_index&&0!==t.file.importsModule(e.file.getPackage(),e.file.getMainModulName(),t.name)._hx_index)return e.defineType}return null}}Bs.__name__="refactor.rename.RenameAnonStructField";class Rs{static refactorEnumField(e,t,n){let r=new ms(e);r.addChange(n.pos.fileName,_s.ReplaceText(e.what.toName,n.pos,gs.NoFormat),n);let i=t.getPackage(),s=t.getMainModulName(),a=n.defineType.name.name,l=n.defineType.get_fullModuleName(),o=e.nameMap.getIdentifiers(a+"."+n.name),c=0;for(;c<o.length;){let t=o[c];++c;let n=t.file.importsModule(i,s,a);switch(n._hx_index){case 0:continue;case 5:if(n.alias!=a)continue}Ms.replaceTextWithPrefix(t,a+".",e.what.toName,r)}o=e.nameMap.getIdentifiers(l+"."+n.name);let u=0;for(;u<o.length;)Ms.replaceTextWithPrefix(o[u++],l+".",e.what.toName,r);o=e.nameMap.matchIdentifierPart(n.name,!0);let h=[],d=0;for(;d<o.length;){let t=o[d];++d;let l=t.type;switch(l._hx_index){case 28:let o=l.switchIdentifier;h.push(Gs.matchesType(e,{name:o.name,pos:o.pos.start,defineType:o.defineType},Ks.ClasspathType(n.defineType,[])).then((function(n){n&&Ms.replaceTextWithPrefix(t,"",e.what.toName,r)})));continue;case 29:if(0!=l.isNew)continue;{if(29!=t.parent.type._hx_index)continue;let e=t.file.importsModule(i,s,a);switch(e._hx_index){case 0:continue;case 5:if(e.alias!=a)continue}}break;case 31:if(29!=t.parent.type._hx_index)continue;let c=t.file.importsModule(i,s,a);switch(c._hx_index){case 0:continue;case 5:if(c.alias!=a)continue}break;default:continue}Ms.replaceTextWithPrefix(t,"",e.what.toName,r)}return Promise.all(h).then((function(e){return r.execute()}))}}Rs.__name__="refactor.rename.RenameEnumField";class js{static refactorField(e,t,n,r){let i=new ms(e),s=Gs.findDescendantTypes(e,t.getPackage(),n.defineType);s.push(n.defineType);let a=[],l=0;for(;l<s.length;){let t=s[l];if(++l,js.replaceInType(i,t,"",n.name,e.what.toName),js.replaceInTypeWithFieldAccess(i,t,"",n.name,e.what.toName),js.replaceInType(i,t,"super.",n.name,e.what.toName),js.replaceInType(i,t,"this.",n.name,e.what.toName),js.replaceInTypeWithFieldAccess(i,t,"this.",n.name,e.what.toName),23==n.type._hx_index&&(js.replaceInType(i,t,"set_",n.name,e.what.toName),js.replaceInType(i,t,"get_",n.name,e.what.toName)),r){a.push(js.replaceStaticUse(e,i,t,n.name));let r=n.type;18==r._hx_index&&1==r.isStatic&&a.push(Ms.replaceStaticExtension(e,i,n))}}return a.push(js.replaceAccessOrCalls(e,i,n,s)),Promise.all(a).then((function(e){return i.execute()}))}static replaceAccessOrCalls(e,t,n,r){let i=e.nameMap.matchIdentifierPart(n.name,!0),s=[],a=0;for(;a<i.length;)s.push(Ms.replaceSingleAccessOrCall(e,t,i[a++],n.name,r));return Promise.all(s).then(null)}static replaceInType(e,t,n,r,i){let s=t.getIdentifiers(n+r),a=0,l=-1,o=0;for(;o<s.length;){let t=s[o];if(++o,a<t.pos.start&&t.pos.start<l)continue;let r=t.type;switch(r._hx_index){case 22:continue;case 33:a=r.scopeStart,l=r.scopeEnd;continue}Ms.replaceTextWithPrefix(t,n,i,e)}}static replaceInTypeWithFieldAccess(e,t,n,r,i){let s=t.getIdentifiers(n+r),a=t.getStartsWith(""+n+r+".");a=a.concat(t.getStartsWith(""+n+r+"?."));let l=!1,o=0;for(;o<a.length;){let t=a[o];++o;let c=0;e:for(;c<s.length;){let e=s[c];if(++c,e.pos.start>t.pos.start)break;let n=e.type;switch(n._hx_index){case 22:break;case 33:if(n.scopeEnd>t.pos.start){l=!0;break e}}}l||e.addChange(t.pos.fileName,_s.ReplaceText(i,{fileName:t.pos.fileName,start:t.pos.start+n.length,end:t.pos.start+n.length+r.length},gs.NoFormat),t)}}static replaceStaticUse(e,t,n,r){let i=n.file.getPackage(),s=e.nameMap.getIdentifiers(n.name.name+"."+r),a=0;for(;a<s.length;){let r=s[a];switch(++a,r.file.importsModule(i,n.file.getMainModulName(),n.name.name)._hx_index){case 0:case 5:continue}Ms.replaceTextWithPrefix(r,n.name.name+".",e.what.toName,t)}let l=n.get_fullModuleName();s=e.nameMap.getIdentifiers(l+"."+r);let o=0;for(;o<s.length;)Ms.replaceTextWithPrefix(s[o++],l+".",e.what.toName,t);let c=[];if(4==n.name.type._hx_index){s=e.nameMap.matchIdentifierPart(r,!0);let i=0;for(;i<s.length;){let r=s[i];++i;let a=r.type;if(28==a._hx_index){let i=a.switchIdentifier;c.push(Gs.matchesType(e,{name:i.name,pos:i.pos.start,defineType:i.defineType},Ks.ClasspathType(n,[])).then((function(n){n&&Ms.replaceTextWithPrefix(r,"",e.what.toName,t)})))}}}return Promise.all(c).then(null)}}js.__name__="refactor.rename.RenameField";class Ms{static replaceTextWithPrefix(e,t,n,r){t.length<=0?r.addChange(e.pos.fileName,_s.ReplaceText(n,e.pos,gs.NoFormat),e):r.addChange(e.pos.fileName,_s.ReplaceText(n,{fileName:e.pos.fileName,start:e.pos.start+t.length,end:e.pos.end},gs.NoFormat),e)}static replaceStaticExtension(e,t,n){let r=e.nameMap.matchIdentifierPart(n.name,!0);if(null==n.uses)return Promise.resolve(null);let i=null,s=0,l=n.uses;for(;s<l.length;){let e=l[s];++s;let t=e.type;if(33==t._hx_index&&0==t.scopeType._hx_index){i=e;break}}if(null==i)return Promise.resolve(null);let o=[],c=0,u=i.uses;for(;c<u.length;){let i=u[c];++c,26==i.type._hx_index&&o.push(Gs.typeFromTypeHint(e,i).then((function(i){if(null==i)return e.verboseLog("could not find type of first parameter for static extension",{fileName:"refactor/rename/RenameHelper.hx",lineNumber:49,className:"refactor.rename.RenameHelper",methodName:"replaceStaticExtension"}),Promise.resolve(null);let s=[],l=0;for(;l<r.length;){let o=r[l];switch(++l,o.type._hx_index){case 0:case 1:case 2:case 3:continue}let c="";if(o.name==n.name){if(null!=o.parent&&null!=i)switch(i._hx_index){case 0:if(o.parent.name==i.type.name.name){t.addChange(o.pos.fileName,_s.ReplaceText(e.what.toName,o.pos,gs.NoFormat),o);continue}break;case 1:if(o.parent.name==i.name){t.addChange(o.pos.fileName,_s.ReplaceText(e.what.toName,o.pos,gs.NoFormat),o);continue}break;case 2:case 3:case 4:case 5:continue}c=o.name}else c=a.substr(o.name,0,o.name.length-n.name.length-1);s.push(Gs.matchesType(e,{name:c,pos:o.pos.start,defineType:o.defineType},i).then((function(n){n&&Ms.replaceTextWithPrefix(o,c+".",e.what.toName,t)})))}return Promise.all(s).then(null)})))}return Promise.all(o).then(null)}static replaceSingleAccessOrCall(e,t,n,r,i){let s=n.name,l=s.lastIndexOf("."+r);if(l<0){let s=n.type;switch(s._hx_index){case 28:return Ms.replaceArrayAccess(e,t,n,r,i,s.switchIdentifier);case 30:return Ms.replaceArrayAccess(e,t,n,r,i,s.arrayIdentifier)}return Promise.resolve(null)}s=a.substr(s,0,l);let o=function(a){if(!i.includes(a))return;let l={fileName:n.pos.fileName,start:n.pos.start+s.length+1,end:n.pos.end};l.end=l.start+r.length,t.addChange(n.pos.fileName,_s.ReplaceText(e.what.toName,l,gs.NoFormat),n)};return Gs.findTypeOfIdentifier(e,{name:s,pos:n.pos.start,defineType:n.defineType}).then((function(e){if(null!=e)switch(e._hx_index){case 0:o(e.type);break;case 1:let t=e.typeParams;if("Null"!=e.name)return;if(null==t||1!=t.length)return;let n=t[0];if(0===n._hx_index)o(n.type)}}))}static replaceArrayAccess(e,t,n,r,i,s){let a=function(s){let a=0;for(;a<i.length;){if(i[a++]!=s)continue;let l={fileName:n.pos.fileName,start:n.pos.start,end:n.pos.end};l.end=l.start+r.length,t.addChange(n.pos.fileName,_s.ReplaceText(e.what.toName,l,gs.NoFormat),n)}};return Gs.findTypeOfIdentifier(e,{name:s.name,pos:s.pos.end,defineType:n.defineType}).then((function(e){if(null!=e)switch(e._hx_index){case 0:a(e.type);break;case 1:let t=e.typeParams;switch(e.name){case"Array":if(1==t.length){let e=t[0];0==e._hx_index&&a(e.type)}break;case"Null":if(1==t.length){let e=t[0];switch(e._hx_index){case 0:a(e.type);break;case 1:let t=e.typeParams;if("Array"==e.name&&1==t.length){let e=t[0];0==e._hx_index&&a(e.type)}}}}break;case 2:let n=e.retVal;if(null==n)return;if(null!=n)switch(n._hx_index){case 0:a(n.type);break;case 1:let e=n.typeParams;if("Null"==n.name&&1==e.length){let t=e[0];0==t._hx_index&&a(t.type)}}}}))}}Ms.__name__="refactor.rename.RenameHelper";class Hs{static refactorImportAlias(e,t,n){let r=e.nameMap.getIdentifiers(n.name),i="import"==t.getMainModulName(),s=new ms(e),a=0;for(;a<r.length;){let n=r[a];++a,n.file.name!=t.name?i&&n.file.importHxFile.name==t.name&&s.addChange(n.pos.fileName,_s.ReplaceText(e.what.toName,n.pos,gs.NoFormat),n):s.addChange(n.pos.fileName,_s.ReplaceText(e.what.toName,n.pos,gs.NoFormat),n)}return Promise.resolve(s.execute())}}Hs.__name__="refactor.rename.RenameImportAlias";class Ws{static refactorModuleLevelStatic(e,t,n){let r=new ms(e),i=t.getPackage(),s=t.getMainModulName(),a=[];Ws.refactorIdentifier(e,r,s+"."+n.name,s+"."+e.what.toName,a),i.length>0&&Ws.refactorIdentifier(e,r,i+"."+s+"."+n.name,i+"."+s+"."+e.what.toName,a);let l=e.nameMap.getIdentifiers(n.name),o=0;for(;o<l.length;){let n=l[o];++o,(n.pos.fileName==t.name||a.includes(n.pos.fileName))&&r.addChange(n.pos.fileName,_s.ReplaceText(e.what.toName,n.pos,gs.NoFormat),n)}l=e.nameMap.getIdentifiers(i+"."+s);let c=0;for(;c<l.length;){let t=l[c];if(++c,1==t.type._hx_index){let i=t.file.findAllIdentifiers((function(e){return e.name==n.name})),s=0;for(;s<i.length;){let t=i[s];++s;let n=t.type;switch(n._hx_index){case 29:0==n.isNew&&r.addChange(t.pos.fileName,_s.ReplaceText(e.what.toName,t.pos,gs.NoFormat),t);break;case 31:r.addChange(t.pos.fileName,_s.ReplaceText(e.what.toName,t.pos,gs.NoFormat),t)}}}}return Ms.replaceStaticExtension(e,r,n).then((function(e){return r.execute()}))}static refactorIdentifier(e,t,n,r,i){let s=e.nameMap.getIdentifiers(n),a=0;for(;a<s.length;){let e=s[a];++a,1==e.type._hx_index&&i.push(e.pos.fileName),t.addChange(e.pos.fileName,_s.ReplaceText(r,e.pos,gs.NoFormat),e)}let l=n+".",o=r+".";s=e.nameMap.getStartsWith(l);let c=0;for(;c<s.length;){let e=s[c];++c,t.addChange(e.pos.fileName,_s.ReplaceText(o,{fileName:e.pos.fileName,start:e.pos.start,end:e.pos.start+l.length},gs.NoFormat),e)}}}Ws.__name__="refactor.rename.RenameModuleLevelStatic";class Us{static refactorPackageName(e,t,n){let r=new ms(e),i=t.getMainModulName(),s="",a=t.getPackage();a.length>0?(s=t.packageIdentifier.name+".",r.addChange(t.name,_s.ReplaceText(e.what.toName,t.packageIdentifier.pos,gs.NoFormat),n)):r.addChange(t.name,_s.InsertText("package "+e.what.toName+";\n",{fileName:t.name,start:0,end:0},gs.NoFormat),n);let l=e.what.toName+"."+i,o=e.nameMap.getIdentifiers(s+i),c=0;for(;c<o.length;){let e=o[c];++c,r.addChange(e.pos.fileName,_s.ReplaceText(l,e.pos,gs.NoFormat),e)}let u=0,h=t.typeList;for(;u<h.length;){let t=h[u];if(++u,i==t.name.name)continue;let n=t.name.name,a=s+n,l=e.what.toName+"."+n;o=e.nameMap.getIdentifiers(a);let c=0;for(;c<o.length;){let e=o[c];++c,r.addChange(e.pos.fileName,_s.ReplaceText(l,e.pos,gs.NoFormat),e)}a=s+i+"."+n,l=e.what.toName+"."+i+"."+n,o=e.nameMap.getIdentifiers(a);let d=0;for(;d<o.length;){let e=o[d];++d,r.addChange(e.pos.fileName,_s.ReplaceText(l,e.pos,gs.NoFormat),e)}}let d=[];o=e.nameMap.getIdentifiers(i);let p=0;for(;p<o.length;){let e=o[p];if(++p,e.file.name!=t.name&&e.file.getPackage()==a&&!d.includes(e.pos.fileName))switch(e.file.importsModule(a,i,i)._hx_index){case 0:case 4:case 5:break;case 1:case 2:case 3:case 6:r.addChange(e.pos.fileName,_s.InsertText("import "+l+";\n",{fileName:e.pos.fileName,start:e.file.importInsertPos,end:e.file.importInsertPos},gs.NoFormat),e),d.push(e.pos.fileName)}}return Us.moveFileToPackage(e,t,r,a),Promise.resolve(r.execute())}static moveFileToPackage(e,t,n,r){let i=new ot(t.name),s=t.getMainModulName(),l=se.replace(se.replace(i.dir,"/","."),"\\","."),o=l.lastIndexOf("."+r)+1;o<0&&(o=l.indexOf(r));let c=e.what.toName.split(".");c.unshift(ot.removeTrailingSlashes(ot.join(a.substr(l,0,o).split(".")))),c.push(s+".hx"),n.addChange(t.name,_s.Move(ot.join(c)),null),e.fileList.addRecentlyRenamed(t)}}Us.__name__="refactor.rename.RenamePackage";class Js{static refactorScopedLocal(e,t,n,r,i){let s=new ms(e),a=n.name+".",l=e.what.toName+".";s.addChange(n.pos.fileName,_s.ReplaceText(e.what.toName,n.pos,gs.NoFormat),n);let o=n.defineType.findAllIdentifiers((function(e){return!(e.pos.start<r)&&(!(e.pos.start>i)&&(e.name==n.name||!!e.name.startsWith(a)))})),c=n.defineType.findAllIdentifiers((function(t){return!(t.pos.start<r)&&(!(t.pos.start>i)&&(t.name==e.what.toName||!!t.name.startsWith(l)))})),u=0;for(;u<c.length;){let t=c[u];switch(++u,t.type._hx_index){case 29:case 31:s.addChange(t.pos.fileName,_s.InsertText("this.",{fileName:t.pos.fileName,start:t.pos.start,end:t.pos.start},gs.NoFormat),t);break;case 33:return Promise.reject('local var "'+e.what.toName+'" exists')}}let h=!1,d=0,p=-1,f=0;for(;f<o.length;){let t=o[f];if(++f,d<t.pos.start&&t.pos.start<p)continue;let i=t.type;switch(i._hx_index){case 22:continue;case 32:if(h){h=!1;continue}break;case 33:let e=i.scopeStart;if(t.pos.start!=n.pos.start){d=e,p=i.scopeEnd;continue}r=e,h=!0;break;default:if(t.pos.start<r)continue}t.name==n.name?s.addChange(t.pos.fileName,_s.ReplaceText(e.what.toName,t.pos,gs.NoFormat),t):s.addChange(t.pos.fileName,_s.ReplaceText(e.what.toName,{fileName:t.pos.fileName,start:t.pos.start,end:t.pos.start+n.pos.end-n.pos.start},gs.NoFormat),t)}return Promise.resolve(s.execute())}}Js.__name__="refactor.rename.RenameScopedLocal";class Vs{static refactorTypeName(e,t,n){let r,i=new ms(e),s=t.getPackage(),a=t.getMainModulName(),l=new ot(t.name);if(a==n.name){let n=ot.join([l.dir,e.what.toName])+"."+l.ext;i.addChange(t.name,_s.Move(n),null)}if(i.addChange(n.pos.fileName,_s.ReplaceText(e.what.toName,n.pos,gs.NoFormat),n),null!=t.packageIdentifier){let t=n.defineType.get_fullModuleName(),s=t.split(".");s.pop();let a=s.join(".")+".";if(r=e.nameMap.getIdentifiers(t),null!=r){let t=0;for(;t<r.length;)Ms.replaceTextWithPrefix(r[t++],a,e.what.toName,i)}}r=e.nameMap.matchIdentifierPart(n.name,!0);let o=[],c=0;for(;c<r.length;){let t=r[c];if(++c,null==t.defineType)continue;let l=t.file.importsModule(s,a,n.name);switch(l._hx_index){case 0:continue;case 5:if(l.alias!=n.name)continue}switch(t.type._hx_index){case 4:case 5:case 6:case 7:case 8:continue}let u=t.name.startsWith(n.name)?n.name:n.defineType.get_fullModuleName();o.push(Gs.findTypeOfIdentifier(e,{name:u,pos:t.pos.start,defineType:t.defineType}).then((function(r){if(null!=r)switch(r._hx_index){case 0:if(r.type.get_fullModuleName()!=n.defineType.get_fullModuleName())return;break;case 1:case 2:case 3:case 4:case 5:return}t.name!=n.name?t.name.startsWith(n.name+".")&&i.addChange(t.pos.fileName,_s.ReplaceText(e.what.toName,{fileName:t.pos.fileName,start:t.pos.start,end:t.pos.start+n.name.length},gs.NoFormat),t):i.addChange(t.pos.fileName,_s.ReplaceText(e.what.toName,t.pos,gs.NoFormat),t)})))}return Promise.all(o).then((function(r){return a==n.name&&e.fileList.addRecentlyRenamed(t),Promise.resolve(i.execute())}))}}Vs.__name__="refactor.rename.RenameTypeName";var Ks=r["refactor.typing.TypeHintType"]={__ename__:!0,__constructs__:null,ClasspathType:(t=function(e,t){return{_hx_index:0,type:e,typeParams:t,__enum__:"refactor.typing.TypeHintType",toString:n,__params__:function(){return[this.type,this.typeParams]}}},t._hx_name="ClasspathType",t),LibType:(t=function(e,t,r){return{_hx_index:1,name:e,fullName:t,typeParams:r,__enum__:"refactor.typing.TypeHintType",toString:n,__params__:function(){return[this.name,this.fullName,this.typeParams]}}},t._hx_name="LibType",t),FunctionType:(t=function(e,t){return{_hx_index:2,args:e,retVal:t,__enum__:"refactor.typing.TypeHintType",toString:n,__params__:function(){return[this.args,this.retVal]}}},t._hx_name="FunctionType",t),StructType:(t=function(e){return{_hx_index:3,fields:e,__enum__:"refactor.typing.TypeHintType",toString:n,__params__:function(){return[this.fields]}}},t._hx_name="StructType",t),NamedType:(t=function(e,t){return{_hx_index:4,name:e,typeHint:t,__enum__:"refactor.typing.TypeHintType",toString:n,__params__:function(){return[this.name,this.typeHint]}}},t._hx_name="NamedType",t),UnknownType:(t=function(e){return{_hx_index:5,name:e,__enum__:"refactor.typing.TypeHintType",toString:n,__params__:function(){return[this.name]}}},t._hx_name="UnknownType",t)};Ks.__constructs__=[Ks.ClasspathType,Ks.LibType,Ks.FunctionType,Ks.StructType,Ks.NamedType,Ks.UnknownType];class Gs{static findDescendantTypes(e,t,n){let r=[],i=function(e){let t=0;for(;t<r.length;){let n=r[t];if(++t,n.file.name==e.file.name&&n.name.name==e.name.name)return}r.push(e)},s=function(e,t){let n=0;for(;n<e.length;){let r=0,s=e[n++].getIdentifiers(t);for(;r<s.length;){let e=s[r];switch(++r,e.type._hx_index){case 11:case 12:case 13:i(e.defineType)}}}},a=e.nameMap.getIdentifiers(t+"."+n.name.name),l=0;for(;l<a.length;){let e=a[l];switch(++l,e.type._hx_index){case 1:let t,r=e.file.importsModule(n.file.getPackage(),n.file.getMainModulName(),n.name.name);switch(r._hx_index){case 0:continue;case 5:t=r.alias;break;case 1:case 2:case 3:case 4:case 6:t=n.name.name}s(e.file.typeList,t);break;case 11:case 12:case 13:i(e.defineType)}}a=e.nameMap.getIdentifiers(n.name.name);let o=0;for(;o<a.length;){let e=a[o];switch(++o,e.type._hx_index){case 11:case 12:case 13:i(e.defineType)}}let c=0;for(;c<r.length;){let t=r[c];++c;let n=0,s=Gs.findDescendantTypes(e,t.file.getPackage(),t);for(;n<s.length;)i(s[n++])}return r}static matchesType(e,t,n){return Gs.findTypeOfIdentifier(e,t).then((function(e){return null!=e&&Gs.typeHintsEqual(e,n)}))}static typeHintsEqual(e,t){for(;;)switch(e._hx_index){case 0:let n=e.type,r=e.typeParams;switch(t._hx_index){case 0:let e=t.typeParams;if(n.get_fullModuleName()!=t.type.get_fullModuleName())return!1;if(r.length!=e.length)return!1;let i=0,s=r.length;for(;i<s;){let t=i++;if(!Gs.typeHintsEqual(r[t],e[t]))return!1}return!0;case 1:let a=t.typeParams;if("Null"==t.name){if(1==a.length){t=a[0];continue}return!1}return!1;default:return!1}break;case 1:let i=e.name,s=e.typeParams;if(1==t._hx_index){let n=t.typeParams;if(e.fullName!=t.fullName)return!1;if(s.length!=n.length)return!1;let r=0,i=s.length;for(;r<i;){let e=r++;if(!Gs.typeHintsEqual(s[e],n[e]))return!1}return!0}if(1==s.length){if("Null"==i){e=s[0];continue}return!1}return!1;case 2:let a=e.args,l=e.retVal;switch(t._hx_index){case 1:let n=t.typeParams;if("Null"==t.name){if(1==n.length){t=n[0];continue}return!1}return!1;case 2:let r=t.args,i=t.retVal;if(a.length!=r.length)return!1;let s=0,o=a.length;for(;s<o;){let e=s++;if(!Gs.typeHintsEqual(a[e],r[e]))return!1}e=l,t=i;continue;default:return!1}break;case 3:let o=e.fields;switch(t._hx_index){case 1:let e=t.typeParams;if("Null"==t.name){if(1==e.length){t=e[0];continue}return!1}return!1;case 3:let n=t.fields;if(o.length!=n.length)return!1;let r=0,i=o.length;for(;r<i;){let e=r++;if(!Gs.typeHintsEqual(o[e],n[e]))return!1}return!0;default:return!1}break;case 4:let c=e.name,u=e.typeHint;switch(t._hx_index){case 1:let n=t.typeParams;if("Null"==t.name){if(1==n.length){t=n[0];continue}return!1}return!1;case 4:if(c!=t.name)return!1;e=u,t=t.typeHint;continue;default:return!1}break;case 5:let h=e.name;switch(t._hx_index){case 1:let e=t.typeParams;if("Null"==t.name){if(1==e.length){t=e[0];continue}return!1}return!1;case 5:return h==t.name;default:return!1}}}static findTypeWithTyper(e,t,n){if(null==e.typer)return Promise.reject("no typer for "+t+"@"+n);let r=e.fileReader(t);switch(r._hx_index){case 0:case 1:n=e.converter(r.text,n)}return e.typer.resolveType(t,n)}static findTypeOfIdentifier(e,t){for(;;){let n=e,r=t,i=r.name.split(".");if(i.length>1){let e=n.typeList.getType(r.name);if(null!=e)return Promise.resolve(Ks.ClasspathType(e,[]))}let s=i.shift();switch(s){case"super":let s=r.defineType;if(null==s)return Promise.reject("cannot resolve super");let a=s.findAllIdentifiers((function(e){return e.type==ss.Extends}));if(1!=a.length)return Promise.reject("cannot resolve super");let l=hs.findTypeFromImports(a[0].name,n.typeList,s.file);return null==l?Promise.reject("cannot resolve super"):Promise.resolve(Ks.ClasspathType(l,[]));case"this":if(null==r.defineType)return Promise.reject("cannot resolve this");if(i.length>0){e=n,t={name:i.join("."),pos:r.pos,defineType:r.defineType};continue}return Promise.resolve(Ks.ClasspathType(r.defineType,[]))}return Gs.findFieldOrScopedLocal(n,r.defineType,s,r.pos).then((function(e){let t=0,s=null;return s=function(e){if(t>=i.length)return Promise.resolve(e);t+=1;let a=i[t-1];if(null==e){let e=r.defineType;n.verboseLog('unable to determine type of "'+a+'" in '+(null!=e?e.file.name:null)+"@"+r.pos,{fileName:"refactor/typing/TypingHelper.hx",lineNumber:203,className:"refactor.typing.TypingHelper",methodName:"findTypeOfIdentifier"});let t=r.defineType;return Promise.reject('unable to determine type of "'+a+'" in '+(null!=t?t.file.name:null)+"@"+r.pos)}switch(e._hx_index){case 0:return Gs.findField(n,e.type,a).then(s);case 1:let t=e.typeParams;return"Null"==e.name&&1==t.length?s(t[0]):Promise.reject('unable to determine type of "'+a+'" in '+r.defineType.name.name+"@"+r.pos);case 2:return s(e.retVal);case 3:let i=e.fields,l=0;for(;l<i.length;){let e=i[l];if(++l,4==e._hx_index&&e.name==a)return s(e.typeHint)}return Promise.reject('unable to determine type of "'+a+'" in '+r.defineType.name.name+"@"+r.pos);case 4:case 5:return Promise.reject('unable to determine type of "'+a+'" in '+r.defineType.name.name+"@"+r.pos)}},s(e).then((function(e){return Promise.resolve(e)}))}))}}static findFieldOrScopedLocal(e,t,n,r){return null==t?Promise.resolve(null):Gs.findTypeWithBuiltIn(t,n,r,e).then((function(e){return Promise.resolve(e)})).catch((function(n){return Gs.findTypeWithTyper(e,t.file.name,r).catch((function(e){return Promise.resolve(null)}))}))}static findTypeWithBuiltIn(e,t,n,r){if(null==e)return Promise.reject("missing containing type");let i=e.getIdentifiers(t),s=null,l=null,o=0;for(;o<i.length;){let a=i[o];++o;let c=a.type;switch(c._hx_index){case 16:case 17:case 18:case 21:l=a;break;case 27:return Promise.resolve(Ks.ClasspathType(a.defineType,[]));case 28:let i=c.switchIdentifier;if(a.pos.start<=n&&a.pos.end>n)return Gs.findTypeOfIdentifier(r,{name:i.name,pos:i.pos.start,defineType:e});break;case 29:if(1==c.isNew&&a.pos.start<=n&&a.pos.end>n){let n=r.typeList.findTypeName(t),i=0;for(;i<n.length;){let t=n[i];switch(++i,e.file.importsModule(t.file.getPackage(),t.file.getMainModulName(),t.name.name)._hx_index){case 0:case 5:break;case 1:case 2:case 3:case 4:case 6:return Promise.resolve(Ks.ClasspathType(t,[]))}}}break;case 33:n>=c.scopeStart&&n<=c.scopeEnd&&(s=a),n==a.pos.start&&(s=a)}}if(null==s&&(s=l),null==s)return Gs.findGlobalIdentifiers(r,t,e);let c=s.getTypeHintNew(r.typeList);if(null!=c)return Promise.resolve(c);let u=s.getTypeHint(),h=s.type;if(33==h._hx_index){let t=h.scopeType;switch(t._hx_index){case 0:if(null!=u)return Gs.typeFromTypeHint(r,u).then((function(e){return Promise.resolve(e)}));let n=t.params.indexOf(s),i=s.parent.type;if(28==i._hx_index){let t=i.switchIdentifier;return Gs.findFieldOrScopedLocal(r,e,t.name,t.pos.start).then((function(e){if(null==e)return Promise.resolve(null);switch(e._hx_index){case 0:let t=e.type;if(6==t.name.type._hx_index){let e=t.findAllIdentifiers((function(e){return e.name==s.parent.name}));for(;0<e.length;){let t=e[0].type;if(27==t._hx_index){let e=t.params;return e.length<=n?Promise.resolve(null):Promise.resolve(e[n].getTypeHintNew(r.typeList))}return Promise.reject("not an enum field")}}break;case 1:return Promise.resolve(e);case 2:case 3:case 4:case 5:return Promise.reject("")}return Promise.resolve(e)}))}break;case 2:let l=t.origin,o=t.index;return Gs.findFieldOrScopedLocal(r,e,l.name,l.pos.start).then((function(e){if(0==e._hx_index){let t=e.type,n=l.name;n.startsWith(t.name.name+".")&&(n=a.substr(n,t.name.name.length+1,null));let i=t.get_fullModuleName()+".";n.startsWith(i)&&(n=a.substr(n,t.get_fullModuleName().length+1,null));let s=t.getIdentifiers(n),c=0;for(;c<s.length;){let e=s[c++].type;if(27==e._hx_index){let t=e.params;return t.length<o?Promise.reject("not found"):Promise.resolve(t[o].getTypeHintNew(r.typeList))}}}return Promise.reject("cannot resolve type of "+l.name)}));case 3:let c=t.loopIdentifiers,h=c.indexOf(s),d=[],p=0;for(;p<c.length;){let t=c[p];++p;let n=t.type;if(33==n._hx_index){if(3==n.scopeType._hx_index)continue;d.push(Gs.findTypeOfIdentifier(r,{name:t.name,pos:t.pos.start,defineType:e}).then((function(e){if(null!=e)switch(e._hx_index){case 0:let t=e.typeParams;return t.length<=h?Promise.reject("not enough type parameters"):Promise.resolve(t[h]);case 1:let n=e.typeParams;return n.length<=h?Promise.reject("not enough type parameters"):Promise.resolve(n[h])}return Promise.reject("not found")})))}else d.push(Gs.findTypeOfIdentifier(r,{name:t.name,pos:t.pos.start,defineType:e}).then((function(e){if(null!=e)switch(e._hx_index){case 0:let t=e.typeParams;return t.length<=h?Promise.reject("not enough type parameters"):Promise.resolve(t[h]);case 1:let n=e.typeParams;return n.length<=h?Promise.reject("not enough type parameters"):Promise.resolve(n[h])}return Promise.reject("not found")})))}return Promise.race(d).catch((function(e){return null!=u?Gs.typeFromTypeHint(r,u):Promise.reject("type not found")}))}}return null!=u?Gs.typeFromTypeHint(r,u):Promise.reject("cannot resolve type of "+t)}static findGlobalIdentifiers(e,t,n){let r=[],i=e.typeList.findTypeName(t),s=0;e:for(;s<i.length;){let e=i[s];switch(++s,n.file.importsModule(e.file.getPackage(),e.file.getMainModulName(),e.name.name)._hx_index){case 0:case 5:break;case 1:case 2:case 3:case 4:case 6:r.push(Ks.ClasspathType(e,[]));break e}}let a=e.nameMap.getIdentifiers(t),l=0;e:for(;l<a.length;){let e=a[l];switch(++l,e.type._hx_index){case 9:case 10:case 17:case 18:break;case 27:switch(n.file.importsModule(e.file.getPackage(),e.file.getMainModulName(),e.defineType.name.name)._hx_index){case 0:case 5:break;case 1:case 2:case 3:case 4:case 6:r.push(Ks.ClasspathType(e.defineType,[]));break e}}}switch(r.length){case 0:return Promise.reject("no candidate found");case 1:return Promise.resolve(r[0]);default:return Promise.reject("too many candidates found "+r.length)}}static findField(e,t,n){for(;;){let r=t.getIdentifiers(n),i=null,s=0;e:for(;s<r.length;){let e=r[s];switch(++s,e.type._hx_index){case 16:case 17:case 18:case 21:case 27:i=e;break e}}if(null==i||null==i.uses){if(5===t.name.type._hx_index){let n=Gs.findBaseClass(e.typeList,t);if(null==n)return Promise.resolve(null);t=n;continue}return Promise.resolve(null)}let a=i.getTypeHintNew(e.typeList);if(null!=a)return Promise.resolve(a);let l=0,o=i.uses;for(;l<o.length;){let t=o[l];if(++l,26==t.type._hx_index)return Gs.typeFromTypeHint(e,t)}return Promise.resolve(null)}}static findBaseClass(e,t){let n=t.findAllIdentifiers((function(e){return 11==e.type._hx_index})),r=0;for(;r<n.length;){let i=e.findTypeName(n[r++].name),s=0;for(;s<i.length;){let e=i[s];switch(++s,t.file.importsModule(e.file.getPackage(),e.file.getMainModulName(),e.name.name)._hx_index){case 0:case 5:break;case 1:case 2:case 3:case 4:case 6:return e}}}return null}static typeFromTypeHint(e,t){if("Null"==t.name)return null==t.uses||t.uses.length<=0?Promise.reject():Gs.typeFromTypeHint(e,t.uses[0]).then((function(e){return Promise.resolve(Ks.LibType("Null","Null",[e]))}));let n=t.name.split("."),r=n.pop(),i=[];if(null!=t.uses){let n=0,r=t.uses;for(;n<r.length;){let s=r[n];if(++n,19==s.type._hx_index){let n=e.typeList.findTypeName(s.name);if(n.length<=0){i.push(Ks.LibType(s.name,s.name,[]));continue}let r=0;for(;r<n.length;){let e=n[r];switch(++r,t.file.importsModule(e.file.getPackage(),e.file.getMainModulName(),e.name.name)._hx_index){case 0:case 5:break;case 1:case 2:case 3:case 4:case 6:i.push(Ks.ClasspathType(e,[]))}}}}}let s=e.typeList.findTypeName(r);if(n.length>0){let e=0;for(;e<s.length;){let n=s[e];if(++e,n.get_fullModuleName()==t.name)return Promise.resolve(Ks.ClasspathType(n,i))}return Promise.resolve(Ks.LibType(t.name,t.name,i))}let a=0;for(;a<s.length;){let e=s[a];switch(++a,t.file.importsModule(e.file.getPackage(),e.file.getMainModulName(),e.name.name)._hx_index){case 0:case 5:break;case 1:case 2:case 3:case 4:case 6:return Promise.resolve(Ks.ClasspathType(e,i))}}return Promise.resolve(Ks.LibType(t.name,t.name,i))}}Gs.__name__="refactor.typing.TypingHelper";class qs extends Me{constructor(e,t,n){super(e,t,n),this.__skipStack++}}qs.__name__="safety.SafetyException",qs.__super__=Me,Object.assign(qs.prototype,{__class__:qs});class $s extends qs{constructor(e,t,n){super(e,t,n),this.__skipStack++}}$s.__name__="safety.NullPointerException",$s.__super__=qs,Object.assign($s.prototype,{__class__:$s});class zs{static exists(e){try{return Ei.accessSync(e),!0}catch(e){return We.lastError=e,!1}}static isDirectory(e){try{return Ei.statSync(e).isDirectory()}catch(e){return We.lastError=e,!1}}static createDirectory(e){try{Ei.mkdirSync(e)}catch(t){We.lastError=t;let n=Me.caught(t).unwrap();if("ENOENT"==n.code)zs.createDirectory(Bi.dirname(e)),Ei.mkdirSync(e);else{let t;try{t=Ei.statSync(e)}catch(e){throw n}if(!t.isDirectory())throw n}}}}zs.__name__="sys.FileSystem";class Qs{static copy(e,t){let n,r=Ei.openSync(e,"r"),i=Ei.fstatSync(r),s=Ei.openSync(t,"w",i.mode),a=0;for(;n=Ei.readSync(r,Qs.copyBuf,0,65536,a),n>0;)Ei.writeSync(s,Qs.copyBuf,0,n),a+=n;Ei.closeSync(r),Ei.closeSync(s)}}Qs.__name__="sys.io.File";class Zs extends le{constructor(e){super(),this.fd=e,this.pos=0}writeByte(e){let t=jr.alloc(1);t[0]=e,Ei.writeSync(this.fd,t,0,1,this.pos),this.pos++}writeBytes(e,t,n){let r=e.b,i=jr.from(r.buffer,r.byteOffset,e.length),s=Ei.writeSync(this.fd,i,t,n,this.pos);return this.pos+=s,s}close(){Ei.closeSync(this.fd)}}Zs.__name__="sys.io.FileOutput",Zs.__super__=le,Object.assign(Zs.prototype,{__class__:Zs});class Xs{static _new(e){return e}static toTokenTreeDef(e){return e}static fromTokenDef(e){let t;switch(e._hx_index){case 0:t=oa.Eof;break;case 1:let n=e.c;switch(n._hx_index){case 0:t=oa.Const(ci.CInt(n.v,n.s));break;case 1:t=oa.Const(ci.CFloat(n.f,n.s));break;case 2:t=oa.Const(ci.CString(n.s,n.kind));break;case 3:t=oa.Const(ci.CIdent(n.s));break;case 4:t=oa.Const(ci.CRegexp(n.r,n.opt));break;case 5:t=oa.Const(ci.CMarkup(n.s))}break;case 2:t=oa.Kwd(e.k);break;case 3:t=oa.Comment(e.s);break;case 4:t=oa.CommentLine(e.s);break;case 5:t=oa.Binop(e.op);break;case 6:t=oa.Unop(e.op);break;case 7:t=oa.Semicolon;break;case 8:t=oa.Comma;break;case 9:t=oa.BrOpen;break;case 10:t=oa.BrClose;break;case 11:t=oa.BkOpen;break;case 12:t=oa.BkClose;break;case 13:t=oa.POpen;break;case 14:t=oa.PClose;break;case 15:t=oa.Dot;break;case 16:t=oa.DblDot;break;case 17:t=oa.QuestionDot;break;case 18:t=oa.Arrow;break;case 19:t=oa.IntInterval(e.s);break;case 20:t=oa.Sharp(e.s);break;case 21:t=oa.Question;break;case 22:t=oa.At;break;case 23:t=oa.Dollar(e.s);break;case 24:t=oa.Spread}return Xs._new(t)}}var Ys=r["tokentree.TokenStreamMode"]={__ename__:!0,__constructs__:null,Strict:{_hx_name:"Strict",_hx_index:0,__enum__:"tokentree.TokenStreamMode",toString:n},Relaxed:{_hx_name:"Relaxed",_hx_index:1,__enum__:"tokentree.TokenStreamMode",toString:n}};Ys.__constructs__=[Ys.Strict,Ys.Relaxed];class ea{constructor(e,t){this.tokens=e,this.bytes=t,this.sharpIfStack=[],this.tempStore=[],this.current=0}hasMore(){return this.current<this.tokens.length}consumeToken(){if(this.current<0||this.current>=this.tokens.length)switch(ea.MODE._hx_index){case 0:throw Me.thrown("no more tokens");case 1:return this.createDummyToken(oa.CommentLine("auto insert"))}let e=this.tokens[this.current];return this.current++,new na(Xs.toTokenTreeDef(Xs.fromTokenDef(e.tok)),"",e.pos,this.current-1)}consumeConstIdent(){let e=this.token();switch(e._hx_index){case 1:if(43==e.k._hx_index)return this.consumeToken();switch(ea.MODE._hx_index){case 0:let e="bad token "+re.string(this.token())+" != Const(CIdent(_))";throw Me.thrown(this.formatCurrentPos()+": "+e);case 1:return this.createDummyToken(oa.Const(ci.CIdent("autoInsert")))}break;case 2:if(3==e.c._hx_index)return this.consumeToken();switch(ea.MODE._hx_index){case 0:let e="bad token "+re.string(this.token())+" != Const(CIdent(_))";throw Me.thrown(this.formatCurrentPos()+": "+e);case 1:return this.createDummyToken(oa.Const(ci.CIdent("autoInsert")))}break;case 4:return this.consumeToken();default:switch(ea.MODE._hx_index){case 0:let e="bad token "+re.string(this.token())+" != Const(CIdent(_))";throw Me.thrown(this.formatCurrentPos()+": "+e);case 1:return this.createDummyToken(oa.Const(ci.CIdent("autoInsert")))}}}consumeConst(){if(2==this.token()._hx_index)return this.consumeToken();switch(ea.MODE._hx_index){case 0:let e="bad token "+re.string(this.token())+" != Const(_)";throw Me.thrown(this.formatCurrentPos()+": "+e);case 1:return this.createDummyToken(oa.Const(ci.CString("autoInsert")))}}consumeTokenDef(e){if(this.matches(e))return this.consumeToken();switch(ea.MODE._hx_index){case 0:let t="bad token "+re.string(this.token())+" != "+re.string(e);throw Me.thrown(this.formatCurrentPos()+": "+t);case 1:return this.createDummyToken(e)}}consumeToTempStore(){this.tempStore.push(this.consumeToken())}addToTempStore(e){this.tempStore.push(e)}applyTempStore(e){for(;this.tempStore.length>0;)e.addChild(this.tempStore.shift())}hasTempStore(){return this.tempStore.length>0}getTempStore(){return this.tempStore}clearTempStore(){this.tempStore=[]}formatCurrentPos(){let e=this.tokens[this.current].pos;return new wi(e.file,e.min,e.max).format(this.bytes)}matches(e){return!(this.current<0||this.current>=this.tokens.length)&&oe.enumEq(e,Xs.toTokenTreeDef(Xs.fromTokenDef(this.tokens[this.current].tok)))}isSharp(){return!(this.current<0||this.current>=this.tokens.length)&&20==this.tokens[this.current].tok._hx_index}isTypedParam(){if(this.current<0||this.current>=this.tokens.length)return!1;let e=this.current+1,t=this.tokens[this.current],n=t.tok;if(5!=n._hx_index)return!1;if(9!=n.op._hx_index)return!1;let r=1,i=0,s=0,a=0;for(;;){t=this.tokens[e++];let n=t.tok;switch(n._hx_index){case 1:case 8:case 15:case 16:case 18:case 23:break;case 5:switch(n.op._hx_index){case 7:if(a>0||s>0||i>0)continue;if(--r,r<=0)return!0;break;case 9:if(a>0||s>0||i>0)continue;++r;break;default:return!1}break;case 9:++i;break;case 10:if(i<=0)return!1;--i;break;case 11:++s;break;case 12:if(s<=0)return!1;--s;break;case 13:++a;break;case 14:if(a<=0)return!1;--a;break;default:return!1}if(e>=this.tokens.length)return!1}}token(){if(this.current<0||this.current>=this.tokens.length)switch(ea.MODE._hx_index){case 0:throw Me.thrown("no more tokens");case 1:return oa.CommentLine("auto insert")}return Xs.toTokenTreeDef(Xs.fromTokenDef(this.tokens[this.current].tok))}tokenForMatch(){return this.current<0||this.current>=this.tokens.length?oa.Root:Xs.toTokenTreeDef(Xs.fromTokenDef(this.tokens[this.current].tok))}peekNonCommentToken(){if(this.current<0||this.current>=this.tokens.length)switch(ea.MODE._hx_index){case 0:throw Me.thrown("no more tokens");case 1:return oa.Const(ci.CString("auto insert"))}let e=this.current;for(;e<this.tokens.length;){let t=this.tokens[e++];if(null!=hi)switch(t.tok._hx_index){case 3:case 4:break;default:return Xs.toTokenTreeDef(Xs.fromTokenDef(t.tok))}}return oa.Root}getTokenPos(){return this.current<0||this.current>=this.tokens.length?null:this.tokens[this.current].pos}getStreamIndex(){return this.current}rewindTo(e){this.current=e}consumeOpGt(){let e=this.consumeTokenDef(oa.Binop(ht.OpGt)),t=this.token();if(6!=t._hx_index)return e;switch(t.op._hx_index){case 4:let t=this.consumeToken();return new na(oa.Binop(ht.OpGte),e.space+t.space,{file:e.pos.file,min:e.pos.min,max:t.pos.max},e.index);case 7:return this.consumeOpShr(e);default:return e}}consumeOpShr(e){let t=this.consumeTokenDef(oa.Binop(ht.OpGt)),n=this.token();if(6!=n._hx_index)return new na(oa.Binop(ht.OpShr),t.space,{file:e.pos.file,min:e.pos.min,max:t.pos.max},e.index);switch(n.op._hx_index){case 4:let n=this.consumeToken();return new na(oa.Binop(ht.OpAssignOp(ht.OpShr)),n.space,{file:e.pos.file,min:e.pos.min,max:n.pos.max},e.index);case 7:let r=this.consumeToken(),i=this.token();if(6==i._hx_index&&4==i.op._hx_index){let t=this.consumeToken();return new na(oa.Binop(ht.OpAssignOp(ht.OpUShr)),t.space,{file:e.pos.file,min:e.pos.min,max:t.pos.max},e.index)}return new na(oa.Binop(ht.OpUShr),r.space,{file:e.pos.file,min:e.pos.min,max:r.pos.max},e.index);default:return new na(oa.Binop(ht.OpShr),t.space,{file:e.pos.file,min:e.pos.min,max:t.pos.max},e.index)}}consumeOpSub(e){let t=this.consumeTokenDef(oa.Binop(ht.OpSub)),n=this.token();if(2!=n._hx_index)return new na(t.tok,t.space,t.pos,t.index);switch(n.c._hx_index){case 0:case 1:break;default:return new na(t.tok,t.space,t.pos,t.index)}let r=this.current-2;if(r<0)throw Me.thrown("no more tokens");let i=this.tokens[r].tok;switch(i._hx_index){case 2:switch(i.k._hx_index){case 3:case 4:case 5:case 6:case 7:case 10:case 15:case 30:break;default:return new na(t.tok,t.space,t.pos,t.index)}break;case 5:case 6:case 7:case 8:case 9:case 11:case 13:case 16:case 21:case 19:break;case 14:if(null==e||e.tok==oa.Root)return new na(t.tok,t.space,t.pos,t.index);let n=e.tok;if(1!=n._hx_index)return new na(t.tok,t.space,t.pos,t.index);switch(n.k._hx_index){case 3:case 4:case 5:case 6:case 7:case 21:break;default:return new na(t.tok,t.space,t.pos,t.index)}break;default:return new na(t.tok,t.space,t.pos,t.index)}let s=this.token();if(2!=s._hx_index)throw Me.thrown("no more tokens");{let e=s.c;switch(e._hx_index){case 0:let n=this.consumeConst();return new na(oa.Const(ci.CInt("-"+e.v,e.s)),n.space,{file:t.pos.file,min:t.pos.min,max:n.pos.max},t.index);case 1:let r=this.consumeConst();return new na(oa.Const(ci.CFloat("-"+e.f,e.s)),r.space,{file:t.pos.file,min:t.pos.min,max:r.pos.max},t.index);default:throw Me.thrown("no more tokens")}}}pushSharpIf(e){this.sharpIfStack.push(e)}popSharpIf(){let e=this.sharpIfStack.pop();if(null==e)switch(ea.MODE._hx_index){case 0:throw Me.thrown("no more tokens");case 1:return this.createDummyToken(oa.CommentLine("dummy token"))}return e}peekSharpIf(){if(this.sharpIfStack.length<=0)switch(ea.MODE._hx_index){case 0:throw Me.thrown("no more tokens");case 1:return this.createDummyToken(oa.CommentLine("dummy token"))}return this.sharpIfStack[this.sharpIfStack.length-1]}createDummyToken(e){let t;if(this.tokens.length<=0)return new na(e,"",{file:"<unknown>",min:0,max:0},-1,!0);if(this.current<0||this.current>=this.tokens.length){let e=this.tokens[this.tokens.length-1].pos;t={min:e.max,max:e.max,file:e.file}}else{let e=this.tokens[this.current].pos;t={min:e.min,max:e.min,file:e.file}}return new na(e,"",t,-1,!0)}}ea.__name__="tokentree.TokenStream",Object.assign(ea.prototype,{__class__:ea});class ta{constructor(e){this.stream=e,this.pos=-1}streamHasChanged(){if(-1==this.pos)return this.pos=this.stream.getStreamIndex(),!0;let e=this.pos;return this.pos=this.stream.getStreamIndex(),this.pos!=e}}ta.__name__="tokentree.TokenStreamProgress",Object.assign(ta.prototype,{__class__:ta});class na{constructor(e,t,n,r,i){null==i&&(i=!1),this.tok=e,this.pos=n,this.index=r,this.inserted=i,this.space=t,this.tokenTypeCache={}}matches(e){return oe.enumEq(e,this.tok)}isComment(){switch(this.tok._hx_index){case 7:case 8:return!0;default:return!1}}isCIdent(){let e=this.tok;return 2==e._hx_index&&3==e.c._hx_index}isCIdentOrCString(){let e=this.tok;if(2!=e._hx_index)return!1;switch(e.c._hx_index){case 2:case 3:return!0;default:return!1}}addChild(e){null!=e&&(null==this.children&&(this.children=[]),this.children.length>0&&(e.previousSibling=this.children[this.children.length-1],this.children[this.children.length-1].nextSibling=e),this.children.push(e),e.parent=this)}hasChildren(){return null!=this.children&&this.children.length>0}getFirstChild(){return this.hasChildren()?this.children[0]:null}getLastChild(){return this.hasChildren()?this.children[this.children.length-1]:null}getPos(){if(null==this.children||this.children.length<=0)return this.pos;let e,t={file:this.pos.file,min:this.pos.min,max:this.pos.max},n=0,r=this.children;for(;n<r.length;)e=r[n++].getPos(),e.min<t.min&&(t.min=e.min),e.max>t.max&&(t.max=e.max);return t}filter(e,t,n){return null==n&&(n=9999),this.filterCallback((function(r,i){return i>n?ia.SkipSubtree:r.matchesAny(e)?t==ra.All?ia.FoundGoDeeper:ia.FoundSkipSubtree:ia.GoDeeper}))}filterCallback(e){let t=[];return this.internalFilterCallback(e,t,0),t}internalFilterCallback(e,t,n){if(null==n&&(n=0),0!=this.tok._hx_index)switch(e(this,n)._hx_index){case 0:return void t.push(this);case 1:t.push(this);break;case 2:return}if(null==this.children)return;let r=0,i=this.children;for(;r<i.length;){let s=i[r];++r,3==s.tok._hx_index?s.internalFilterCallback(e,t,n):s.internalFilterCallback(e,t,n+1)}}matchesAny(e){if(null==e||this.tok==oa.Root)return!1;let t=0;for(;t<e.length;)if(oe.enumEq(this.tok,e[t++]))return!0;return!1}toString(){return ca.toString(this.tok)}}na.__name__="tokentree.TokenTree",Object.assign(na.prototype,{__class__:na});var ra=r["tokentree.TokenFilterMode"]={__ename__:!0,__constructs__:null,All:{_hx_name:"All",_hx_index:0,__enum__:"tokentree.TokenFilterMode",toString:n},First:{_hx_name:"First",_hx_index:1,__enum__:"tokentree.TokenFilterMode",toString:n}};ra.__constructs__=[ra.All,ra.First];var ia=r["tokentree.FilterResult"]={__ename__:!0,__constructs__:null,FoundSkipSubtree:{_hx_name:"FoundSkipSubtree",_hx_index:0,__enum__:"tokentree.FilterResult",toString:n},FoundGoDeeper:{_hx_name:"FoundGoDeeper",_hx_index:1,__enum__:"tokentree.FilterResult",toString:n},SkipSubtree:{_hx_name:"SkipSubtree",_hx_index:2,__enum__:"tokentree.FilterResult",toString:n},GoDeeper:{_hx_name:"GoDeeper",_hx_index:3,__enum__:"tokentree.FilterResult",toString:n}};ia.__constructs__=[ia.FoundSkipSubtree,ia.FoundGoDeeper,ia.SkipSubtree,ia.GoDeeper];class sa{static parent(e){return null!=e?e.parent:null}static findParent(e,t){let n=sa.parent(e);for(;null!=n&&n.tok!=oa.Root;){if(t(n))return n;n=sa.parent(n)}return null}static previousSibling(e){return null!=e?e.previousSibling:null}static firstChild(e){return null!=e?e.getFirstChild():null}static lastChild(e){return null!=e?e.getLastChild():null}static firstOf(e,t){if(null==e||null==e.children)return null;let n=0,r=e.children;for(;n<r.length;){let e=r[n];if(++n,oe.enumEq(e.tok,t))return e}return null}static lastOf(e,t){if(null==e||null==e.children)return null;let n=null,r=0,i=e.children;for(;r<i.length;){let e=i[r];++r,oe.enumEq(e.tok,t)&&(n=e)}return n}static child(e,t){return null!=e&&null!=e.children?e.children[t]:null}static matches(e,t){return null!=e&&oe.enumEq(e.tok,t)?e:null}static isCIdent(e){return null!=e&&e.isCIdent()?e:null}}class aa{static buildTokenTree(e,t,n){return null==n&&(n=la.TypeLevel),aa.buildTokenTreeFromStream(new ea(e,t),n)}static buildTokenTreeFromStream(e,t){let n=e.createDummyToken(oa.Root);switch(t._hx_index){case 0:Na.walkFile(e,n);break;case 1:Ca.walkClassBody(e,n);break;case 2:Ga.walkStatement(e,n);break;case 3:Qa.walkTypeNameDef(e,n)}if(e.hasMore())switch(ea.MODE._hx_index){case 0:throw Me.thrown("invalid token tree structure - found:"+re.string(e.token()));case 1:let t=new ta(e);for(;t.streamHasChanged();)Ga.walkStatement(e,n);if(e.hasMore())throw Me.thrown("invalid token tree structure - found:"+re.string(e.token()))}let r=e.getTempStore();switch(ea.MODE._hx_index){case 0:if(0!=r.length)throw Me.thrown("invalid token tree structure - tokens in temp store:"+r.join(", "));break;case 1:let e=0;for(;e<r.length;)n.addChild(r[e++])}return n}}aa.__name__="tokentree.TokenTreeBuilder";var la=r["tokentree.TokenTreeEntryPoint"]={__ename__:!0,__constructs__:null,TypeLevel:{_hx_name:"TypeLevel",_hx_index:0,__enum__:"tokentree.TokenTreeEntryPoint",toString:n},FieldLevel:{_hx_name:"FieldLevel",_hx_index:1,__enum__:"tokentree.TokenTreeEntryPoint",toString:n},ExpressionLevel:{_hx_name:"ExpressionLevel",_hx_index:2,__enum__:"tokentree.TokenTreeEntryPoint",toString:n},TypeHintLevel:{_hx_name:"TypeHintLevel",_hx_index:3,__enum__:"tokentree.TokenTreeEntryPoint",toString:n}};la.__constructs__=[la.TypeLevel,la.FieldLevel,la.ExpressionLevel,la.TypeHintLevel];var oa=r["tokentree.TokenTreeDef"]={__ename__:!0,__constructs__:null,Root:{_hx_name:"Root",_hx_index:0,__enum__:"tokentree.TokenTreeDef",toString:n},Kwd:(t=function(e){return{_hx_index:1,k:e,__enum__:"tokentree.TokenTreeDef",toString:n,__params__:function(){return[this.k]}}},t._hx_name="Kwd",t),Const:(t=function(e){return{_hx_index:2,c:e,__enum__:"tokentree.TokenTreeDef",toString:n,__params__:function(){return[this.c]}}},t._hx_name="Const",t),Sharp:(t=function(e){return{_hx_index:3,s:e,__enum__:"tokentree.TokenTreeDef",toString:n,__params__:function(){return[this.s]}}},t._hx_name="Sharp",t),Dollar:(t=function(e){return{_hx_index:4,s:e,__enum__:"tokentree.TokenTreeDef",toString:n,__params__:function(){return[this.s]}}},t._hx_name="Dollar",t),Unop:(t=function(e){return{_hx_index:5,op:e,__enum__:"tokentree.TokenTreeDef",toString:n,__params__:function(){return[this.op]}}},t._hx_name="Unop",t),Binop:(t=function(e){return{_hx_index:6,op:e,__enum__:"tokentree.TokenTreeDef",toString:n,__params__:function(){return[this.op]}}},t._hx_name="Binop",t),Comment:(t=function(e){return{_hx_index:7,s:e,__enum__:"tokentree.TokenTreeDef",toString:n,__params__:function(){return[this.s]}}},t._hx_name="Comment",t),CommentLine:(t=function(e){return{_hx_index:8,s:e,__enum__:"tokentree.TokenTreeDef",toString:n,__params__:function(){return[this.s]}}},t._hx_name="CommentLine",t),IntInterval:(t=function(e){return{_hx_index:9,s:e,__enum__:"tokentree.TokenTreeDef",toString:n,__params__:function(){return[this.s]}}},t._hx_name="IntInterval",t),Semicolon:{_hx_name:"Semicolon",_hx_index:10,__enum__:"tokentree.TokenTreeDef",toString:n},Dot:{_hx_name:"Dot",_hx_index:11,__enum__:"tokentree.TokenTreeDef",toString:n},DblDot:{_hx_name:"DblDot",_hx_index:12,__enum__:"tokentree.TokenTreeDef",toString:n},QuestionDot:{_hx_name:"QuestionDot",_hx_index:13,__enum__:"tokentree.TokenTreeDef",toString:n},Arrow:{_hx_name:"Arrow",_hx_index:14,__enum__:"tokentree.TokenTreeDef",toString:n},Comma:{_hx_name:"Comma",_hx_index:15,__enum__:"tokentree.TokenTreeDef",toString:n},BkOpen:{_hx_name:"BkOpen",_hx_index:16,__enum__:"tokentree.TokenTreeDef",toString:n},BkClose:{_hx_name:"BkClose",_hx_index:17,__enum__:"tokentree.TokenTreeDef",toString:n},BrOpen:{_hx_name:"BrOpen",_hx_index:18,__enum__:"tokentree.TokenTreeDef",toString:n},BrClose:{_hx_name:"BrClose",_hx_index:19,__enum__:"tokentree.TokenTreeDef",toString:n},POpen:{_hx_name:"POpen",_hx_index:20,__enum__:"tokentree.TokenTreeDef",toString:n},PClose:{_hx_name:"PClose",_hx_index:21,__enum__:"tokentree.TokenTreeDef",toString:n},Question:{_hx_name:"Question",_hx_index:22,__enum__:"tokentree.TokenTreeDef",toString:n},At:{_hx_name:"At",_hx_index:23,__enum__:"tokentree.TokenTreeDef",toString:n},Eof:{_hx_name:"Eof",_hx_index:24,__enum__:"tokentree.TokenTreeDef",toString:n},Spread:{_hx_name:"Spread",_hx_index:25,__enum__:"tokentree.TokenTreeDef",toString:n}};oa.__constructs__=[oa.Root,oa.Kwd,oa.Const,oa.Sharp,oa.Dollar,oa.Unop,oa.Binop,oa.Comment,oa.CommentLine,oa.IntInterval,oa.Semicolon,oa.Dot,oa.DblDot,oa.QuestionDot,oa.Arrow,oa.Comma,oa.BkOpen,oa.BkClose,oa.BrOpen,oa.BrClose,oa.POpen,oa.PClose,oa.Question,oa.At,oa.Eof,oa.Spread];class ca{static toString(e){switch(e._hx_index){case 0:return"<root>";case 1:let t=e.k;return a.substr(r[t.__enum__].__constructs__[t._hx_index]._hx_name,3,null).toLowerCase();case 2:let n=e.c;switch(n._hx_index){case 0:let e=n.v,t=n.s;return null==t?e:""+e+t;case 1:let r=n.f,i=n.s;return null==i?r:""+r+i;case 2:return'"'+n.s+'"';case 3:return n.s;case 4:return"~/"+n.r+"/"+n.opt;case 5:return""+n.s}break;case 3:return"#"+e.s;case 4:return"$"+e.s;case 5:return new pt("").printUnop(e.op);case 6:return new pt("").printBinop(e.op);case 7:return"/*"+e.s+"*/";case 8:return"//"+e.s;case 9:return e.s+"...";case 10:return";";case 11:return".";case 12:return":";case 13:return"?.";case 14:return"->";case 15:return",";case 16:return"[";case 17:return"]";case 18:return"{";case 19:return"}";case 20:return"(";case 21:return")";case 22:return"?";case 23:return"@";case 24:return"<eof>";case 25:return"..."}}}ca.__name__="tokentree.TokenTreeDefPrinter";class ua{static getFieldType(e,t){if(null==e)return ha.Unknown;let n=e.tok;if(1==n._hx_index)switch(n.k._hx_index){case 0:return ua.getFunctionFieldType(e,t);case 2:case 42:return ua.getVarFieldType(e,t)}return ha.Unknown}static getFunctionFieldType(e,t){let n=sa.firstChild(e);if(null==n)return ha.Unknown;let r=fa.getName(fa.getNameToken(e)),i=t,s=!1,a=!1,l=!1,o=!1,c=!1;if(null!=n.children){let e=0,t=n.children;e:for(;e<t.length;){let n=t[e++].tok;switch(n._hx_index){case 1:switch(n.k._hx_index){case 17:s=!0;break;case 18:i=da.Public;break;case 19:i=da.Private;break;case 25:c=!0;break;case 31:l=!0;break;case 35:a=!0;break;case 42:o=!0}break;case 18:case 20:break e}}}return ha.Function(r,i,s,a,l,o,c)}static getVarFieldType(e,t){let n=sa.firstChild(e);if(null==n)return ha.Unknown;let r=fa.getName(fa.getNameToken(e)),i=t,s=!1,a=!1,l=e.tok,o=1==l._hx_index&&42==l.k._hx_index,c=!1;if(null!=n.children){let e=0,t=n.children;for(;e<t.length;){let n=t[e++].tok;if(1==n._hx_index)switch(n.k._hx_index){case 17:s=!0;break;case 18:i=da.Public;break;case 19:i=da.Private;break;case 25:c=!0;break;case 35:a=!0}}}return n=sa.firstOf(n,oa.POpen),o||null==n?ha.Var(r,i,s,a,o,c):ha.Prop(r,i,s,ua.makePropertyAccess(sa.firstChild(n)),ua.makePropertyAccess(sa.child(n,1)))}static makePropertyAccess(e){if(null==e)return pa.Default;let t=e.tok;switch(t._hx_index){case 1:switch(t.k._hx_index){case 16:default:return pa.Default;case 33:return pa.DynamicAccess;case 37:return pa.NullAccess}break;case 2:let e=t.c;if(3!=e._hx_index)return pa.Default;switch(e.s){case"get":return pa.Get;case"never":return pa.Never;case"set":return pa.Set;default:return pa.Default}break;default:return pa.Default}}static isOperatorFunction(e){return te.exists(fa.getMetadata(e),(function(e){let t=e.tok;if(2!=t._hx_index)return!1;{let e=t.c;if(3!=e._hx_index)return!1;switch(e.s){case"arrayAccess":case"op":case"resolve":return!0;default:return!1}}}))}}ua.__name__="tokentree.utils.FieldUtils";var ha=r["tokentree.utils.TokenFieldType"]={__ename__:!0,__constructs__:null,Function:(t=function(e,t,r,i,s,a,l){return{_hx_index:0,name:e,visibility:t,isStatic:r,isInline:i,isOverride:s,isFinal:a,isExtern:l,__enum__:"tokentree.utils.TokenFieldType",toString:n,__params__:function(){return[this.name,this.visibility,this.isStatic,this.isInline,this.isOverride,this.isFinal,this.isExtern]}}},t._hx_name="Function",t),Var:(t=function(e,t,r,i,s,a){return{_hx_index:1,name:e,visibility:t,isStatic:r,isInline:i,isFinal:s,isExtern:a,__enum__:"tokentree.utils.TokenFieldType",toString:n,__params__:function(){return[this.name,this.visibility,this.isStatic,this.isInline,this.isFinal,this.isExtern]}}},t._hx_name="Var",t),Prop:(t=function(e,t,r,i,s){return{_hx_index:2,name:e,visibility:t,isStatic:r,getter:i,setter:s,__enum__:"tokentree.utils.TokenFieldType",toString:n,__params__:function(){return[this.name,this.visibility,this.isStatic,this.getter,this.setter]}}},t._hx_name="Prop",t),Unknown:{_hx_name:"Unknown",_hx_index:3,__enum__:"tokentree.utils.TokenFieldType",toString:n}};ha.__constructs__=[ha.Function,ha.Var,ha.Prop,ha.Unknown];var da=r["tokentree.utils.TokenFieldVisibility"]={__ename__:!0,__constructs__:null,Public:{_hx_name:"Public",_hx_index:0,__enum__:"tokentree.utils.TokenFieldVisibility",toString:n},Private:{_hx_name:"Private",_hx_index:1,__enum__:"tokentree.utils.TokenFieldVisibility",toString:n}};da.__constructs__=[da.Public,da.Private];var pa=r["tokentree.utils.TokenPropertyAccess"]={__ename__:!0,__constructs__:null,Default:{_hx_name:"Default",_hx_index:0,__enum__:"tokentree.utils.TokenPropertyAccess",toString:n},NullAccess:{_hx_name:"NullAccess",_hx_index:1,__enum__:"tokentree.utils.TokenPropertyAccess",toString:n},Get:{_hx_name:"Get",_hx_index:2,__enum__:"tokentree.utils.TokenPropertyAccess",toString:n},Set:{_hx_name:"Set",_hx_index:3,__enum__:"tokentree.utils.TokenPropertyAccess",toString:n},DynamicAccess:{_hx_name:"DynamicAccess",_hx_index:4,__enum__:"tokentree.utils.TokenPropertyAccess",toString:n},Never:{_hx_name:"Never",_hx_index:5,__enum__:"tokentree.utils.TokenPropertyAccess",toString:n}};pa.__constructs__=[pa.Default,pa.NullAccess,pa.Get,pa.Set,pa.DynamicAccess,pa.Never];class fa{static isImport(e){let t=e;for(;null!=t;){if(t.tok==oa.Root)return!1;let e=t.tok;switch(e._hx_index){case 1:switch(e.k._hx_index){case 13:case 36:return!0;case 25:case 27:case 41:break;default:return!1}break;case 2:if(3!=e.c._hx_index)return!1;break;case 6:if(23!=e.op._hx_index)return!1;break;case 11:break;default:return!1}t=t.parent}return!1}static isTypeParameter(e){let t=e.tok;if(6!=t._hx_index)return!1;switch(t.op._hx_index){case 7:return null!=sa.matches(sa.parent(e),oa.Binop(ht.OpLt));case 9:return null!=sa.firstOf(e,oa.Binop(ht.OpGt));default:return!1}}static isOpGtTypedefExtension(e){let t=e.tok;return 6==t._hx_index&&(7==t.op._hx_index&&null!=sa.matches(sa.parent(sa.isCIdent(sa.parent(sa.matches(sa.parent(sa.matches(sa.parent(e),oa.BrOpen)),oa.Binop(ht.OpAssign))))),oa.Kwd(li.KwdTypedef)))}static filterOpSub(e){if(null==e)return!1;let t=e.tok;if(6!=t._hx_index||3!=t.op._hx_index)return!1;let n=e.previousSibling;if(null==e.previousSibling)n=e.parent;else if(n=fa.getLastToken(e.previousSibling),null==n)return!1;let r=n.tok;switch(r._hx_index){case 1:switch(r.k._hx_index){case 4:case 5:case 6:case 10:case 27:return!0;default:return!1}break;case 6:return r.op._hx_index,!0;case 12:case 14:case 15:case 16:case 18:case 19:case 20:case 22:case 25:return!0;case 17:default:return!1;case 21:switch(fa.getPOpenType(n.parent)._hx_index){case 0:case 1:case 3:case 4:case 5:case 6:case 8:return!0;case 2:case 7:case 9:return!1}}}static isTernary(e){for(;;){if(null==e)return!1;if(12==e.tok._hx_index){e=e.parent;continue}if(22!=e.tok._hx_index)return!1;if(null==sa.firstOf(e,oa.DblDot))return!1;if(null==e.parent)return!1;let t=e.parent.tok;switch(t._hx_index){case 1:switch(t.k._hx_index){case 0:case 2:case 42:return!1;default:return!0}break;case 3:case 15:return!1;case 6:default:return!0;case 20:let n=e.previousSibling;if(null==n)return!1;let r=fa.getLastToken(n);if(null==r)return!1;switch(r.tok._hx_index){case 10:case 15:return!1;default:return!0}}}}static isTypeEnumAbstract(e){let t=e.tok;if(1==t._hx_index&&40==t.k._hx_index){let t=sa.firstChild(e);if(null==t||null==t.children||t.children.length<=0)return!1;if(null!=sa.firstOf(t,oa.Kwd(li.KwdEnum)))return!0;let n=0,r=t.children;for(;n<r.length;){let e=r[n];if(++n,23==e.tok._hx_index&&null!=sa.matches(sa.firstChild(sa.matches(sa.firstChild(e),oa.DblDot)),oa.Kwd(li.KwdEnum)))return!0}}return!1}static isTypeStructure(e){let t=sa.firstChild(sa.firstOf(sa.isCIdent(sa.firstChild(e)),oa.Binop(ht.OpAssign)));return null!=sa.matches(t,oa.BrOpen)||null!=sa.firstOf(sa.isCIdent(t),oa.Binop(ht.OpAnd))}static isTypeEnum(e){let t=e.tok;return 1==t._hx_index&&26==t.k._hx_index&&(!fa.isTypeEnumAbstract(e)&&null==sa.matches(sa.parent(sa.matches(sa.parent(e),oa.DblDot)),oa.At))}static isTypeMacroClass(e){let t=e.tok;return 1==t._hx_index&&1==t.k._hx_index&&null!=sa.matches(sa.parent(e),oa.Kwd(li.KwdMacro))}static getName(e){if(null==e)return null;let t=e.tok;switch(t._hx_index){case 1:return 22==t.k._hx_index?"new":null;case 2:let e=t.c;return 3==e._hx_index?e.s:null;default:return null}}static getNameToken(e){if(fa.isNameToken(e))return e;let t=sa.firstChild(e);return fa.isNameToken(t)?t:(t=sa.firstChild(sa.matches(t,oa.Question)),fa.isNameToken(t)?t:null)}static isNameToken(e){if(null==e)return!1;let t=e.tok;switch(t._hx_index){case 1:return 22==t.k._hx_index;case 2:return 3==t.c._hx_index;default:return!1}}static getMetadata(e){let t=sa.isCIdent(sa.firstChild(e));if(null==t||!t.hasChildren())return[];let n=t.children,r=new Array(n.length),i=0,s=n.length;for(;i<s;){let e=i++;r[e]=sa.firstChild(sa.matches(sa.firstChild(sa.matches(n[e],oa.At)),oa.DblDot))}let a=[],l=0;for(;l<r.length;){let e=r[l];++l,null!=e&&a.push(e)}return a}static getDocComment(e){let t=e;for(;;){if(t=sa.previousSibling(t),null==t)return null;switch(t.tok._hx_index){case 7:return t;case 8:continue;default:return null}}}static isModifier(e){if(null==e)return!1;let t=e.tok;if(1!=t._hx_index)return!1;switch(t.k._hx_index){case 17:case 18:case 19:case 25:case 31:case 33:case 35:case 41:return!0;default:return!1}}static getBrOpenType(e){if(null==e)return ma.Unknown;if(null!=e.tokenTypeCache.brOpenType)return e.tokenTypeCache.brOpenType;let t=fa.determineBrOpenType(e);return e.tokenTypeCache.brOpenType=t,t}static determineBrOpenType(e){if(null==e)return ma.Unknown;if(null==e.parent||e.parent.tok==oa.Root)return fa.determinBrChildren(e);let t=e.parent.tok;switch(t._hx_index){case 1:if(10==t.k._hx_index)return fa.determinBrChildren(e);break;case 2:let n=t.c;if(3!=n._hx_index)return ma.Block;switch(n.s){case"from":case"to":return ma.AnonType;default:return ma.Block}break;case 4:return ma.Block;case 6:switch(t.op._hx_index){case 4:return fa.isInsideTypedef(e.parent)?ma.TypedefDecl:fa.determinBrChildren(e);case 9:return ma.AnonType;case 22:return fa.determinBrChildren(e);default:return ma.ObjectDecl}break;case 12:if(fa.isTernary(e.parent))return ma.ObjectDecl;let r=e.parent.parent,i=r.tok;switch(i._hx_index){case 1:switch(i.k._hx_index){case 15:case 16:return ma.ObjectDecl;default:return ma.AnonType}break;case 2:switch(i.c._hx_index){case 2:case 3:break;default:return ma.AnonType}break;default:return ma.AnonType}r=r.parent;let s=r.tok;switch(s._hx_index){case 1:switch(s.k._hx_index){case 0:case 2:case 42:return ma.AnonType;default:return ma.ObjectDecl}break;case 6:return 9==s.op._hx_index?ma.AnonType:ma.ObjectDecl;case 18:return fa.getBrOpenType(r);case 20:case 22:return ma.AnonType;default:return ma.ObjectDecl}break;case 16:return ma.ObjectDecl;case 20:switch(fa.getPOpenType(e.parent)._hx_index){case 0:case 2:case 9:return ma.ObjectDecl;case 1:return ma.AnonType;case 3:case 4:case 5:case 6:case 7:case 8:return ma.Unknown}break;case 22:if(fa.isTernary(e.parent))return ma.ObjectDecl}return fa.determinBrChildren(e)}static determinBrChildren(e){if(null==e.children||e.children.length<=0)return 1==e.parent.tok._hx_index?ma.Block:ma.ObjectDecl;if(null!=e.parent&&e.parent.tok!=oa.Root){if(1==e.children.length)return 1==e.parent.tok._hx_index?ma.Block:ma.ObjectDecl;if(2==e.children.length&&10==e.getLastChild().tok._hx_index)return 1==e.parent.tok._hx_index?ma.Block:ma.ObjectDecl}if(null!=sa.firstOf(e,oa.Arrow))return ma.AnonType;if(null!=e.nextSibling&&14==e.nextSibling.tok._hx_index)return ma.AnonType;let t=!0,n=0,r=e.children;for(;n<r.length;){let i=r[n];++n;let s=i.tok;switch(s._hx_index){case 2:switch(s.c._hx_index){case 2:case 3:if(null==sa.matches(sa.firstChild(i),oa.DblDot))return ma.Block;t=!1;break;default:return ma.Block}break;case 3:case 7:case 8:case 23:break;case 19:return t&&(null!=e.parent&&e.parent.tok!=oa.Root&&1==e.parent.tok._hx_index)?ma.Block:ma.ObjectDecl;default:return ma.Block}}return ma.ObjectDecl}static getBkOpenType(e){if(null==e)return _a.Unknown;if(null!=e.tokenTypeCache.bkOpenType)return e.tokenTypeCache.bkOpenType;let t=fa.determineBkOpenType(e);return e.tokenTypeCache.bkOpenType=t,t}static determineBkOpenType(e){if(null==e)return _a.Unknown;let t=e.parent;if(null==t||t.tok==oa.Root)return fa.determinBkChildren(e);let n=t.tok;switch(n._hx_index){case 1:return 23==n.k._hx_index?_a.ArrayAccess:fa.determinBkChildren(e);case 3:case 6:case 12:case 16:case 18:case 20:return fa.determinBkChildren(e);default:return _a.ArrayAccess}}static determinBkChildren(e){if(!e.hasChildren())return _a.Unknown;let t=0,n=e.children;e:for(;t<n.length;){let e=n[t++].tok;switch(e._hx_index){case 1:switch(e.k._hx_index){case 5:case 7:return _a.Comprehension;default:break e}break;case 7:case 8:break;default:break e}}let r=-1;return e.filterCallback((function(e,t){let n=e.tok;switch(n._hx_index){case 6:return 22==n.op._hx_index?0==r?ia.FoundSkipSubtree:ia.SkipSubtree:ia.GoDeeper;case 16:return r+=1,ia.GoDeeper;case 17:return r-=1,ia.GoDeeper;default:return ia.GoDeeper}})).length>0?_a.MapLiteral:_a.ArrayLiteral}static getPOpenType(e){for(;;){if(null==e)return ga.Expression;switch(e.tok._hx_index){case 20:break;case 21:e=e.parent;continue;default:return ga.Expression}if(null!=e.tokenTypeCache.pOpenType)return e.tokenTypeCache.pOpenType;let t=fa.determinePOpenType(e);return e.tokenTypeCache.pOpenType=t,t}}static determinePOpenType(e){let t=e.parent;if(null==t||t.tok==oa.Root)return ga.Expression;if(fa.hasAtParent(e))return ga.At;if(e.hasChildren()&&fa.checkPOpenForArrowChildren(e))return ga.Parameter;e:for(;null!=t&&t.tok!=oa.Root;){let n=t.tok;switch(n._hx_index){case 3:switch(n.s){case"elseif":case"if":if(t.getFirstChild()==e)return ga.SharpCondition;t=t.parent;break;default:break e}break;case 6:if(9!=n.op._hx_index)break e;t=t.parent;break;default:break e}}if(null==t||t.tok==oa.Root)return ga.Expression;let n=t.tok;switch(n._hx_index){case 1:switch(n.k._hx_index){case 0:case 22:return ga.Parameter;case 3:let n=t.getFirstChild();return null==n||n.index==e.index?ga.IfCondition:ga.Expression;case 5:return ga.WhileCondition;case 7:return ga.ForLoop;case 14:return ga.SwitchCondition;case 21:return ga.Catch}break;case 2:if(3==n.c._hx_index){if(null==t.parent||t.parent.tok==oa.Root)return ga.Call;let n=t.parent.tok;switch(n._hx_index){case 1:switch(n.k._hx_index){case 0:if(null==t.previousSibling){let n=sa.firstOf(t,oa.POpen);return null==n||n.index==e.index?ga.Parameter:ga.Expression}return ga.Call;case 40:return ga.Parameter;default:return ga.Call}break;case 18:return null!=sa.matches(sa.parent(sa.parent(t.parent)),oa.Kwd(li.KwdEnum))?ga.Parameter:ga.Call;default:return ga.Call}}break;case 20:return ga.Expression}return null!=sa.firstOf(e,oa.Arrow)?ga.Parameter:ga.Expression}static checkPOpenForArrowChildren(e){let t=!0,n=0,r=e.children;for(;n<r.length;){let e=r[n];if(++n,21==e.tok._hx_index&&(t=!1),!t&&14==e.tok._hx_index)return!0}return!1}static hasAtParent(e){let t=e.parent;for(;t.tok!=oa.Root;){let e=t.tok;switch(e._hx_index){case 1:case 2:case 11:case 12:break;case 6:if(23!=e.op._hx_index)return!1;break;case 23:return!0;default:return!1}t=t.parent}return!1}static isInsideTypedef(e){if(null==e)return!1;let t=e;for(;null!=t.parent;){let e=t.tok;if(1==e._hx_index&&32==e.k._hx_index)return!0;t=t.parent}return!1}static isDeprecated(e){return te.exists(fa.getMetadata(e),(function(e){let t=e.tok;if(2==t._hx_index){let e=t.c;return 3==e._hx_index&&"deprecated"==e.s}return!1}))}static getArrowType(e){if(null==e)return xa.ArrowFunction;if(null!=e.tokenTypeCache.arrowType)return e.tokenTypeCache.arrowType;let t=fa.determineArrowType(e);return null==t&&(t=xa.ArrowFunction),e.tokenTypeCache.arrowType=t,t}static determineArrowType(e){if(null==e)return xa.ArrowFunction;let t=e.getFirstChild();e:for(;null!=t;){let e=t.tok;switch(e._hx_index){case 1:if(41!=e.k._hx_index)return xa.ArrowFunction;break;case 2:if(3!=e.c._hx_index)return xa.ArrowFunction;break;case 6:if(9==e.op._hx_index){t=t.nextSibling;continue}return xa.ArrowFunction;case 7:case 8:case 20:case 10:case 11:case 14:case 22:break;case 18:let n=t.getFirstChild();if(null==n)break e;if(19==n.tok._hx_index)return xa.ArrowFunction;let r=fa.getBrOpenType(t);if(null==r&&(r=ma.Unknown),null!=r&&0===r._hx_index)return xa.ArrowFunction;t=t.nextSibling;continue;default:return xa.ArrowFunction}t=t.getFirstChild()}let n=e.parent;if(null==n)return xa.ArrowFunction;let r=fa.checkArrowParent(n);return null!=r?r:fa.checkArrowChildren(n)}static checkArrowChildren(e){let t=e.getFirstChild();if(null==t)return xa.ArrowFunction;let n=!1;for(;null!=t;){let e=t.tok;switch(e._hx_index){case 1:return xa.ArrowFunction;case 2:if(3!=e.c._hx_index)return xa.NewFunctionType;break;case 6:if(9==e.op._hx_index){t=t.nextSibling;continue}return xa.NewFunctionType;case 7:case 8:case 10:case 11:case 12:case 18:case 21:case 22:break;case 14:n=!0;break;case 20:let r=fa.checkArrowPOpen(t);if(null!=r)return r;t=t.nextSibling;continue;default:return xa.NewFunctionType}t=t.getFirstChild()}return n?xa.OldFunctionType:xa.NewFunctionType}static checkArrowPOpen(e){return null==e.children||e.children.length<=1?null:e.parent.isCIdent()||e.filterCallback((function(e,t){return 14==e.tok._hx_index?ia.FoundSkipSubtree:ia.GoDeeper})).length<=0?xa.ArrowFunction:e.filterCallback((function(e,t){return 12==e.tok._hx_index?ia.FoundSkipSubtree:ia.GoDeeper})).length>0?xa.NewFunctionType:xa.OldFunctionType}static checkArrowParent(e){if(null==e)return xa.ArrowFunction;let t=e.tok;switch(t._hx_index){case 2:if(3!=t.c._hx_index)return xa.OldFunctionType;{if(null==e.parent||e.parent.tok==oa.Root)return xa.ArrowFunction;let t=e.parent.tok;switch(t._hx_index){case 6:switch(t.op._hx_index){case 4:return fa.isInsideTypedef(e.parent)?xa.OldFunctionType:xa.ArrowFunction;case 22:return xa.ArrowFunction}break;case 12:switch(fa.getColonType(e.parent)._hx_index){case 1:case 2:return xa.OldFunctionType;case 0:case 3:case 4:case 5:case 6:return xa.ArrowFunction}break;case 14:return xa.OldFunctionType;case 20:let n=fa.getPOpenType(e.parent);switch(null==n&&(n=ga.Expression),n._hx_index){case 1:case 9:return xa.OldFunctionType;default:return xa.ArrowFunction}}}break;case 20:let n=null!=e?e.parent.tok:null;if(null!=n&&20==n._hx_index)return xa.ArrowFunction;break;default:return xa.OldFunctionType}return null}static getColonType(e){if(null==e)return ka.Unknown;if(null!=e.tokenTypeCache.colonType)return e.tokenTypeCache.colonType;let t=fa.determineColonType(e);return e.tokenTypeCache.colonType=t,t}static determineColonType(e){if(null==e)return ka.Unknown;if(fa.isTernary(e))return ka.Ternary;let t=e.parent;if(null==t)return ka.Unknown;if(3==t.tok._hx_index&&(t=t.parent,null==t||t.tok==oa.Root))return ka.Unknown;let n=t.tok;switch(n._hx_index){case 1:switch(n.k._hx_index){case 0:case 41:return ka.TypeHint;case 15:case 16:return ka.SwitchCase;case 22:case 23:return fa.findColonParent(t)}break;case 2:case 22:return fa.findColonParent(t);case 6:if(9==n.op._hx_index)return fa.findColonParent(t);break;case 18:let r=sa.firstOf(t,oa.BrClose);if(null==r)return ka.Unknown;if(r.pos.max<=e.pos.min)return ka.TypeCheck;break;case 20:return fa.findColonParent(e);case 23:return ka.At}return ka.Unknown}static findColonParent(e){let t=e;for(;t.tok!=oa.Root;){let n=t.tok;switch(n._hx_index){case 1:switch(n.k._hx_index){case 0:case 2:case 42:return ka.TypeHint}break;case 18:switch(fa.getBrOpenType(t)._hx_index){case 0:case 4:return ka.Unknown;case 1:case 3:return ka.TypeHint;case 2:return ka.ObjectLiteral}break;case 20:let r=sa.firstOf(t,oa.PClose);if(null!=r&&r.pos.max<=e.pos.min)return ka.TypeCheck;switch(fa.getPOpenType(t)._hx_index){case 0:return ka.ObjectLiteral;case 1:return ka.TypeHint;case 2:case 4:case 5:case 6:case 7:return ka.Unknown;case 3:case 8:case 9:return ka.TypeCheck}}t=t.parent}return ka.Unknown}static getLastToken(e){if(null==e)return null;if(null==e.children)return e;if(e.children.length<=0)return e;let t=e.getLastChild();for(;null!=t;){let e=t.getLastChild();if(null==e)return t;t=e}return null}static isMetadata(e){if(null==e||e.tok==oa.Root)return!1;let t=e.parent;for(;null!=t&&t.tok!=oa.Root;)switch(t.tok._hx_index){case 12:return t=t.parent,null!=t&&t.tok!=oa.Root&&23==t.tok._hx_index;case 23:return!0;default:t=t.parent}return!1}}fa.__name__="tokentree.utils.TokenTreeCheckUtils";var ma=r["tokentree.utils.BrOpenType"]={__ename__:!0,__constructs__:null,Block:{_hx_name:"Block",_hx_index:0,__enum__:"tokentree.utils.BrOpenType",toString:n},TypedefDecl:{_hx_name:"TypedefDecl",_hx_index:1,__enum__:"tokentree.utils.BrOpenType",toString:n},ObjectDecl:{_hx_name:"ObjectDecl",_hx_index:2,__enum__:"tokentree.utils.BrOpenType",toString:n},AnonType:{_hx_name:"AnonType",_hx_index:3,__enum__:"tokentree.utils.BrOpenType",toString:n},Unknown:{_hx_name:"Unknown",_hx_index:4,__enum__:"tokentree.utils.BrOpenType",toString:n}};ma.__constructs__=[ma.Block,ma.TypedefDecl,ma.ObjectDecl,ma.AnonType,ma.Unknown];var _a=r["tokentree.utils.BkOpenType"]={__ename__:!0,__constructs__:null,ArrayAccess:{_hx_name:"ArrayAccess",_hx_index:0,__enum__:"tokentree.utils.BkOpenType",toString:n},ArrayLiteral:{_hx_name:"ArrayLiteral",_hx_index:1,__enum__:"tokentree.utils.BkOpenType",toString:n},Comprehension:{_hx_name:"Comprehension",_hx_index:2,__enum__:"tokentree.utils.BkOpenType",toString:n},MapLiteral:{_hx_name:"MapLiteral",_hx_index:3,__enum__:"tokentree.utils.BkOpenType",toString:n},Unknown:{_hx_name:"Unknown",_hx_index:4,__enum__:"tokentree.utils.BkOpenType",toString:n}};_a.__constructs__=[_a.ArrayAccess,_a.ArrayLiteral,_a.Comprehension,_a.MapLiteral,_a.Unknown];var ga=r["tokentree.utils.POpenType"]={__ename__:!0,__constructs__:null,At:{_hx_name:"At",_hx_index:0,__enum__:"tokentree.utils.POpenType",toString:n},Parameter:{_hx_name:"Parameter",_hx_index:1,__enum__:"tokentree.utils.POpenType",toString:n},Call:{_hx_name:"Call",_hx_index:2,__enum__:"tokentree.utils.POpenType",toString:n},SwitchCondition:{_hx_name:"SwitchCondition",_hx_index:3,__enum__:"tokentree.utils.POpenType",toString:n},WhileCondition:{_hx_name:"WhileCondition",_hx_index:4,__enum__:"tokentree.utils.POpenType",toString:n},IfCondition:{_hx_name:"IfCondition",_hx_index:5,__enum__:"tokentree.utils.POpenType",toString:n},SharpCondition:{_hx_name:"SharpCondition",_hx_index:6,__enum__:"tokentree.utils.POpenType",toString:n},Catch:{_hx_name:"Catch",_hx_index:7,__enum__:"tokentree.utils.POpenType",toString:n},ForLoop:{_hx_name:"ForLoop",_hx_index:8,__enum__:"tokentree.utils.POpenType",toString:n},Expression:{_hx_name:"Expression",_hx_index:9,__enum__:"tokentree.utils.POpenType",toString:n}};ga.__constructs__=[ga.At,ga.Parameter,ga.Call,ga.SwitchCondition,ga.WhileCondition,ga.IfCondition,ga.SharpCondition,ga.Catch,ga.ForLoop,ga.Expression];var xa=r["tokentree.utils.ArrowType"]={__ename__:!0,__constructs__:null,ArrowFunction:{_hx_name:"ArrowFunction",_hx_index:0,__enum__:"tokentree.utils.ArrowType",toString:n},OldFunctionType:{_hx_name:"OldFunctionType",_hx_index:1,__enum__:"tokentree.utils.ArrowType",toString:n},NewFunctionType:{_hx_name:"NewFunctionType",_hx_index:2,__enum__:"tokentree.utils.ArrowType",toString:n}};xa.__constructs__=[xa.ArrowFunction,xa.OldFunctionType,xa.NewFunctionType];var ka=r["tokentree.utils.ColonType"]={__ename__:!0,__constructs__:null,SwitchCase:{_hx_name:"SwitchCase",_hx_index:0,__enum__:"tokentree.utils.ColonType",toString:n},TypeHint:{_hx_name:"TypeHint",_hx_index:1,__enum__:"tokentree.utils.ColonType",toString:n},TypeCheck:{_hx_name:"TypeCheck",_hx_index:2,__enum__:"tokentree.utils.ColonType",toString:n},Ternary:{_hx_name:"Ternary",_hx_index:3,__enum__:"tokentree.utils.ColonType",toString:n},ObjectLiteral:{_hx_name:"ObjectLiteral",_hx_index:4,__enum__:"tokentree.utils.ColonType",toString:n},At:{_hx_name:"At",_hx_index:5,__enum__:"tokentree.utils.ColonType",toString:n},Unknown:{_hx_name:"Unknown",_hx_index:6,__enum__:"tokentree.utils.ColonType",toString:n}};ka.__constructs__=[ka.SwitchCase,ka.TypeHint,ka.TypeCheck,ka.Ternary,ka.ObjectLiteral,ka.At,ka.Unknown];class ya{static walkAbstract(e,t){let n=e.consumeToken(),r=e.token();if(1==r._hx_index)switch(r.k._hx_index){case 1:case 28:return e.addToTempStore(n),void za.walkType(e,t)}t.addChild(n);let i=Qa.walkTypeNameDef(e,n);e.applyTempStore(i),20==e.tokenForMatch()._hx_index&&Ha.walkPOpen(e,i);let s,a=i,l=new ta(e);e:for(;l.streamHasChanged();){let t=e.token();switch(t._hx_index){case 2:let n=t.c;if(3==n._hx_index)switch(n.s){case"from":case"to":let t=e.consumeToken();i.addChild(t),Qa.walkTypeNameDef(e,t);break;default:s=e.consumeToken(),a.addChild(s),a=s}else s=e.consumeToken(),a.addChild(s),a=s;break;case 7:case 8:i.addChild(e.consumeToken());break;case 18:break e;default:s=e.consumeToken(),a.addChild(s),a=s}}let o=e.consumeTokenDef(oa.BrOpen);i.addChild(o),ya.walkAbstractBody(e,o),o.addChild(e.consumeTokenDef(oa.BrClose))}static walkAbstractBody(e,t){let n=new ta(e);e:for(;n.streamHasChanged();){let n=e.token();switch(n._hx_index){case 1:switch(n.k._hx_index){case 0:Ea.walkFunction(e,t);break;case 2:Ya.walkVar(e,t);break;case 42:Ia.walkFinal(e,t);break;default:e.consumeToTempStore()}break;case 3:Ja.walkSharp(e,t,ya.walkAbstractBody);break;case 7:case 8:case 10:t.addChild(e.consumeToken());break;case 19:break e;case 23:e.addToTempStore(ba.walkAt(e));break;default:e.consumeToTempStore()}}e.applyTempStore(t)}}ya.__name__="tokentree.walk.WalkAbstract";class wa{static walkArrayAccess(e,t){let n=e.consumeTokenDef(oa.BkOpen);t.addChild(n),e.applyTempStore(n);let r=new ta(e);e:for(;r.streamHasChanged();){let t=e.token();switch(t._hx_index){case 1:switch(t.k._hx_index){case 0:Ea.walkFunction(e,n);break;case 5:e.applyTempStore(n),el.walkWhile(e,n);break;case 7:e.applyTempStore(n),Oa.walkFor(e,n);break;default:e.applyTempStore(n),Ga.walkStatement(e,n)}break;case 6:if(22==t.op._hx_index){let t=n.getLastChild();null==t&&(t=n),Ga.walkStatement(e,t)}else e.applyTempStore(n),Ga.walkStatement(e,n);break;case 15:let r=e.consumeToken(),i=n.getLastChild();null==i&&(i=n),i.addChild(r);break;case 16:wa.walkArrayAccess(e,n);break;case 17:break e;case 18:e.applyTempStore(n),Sa.walkBlock(e,n);break;case 20:e.applyTempStore(n),Ha.walkPOpen(e,n);break;case 23:e.addToTempStore(ba.walkAt(e));break;default:e.applyTempStore(n),Ga.walkStatement(e,n)}}if(n.addChild(e.consumeTokenDef(oa.BkClose)),e.hasMore()){let t=e.token();switch(t._hx_index){case 2:let r=t.c;3==r._hx_index&&"is"==r.s&&Ga.walkStatementContinue(e,n);break;case 6:case 11:case 16:Ga.walkStatementContinue(e,n)}}}}wa.__name__="tokentree.walk.WalkArrayAccess";class ba{static walkAt(e){let t=e.consumeTokenDef(oa.At),n=t;if(12==e.tokenForMatch()._hx_index){let r=e.consumeToken();t.addChild(r),n=r}return ba.walkIdent(e,n),t}static walkIdent(e,t){for(;;){let n,r=e.token();switch(r._hx_index){case 1:n=e.consumeToken();break;case 2:if(3!=r.c._hx_index)return;n=e.consumeConstIdent();break;case 6:if(23!=r.op._hx_index)return;n=e.consumeToken();break;default:return}switch(t.addChild(n),e.token()._hx_index){case 11:let r=e.consumeToken();n.addChild(r),t=r;continue;case 20:let i=e.getTokenPos();if(n.pos.max==i.min){let t=e.getTempStore();e.clearTempStore(),Ha.walkPOpen(e,n,!1);let r=0;for(;r<t.length;)e.addToTempStore(t[r++])}}return}}static walkAts(e){let t=new ta(e);for(;t.streamHasChanged();)23==e.token()._hx_index&&e.addToTempStore(ba.walkAt(e))}}ba.__name__="tokentree.walk.WalkAt";class Ta{static walkBinopSub(e,t){let n=e.consumeOpSub(t);t.addChild(n),2==n.tok._hx_index?Ga.walkStatementContinue(e,n):Ga.walkStatement(e,n)}}Ta.__name__="tokentree.walk.WalkBinopSub";class Sa{static walkBlock(e,t){for(;23==e.tokenForMatch()._hx_index;)e.addToTempStore(ba.walkAt(e));if(18==e.tokenForMatch()._hx_index){let n=e.consumeTokenDef(oa.BrOpen);t.addChild(n),e.applyTempStore(n),Sa.walkBlockContinue(e,n),e.applyTempStore(n)}else Ga.walkStatement(e,t)}static walkBlockContinue(e,t){let n=new ta(e);e:for(;n.streamHasChanged();){let n=e.token();switch(n._hx_index){case 1:switch(n.k._hx_index){case 15:case 16:qa.walkSwitchCases(e,t);break;default:Ga.walkStatement(e,t)}break;case 15:let r=e.consumeToken(),i=t.getLastChild();null==i?t.addChild(r):i.addChild(r);break;case 19:break e;case 17:case 21:t.addChild(e.consumeToken());break;default:Ga.walkStatement(e,t)}}Sa.walkBlockEnd(e,t)}static walkBlockEnd(e,t){if(t.addChild(e.consumeTokenDef(oa.BrClose)),e.hasMore()){let n=e.token();if(6==n._hx_index&&7==n.op._hx_index)return;Sa.walkAfterBlock(e,t),e.hasMore()&&10==e.token()._hx_index&&t.addChild(e.consumeToken())}}static walkAfterBlock(e,t){if(!e.hasMore())return;let n=e.token();switch(n._hx_index){case 2:let r=n.c;3==r._hx_index&&"is"==r.s&&Ga.walkStatementWithoutSemicolon(e,t);break;case 5:t.isCIdentOrCString()&&Ga.walkStatementWithoutSemicolon(e,t);break;case 6:case 11:case 14:Ga.walkStatementWithoutSemicolon(e,t);break;case 7:let i=e.peekNonCommentToken();if(null==i)return;if(null!=i)switch(i._hx_index){case 5:case 6:case 11:case 12:case 22:va.walkComment(e,t),Ga.walkStatementContinue(e,t)}break;case 8:let s=e.peekNonCommentToken();if(null==s)return;if(null!=s)switch(s._hx_index){case 5:case 6:case 11:case 12:case 22:va.walkComment(e,t),Ga.walkStatementContinue(e,t)}break;case 10:return;case 12:Ga.walkDblDot(e,t);break;case 20:4==t.parent.tok._hx_index&&Ga.walkStatementWithoutSemicolon(e,t);break;case 22:Ua.walkQuestion(e,t)}}}Sa.__name__="tokentree.walk.WalkBlock";class Ca{static walkClass(e,t){let n=e.consumeToken();t.addChild(n),va.walkComment(e,t);let r=n,i=e.token();switch(i._hx_index){case 2:3==i.c._hx_index&&(r=Qa.walkTypeNameDef(e,n),e.applyTempStore(r));break;case 4:r=Qa.walkTypeNameDef(e,n),e.applyTempStore(r)}Ca.walkClassExtends(e,r);let s=e.consumeTokenDef(oa.BrOpen);r.addChild(s),Ca.walkClassBody(e,s),s.addChild(e.consumeTokenDef(oa.BrClose))}static walkClassExtends(e,t){let n=new ta(e);for(;n.streamHasChanged();)Aa.walkExtends(e,t),Ba.walkImplements(e,t),e.isSharp()&&Ja.walkSharp(e,t,Ca.walkClassExtends),va.walkComment(e,t)}static walkClassBody(e,t){let n=new ta(e);e:for(;e.hasMore()&&n.streamHasChanged();){let n=e.token();switch(n._hx_index){case 1:switch(n.k._hx_index){case 0:Ea.walkFunction(e,t);break;case 2:Ya.walkVar(e,t);break;case 42:Ia.walkFinal(e,t);break;case 17:case 18:case 19:case 25:case 31:case 33:case 35:case 40:case 41:case 44:e.consumeToTempStore();break;default:switch(ea.MODE._hx_index){case 0:throw Me.thrown("invalid token tree structure - found:"+re.string(e.token()));case 1:Ga.walkStatement(e,t)}}break;case 3:Ja.walkSharp(e,t,Ca.walkClassBody),Ca.walkClassContinueAfterSharp(e,t);break;case 7:case 8:e.hasTempStore()?e.consumeToTempStore():t.addChild(e.consumeToken());break;case 10:t.addChild(e.consumeToken());break;case 19:break e;case 23:e.addToTempStore(ba.walkAt(e));break;default:switch(ea.MODE._hx_index){case 0:throw Me.thrown("invalid token tree structure - found:"+re.string(e.token()));case 1:Ga.walkStatement(e,t)}}}let r=e.getTempStore();if(r.length>0)switch(ea.MODE._hx_index){case 0:throw Me.thrown("invalid token tree structure - found:"+re.string(r));case 1:e.applyTempStore(t)}}static walkClassContinueAfterSharp(e,t){let n=sa.matches(sa.lastChild(sa.firstChild(sa.lastOf(sa.matches(sa.lastChild(t),oa.Sharp("if")),oa.Kwd(li.KwdFunction)))),oa.BrOpen);null!=n&&null==sa.matches(sa.lastChild(n),oa.BrClose)&&Sa.walkBlockContinue(e,t)}}Ca.__name__="tokentree.walk.WalkClass";class va{static walkComment(e,t){let n=new ta(e);for(;e.hasMore()&&n.streamHasChanged();)switch(e.token()._hx_index){case 7:case 8:t.addChild(e.consumeToken());break;default:return}}static tryWalkComment(e,t,n){let r=e.getStreamIndex(),i=new ta(e),s=[];for(;e.hasMore()&&i.streamHasChanged();)switch(e.token()._hx_index){case 7:case 8:s.push(e.consumeToken());break;default:if(e.matches(n)){let e=0;for(;e<s.length;)t.addChild(s[e++]);return}return void e.rewindTo(r)}}}va.__name__="tokentree.walk.WalkComment";class Pa{static walkDoWhile(e,t){let n=e.consumeTokenDef(oa.Kwd(li.KwdDo));t.addChild(n),e.applyTempStore(n),va.walkComment(e,n),Sa.walkBlock(e,n);let r=e.consumeTokenDef(oa.Kwd(li.KwdWhile));n.addChild(r),Ga.walkStatement(e,r),va.walkComment(e,r),10==e.tokenForMatch()._hx_index&&r.addChild(e.consumeToken())}}Pa.__name__="tokentree.walk.WalkDoWhile";class La{static walkEnum(e,t){let n=e.consumeToken(),r=e.tokenForMatch();if(1==r._hx_index&&40==r.k._hx_index)return e.addToTempStore(n),void ya.walkAbstract(e,t);t.addChild(n);let i=Qa.walkTypeNameDef(e,n);e.applyTempStore(i),Sa.walkBlock(e,i)}}La.__name__="tokentree.walk.WalkEnum";class Aa{static walkExtends(e,t){let n=e.tokenForMatch();if(1!=n._hx_index||11!=n.k._hx_index)return;let r=e.consumeTokenDef(oa.Kwd(li.KwdExtends));t.addChild(r),va.walkComment(e,t),Qa.walkTypeNameDef(e,r),va.walkComment(e,t),Aa.walkExtends(e,t),va.walkComment(e,t)}}Aa.__name__="tokentree.walk.WalkExtends";class Fa{static walkFieldDef(e,t){let n=new ta(e);e:for(;n.streamHasChanged();){let n=e.token();switch(n._hx_index){case 1:switch(n.k._hx_index){case 0:case 2:case 42:let n=e.consumeToken();t.addChild(n),t=n;break;default:break e}break;case 7:case 8:va.walkComment(e,t);break;case 23:e.addToTempStore(ba.walkAt(e));break;default:break e}}let r=Qa.walkTypeNameDef(e,t);if(e.applyTempStore(r),12==e.tokenForMatch()._hx_index){let t=e.consumeTokenDef(oa.DblDot);r.addChild(t),Xa.walkTypedefBody(e,t)}let i=e.tokenForMatch();switch(6==i._hx_index&&4==i.op._hx_index&&Ga.walkStatement(e,r),e.token()._hx_index){case 10:r.addChild(e.consumeTokenDef(oa.Semicolon));break;case 15:r.addChild(e.consumeTokenDef(oa.Comma))}}}Fa.__name__="tokentree.walk.WalkFieldDef";class Na{static walkFile(e,t){let n=new ta(e);for(;e.hasMore()&&n.streamHasChanged();){let n=e.token();switch(n._hx_index){case 1:switch(n.k._hx_index){case 0:Ea.walkFunction(e,t);break;case 2:Ya.walkVar(e,t);break;case 13:case 34:case 36:e.applyTempStore(t),Wa.walkPackageImport(e,t);break;case 1:case 26:case 28:case 32:case 40:za.walkType(e,t);break;case 42:Ia.walkFinal(e,t);break;case 17:case 18:case 19:case 25:case 33:case 35:case 41:case 44:e.consumeToTempStore();break;default:Sa.walkBlock(e,t)}break;case 3:if(Ja.walkSharp(e,t,Na.walkFile),!e.hasMore())return;18==e.token()._hx_index&&Sa.walkBlock(e,t.children[t.children.length-1]);break;case 7:case 8:e.hasTempStore()?e.consumeToTempStore():va.walkComment(e,t);break;case 10:case 15:case 17:case 19:case 21:t.addChild(e.consumeToken());break;case 23:e.addToTempStore(ba.walkAt(e));break;default:Sa.walkBlock(e,t)}}let r=e.getTempStore(),i=0;for(;i<r.length;){let e=r[i];++i;let n=e.tok;switch(n._hx_index){case 1:switch(n.k._hx_index){case 18:case 19:case 25:switch(ea.MODE._hx_index){case 0:throw Me.thrown("invalid token tree structure - found:"+re.string(e));case 1:t.addChild(e)}break;default:t.addChild(e)}break;case 23:switch(ea.MODE._hx_index){case 0:throw Me.thrown("invalid token tree structure - found:"+re.string(e));case 1:t.addChild(e)}break;default:t.addChild(e)}}}}Na.__name__="tokentree.walk.WalkFile";class Ia{static walkFinal(e,t){let n=null,r=e.consumeToken();e.addToTempStore(r),va.walkComment(e,t);let i=new ta(e);e:for(;i.streamHasChanged();){let t=e.token();switch(t._hx_index){case 1:switch(t.k._hx_index){case 0:case 1:case 28:return;case 17:case 18:case 19:case 25:case 31:case 33:case 35:case 41:e.consumeToTempStore()}break;case 2:if(3==t.c._hx_index)break e;break;case 7:case 8:e.consumeToTempStore()}}t.addChild(r);let s=new ta(e);for(;s.streamHasChanged();){va.walkComment(e,t),23==e.token()._hx_index&&ba.walkAts(e),va.walkComment(e,t);let i=r;22==e.tokenForMatch()._hx_index&&(i=e.consumeToken(),r.addChild(i)),n=e.consumeConstIdent(),i.addChild(n);let s=e.getTempStore(),a=0;for(;a<s.length;){let e=s[a];++a;let t=e.tok;1==t._hx_index?42!=t.k._hx_index&&n.addChild(e):n.addChild(e)}if(e.clearTempStore(),va.walkComment(e,n),20==e.tokenForMatch()._hx_index&&Ha.walkPOpen(e,n),12==e.tokenForMatch()._hx_index){let t=e.consumeToken();n.addChild(t),Xa.walkTypedefAlias(e,t)}let l=e.tokenForMatch();if(6==l._hx_index&&4==l.op._hx_index&&Ga.walkStatement(e,n),15!=e.tokenForMatch()._hx_index)break;n.addChild(e.consumeToken())}10==e.tokenForMatch()._hx_index&&n.addChild(e.consumeToken())}}Ia.__name__="tokentree.walk.WalkFinal";class Oa{static walkFor(e,t){let n=e.consumeTokenDef(oa.Kwd(li.KwdFor));t.addChild(n),e.applyTempStore(n),va.walkComment(e,n),Oa.walkForPOpen(e,n),va.walkComment(e,n),Sa.walkBlock(e,n)}static walkForPOpen(e,t){let n=e.consumeTokenDef(oa.POpen);t.addChild(n),va.walkComment(e,n);let r=null;4==e.token()._hx_index?(Ga.walkStatement(e,n),r=n.getLastChild()):(r=e.consumeConstIdent(),n.addChild(r)),va.walkComment(e,r);let i=e.tokenForMatch();if(6==i._hx_index&&22==i.op._hx_index){let t=e.consumeToken();r.addChild(t),4==e.token()._hx_index?Ga.walkStatement(e,t):t.addChild(e.consumeConstIdent())}let s=null,a=e.token();switch(a._hx_index){case 1:27==a.k._hx_index&&(s=e.consumeToken(),r.addChild(s),va.walkComment(e,s),Ga.walkStatement(e,s),va.walkComment(e,n),n.addChild(e.consumeTokenDef(oa.PClose)),va.walkComment(e,t));break;case 6:23==a.op._hx_index&&(s=e.consumeToken(),r.addChild(s),va.walkComment(e,s),Ga.walkStatement(e,s),va.walkComment(e,n),n.addChild(e.consumeTokenDef(oa.PClose)),va.walkComment(e,t));break;case 21:return n.addChild(e.consumeToken()),void va.walkComment(e,t)}}}Oa.__name__="tokentree.walk.WalkFor";class Ea{static walkFunction(e,t){let n=e.consumeTokenDef(oa.Kwd(li.KwdFunction));t.addChild(n),va.walkComment(e,n);let r=n,i=e.token();switch(i._hx_index){case 1:r=(i.k._hx_index,Qa.walkTypeNameDef(e,n));break;case 6:9==i.op._hx_index?(ja.walkLtGt(e,n),r=n.getLastChild()):r=Qa.walkTypeNameDef(e,n);break;case 20:break;default:r=Qa.walkTypeNameDef(e,n)}if(e.applyTempStore(r),va.walkComment(e,r),Ea.walkFunctionParameters(e,r),va.walkComment(e,r),3==e.token()._hx_index)switch(Ja.walkSharp(e,r,Ga.walkStatement),e.token()._hx_index){case 12:case 18:break;default:return}if(12==e.tokenForMatch()._hx_index){let t=e.consumeToken();r.addChild(t),Qa.walkTypeNameDef(e,t)}Sa.walkBlock(e,r)}static walkFunctionParameters(e,t){let n=e.consumeTokenDef(oa.POpen);t.addChild(n);let r=new ta(e);for(;r.streamHasChanged()&&(va.walkComment(e,n),21!=e.tokenForMatch()._hx_index);)Fa.walkFieldDef(e,n);n.addChild(e.consumeTokenDef(oa.PClose))}}Ea.__name__="tokentree.walk.WalkFunction";class Da{static walkIf(e,t){let n=e.consumeTokenDef(oa.Kwd(li.KwdIf));if(t.addChild(n),e.applyTempStore(n),Ga.walkStatement(e,n),12==e.tokenForMatch()._hx_index)return;Sa.walkBlock(e,n),va.tryWalkComment(e,n,oa.Kwd(li.KwdElse));let r=e.tokenForMatch();if(1==r._hx_index&&4==r.k._hx_index){let t=e.consumeTokenDef(oa.Kwd(li.KwdElse));n.addChild(t),Sa.walkBlock(e,t)}}}Da.__name__="tokentree.walk.WalkIf";class Ba{static walkImplements(e,t){let n=e.tokenForMatch();if(1!=n._hx_index||12!=n.k._hx_index)return;let r=e.consumeTokenDef(oa.Kwd(li.KwdImplements));t.addChild(r),va.walkComment(e,t),Qa.walkTypeNameDef(e,r),va.walkComment(e,t),Ba.walkImplements(e,t),va.walkComment(e,t)}}Ba.__name__="tokentree.walk.WalkImplements";class Ra{static walkInterface(e,t){let n=e.consumeToken();t.addChild(n);let r=Qa.walkTypeNameDef(e,n);e.applyTempStore(r),Ca.walkClassExtends(e,r);let i=e.consumeTokenDef(oa.BrOpen);r.addChild(i),Ra.walkInterfaceBody(e,i),i.addChild(e.consumeTokenDef(oa.BrClose))}static walkInterfaceBody(e,t){let n=new ta(e);e:for(;n.streamHasChanged();){let n=e.token();switch(n._hx_index){case 1:switch(n.k._hx_index){case 0:Ea.walkFunction(e,t);break;case 2:Ya.walkVar(e,t);break;case 17:case 18:case 19:case 25:case 31:case 33:case 35:case 41:default:e.consumeToTempStore();break;case 42:Ia.walkFinal(e,t)}break;case 3:Ja.walkSharp(e,t,Ra.walkInterfaceBody);break;case 7:case 8:e.hasTempStore()?e.consumeToTempStore():t.addChild(e.consumeToken());break;case 10:t.addChild(e.consumeToken());break;case 19:break e;case 23:e.addToTempStore(ba.walkAt(e));break;default:e.consumeToTempStore()}}e.applyTempStore(t)}}Ra.__name__="tokentree.walk.WalkInterface";class ja{static walkLtGt(e,t){let n=e.consumeTokenDef(oa.Binop(ht.OpLt));t.addChild(n);let r=new ta(e);e:for(;r.streamHasChanged();){let t=e.token();switch(t._hx_index){case 6:switch(t.op._hx_index){case 4:let t=e.consumeToken();n.getLastChild().addChild(t),Qa.walkTypeNameDef(e,t);break;case 7:break e;default:Qa.walkTypeNameDef(e,n)}break;case 12:let r=e.consumeToken();n.addChild(r),Qa.walkTypeNameDef(e,r);break;case 15:n.addChild(e.consumeToken()),Qa.walkTypeNameDef(e,n);break;case 20:Ha.walkPOpen(e,n);break;default:Qa.walkTypeNameDef(e,n)}}n.addChild(e.consumeTokenDef(oa.Binop(ht.OpGt)))}}ja.__name__="tokentree.walk.WalkLtGt";class Ma{static walkNew(e,t){let n=e.consumeTokenDef(oa.Kwd(li.KwdNew));t.addChild(n);let r=Qa.walkTypeNameDef(e,n),i=null;switch(va.walkComment(e,r),e.token()._hx_index){case 3:Ja.walkSharp(e,t,Ga.walkStatement);break;case 20:i=Ha.walkPOpen(e,r)}va.walkComment(e,r);let s=e.token();switch(s._hx_index){case 2:let t=s.c;3==t._hx_index&&"is"==t.s&&(null!=i?Ga.walkStatement(e,i):Ga.walkStatement(e,r));break;case 6:case 11:case 16:null!=i?Ga.walkStatement(e,i):Ga.walkStatement(e,r)}}}Ma.__name__="tokentree.walk.WalkNew";class Ha{static walkPOpen(e,t,n){null==n&&(n=!0);let r=e.consumeTokenDef(oa.POpen);if(t.addChild(r),e.applyTempStore(r),Ha.walkPOpenParts(e,r),r.addChild(e.consumeTokenDef(oa.PClose)),n&&va.walkComment(e,t),e.hasMore()){let n=e.token();switch(n._hx_index){case 3:if("if"==n.s){let n=t.tok;3==n._hx_index?"if"!=n.s&&Ja.walkSharp(e,t,Ga.walkStatement):Ja.walkSharp(e,t,Ga.walkStatement)}break;case 14:let i=e.consumeToken();r.addChild(i),Sa.walkBlock(e,i)}}return r}static walkPOpenParts(e,t){let n=new ta(e);e:for(;n.streamHasChanged();)switch(e.token()._hx_index){case 3:Ja.walkSharp(e,t,Ha.walkPOpenParts);break;case 15:let n=e.consumeToken(),r=t.getLastChild();null==r&&(r=t),r.addChild(n);break;case 16:wa.walkArrayAccess(e,t);break;case 18:Sa.walkBlock(e,t);break;case 21:break e;default:Ga.walkStatement(e,t)}}}Ha.__name__="tokentree.walk.WalkPOpen";class Wa{static walkPackageImport(e,t){let n=new ta(e);for(;e.hasMore()&&n.streamHasChanged();)switch(e.token()._hx_index){case 3:Ja.walkSharp(e,t,Wa.walkPackageImport);break;case 10:return void t.addChild(e.consumeToken());default:let n=e.consumeToken();t.addChild(n),t=n}}}Wa.__name__="tokentree.walk.WalkPackageImport";class Ua{static walkQuestion(e,t){if(!Ua.isTernary(e,t))return void Fa.walkFieldDef(e,t);let n=e.consumeTokenDef(oa.Question);if(t.addChild(n),va.walkComment(e,n),Ga.walkStatement(e,n),va.walkComment(e,n),12!=e.tokenForMatch()._hx_index)return;let r=e.consumeTokenDef(oa.DblDot);n.addChild(r),Ga.walkStatement(e,r)}static isTernary(e,t){let n=t.getLastChild();if(null==n){let e=t.tok;switch(e._hx_index){case 1:switch(e.k._hx_index){case 23:case 37:case 38:case 39:return!0;default:return!1}break;case 2:case 4:case 21:return!0;default:return!1}}let r=n.tok;switch(r._hx_index){case 1:switch(r.k._hx_index){case 0:case 22:case 23:case 29:case 30:case 37:case 38:case 39:return!0;case 41:return n.index+1!=e.getStreamIndex();default:return!1}break;case 2:case 4:case 5:case 12:case 16:case 18:case 20:case 21:return!0;case 6:switch(r.op._hx_index){case 0:case 3:return!0;default:return!1}break;default:return!1}}}Ua.__name__="tokentree.walk.WalkQuestion";class Ja{static walkSharp(e,t,n){let r=e.token();if(3==r._hx_index)switch(r.s){case"else":Ja.walkSharpElse(e,t);break;case"elseif":Ja.walkSharpElseIf(e,t);break;case"end":Ja.walkSharpEnd(e,t);break;case"error":let r=e.consumeToken();t.addChild(r);let i=e.token();2==i._hx_index&&2==i.c._hx_index&&r.addChild(e.consumeToken());break;case"if":Ja.walkSharpIf(e,t,n);break;default:t.addChild(e.consumeToken())}}static walkSharpIf(e,t,n){let r=e.consumeToken();t.addChild(r),Ja.walkSharpIfExpr(e,r),e.pushSharpIf(r);let i=r,s=new ta(e);for(;s.streamHasChanged();)try{switch(n(e,i),e.token()._hx_index){case 15:case 19:case 21:i.addChild(e.consumeToken())}}catch(t){We.lastError=t;let n=Me.caught(t).unwrap();if(!(n instanceof Va)){if(n instanceof Ka)return void e.popSharpIf();throw t}i=n.token}}static walkSharpElse(e,t){let n=e.peekSharpIf(),r=e.consumeToken();throw n.addChild(r),e.applyTempStore(n),Me.thrown(new Va(r))}static walkSharpElseIf(e,t){let n=e.peekSharpIf(),r=e.consumeToken();throw n.addChild(r),e.applyTempStore(n),Ja.walkSharpIfExpr(e,r),Me.thrown(new Va(r))}static walkSharpEnd(e,t){let n=e.peekSharpIf(),r=e.consumeToken();throw e.applyTempStore(n),n.addChild(r),Me.thrown(new Ka)}static walkSharpIfExpr(e,t){let n,r=new ta(e);for(;r.streamHasChanged();){let r=e.token();switch(r._hx_index){case 1:if(n=e.consumeToken(),t.addChild(n),!e.hasMore())return;if(11!=e.token()._hx_index)return;let i=e.getTokenPos();if(null==i)return;if(i.min==n.pos.max+1)continue;let s=e.consumeToken();return n.addChild(s),void Ja.walkSharpIfExpr(e,s);case 2:if(3==r.c._hx_index){if(n=e.consumeToken(),t.addChild(n),!e.hasMore())return;if(11!=e.token()._hx_index)return;let r=e.getTokenPos();if(null==r)return;if(r.min==n.pos.max+1)continue;let i=e.consumeToken();return n.addChild(i),void Ja.walkSharpIfExpr(e,i)}return;case 5:return 2==r.op._hx_index?(n=e.consumeToken(),t.addChild(n),void Ja.walkSharpIfExpr(e,n)):void 0;case 20:return void Ha.walkPOpen(e,t);default:return}}}}Ja.__name__="tokentree.walk.WalkSharp";class Va{constructor(e){this.token=e}}Va.__name__="tokentree.walk.SharpElseException",Object.assign(Va.prototype,{__class__:Va});class Ka{constructor(){}}Ka.__name__="tokentree.walk.SharpEndException",Object.assign(Ka.prototype,{__class__:Ka});class Ga{static walkStatement(e,t){if(Ga.walkStatementWithoutSemicolon(e,t),10==e.tokenForMatch()._hx_index){let n,r=e.consumeToken(),i=t.tok;if(6==i._hx_index)switch(i.op._hx_index){case 0:case 3:case 14:case 15:n=t.parent.getLastChild();break;default:n=t.getLastChild()}else n=t.getLastChild();switch(null==n&&(n=t),n.tok._hx_index){case 17:case 19:case 21:n=t}n.addChild(r)}}static walkStatementWithoutSemicolon(e,t){for(;;){va.walkComment(e,t);let n=!0;ba.walkAts(e);let r=e.token();switch(r._hx_index){case 1:if(!Ga.walkKeyword(e,t))return;n=!0;break;case 2:let i=r.c;if(3==i._hx_index)switch(i.s){case"final":if(!Ga.walkKeyword(e,t))return;n=!0;break;case"is":n=!0;break;default:n=!1}else n=!1;break;case 3:return Ja.walkSharp(e,t,Ga.walkStatement),void Ga.walkStatementContinueAfterSharp(e,t);case 4:return void Ga.walkDollarStatement(e,t);case 5:if(t.isCIdentOrCString()){let n=e.consumeToken();if(t.addChild(n),!e.hasMore())return;let r=e.token();switch(r._hx_index){case 2:let t=r.c;3==t._hx_index&&"is"==t.s&&Ga.walkStatementWithoutSemicolon(e,n);break;case 6:case 11:Ga.walkStatementWithoutSemicolon(e,n)}return}break;case 6:switch(r.op._hx_index){case 3:return void Ta.walkBinopSub(e,t);case 7:let r=e.consumeOpGt();t.addChild(r),t=r;continue;case 9:if(e.isTypedParam())return ja.walkLtGt(e,t),14==e.tokenForMatch()._hx_index&&Ga.walkStatementWithoutSemicolon(e,t),void(20==e.tokenForMatch()._hx_index&&Ga.walkStatementWithoutSemicolon(e,t));n=!0;break;case 12:if(null!=t.parent&&t.parent.tok!=oa.Root){let n=t.parent.tok;if(1==n._hx_index&&15==n.k._hx_index){t.addChild(e.consumeToken()),t=t.parent;continue}}n=!0;break;default:n=!0}break;case 9:case 11:case 13:case 14:case 25:n=!0;break;case 10:case 15:case 17:case 19:case 21:return;case 12:let s=t.tok;switch(s._hx_index){case 1:if(41==s.k._hx_index)return void Ga.walkDblDot(e,t);break;case 11:return}if(11==t.tok._hx_index)return;if(Ua.isTernary(e,t))return void Ga.walkStatementContinue(e,t);n=!0;break;case 16:return wa.walkArrayAccess(e,t),void Ga.walkStatementContinue(e,t);case 18:return void Sa.walkBlock(e,t);case 20:return void Ga.walkPOpen(e,t);case 22:return void Ua.walkQuestion(e,t);default:n=!1}let i=e.consumeToken();return t.addChild(i),e.applyTempStore(i),Ga.walkTrailingComment(e,i),n&&Ga.walkStatementWithoutSemicolon(e,i),Ga.walkStatementContinue(e,i),void Ga.walkTrailingComment(e,i)}}static walkTrailingComment(e,t){if(e.hasMore()&&8==e.token()._hx_index){let n=e.getStreamIndex(),r=e.consumeToken(),i=e.tokenForMatch();if(1!=i._hx_index||4!=i.k._hx_index)return void e.rewindTo(n);t.addChild(r)}}static walkStatementContinue(e,t){for(;;){if(!e.hasMore())return;let n=e.token();switch(n._hx_index){case 2:let r=n.c;3==r._hx_index&&"is"==r.s&&Ga.walkStatementWithoutSemicolon(e,t);break;case 5:t.isCIdentOrCString()&&Ga.walkStatementWithoutSemicolon(e,t);break;case 6:switch(n.op._hx_index){case 0:case 3:Ga.walkOpAdd(e,t);break;case 7:let n=t;e:for(;;){let e=n.tok;switch(e._hx_index){case 0:default:break e;case 2:case 4:case 11:case 12:case 14:case 15:case 16:case 18:case 20:n=n.parent;break;case 6:switch(e.op._hx_index){case 7:n=n.parent;break;case 9:return;default:break e}}}Ga.walkStatementWithoutSemicolon(e,t);break;case 14:case 15:Ga.walkOpBool(e,t);break;default:Ga.walkStatementWithoutSemicolon(e,t)}break;case 7:let i=e.peekNonCommentToken();if(null==i)return;if(null!=i)switch(i._hx_index){case 5:case 6:case 11:case 12:case 22:va.walkComment(e,t);continue}break;case 8:let s=e.peekNonCommentToken();if(null==s)return;if(null!=s)switch(s._hx_index){case 5:case 6:case 11:case 12:case 22:va.walkComment(e,t);continue}break;case 10:return;case 12:Ga.walkDblDot(e,t);break;case 11:case 13:case 14:case 16:case 20:case 25:Ga.walkStatementWithoutSemicolon(e,t);break;case 22:Ua.walkQuestion(e,t)}return}}static walkKeyword(e,t){let n=e.token();if(1!=n._hx_index)return!0;switch(n.k._hx_index){case 0:Ea.walkFunction(e,t);break;case 1:Ca.walkClass(e,t);break;case 2:Ya.walkVar(e,t);break;case 3:Da.walkIf(e,t);break;case 5:let n;if(18!=t.tok._hx_index){let e=t.parent.tok;n=1==e._hx_index&&6==e.k._hx_index}else n=!1;if(n)return!1;el.walkWhile(e,t);break;case 6:Pa.walkDoWhile(e,t);break;case 7:Oa.walkFor(e,t);break;case 10:case 41:default:return!0;case 14:qa.walkSwitch(e,t);break;case 15:return!1;case 16:return 18!=t.tok._hx_index;case 17:case 18:case 19:return e.addToTempStore(e.consumeToken()),!1;case 20:$a.walkTry(e,t);break;case 22:if(11==t.tok._hx_index){let n=e.consumeToken();t.addChild(n),Ga.walkStatementContinue(e,n)}else Ma.walkNew(e,t);break;case 23:let r=e.consumeToken();return t.addChild(r),Ga.walkStatementContinue(e,r),!1;case 30:let i=e.consumeToken();return t.addChild(i),Ga.walkStatementWithoutSemicolon(e,i),!1;case 35:return Ga.walkInline(e,t);case 37:case 38:case 39:let s=e.consumeToken();if(t.addChild(s),!e.hasMore())return!1;let a=e.token();switch(a._hx_index){case 6:switch(a.op._hx_index){case 14:case 15:Ga.walkOpBool(e,s);break;default:Ga.walkStatementWithoutSemicolon(e,s)}break;case 22:Ua.walkQuestion(e,s)}return!1;case 42:Ia.walkFinal(e,t)}return!1}static walkInline(e,t){e.addToTempStore(e.consumeToken());let n=e.token();switch(n._hx_index){case 1:switch(n.k._hx_index){case 0:return Ea.walkFunction(e,t),!1;case 22:return!0;default:return!1}break;case 2:return!0;default:return!1}}static walkDblDot(e,t){if(null!=Ga.findQuestionParent(e,t))return;let n=e.consumeToken();if(t.addChild(n),t.isCIdentOrCString()&&18==t.parent.tok._hx_index)return void Ga.walkStatementWithoutSemicolon(e,n);let r=e.tokenForMatch();if(1==r._hx_index&&22==r.k._hx_index)return void Ma.walkNew(e,n);if(!Ga.walkKeyword(e,n))return;Qa.walkTypeNameDef(e,n);let i=e.tokenForMatch();6==i._hx_index&&4==i.op._hx_index&&Ga.walkStatementWithoutSemicolon(e,t),14==e.tokenForMatch()._hx_index&&Ga.walkStatementWithoutSemicolon(e,t)}static walkPOpen(e,t){let n=Ha.walkPOpen(e,t);if(t.tok!=oa.Root)if(t.isCIdent())Ga.walkStatementContinue(e,t);else{let r=t.tok;if(1==r._hx_index)switch(r.k._hx_index){case 3:case 5:case 7:case 14:let t=e.token();switch(t._hx_index){case 6:if(3==t.op._hx_index)return;break;case 11:break;default:return}}Ga.walkStatementContinue(e,n)}}static findQuestionParent(e,t){let n=t;for(;null!=n&&n.tok!=oa.Root;){let t=n.tok;switch(t._hx_index){case 1:switch(t.k._hx_index){case 10:case 15:case 16:return n;case 41:if(n.index+1==e.getStreamIndex())return null;if(n=Ga.findQuestionParent(e,n.parent),null==n)return null;let t=n.tok;switch(t._hx_index){case 1:switch(t.k._hx_index){case 15:case 16:return n;default:return null}break;case 22:return n;default:return null}}break;case 6:return n;case 12:switch(fa.determineColonType(n)._hx_index){case 0:case 5:return null}break;case 15:return null;case 18:if(null==sa.firstOf(n,oa.BrClose))return null;break;case 20:if(null==sa.firstOf(n,oa.PClose))return null;break;case 22:return Ua.isTernary(e,n)?n:null}n=n.parent}return null}static walkStatementContinueAfterSharp(e,t){let n=e.token();if(1==n._hx_index)switch(n.k._hx_index){case 15:case 16:let n=t.getLastChild();null==n&&(n=t),qa.walkSwitchCases(e,n)}}static walkOpBool(e,t){let n=t.parent;e:for(;n.tok!=oa.Root;){let e=n.tok;switch(e._hx_index){case 1:switch(e.k._hx_index){case 0:case 14:case 15:case 16:case 3:case 5:case 10:case 24:case 29:break e;default:t=n,n=n.parent}break;case 6:switch(e.op._hx_index){case 4:case 20:break e;case 14:case 15:t=n.parent;break e;default:t=n,n=n.parent}break;case 12:t=n;break e;case 20:20==t.tok._hx_index&&(t=n);break e;case 14:case 22:break e;default:t=n,n=n.parent}}Ga.walkStatementWithoutSemicolon(e,t)}static walkOpAdd(e,t){let n=t.parent;e:for(;n.tok!=oa.Root;){let e=n.tok;switch(e._hx_index){case 1:switch(e.k._hx_index){case 0:case 3:case 5:case 10:case 24:case 29:break e;default:t=n,n=n.parent}break;case 6:switch(e.op._hx_index){case 1:case 2:t=n,n=n.parent;break;case 0:case 3:t=n.parent;break e;default:break e}break;case 9:case 12:case 16:case 18:case 14:case 22:break e;case 20:if(null==sa.firstOf(n,oa.PClose)){t=n;break e}t=n,n=n.parent;break;default:t=n,n=n.parent}}Ga.walkStatementWithoutSemicolon(e,t)}static walkDollarStatement(e,t){let n=e.consumeToken();t.addChild(n);let r=e.token();switch(r._hx_index){case 2:let t=r.c;3==t._hx_index&&"is"==t.s&&Sa.walkBlock(e,n);break;case 6:case 11:case 16:case 18:case 20:Sa.walkBlock(e,n)}}}Ga.__name__="tokentree.walk.WalkStatement";class qa{static walkSwitch(e,t){let n=e.consumeTokenDef(oa.Kwd(li.KwdSwitch));if(t.addChild(n),e.applyTempStore(n),va.walkComment(e,n),Ga.walkStatement(e,n),va.walkComment(e,n),3==e.token()._hx_index&&Ja.walkSharp(e,t,qa.walkSwitchCases),18==e.tokenForMatch()._hx_index){let t=e.consumeToken();n.addChild(t),qa.walkSwitchCases(e,t),t.addChild(e.consumeTokenDef(oa.BrClose))}}static walkSwitchCases(e,t){let n=new ta(e);e:for(;n.streamHasChanged();){let n=e.token();switch(n._hx_index){case 1:switch(n.k._hx_index){case 15:case 16:qa.walkCase(e,t);break;default:Ga.walkStatement(e,t)}break;case 3:Ja.walkSharp(e,t,qa.walkSwitchCases);break;case 7:case 8:va.walkComment(e,t);break;case 19:break e;default:Ga.walkStatement(e,t)}}}static walkCase(e,t){va.walkComment(e,t);let n=e.consumeToken();t.addChild(n),qa.walkCaseExpr(e,n);let r=e.consumeTokenDef(oa.DblDot);n.addChild(r);let i=new ta(e);for(;i.streamHasChanged();){let n=e.token();switch(n._hx_index){case 1:switch(n.k._hx_index){case 15:case 16:return;default:Ga.walkStatement(e,r)}break;case 3:Ja.walkSharp(e,t,qa.walkSwitchCases),qa.relocateSharpTree(t,r);break;case 7:let i=e.peekNonCommentToken();if(null!=i&&1==i._hx_index)switch(i.k._hx_index){case 15:case 16:if(e.getStreamIndex()>r.index+1)return}va.walkComment(e,r);break;case 8:let s=e.peekNonCommentToken();if(null!=s&&1==s._hx_index)switch(s.k._hx_index){case 15:case 16:if(e.getStreamIndex()>r.index+1)return}va.walkComment(e,r);break;case 18:Sa.walkBlock(e,r);break;case 19:return;default:Ga.walkStatement(e,r)}}}static relocateSharpTree(e,t){let n=e.getLastChild();if(n.children.length<2)return;let r=n.children[1].tok;1==r._hx_index&&15==r.k._hx_index||(e.children.pop(),t.addChild(n))}static walkCaseExpr(e,t){let n=new ta(e);for(;n.streamHasChanged();){let n=e.token();switch(n._hx_index){case 1:if(2==n.k._hx_index){let n=e.consumeToken();t.addChild(n),Ga.walkStatement(e,n)}else Ga.walkStatement(e,t);break;case 10:case 12:case 17:case 19:case 21:return;case 15:let r=e.consumeToken(),i=t.getLastChild();null==i&&(i=t),i.addChild(r);break;default:Ga.walkStatement(e,t)}}}}qa.__name__="tokentree.walk.WalkSwitch";class $a{static walkTry(e,t){let n=e.consumeTokenDef(oa.Kwd(li.KwdTry));t.addChild(n),e.applyTempStore(n),Sa.walkBlock(e,n);let r=e.getStreamIndex(),i=new ta(e),s=[];for(;e.hasMore()&&i.streamHasChanged();){let t=e.token();switch(t._hx_index){case 1:if(21!=t.k._hx_index)return void e.rewindTo(r);{let t=0;for(;t<s.length;)n.addChild(s[t++]);s=[],$a.walkCatch(e,n),r=e.getStreamIndex()}break;case 7:case 8:s.push(e.consumeToken());break;default:return void e.rewindTo(r)}}}static walkCatch(e,t){let n=e.consumeTokenDef(oa.Kwd(li.KwdCatch));t.addChild(n),Ha.walkPOpen(e,n),va.walkComment(e,n),Sa.walkBlock(e,n)}}$a.__name__="tokentree.walk.WalkTry";class za{static walkType(e,t){let n=e.token();if(1==n._hx_index)switch(n.k._hx_index){case 1:Ca.walkClass(e,t);break;case 26:La.walkEnum(e,t);break;case 28:Ra.walkInterface(e,t);break;case 32:Za.walkTypedef(e,t);break;case 40:ya.walkAbstract(e,t)}}}za.__name__="tokentree.walk.WalkType";class Qa{static walkTypeNameDef(e,t){if(va.walkComment(e,t),ba.walkAts(e),22==e.tokenForMatch()._hx_index){let n=e.consumeTokenDef(oa.Question);t.addChild(n),t=n,va.walkComment(e,n)}let n,r=!0,i=e.token();switch(i._hx_index){case 1:i.k._hx_index,n=e.consumeToken();break;case 2:n=e.consumeConst();break;case 3:if(Ja.walkSharp(e,t,Ga.walkStatement),!e.hasMore())return t.getFirstChild();if(2!=e.token()._hx_index)return t.getFirstChild();n=e.consumeConst();break;case 4:default:n=e.consumeToken();break;case 16:return wa.walkArrayAccess(e,t),t.getFirstChild();case 18:return Xa.walkTypedefBody(e,t),t.getFirstChild();case 20:n=Ha.walkPOpen(e,t),22==e.tokenForMatch()._hx_index&&Ua.walkQuestion(e,n),r=!1}return e.applyTempStore(n),r&&t.addChild(n),Qa.walkTypeNameDefContinue(e,n),n}static walkTypeNameDefContinue(e,t){if(Qa.walkTypeNameDefComment(e,t),11==e.tokenForMatch()._hx_index){let n=e.consumeToken();return t.addChild(n),void Qa.walkTypeNameDef(e,n)}let n=e.tokenForMatch();if(6==n._hx_index&&9==n.op._hx_index&&ja.walkLtGt(e,t),14==e.tokenForMatch()._hx_index){let n=e.consumeToken();return t.addChild(n),void Qa.walkTypeNameDef(e,n)}16==e.tokenForMatch()._hx_index&&wa.walkArrayAccess(e,t),Qa.walkTypeNameDefComment(e,t)}static walkTypeNameDefComment(e,t){let n=e.getStreamIndex(),r=new ta(e),i=[];for(;e.hasMore()&&r.streamHasChanged();)switch(e.token()._hx_index){case 6:let r=0;for(;r<i.length;)t.addChild(i[r++]);return;case 7:case 8:i.push(e.consumeToken());break;case 10:case 11:case 12:case 15:case 16:case 18:case 20:let s=0;for(;s<i.length;)t.addChild(i[s++]);return;default:return void e.rewindTo(n)}}}Qa.__name__="tokentree.walk.WalkTypeNameDef";class Za{static walkTypedef(e,t){let n=e.consumeToken();t.addChild(n);let r=Qa.walkTypeNameDef(e,n);e.applyTempStore(r);let i=e.tokenForMatch();if(6==i._hx_index&&4==i.op._hx_index){let t=e.consumeTokenDef(oa.Binop(ht.OpAssign));r.addChild(t),r=t}Xa.walkTypedefBody(e,r)}}Za.__name__="tokentree.walk.WalkTypedef";class Xa{static walkTypedefBody(e,t){if(18==e.tokenForMatch()._hx_index){let n=e.consumeToken();t.addChild(n),Xa.walkTypedefCurlyBody(e,n),n.addChild(e.consumeTokenDef(oa.BrClose))}else Xa.walkTypedefAlias(e,t);let n=e.tokenForMatch();if(6==n._hx_index&&11==n.op._hx_index){let n=e.consumeTokenDef(oa.Binop(ht.OpAnd));t.getLastChild().addChild(n),Xa.walkTypedefBody(e,t)}14==e.tokenForMatch()._hx_index&&Ga.walkStatement(e,t)}static walkTypedefCurlyBody(e,t){let n=new ta(e);e:for(;n.streamHasChanged();){let n=e.token();switch(n._hx_index){case 1:switch(n.k._hx_index){case 0:Ea.walkFunction(e,t);break;case 2:Ya.walkVar(e,t);break;case 17:case 18:case 19:case 25:case 31:case 33:case 35:case 41:e.consumeToTempStore();break;case 42:Ia.walkFinal(e,t);break;default:Fa.walkFieldDef(e,t)}break;case 3:Ja.walkSharp(e,t,Xa.walkTypedefCurlyBody);break;case 6:7==n.op._hx_index?Xa.walkStructureExtension(e,t):Fa.walkFieldDef(e,t);break;case 7:case 8:e.hasTempStore()?e.consumeToTempStore():va.walkComment(e,t);break;case 19:break e;case 23:e.addToTempStore(ba.walkAt(e));break;default:Fa.walkFieldDef(e,t)}}let r=e.getTempStore();if(r.length>0)switch(ea.MODE._hx_index){case 0:throw Me.thrown("invalid token tree structure - found:"+re.string(r));case 1:e.applyTempStore(t)}}static walkTypedefAlias(e,t){let n;if(n=20==e.tokenForMatch()._hx_index?Ha.walkPOpen(e,t):Qa.walkTypeNameDef(e,t),14==e.tokenForMatch()._hx_index){let t=e.consumeToken();n.addChild(t),Xa.walkTypedefAlias(e,t)}10==e.tokenForMatch()._hx_index&&n.addChild(e.consumeToken())}static walkStructureExtension(e,t){let n=e.consumeTokenDef(oa.Binop(ht.OpGt));t.addChild(n);let r=Qa.walkTypeNameDef(e,t);n.addChild(r),15==e.tokenForMatch()._hx_index&&r.addChild(e.consumeToken())}}Xa.__name__="tokentree.walk.WalkTypedefBody";class Ya{static walkVar(e,t){let n=null,r=e.consumeTokenDef(oa.Kwd(li.KwdVar));t.addChild(r),va.walkComment(e,t);let i=new ta(e);for(;i.streamHasChanged();){let i=e.tokenForMatch();if(1==i._hx_index&&2==i.k._hx_index)return;va.walkComment(e,t),23==e.token()._hx_index&&ba.walkAts(e),va.walkComment(e,t);let s=r;if(22==e.tokenForMatch()._hx_index&&(s=e.consumeToken(),r.addChild(s)),n=e.consumeConstIdent(),s.addChild(n),e.applyTempStore(n),va.walkComment(e,n),20==e.tokenForMatch()._hx_index&&Ha.walkPOpen(e,n),12==e.tokenForMatch()._hx_index){let t=e.consumeToken();n.addChild(t),Xa.walkTypedefAlias(e,t)}let a=e.tokenForMatch();if(6==a._hx_index&&4==a.op._hx_index&&Ga.walkStatement(e,n),15!=e.tokenForMatch()._hx_index)break;n.addChild(e.consumeToken())}10==e.tokenForMatch()._hx_index&&n.addChild(e.consumeToken())}}Ya.__name__="tokentree.walk.WalkVar";class el{static walkWhile(e,t){let n=e.consumeTokenDef(oa.Kwd(li.KwdWhile));t.addChild(n),e.applyTempStore(n),va.walkComment(e,n),Ga.walkStatement(e,n),va.walkComment(e,n),Sa.walkBlock(e,n)}}function tl(e){return e instanceof Array?new ct(e):e.iterator()}function nl(t,n){return null==n?null:(null==n.__id__&&(n.__id__=e.$haxeUID++),null==t.hx__closures__?t.hx__closures__={}:r=t.hx__closures__[n.__id__],null==r&&(r=n.bind(t),t.hx__closures__[n.__id__]=r),r);var r}el.__name__="tokentree.walk.WalkWhile",e.$haxeUID|=0,"undefined"!=typeof performance&&"function"==typeof performance.now&&(a.now=performance.now.bind(performance)),Object.defineProperty(String.prototype,"__class__",{value:String,enumerable:!1,writable:!0}),String.__name__="String",Array.__name__="Array",Date.prototype.__class__=Date,Date.__name__="Date";var rl={},il={},sl=Number,al=Boolean,ll={},ol={};Yn.__toStr={}.toString,i.DAY_SHORT_NAMES=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],i.DAY_NAMES=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],i.MONTH_SHORT_NAMES=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],i.MONTH_NAMES=["January","February","March","April","May","June","July","August","September","October","November","December"],ue.Element=0,ue.PCData=1,ue.CData=2,ue.Comment=3,ue.DocType=4,ue.ProcessingInstruction=5,ue.Document=6,he.totalLinesOrig=0,he.totalLinesFormatted=0,mt.escapes=function(e){let t=new tt;return t.m.set("lt","<"),t.m.set("gt",">"),t.m.set("amp","&"),t.m.set("quot",'"'),t.m.set("apos","'"),t}(),xt.DefaultInitOptions={displayServerConfig:{path:"haxe",env:{},arguments:[],print:{completion:!1,reusing:!1},useSocket:!0},displayArguments:[],haxelibConfig:{executable:"haxelib"},sendMethodResults:!1,experimentalClientCapabilities:{supportedCommands:[]}},xt.DefaultUserSettings={enableCodeLens:!1,enableDiagnostics:!0,enableServerView:!1,enableSignatureHelpDocumentation:!0,diagnosticsForAllOpenFiles:!0,diagnosticsPathFilter:"${workspaceRoot}",displayHost:null,displayPort:null,buildCompletionCache:!0,enableCompletionCacheWarning:!0,useLegacyCompletion:!1,useLegacyDiagnostics:!1,codeGeneration:{functions:{anonymous:{argumentTypeHints:!1,returnTypeHint:"never",useArrowSyntax:!0,placeOpenBraceOnNewLine:!1,explicitPublic:!1,explicitPrivate:!1,explicitNull:!1},field:{argumentTypeHints:!0,returnTypeHint:"non-void",useArrowSyntax:!1,placeOpenBraceOnNewLine:!1,explicitPublic:!1,explicitPrivate:!1,explicitNull:!1}},imports:{style:"type",enableAutoImports:!0},switch_:{parentheses:!1}},exclude:["zpp_nape"],postfixCompletion:{level:"full"},importsSortOrder:"all-alphabetical",maxCompletionItems:1e3,renameSourceFolders:["src","source","Source","test","tests"],disableRefactorCache:!1,disableInlineValue:!0,inlayHints:{variableTypes:!1,parameterNames:!1,parameterTypes:!1,functionReturnTypes:!1,conditionals:!1},serverRecording:{enabled:!1,path:".haxelsp/recording/",exclude:[],excludeUntracked:!1,watch:[]}},kt.haxeSelector=[{language:"haxe",scheme:"file"},{language:"haxe",scheme:"untitled"}],kt.hxmlSelector=[{language:"hxml",scheme:"file"},{language:"hxml",scheme:"untitled"}];var cl=new s("^/[a-zA-Z]:",""),ul=new s("^(([^:/?#]+?):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?",""),hl=new s("^(/)?([A-Z]:)","");cn.HINT_SETTINGS=" - check `haxe.renameSourceFolders` setting (see https://github.com/vshaxe/vshaxe/wiki/Rename-Symbol)",gn.stdLibPackages=["cpp","cs","eval","flash","haxe","hl","java","js","lua","neko","php","python","sys","Any","Array","ArrayAccess","Bool","Class","Date","DateTools","Dynamic","EReg","Enum","EnumValue","Float","Int","IntIterator","Iterable","Iterator","KeyValueIterable","KeyValueIterator","Lambda","List","Map","Math","Null","Reflect","Single","Std","String","StringBuf","StringTools","Sys","SysError","Type","UInt","UnicodeString","ValueType","Void","Xml","XmlType"],Nn.autoTriggerOnSpacePattern=new s("(\\b(import|using|extends|implements|from|to|case|new|cast|override)|(->)) $",""),Nn.dollarPattern=new s("(\\$+)$",""),In.reCaseOrDefault=new s("\\b(case|default)\\b[^:]*:$",""),In.reFieldPart=new s("(\\.|@(:?))(\\w*)$",""),Wn.regionStartPattern=new s("^\\s*[#{]?\\s*region\\b",""),Wn.regionEndPattern=new s("^\\s*[#}]?\\s*end ?region\\b","");var dl=[{name:"full",description:"Apply dead code elimination to all code."},{name:"std",description:"Only apply dead code elimination to the standard library."},{name:"no",description:"Disable dead code elimination."}],pl=function(e){let t={major:4,minor:0,patch:0,pre:"rc.3",build:null},n={major:4,minor:0,patch:0,pre:"rc.4",build:null},r={major:4,minor:1,patch:0,pre:null,build:null},i={major:4,minor:2,patch:0,pre:null,build:null},s=new tt;return s.m.set("CsVer",{since:t}),s.m.set("NetcoreVer",{since:t}),s.m.set("DumpPath",{since:n}),s.m.set("KeepInlinePositions",{since:n}),s.m.set("StdEncodingUtf8",{since:r}),s.m.set("NoTre",{since:r}),s.m.set("JarLegacyLoader",{since:i}),s.m.set("NoCOpt",{until:r}),s.m.set("OldConstructorInline",{until:r}),s.m.set("JvmCompressionLevel",{since:i}),s.m.set("JvmDynamicLevel",{since:i}),s}(),fl=function(e){let t=new tt;t.m.set("Dce",dl),t.m.set("Dump",[{name:"pretty"},{name:"record"},{name:"position"},{name:"legacy"}]),t.m.set("HlVer",[{name:"1.10.0"},{name:"1.11.0"},{name:"1.12.0"}]),t.m.set("JavaVer",[{name:"7"},{name:"6"},{name:"5"}]),t.m.set("JsEs",[{name:"6"},{name:"5"},{name:"3"}]),t.m.set("LuaVer",[{name:"5.2"},{name:"5.1"}]),t.m.set("NetTarget",[{name:"net"},{name:"netcore",description:".NET core"},{name:"xbox"},{name:"micro",description:"Micro Framework"},{name:"compact",description:"Compact Framework"}]);{let e=er(1,9);t.m.set("SwfCompressLevel",e)}{let e=er(0,9);t.m.set("JvmCompressionLevel",e)}return t.m.set("JvmDynamicLevel",[{name:"1",description:"field read/write optimization (default)"},{name:"0",description:"none"},{name:"2",description:"compile-time method closures"}]),t}(),ml=[{name:"NoCOpt",define:"no_copt",doc:"Disable completion optimization (for debug purposes)."},{name:"OldConstructorInline",define:"old-constructor-inline",doc:"Use old constructor inlining logic (from Haxe 3.4.2) instead of the reworked version."}],_l=[{name:"AbsolutePath",define:"absolute_path",doc:"Print absolute file path in trace output."},{name:"AdvancedTelemetry",define:"advanced-telemetry",doc:"Allow the SWF to be measured with Monocle tool.",platforms:["flash"]},{name:"AnalyzerOptimize",define:"analyzer_optimize",doc:"Perform advanced optimizations."},{name:"AnnotateSource",define:"annotate_source",doc:"Add additional comments to generated source code.",platforms:["cpp"]},{name:"CheckXmlProxy",define:"check_xml_proxy",doc:"Check the used fields of the XML proxy."},{name:"CoreApi",define:"core_api",doc:"Defined in the core API context."},{name:"CoreApiSerialize",define:"core_api_serialize",doc:"Mark some generated core API classes with the `Serializable` attribute on C#.",platforms:["cs"]},{name:"Cppia",define:"cppia",doc:"Generate cpp instruction assembly."},{name:"CsVer",define:"cs_ver",doc:"The C# version to target.",platforms:["cs"],params:["version"]},{name:"NoCppiaAst",define:"nocppiaast",doc:"Use legacy cppia generation."},{name:"Dce",define:"dce",doc:"Set the dead code elimination mode. (default: std)",params:["mode: std | full | no"],links:["https://haxe.org/manual/cr-dce.html"]},{name:"DceDebug",define:"dce_debug",doc:"Show DCE log.",links:["https://haxe.org/manual/cr-dce.html"]},{name:"Debug",define:"debug",doc:"Activated when compiling with -debug."},{name:"DisableUnicodeStrings",define:"disable_unicode_strings",doc:"Disable Unicode support in `String` type.",platforms:["cpp"]},{name:"Display",define:"display",doc:"Activated during completion.",links:["https://haxe.org/manual/cr-completion.html"]},{name:"DisplayStdin",define:"display_stdin",doc:"Read the contents of a file specified in `--display` from standard input."},{name:"DllExport",define:"dll_export",doc:"GenCPP experimental linking.",platforms:["cpp"]},{name:"DllImport",define:"dll_import",doc:"Handle Haxe-generated .NET DLL imports.",platforms:["cs"]},{name:"DocGen",define:"doc_gen",doc:"Do not perform any removal/change in order to correctly generate documentation."},{name:"Dump",define:"dump",doc:"Dump typed AST in dump subdirectory using specified mode or non-prettified default.",params:["mode: pretty | record | position | legacy"]},{name:"DumpPath",define:"dump_path",doc:'Path to generate dumps to (default: "dump").',params:["path"]},{name:"DumpDependencies",define:"dump_dependencies",doc:"Dump the classes dependencies in a dump subdirectory."},{name:"DumpIgnoreVarIds",define:"dump_ignore_var_ids",doc:"Remove variable IDs from non-pretty dumps (helps with diff)."},{name:"DynamicInterfaceClosures",define:"dynamic_interface_closures",doc:"Use slow path for interface closures to save space.",platforms:["cpp"]},{name:"EraseGenerics",define:"erase_generics",doc:"Erase generic classes on C#.",platforms:["cs"]},{name:"EvalCallStackDepth",define:"eval_call_stack_depth",doc:"Set maximum call stack depth for eval. (default: 1000)",platforms:["eval"],params:["depth"]},{name:"EvalDebugger",define:"eval_debugger",doc:"Support debugger in macro/interp mode. Allows `host:port` value to open a socket. Implies eval_stack.",platforms:["eval"]},{name:"EvalStack",define:"eval_stack",doc:"Record stack information in macro/interp mode.",platforms:["eval"]},{name:"EvalTimes",define:"eval_times",doc:"Record per-method execution times in macro/interp mode. Implies eval_stack.",platforms:["eval"]},{name:"FilterTimes",define:"filter_times",doc:"Record per-filter execution times upon --times."},{name:"FastCast",define:"fast_cast",doc:"Enables an experimental casts cleanup on C# and Java.",platforms:["cs","java"]},{name:"Fdb",define:"fdb",doc:"Enable full flash debug infos for FDB interactive debugging.",platforms:["flash"]},{name:"FileExtension",define:"file_extension",doc:"Output filename extension for cpp source code.",platforms:["cpp"]},{name:"FlashStrict",define:"flash_strict",doc:"More strict typing for flash target.",platforms:["flash"]},{name:"FlashUseStage",define:"flash_use_stage",doc:"Keep the SWF library initial stage.",platforms:["flash"]},{devcomment:"force_lib_check is only here as a debug facility - compiler checking allows errors to be found more easily",name:"ForceLibCheck",define:"force_lib_check",doc:"Force the compiler to check `--net-lib` and `–-java-lib` added classes (internal).",platforms:["cs","java"]},{name:"ForceNativeProperty",define:"force_native_property",doc:"Tag all properties with `:nativeProperty` metadata for 3.1 compatibility.",platforms:["cpp"]},{name:"GencommonDebug",define:"gencommon_debug",doc:"GenCommon internal.",platforms:["cs","java"]},{name:"Haxe3Compat",define:"haxe3compat",doc:"Gives warnings about transition from Haxe 3.x to Haxe 4.0."},{name:"HaxeBoot",define:"haxe_boot",doc:"Give the name 'haxe' to the flash boot class instead of a generated name.",platforms:["flash"]},{name:"HaxeVer",define:"haxe_ver",doc:"The current Haxe version value as decimal number. E.g. 3.407 for 3.4.7.",reserved:!0},{name:"Haxe",define:"haxe",doc:"The current Haxe version value in SemVer format.",reserved:!0},{name:"HlVer",define:"hl_ver",doc:"The HashLink version to target. (default: 1.10.0)",platforms:["hl"],params:["version"]},{name:"HxcppApiLevel",define:"hxcpp_api_level",doc:"Provided to allow compatibility between hxcpp versions.",platforms:["cpp"],reserved:!0},{name:"HxcppGcGenerational",define:"HXCPP_GC_GENERATIONAL",doc:"Experimental Garbage Collector.",platforms:["cpp"]},{name:"HxcppDebugger",define:"HXCPP_DEBUGGER",doc:"Include additional information for hxcpp_debugger.",platforms:["cpp"]},{name:"HxcppSmartStings",define:"hxcpp_smart_strings",doc:"Use wide strings in hxcpp. (Turned on by default unless `-D disable_unicode_strings` is specified.)",platforms:["cpp"]},{name:"IncludePrefix",define:"include_prefix",doc:"Prepend path to generated include files.",platforms:["cpp"]},{name:"Interp",define:"interp",doc:"The code is compiled to be run with `--interp`."},{name:"JarLegacyLoader",define:"jar-legacy-loader",doc:"Use the legacy loader to load .jar files on the JVM target.",platforms:["java"]},{name:"JavaVer",define:"java_ver",doc:"Sets the Java version to be targeted.",platforms:["java"],params:["version: 5-7"]},{name:"JsClassic",define:"js_classic",doc:"Don't use a function wrapper and strict mode in JS output.",platforms:["js"]},{name:"JsEs",define:"js_es",doc:"Generate JS compliant with given ES standard version. (default: 5)",platforms:["js"],params:["version: 3 | 5 | 6"],links:["https://haxe.org/manual/target-javascript-es6.html"]},{name:"JsEnumsAsArrays",define:"js_enums_as_arrays",doc:"Generate enum representation as array instead of as object.",platforms:["js"]},{name:"JsUnflatten",define:"js_unflatten",doc:"Generate nested objects for packages and types.",platforms:["js"]},{name:"JsSourceMap",define:"js_source_map",doc:"Generate JavaScript source map even in non-debug mode. Deprecated in favor of `-D source_map`.",platforms:["js"]},{name:"SourceMap",define:"source_map",doc:"Generate source map for compiled files.",platforms:["php","js"]},{name:"Jvm",define:"jvm",doc:"Generate jvm directly.",platforms:["java"]},{name:"JvmCompressionLevel",define:"jvm.compression-level",doc:"Set the compression level of the generated file between 0 (no compression) and 9 (highest compression). Default: 6",platforms:["java"]},{name:"JvmDynamicLevel",define:"jvm.dynamic-level",doc:"Controls the amount of dynamic support code being generated. 0 = none, 1 = field read/write optimization (default), 2 = compile-time method closures",platforms:["java"]},{name:"KeepOldOutput",define:"keep_old_output",doc:"Keep old source files in the output directory.",platforms:["cs","java"]},{name:"LoopUnrollMaxCost",define:"loop_unroll_max_cost",doc:"Maximum cost (number of expressions * iterations) before loop unrolling is canceled. (default: 250)",params:["cost"]},{name:"LuaJit",define:"lua_jit",doc:"Enable the jit compiler for lua (version 5.2 only).",platforms:["lua"]},{name:"LuaVanilla",define:"lua_vanilla",doc:"Generate code lacking compiled extern lib support (e.g. utf8).",platforms:["lua"]},{name:"LuaVer",define:"lua_ver",doc:"The lua version to target.",platforms:["lua"],params:["version"]},{name:"Macro",define:"macro",doc:"Defined when code is compiled in the macro context.",links:["https://haxe.org/manual/macro.html"],reserved:!0},{name:"MacroTimes",define:"macro_times",doc:"Display per-macro timing when used with `--times`."},{name:"NetVer",define:"net_ver",doc:"Sets the .NET version to be targeted.",platforms:["cs"],params:["version: 20-45"]},{name:"NetcoreVer",define:"netcore_ver",doc:"Sets the .NET core version to be targeted",platforms:["cs"],params:["version: x.x.x"]},{name:"NetTarget",define:"net_target",doc:"Sets the .NET target. `netcore` (.NET core), `xbox`, `micro` (Micro Framework), `compact` (Compact Framework) are some valid values. (default: `net`)",platforms:["cs"],params:["name"]},{name:"NekoSource",define:"neko_source",doc:"Output neko source instead of bytecode.",platforms:["neko"]},{name:"NekoV1",define:"neko_v1",doc:"Keep Neko 1.x compatibility.",platforms:["neko"]},{name:"NetworkSandbox",define:"network-sandbox",doc:"Use local network sandbox instead of local file access one.",platforms:["flash"]},{name:"NoCompilation",define:"no-compilation",doc:"Disable final compilation.",platforms:["cs","java","cpp","hl"]},{name:"NoDebug",define:"no_debug",doc:"Remove all debug macros from cpp output."},{name:"NoDeprecationWarnings",define:"no-deprecation-warnings",doc:"Do not warn if fields annotated with `@:deprecated` are used."},{name:"NoFlashOverride",define:"no-flash-override",doc:"Change overrides on some basic classes into HX suffixed methods",platforms:["flash"]},{name:"NoOpt",define:"no_opt",doc:"Disable optimizations."},{name:"NoInline",define:"no_inline",doc:"Disable inlining.",links:["https://haxe.org/manual/class-field-inline.html"]},{name:"KeepInlinePositions",define:"keep_inline_positions",doc:"Don't substitute positions of inlined expressions with the position of the place of inlining.",links:["https://haxe.org/manual/class-field-inline.html"]},{name:"NoRoot",define:"no_root",doc:"Generate top-level types into the `haxe.root` namespace.",platforms:["cs"]},{name:"NoMacroCache",define:"no_macro_cache",doc:"Disable macro context caching."},{name:"NoSwfCompress",define:"no_swf_compress",doc:"Disable SWF output compression.",platforms:["flash"]},{name:"NoTraces",define:"no_traces",doc:"Disable all trace calls."},{name:"Objc",define:"objc",doc:"Sets the hxcpp output to Objective-C++ classes. Must be defined for interop.",platforms:["cpp"]},{name:"OldErrorFormat",define:"old-error-format",doc:"Use Haxe 3.x zero-based column error messages instead of new one-based format."},{name:"PhpPrefix",define:"php_prefix",doc:"Root namespace for generated php classes. E.g. if compiled with`-D php-prefix=some.sub`, then all classes will be generated in `\\some\\sub` namespace.",platforms:["php"],params:["dot-separated namespace"]},{name:"PhpLib",define:"php_lib",doc:"Select the name for the php lib folder.",platforms:["php"],params:["folder name"]},{name:"PhpFront",define:"php_front",doc:"Select the name for the php front file. (default: `index.php`)",platforms:["php"],params:["filename"]},{name:"PythonVersion",define:"python_version",doc:"The python version to target. (default: 3.3)",platforms:["python"],params:["version"]},{name:"RealPosition",define:"real_position",doc:"Disables Haxe source mapping when targetting C#, removes position comments in Java and Php output.",platforms:["cs","java","php"]},{name:"ReplaceFiles",define:"replace_files",doc:"GenCommon internal.",platforms:["cs","java"]},{name:"Scriptable",define:"scriptable",doc:"GenCPP internal.",platforms:["cpp"]},{name:"ShallowExpose",define:"shallow-expose",doc:"Expose types to surrounding scope of Haxe generated closure without writing to window object.",platforms:["js"]},{name:"SourceHeader",define:"source-header",doc:"Print value as comment on top of generated files, use '' value to disable."},{name:"SourceMapContent",define:"source-map-content",doc:"Include the Haxe sources as part of the JS source map.",platforms:["js"]},{name:"Static",define:"static",doc:"Defined if the current target is static.",reserved:!0},{name:"StdEncodingUtf8",define:"std-encoding-utf8",doc:"Force utf8 encoding for stdin, stdout and stderr",platforms:["java","cs","python"]},{name:"Swc",define:"swc",doc:"Output a SWC instead of a SWF.",platforms:["flash"],reserved:!0},{name:"SwfCompressLevel",define:"swf_compress_level",doc:"Set the amount of compression for the SWF output.",platforms:["flash"],params:["level: 1-9"]},{name:"SwfDebugPassword",define:"swf_debug_password",doc:"Set a password for debugging.",platforms:["flash"],params:["password"]},{name:"SwfDirectBlit",define:"swf_direct_blit",doc:"Use hardware acceleration to blit graphics.",platforms:["flash"]},{name:"SwfGpu",define:"swf_gpu",doc:"Use GPU compositing features when drawing graphics.",platforms:["flash"]},{name:"SwfMetadata",define:"swf_metadata",doc:"Include contents of the given file as metadata in the SWF.",platforms:["flash"],params:["file"]},{name:"SwfPreloaderFrame",define:"swf_preloader_frame",doc:"Insert empty first frame in SWF.",platforms:["flash"]},{name:"SwfProtected",define:"swf_protected",doc:"Compile Haxe `private` as `protected` in the SWF instead of `public`.",platforms:["flash"]},{name:"SwfScriptTimeout",define:"swf_script_timeout",doc:"Maximum ActionScript processing time before script stuck dialog box displays.",platforms:["flash"],params:["time in seconds"]},{name:"SwfUseDoAbc",define:"swf_use_doabc",doc:"Use `DoAbc` SWF-tag instead of `DoAbcDefine`.",platforms:["flash"]},{name:"Sys",define:"sys",doc:"Defined for all system platforms.",reserved:!0},{name:"Unsafe",define:"unsafe",doc:"Allow unsafe code when targeting C#.",platforms:["cs"]},{name:"UseNekoc",define:"use_nekoc",doc:"Use `nekoc` compiler instead of the internal one.",platforms:["neko"]},{name:"Utf16",define:"utf16",doc:"Defined for all platforms that use UTF-16 string encoding with UCS-2 API.",reserved:!0},{name:"Vcproj",define:"vcproj",doc:"GenCPP internal.",platforms:["cpp"]},{name:"WarnVarShadowing",define:"warn_var_shadowing",doc:"Warn about shadowing variable declarations."},{name:"NoTre",define:"no_tre",doc:"Disable tail recursion elimination."}],gl=function(e){let t=new qe;t.set(rr.Target,[{name:"--js",deprecatedNames:["-js"],argument:{name:"<file>",insertion:"bin/${1:main}.js",kind:nr.File},description:"generate JavaScript code into target file"},{name:"--lua",deprecatedNames:["-lua"],argument:{name:"<file>",insertion:"bin/${1:main}.lua",kind:nr.File},description:"generate Lua code into target file"},{name:"--swf",deprecatedNames:["-swf"],argument:{name:"<file>",insertion:"bin/${1:main}.swf",kind:nr.File},description:"generate Flash SWF bytecode into target file"},{name:"--neko",deprecatedNames:["-neko"],argument:{name:"<file>",insertion:"bin/${1:main}.n",kind:nr.File},description:"generate Neko bytecode into target file"},{name:"--php",deprecatedNames:["-php"],argument:{name:"<directory>",insertion:"bin/php",kind:nr.Directory},description:"generate PHP code into target directory"},{name:"--cpp",deprecatedNames:["-cpp"],argument:{name:"<directory>",insertion:"bin/cpp",kind:nr.Directory},description:"generate C++ code into target directory"},{name:"--cppia",deprecatedNames:["-cppia"],argument:{name:"<file>",insertion:"bin/${1:main}.cppia",kind:nr.File},description:"generate Cppia bytecode into target file"},{name:"--cs",deprecatedNames:["-cs"],argument:{name:"<directory>",insertion:"bin/cs",kind:nr.Directory},description:"generate C# code into target directory"},{name:"--java",deprecatedNames:["-java"],argument:{name:"<directory>",insertion:"bin/java",kind:nr.Directory},description:"generate Java code into target directory"},{name:"--jvm",deprecatedNames:["-jvm"],argument:{name:"<file>",insertion:"bin/${1:main}.jar",kind:nr.File},description:"generate JVM bytecode into target file"},{name:"--python",deprecatedNames:["-python"],argument:{name:"<file>",insertion:"bin/${1:main}.py",kind:nr.File},description:"generate Python code into target file"},{name:"--hl",deprecatedNames:["-hl"],argument:{name:"<file>",insertion:"bin/${1:main}.hl",kind:nr.File},description:"generate HashLink `.hl` bytecode or `.c` code into target file"},{name:"--interp",deprecatedNames:["-interp"],description:"interpret the program using internal macro system"},{name:"--run",argument:{name:"<module> [args...]",insertion:"Main"},description:"interpret a Haxe module with command line arguments"}]),t.set(rr.Compilation,[{name:"--class-path",shortName:"-p",deprecatedNames:["-cp"],argument:{name:"<path>",kind:nr.Directory},description:"add a directory to find source files"},{name:"--main",shortName:"-m",deprecatedNames:["-main"],argument:{name:"<class>",insertion:"Main"},description:"select startup class"},{name:"--library",shortName:"-L",deprecatedNames:["-lib"],argument:{name:"<name[:ver]>",kind:nr.LibraryName},description:"use a haxelib library"},{name:"--define",shortName:"-D",argument:{name:"<var[=value]>",kind:nr.Define},description:"define a conditional compilation flag"},{name:"--resource",shortName:"-r",deprecatedNames:["-resource"],argument:{name:"<file>[@name]",kind:nr.File},description:"define a conditional compilation flag"},{name:"--cmd",deprecatedNames:["-cmd"],argument:{name:"<command>",insertion:"command"},description:"run the specified command after successful compilation"},{name:"--remap",argument:{name:"<package:target>",insertion:"${1:package}:${2:target}"},description:"remap a package to another one"},{name:"--macro",argument:{name:"<macro>",insertion:"macro"},description:"call the given macro before typing anything else"},{name:"--cwd",shortName:"-C",argument:{name:"<directory>",kind:nr.Directory},description:"set current working directory"},{name:"--haxelib-global",description:"pass `--global` argument to haxelib"}]),t.set(rr.Optimization,[{name:"--dce",deprecatedNames:["-dce"],argument:{name:"[std|full|no]",kind:nr.Enum(dl)},description:"set the dead code elimination mode (default `std`)"},{name:"--no-traces",description:"don't compile trace calls in the program"},{name:"--no-output",description:"compiles but does not generate any file"},{name:"--no-inline",description:"disable inlining"},{name:"--no-opt",description:"disable code optimizations"}]),t.set(rr.Debug,[{name:"--verbose",shortName:"-v",description:"turn on verbose mode"},{name:"--debug",deprecatedNames:["-debug"],description:"add debug information to the compiled code"},{name:"--times",description:"measure compilation times"}]),t.set(rr.Batch,[{name:"--next",description:"separate several haxe compilations"},{name:"--each",description:"append preceding parameters to all Haxe compilations separated by `--next`"}]),t.set(rr.Services,[{name:"--xml",deprecatedNames:["-xml"],argument:{name:"<file>",insertion:"bin/${1:types}.xml",kind:nr.File},description:"generate XML types description"},{name:"--json",argument:{name:"<file>",insertion:"bin/${1:types}.json",kind:nr.File},description:"generate JSON types description"}]),t.set(rr.CompilationServer,[{name:"--connect",argument:{name:"<[host:]port>",insertion:"7000"},description:"connect on the given port and run commands there"}]);{let e=[9,10,10.1,10.2,10.3,11,11.1,11.2,11.3,11.4,11.5,11.6,11.7,11.8,11.9,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,31,32],n=new Array(e.length),r=0,i=e.length;for(;r<i;){let t=r++,i=e[t];n[t]={name:null==i?"null":""+i,description:null}}t.set(rr.TargetSpecific,[{name:"--swf-version",argument:{name:"<version>",kind:nr.Enum(n)},description:"change the SWF version"},{name:"--swf-header",argument:{name:"<header>",insertion:"${1:width}:${2:height}:${3:fps}:${4:color}"},description:"define SWF header (`width:height:fps:color`)"},{name:"--flash-strict",description:"more type strict flash API"},{name:"--swf-lib",argument:{name:"<file>",kind:nr.File},description:"add the SWF library to the compiled SWF"},{name:"--swf-lib-extern",argument:{name:"<file>",kind:nr.File},description:"use the SWF library for type checking"},{name:"--java-lib",argument:{name:"<file>",kind:nr.File},description:"add an external JAR or directory of JAR files"},{name:"--java-lib-extern",argument:{name:"<file>",kind:nr.File},description:"use an external JAR or directory of JAR files for type checking"},{name:"--net-lib",argument:{name:"<file>[@std]",kind:nr.File},description:"add an external .NET DLL file"},{name:"--net-std",argument:{name:"<file>",kind:nr.File},description:"add a root std .NET DLL search path"},{name:"--c-arg",argument:{name:"<arg>",insertion:"arg"},description:"pass option `<arg>` to the native Java/C# compiler"}])}t.set(rr.Miscellaneous,[]);{let e=0,r=[],i=t.iterator();for(;i.hasNext();){let e=tl(i.next());for(;e.hasNext();)r.push(e.next())}for(;e<r.length;){let t=r[e];++e,t.description=(n=t.description).charAt(0).toUpperCase()+a.substr(n,1,null)+"."}}var n;return t}();lr.reStartsWhitespace=new s("^\\s*",""),lr.reEndsWithWhitespace=new s("\\s*$",""),ur.positionRe=new s("^(.+):(\\d+): (?:lines (\\d+)-(\\d+)|character(?:s (\\d+)-| )(\\d+))$",""),ur.properFileNameCaseCache=new tt,ur.isWindows="Windows"==ae.systemName(),_r.reUpperCaseDriveLetter=new s("^([A-Z]:)",""),gr.reVersion=new s("^(\\d+)\\.(\\d+)\\.(\\d+)(?:[-]([a-z0-9.-]+))?(?:[+]([a-z0-9.-]+))?","i"),kr.stripAnsi=new s("[][[()#;?]*(?:[0-9]{1,4}(?:;[0-9]{0,4})*)?[0-9A-ORZcf-nqry=><]","g"),yr.groupRegex=new s("\\$(\\d+)","g"),yr.parenRegex=new s("^\\((.*)\\)$",""),yr.argNameRegex=new s("^(\\??\\w+) : ",""),yr.monomorphRegex=new s("^Unknown<\\d+>$",""),yr.nullRegex=new s("^Null<(\\$\\d+)>$",""),yr.packagePathsRegex=new s("((?:_*[a-z]\\w*\\.)*)(?=_*[A-Z])","g"),yr.subtypePackageRegex=new s("\\b[A-Z]\\w*\\.[A-Z]","");var xl={title:"Trigger Suggest",command:"editor.action.triggerSuggest",arguments:[]},kl={title:"Trigger Parameter Hints",command:"editor.action.triggerParameterHints",arguments:[]};Sr.castRegex=new s("^(cast )+",""),Mr.stdinSepBuf=jr.alloc(1,1),Wr._hx_skip_constructor=!1,Wr.reTrailingNewline=new s("\r?\n$",""),gi.EMPTY=[],gi.ALL_CHARS=[new _i(0,255)],bi.keywords=function(e){let t=new tt;return t.m.set("function",li.KwdFunction),t.m.set("class",li.KwdClass),t.m.set("var",li.KwdVar),t.m.set("if",li.KwdIf),t.m.set("else",li.KwdElse),t.m.set("while",li.KwdWhile),t.m.set("do",li.KwdDo),t.m.set("for",li.KwdFor),t.m.set("break",li.KwdBreak),t.m.set("continue",li.KwdContinue),t.m.set("return",li.KwdReturn),t.m.set("extends",li.KwdExtends),t.m.set("implements",li.KwdImplements),t.m.set("import",li.KwdImport),t.m.set("switch",li.KwdSwitch),t.m.set("case",li.KwdCase),t.m.set("default",li.KwdDefault),t.m.set("static",li.KwdStatic),t.m.set("public",li.KwdPublic),t.m.set("private",li.KwdPrivate),t.m.set("try",li.KwdTry),t.m.set("catch",li.KwdCatch),t.m.set("new",li.KwdNew),t.m.set("this",li.KwdThis),t.m.set("throw",li.KwdThrow),t.m.set("extern",li.KwdExtern),t.m.set("enum",li.KwdEnum),t.m.set("in",li.KwdIn),t.m.set("interface",li.KwdInterface),t.m.set("untyped",li.KwdUntyped),t.m.set("cast",li.KwdCast),t.m.set("override",li.KwdOverride),t.m.set("typedef",li.KwdTypedef),t.m.set("dynamic",li.KwdDynamic),t.m.set("package",li.KwdPackage),t.m.set("inline",li.KwdInline),t.m.set("using",li.KwdUsing),t.m.set("null",li.KwdNull),t.m.set("true",li.KwdTrue),t.m.set("false",li.KwdFalse),t.m.set("abstract",li.KwdAbstract),t.m.set("macro",li.KwdMacro),t.m.set("final",li.KwdFinal),t.m.set("operator",li.KwdOperator),t.m.set("overload",li.KwdOverload),t}(),bi.buf=new ie,bi.tok=fi.buildRuleset([{rule:"",func:function(e){return bi.mk(e,oi.Eof)}},{rule:"[\r\n\t ]+",func:function(e){return e.token(bi.tok)}},{rule:"((0x)(([0-9a-fA-F](_?[0-9a-fA-F])*)+))((_?[iu](([1-9](_?[0-9])*)|0)+)?)",func:function(e){return bi.mk(e,bi.splitIntSuffix(e.current))}},{rule:"((0b)(([01](_?[01])*)+))((_?[iu](([1-9](_?[0-9])*)|0)+)?)",func:function(e){return bi.mk(e,bi.splitIntSuffix(e.current))}},{rule:"(([1-9](_?[0-9])*)|0)((_?[iu](([1-9](_?[0-9])*)|0)+)?)",func:function(e){return bi.mk(e,bi.splitIntSuffix(e.current))}},{rule:"(([1-9](_?[0-9])*)|0)((_?f(([1-9](_?[0-9])*)|0)+)?)",func:function(e){return bi.mk(e,bi.splitFloatSuffix(e.current))}},{rule:"(((([1-9](_?[0-9])*)|0)(\\.))(([0-9](_?[0-9])*)+))((_?f(([1-9](_?[0-9])*)|0)+)?)",func:function(e){return bi.mk(e,bi.splitFloatSuffix(e.current))}},{rule:"((\\.)(([0-9](_?[0-9])*)+))((_?f(([1-9](_?[0-9])*)|0)+)?)",func:function(e){return bi.mk(e,bi.splitFloatSuffix(e.current))}},{rule:"(((([1-9](_?[0-9])*)|0)([eE][\\+\\-]?))(([0-9](_?[0-9])*)+))((_?f(([1-9](_?[0-9])*)|0)+)?)",func:function(e){return bi.mk(e,bi.splitFloatSuffix(e.current))}},{rule:"(((([1-9](_?[0-9])*)|0)(\\.[0-9]*[eE][\\+\\-]?))(([0-9](_?[0-9])*)+))((_?f(([1-9](_?[0-9])*)|0)+)?)",func:function(e){return bi.mk(e,bi.splitFloatSuffix(e.current))}},{rule:"(([1-9](_?[0-9])*)|0)(\\.\\.\\.)",func:function(e){return bi.mk(e,oi.IntInterval(a.substr(e.current,0,-3)))}},{rule:"//[^\n\r]*",func:function(e){return bi.mk(e,oi.CommentLine(a.substr(e.current,2,null)))}},{rule:"+\\+",func:function(e){return bi.mk(e,oi.Unop(dt.OpIncrement))}},{rule:"--",func:function(e){return bi.mk(e,oi.Unop(dt.OpDecrement))}},{rule:"~",func:function(e){return bi.mk(e,oi.Unop(dt.OpNegBits))}},{rule:"%=",func:function(e){return bi.mk(e,oi.Binop(ht.OpAssignOp(ht.OpMod)))}},{rule:"&=",func:function(e){return bi.mk(e,oi.Binop(ht.OpAssignOp(ht.OpAnd)))}},{rule:"|=",func:function(e){return bi.mk(e,oi.Binop(ht.OpAssignOp(ht.OpOr)))}},{rule:"^=",func:function(e){return bi.mk(e,oi.Binop(ht.OpAssignOp(ht.OpXor)))}},{rule:"+=",func:function(e){return bi.mk(e,oi.Binop(ht.OpAssignOp(ht.OpAdd)))}},{rule:"-=",func:function(e){return bi.mk(e,oi.Binop(ht.OpAssignOp(ht.OpSub)))}},{rule:"*=",func:function(e){return bi.mk(e,oi.Binop(ht.OpAssignOp(ht.OpMult)))}},{rule:"/=",func:function(e){return bi.mk(e,oi.Binop(ht.OpAssignOp(ht.OpDiv)))}},{rule:"<<=",func:function(e){return bi.mk(e,oi.Binop(ht.OpAssignOp(ht.OpShl)))}},{rule:"|\\|=",func:function(e){return bi.mk(e,oi.Binop(ht.OpAssignOp(ht.OpBoolOr)))}},{rule:"&&=",func:function(e){return bi.mk(e,oi.Binop(ht.OpAssignOp(ht.OpBoolAnd)))}},{rule:"?\\?=",func:function(e){return bi.mk(e,oi.Binop(ht.OpAssignOp(ht.OpNullCoal)))}},{rule:"==",func:function(e){return bi.mk(e,oi.Binop(ht.OpEq))}},{rule:"!=",func:function(e){return bi.mk(e,oi.Binop(ht.OpNotEq))}},{rule:"<=",func:function(e){return bi.mk(e,oi.Binop(ht.OpLte))}},{rule:"&&",func:function(e){return bi.mk(e,oi.Binop(ht.OpBoolAnd))}},{rule:"|\\|",func:function(e){return bi.mk(e,oi.Binop(ht.OpBoolOr))}},{rule:"<<",func:function(e){return bi.mk(e,oi.Binop(ht.OpShl))}},{rule:"->",func:function(e){return bi.mk(e,oi.Arrow)}},{rule:"\\.\\.\\.",func:function(e){return bi.mk(e,oi.Spread)}},{rule:"=>",func:function(e){return bi.mk(e,oi.Binop(ht.OpArrow))}},{rule:"!",func:function(e){return bi.mk(e,oi.Unop(dt.OpNot))}},{rule:"(<)([$|:A-Z_a-z\\u{x00C0}-\\u{x00D6}\\u{x00D8}-\\u{x00F6}\\u{x00F8}-\\u{x002FF}\\u{x00370}-\\u{x0037D}\\u{x0037F}-\\u{x001FFF}\\u{x00200C}-\\u{x00200D}\\u{x002070}-\\u{x00218F}\\u{x002C00}-\\u{x002FEF}\\u{x003001}-\\u{x00D7FF}\\u{x00F900}-\\u{x00FDCF}\\u{x00FDF0}-\\u{x00FFFD}\\u{x0010000}-\\u{x00EFFFF}][$|:A-Z_a-z\\u{x00C0}-\\u{x00D6}\\u{x00D8}-\\u{x00F6}\\u{x00F8}-\\u{x002FF}\\u{x00370}-\\u{x0037D}\\u{x0037F}-\\u{x001FFF}\\u{x00200C}-\\u{x00200D}\\u{x002070}-\\u{x00218F}\\u{x002C00}-\\u{x002FEF}\\u{x003001}-\\u{x00D7FF}\\u{x00F900}-\\u{x00FDCF}\\u{x00FDF0}-\\u{x00FFFD}\\u{x0010000}-\\u{x00EFFFF}\\-.0-9\\u{x00B7}\\u{x0300}-\\u{x036F}\\u{x203F}-\\u{x2040}]*)",func:function(e){return bi.inlineMarkup(e)}},{rule:"<",func:function(e){return bi.mk(e,oi.Binop(ht.OpLt))}},{rule:">",func:function(e){return bi.mk(e,oi.Binop(ht.OpGt))}},{rule:";",func:function(e){return bi.mk(e,oi.Semicolon)}},{rule:":",func:function(e){return bi.mk(e,oi.DblDot)}},{rule:",",func:function(e){return bi.mk(e,oi.Comma)}},{rule:"?\\.",func:function(e){return bi.mk(e,oi.QuestionDot)}},{rule:"\\.",func:function(e){return bi.mk(e,oi.Dot)}},{rule:"%",func:function(e){return bi.mk(e,oi.Binop(ht.OpMod))}},{rule:"&",func:function(e){return bi.mk(e,oi.Binop(ht.OpAnd))}},{rule:"|",func:function(e){return bi.mk(e,oi.Binop(ht.OpOr))}},{rule:"^",func:function(e){return bi.mk(e,oi.Binop(ht.OpXor))}},{rule:"+",func:function(e){return bi.mk(e,oi.Binop(ht.OpAdd))}},{rule:"*",func:function(e){return bi.mk(e,oi.Binop(ht.OpMult))}},{rule:"/",func:function(e){return bi.mk(e,oi.Binop(ht.OpDiv))}},{rule:"-",func:function(e){return bi.mk(e,oi.Binop(ht.OpSub))}},{rule:"=",func:function(e){return bi.mk(e,oi.Binop(ht.OpAssign))}},{rule:"[",func:function(e){return bi.mk(e,oi.BkOpen)}},{rule:"]",func:function(e){return bi.mk(e,oi.BkClose)}},{rule:"{",func:function(e){return bi.mk(e,oi.BrOpen)}},{rule:"}",func:function(e){return bi.mk(e,oi.BrClose)}},{rule:"\\(",func:function(e){return bi.mk(e,oi.POpen)}},{rule:"\\)",func:function(e){return bi.mk(e,oi.PClose)}},{rule:"?\\?",func:function(e){return bi.mk(e,oi.Binop(ht.OpNullCoal))}},{rule:"?",func:function(e){return bi.mk(e,oi.Question)}},{rule:"@",func:function(e){return bi.mk(e,oi.At)}},{rule:'"',func:function(e){bi.buf=new ie;let t=new wi(e.source,e.pos-e.current.length,e.pos);try{e.token(bi.string)}catch(e){throw We.lastError=e,Me.caught(e).unwrap()instanceof at?Me.thrown(new pi(di.UnterminatedString,bi.mkPos(t))):e}let n=bi.mk(e,oi.Const(ci.CString(bi.unescape(bi.buf.b,bi.mkPos(t)),ut.DoubleQuotes)));return n.pos.min=t.pmin,n}},{rule:"'",func:function(e){bi.buf=new ie;let t=new wi(e.source,e.pos-e.current.length,e.pos);try{e.token(bi.string2)}catch(e){throw We.lastError=e,Me.caught(e).unwrap()instanceof at?Me.thrown(new pi(di.UnterminatedString,bi.mkPos(t))):e}let n=bi.mk(e,oi.Const(ci.CString(bi.unescape(bi.buf.b,bi.mkPos(t)),ut.SingleQuotes)));return n.pos.min=t.pmin,n}},{rule:"~/",func:function(e){bi.buf=new ie;let t,n=new wi(e.source,e.pos-e.current.length,e.pos);try{t=e.token(bi.regexp)}catch(e){throw We.lastError=e,Me.caught(e).unwrap()instanceof at?Me.thrown(new pi(di.UnterminatedRegExp,bi.mkPos(n))):e}let r=bi.mk(e,oi.Const(ci.CRegexp(bi.buf.b,t.opt)));return r.pos.min=n.pmin,r}},{rule:"/\\*",func:function(e){bi.buf=new ie;let t=new wi(e.source,e.pos-e.current.length,e.pos);try{e.token(bi.comment)}catch(e){throw We.lastError=e,Me.caught(e).unwrap()instanceof at?Me.thrown(new pi(di.UnclosedComment,bi.mkPos(t))):e}let n=bi.mk(e,oi.Comment(bi.buf.b));return n.pos.min=t.pmin,n}},{rule:"(#)(_*[a-z][a-zA-Z0-9_]*|_+|_+[0-9][_a-zA-Z0-9]*)",func:function(e){return bi.mk(e,oi.Sharp(a.substr(e.current,1,null)))}},{rule:"$[_a-zA-Z0-9]*",func:function(e){return bi.mk(e,oi.Dollar(a.substr(e.current,1,null)))}},{rule:"_*[a-z][a-zA-Z0-9_]*|_+|_+[0-9][_a-zA-Z0-9]*",func:function(e){let t=bi.keywords.m.get(e.current);return null!=t?bi.mk(e,oi.Kwd(t)):bi.mk(e,oi.Const(ci.CIdent(e.current)))}},{rule:"_*[A-Z][a-zA-Z0-9_]*",func:function(e){return bi.mk(e,oi.Const(ci.CIdent(e.current)))}}],"tok"),bi.string=fi.buildRuleset([{rule:"\\\\\\\\",func:function(e){return bi.buf.b+="\\\\",e.token(bi.string)}},{rule:"\\\\",func:function(e){return bi.buf.b+="\\",e.token(bi.string)}},{rule:'\\\\"',func:function(e){return bi.buf.b+='"',e.token(bi.string)}},{rule:'"',func:function(e){return new wi(e.source,e.pos-e.current.length,e.pos).pmax}},{rule:'[^\\\\"]+',func:function(e){return bi.buf.b+=re.string(e.current),e.token(bi.string)}}],"string"),bi.string2=fi.buildRuleset([{rule:"\\\\\\\\",func:function(e){return bi.buf.b+="\\\\",e.token(bi.string2)}},{rule:"\\\\",func:function(e){return bi.buf.b+="\\",e.token(bi.string2)}},{rule:"\\\\'",func:function(e){return bi.buf.b+="'",e.token(bi.string2)}},{rule:"'",func:function(e){return new wi(e.source,e.pos-e.current.length,e.pos).pmax}},{rule:"($$)|(\\$)|$",func:function(e){return bi.buf.b+="$",e.token(bi.string2)}},{rule:"${",func:function(e){let t=new wi(e.source,e.pos-e.current.length,e.pos);bi.buf.b+=re.string(e.current);try{e.token(bi.codeString)}catch(e){throw We.lastError=e,Me.caught(e).unwrap()instanceof at?Me.thrown(new pi(di.UnclosedCode,bi.mkPos(t))):e}return e.token(bi.string2)}},{rule:"[^$\\\\']+",func:function(e){return bi.buf.b+=re.string(e.current),e.token(bi.string2)}}],"string2"),bi.codeString=fi.buildRuleset([{rule:"{|/",func:function(e){bi.buf.b+=re.string(e.current),e.token(bi.codeString)}},{rule:"}",func:function(e){bi.buf.b+=re.string(e.current)}},{rule:'"',func:function(e){bi.buf.b+=String.fromCodePoint(34);let t=new wi(e.source,e.pos-e.current.length,e.pos);try{e.token(bi.string)}catch(e){throw We.lastError=e,Me.caught(e).unwrap()instanceof at?Me.thrown(new pi(di.UnterminatedString,bi.mkPos(t))):e}bi.buf.b+=String.fromCodePoint(34),e.token(bi.codeString)}},{rule:"'",func:function(e){bi.buf.b+=String.fromCodePoint(39);let t=new wi(e.source,e.pos-e.current.length,e.pos);try{e.token(bi.string2)}catch(e){throw We.lastError=e,Me.caught(e).unwrap()instanceof at?Me.thrown(new pi(di.UnterminatedString,bi.mkPos(t))):e}bi.buf.b+=String.fromCodePoint(39),e.token(bi.codeString)}},{rule:"/\\*",func:function(e){let t=new wi(e.source,e.pos-e.current.length,e.pos);try{e.token(bi.comment)}catch(e){throw We.lastError=e,Me.caught(e).unwrap()instanceof at?Me.thrown(new pi(di.UnclosedComment,bi.mkPos(t))):e}e.token(bi.codeString)}},{rule:"//[^\n\r]*",func:function(e){bi.buf.b+=re.string(e.current),e.token(bi.codeString)}},{rule:"[^/\"'{}\n\r]+",func:function(e){bi.buf.b+=re.string(e.current),e.token(bi.codeString)}},{rule:"[\r\n\t ]+",func:function(e){bi.buf.b+=re.string(e.current),e.token(bi.codeString)}}],"codeString"),bi.comment=fi.buildRuleset([{rule:"*/",func:function(e){return new wi(e.source,e.pos-e.current.length,e.pos).pmax}},{rule:"*",func:function(e){return bi.buf.b+="*",e.token(bi.comment)}},{rule:"[^\\*]+",func:function(e){return bi.buf.b+=re.string(e.current),e.token(bi.comment)}}],"comment"),bi.regexp=fi.buildRuleset([{rule:"\\\\/",func:function(e){return bi.buf.b+="/",e.token(bi.regexp)}},{rule:"\\\\r",func:function(e){return bi.buf.b+="\r",e.token(bi.regexp)}},{rule:"\\\\n",func:function(e){return bi.buf.b+="\n",e.token(bi.regexp)}},{rule:"\\\\t",func:function(e){return bi.buf.b+="\t",e.token(bi.regexp)}},{rule:"\\\\[\\\\$\\.*+\\^|{}\\[\\]()?\\-0-9]",func:function(e){return bi.buf.b+=re.string(e.current),e.token(bi.regexp)}},{rule:"\\\\[wWbBsSdDx]",func:function(e){return bi.buf.b+=re.string(e.current),e.token(bi.regexp)}},{rule:"\\\\[uU][0-9a-fA-F][0-9a-fA-F][0-9a-fA-F][0-9a-fA-F]",func:function(e){return bi.buf.b+=re.string(e.current),e.token(bi.regexp)}},{rule:"\\[^\\]",func:function(e){throw Me.thrown(new pi(di.UnterminatedRegExp,bi.mkPos(new wi(e.source,e.pos-e.current.length,e.pos))))}},{rule:"/",func:function(e){return e.token(bi.regexp_options)}},{rule:"[^\\\\/\r\n]+",func:function(e){return bi.buf.b+=re.string(e.current),e.token(bi.regexp)}}],"regexp"),bi.regexp_options=fi.buildRuleset([{rule:"[gimsu]*",func:function(e){return{pmax:new wi(e.source,e.pos-e.current.length,e.pos).pmax,opt:e.current}}}],"regexp_options"),Gi.CR=jr.from("\r","ascii")[0],Gi.LF=jr.from("\n","ascii")[0],Qs.copyBuf=jr.alloc(65536),ea.MODE=Ys.Strict,function(){let e=new Ki(process.stdin),t=new qi(process.stdout),n=new Ji(nl(t,t.write));n.logError=function(e){let t={type:2,message:e},r={jsonrpc:"2.0",method:"window/logMessage"};null!=t&&(r.params=t),n.writeMessage(r,null),null!=n.didSendNotification&&n.didSendNotification(r)},function(e){He.trace=function(t,n){let r=[re.string(t)];if(null!=n&&null!=n.customParams){let e=0,t=n.customParams;for(;e<t.length;)r.push(re.string(t[e++]))}let i={type:4,message:r.join(" ")},s={jsonrpc:"2.0",method:"window/logMessage"};null!=i&&(s.params=i),e.writeMessage(s,null),null!=e.didSendNotification&&e.didSendNotification(s)}}(n);let r=new kt(n);e.listen(nl(n,n.handleMessage));let i=function(e,t){if(r.config.sendMethodResults){let r={kind:"Lsp",method:e,debugInfo:null,response:{result:t}},i={jsonrpc:"2.0",method:"haxe/didRunHaxeMethod"};null!=r&&(i.params=r),n.writeMessage(i,null),null!=n.didSendNotification&&n.didSendNotification(i)}};n.didRespondToRequest=function(e,t){i(e.method,{request:e,response:t})},n.didSendNotification=function(e){"window/logMessage"==e.method||e.method.startsWith("haxe/")||i(e.method,e)}}()}("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);